Section: Abstract

The metabolic activities of microbial communities play a defining role in the evolution and persistence of life on Earth, driving redox reactions that give rise to global biogeochemical cycles. Community metabolism emerges from a hierarchy of processes, including gene expression, ecological interactions, and environmental factors. In wild communities, gene content is correlated with environmental context, but predicting metabolite dynamics from genomes remains elusive. Here, we show, for the process of denitrification, that metabolite dynamics of a community are predictable from the genes each member of the community possesses. A simple linear regression reveals a sparse and generalizable mapping from gene content to metabolite dynamics for genomically diverse bacteria. A consumer-resource model correctly predicts community metabolite dynamics from single-strain phenotypes. Our results demonstrate that the conserved impacts of metabolic genes can predict community metabolite dynamics, enabling the prediction of metabolite dynamics from metagenomes, designing denitrifying communities, and discovering how genome evolution impacts metabolism.

Section: Introduction, Literature Review

The metabolism of microbial communities plays an essential role in sustaining life on Earth, impacting global nutrient cycles ( Falkowski et al., 2008 22. Falkowski, P.G. ∙ Fenchel, T. ∙ Delong, E.F. The microbial engines that drive earth's biogeochemical cycles Science. 2008; 320 :1034-1039 Crossref Scopus (1460) PubMed Google Scholar ; Canfield et al., 2010 11. Canfield, D.E. ∙ Glazer, A.N. ∙ Falkowski, P.G. The evolution and future of earth's nitrogen cycle Science. 2010; 330 :192-196 Crossref Scopus (1276) PubMed Google Scholar ; Stein and Klotz, 2016 103. Stein, L.Y. ∙ Klotz, M.G. The nitrogen cycle Curr. Biol. 2016; 26 :R94-R98 Full Text Full Text (PDF) Scopus (151) PubMed Google Scholar ), wastewater treatment ( Lu et al., 2014 66. Lu, H. ∙ Chandran, K. ∙ Stensel, D. Microbial ecology of denitrification in biological wastewater treatment Water Res. 2014; 64 :237-254 Crossref Scopus (362) PubMed Google Scholar ), and human health ( Subramanian et al., 2014 106. Subramanian, S. ∙ Huq, S. ∙ Yatsunenko, T. ... Persistent gut microbiota immaturity in malnourished Bangladeshi children Nature. 2014; 510 :417-421 Crossref Scopus (625) PubMed Google Scholar ). A challenge in microbial ecology is understanding how community metabolism is determined by the taxa present, their metabolic traits, and the genes they possess ( Widder et al., 2016 116. Widder, S. ∙ Allen, R.J. ∙ Pfeiffer, T. ... Challenges in microbial ecology: building predictive understanding of community function and dynamics ISME J. 2016; 10 :2557-2568 Crossref Scopus (321) PubMed Google Scholar ; Louca et al., 2018 65. Louca, S. ∙ Polz, M.F. ∙ Mazel, F. ... Function and functional redundancy in microbial systems Nat. Ecol. Evol. 2018; 2 :936-943 Crossref Scopus (326) PubMed Google Scholar ). Addressing this challenge requires mapping the genotypes of each community member to its metabolic traits and then deciphering how complex interactions between each member impact the flux of metabolites through the community. Complicating the prediction of metabolite fluxes from community composition, interactions can depend on extracellular metabolites ( Lilja and Johnson, 2016 60. Lilja, E.E. ∙ Johnson, D.R. Segregating metabolic processes into different microbial cells accelerates the consumption of inhibitory substrates ISME J. 2016; 10 :1568-1578 Crossref Scopus (43) PubMed Google Scholar ), abiotic factors ( Ward et al., 2006 113. Ward, D.M. ∙ Bateson, M.M. ∙ Ferris, M.J. ... Cyanobacterial ecotypes in the microbial mat community of Mushroom Spring (Yellowstone National Park, Wyoming) as species-like units linking microbial community composition, structure and function Philos. Trans. R. Soc. Lond. B Biol. Sci. 2006; 361 :1997-2008 Crossref Scopus (0) PubMed Google Scholar ), cooperation ( Cordero et al., 2012 15. Cordero, O.X. ∙ Ventouras, L.A. ∙ DeLong, E.F. ... Public good dynamics drive evolution of iron acquisition strategies in natural bacterioplankton populations Proc. Natl. Acad. Sci. USA. 2012; 109 :20059-20064 Crossref Scopus (194) PubMed Google Scholar ), and higher-order effects ( Sanchez-Gorostiaga et al., 2019 93. Sanchez-Gorostiaga, A. ∙ Bajić, D. ∙ Osborne, M.L. ... High-order interactions distort the functional landscape of microbial consortia PLoS Biol. 2019; 17 :e3000550 Crossref Scopus (24) PubMed Google Scholar ; Mickalide and Kuehn, 2019 74. Mickalide, H. ∙ Kuehn, S. Higher-order interaction between species inhibits bacterial invasion of a phototroph-predator microbial community Cell Syst. 2019; 9 :521-533.e10 Full Text Full Text (PDF) Scopus (18) PubMed Google Scholar ). Despite these challenges, connecting genomic structure to the collective metabolism of a community is important for functionally interpreting community gene content ( Anantharaman et al., 2016 2. Anantharaman, K. ∙ Brown, C.T. ∙ Hug, L.A. ... Thousands of microbial genomes shed light on interconnected biogeochemical processes in an aquifer system Nat. Commun. 2016; 7 :13219 Crossref Scopus (451) PubMed Google Scholar ), designing synthetic communities ( Shou et al., 2007 100. Shou, W. ∙ Ram, S. ∙ Vilar, J.M.G. Synthetic cooperation in engineered yeast populations Proc. Natl. Acad. Sci. USA. 2007; 104 :1877-1882 Crossref Scopus (282) PubMed Google Scholar ), and understanding how gene gain and loss ( Molina and Nimwegen, 2009 77. Molina, N. ∙ Nimwegen, E. van. Scaling laws in functional genome content across prokaryotic clades and lifestyles Trends Genet. 2009; 25 :243-247 Full Text Full Text (PDF) Scopus (40) PubMed Google Scholar ; Sela et al., 2019 99. Sela, I. ∙ Wolf, Y.I. ∙ Koonin, E.V. Selection and genome plasticity as the key factors in the evolution of bacteria Phys. Rev. X. 2019; 9 , 031018 Google Scholar ) impact community metabolism.
Recent work suggests that the genes present in a community may be more informative about metabolic activity than the identity of strains or species making up the community. Sequencing studies of environmental and host-associated communities show that, while the individual strains or species present are often highly variable ( Louca et al., 2018 65. Louca, S. ∙ Polz, M.F. ∙ Mazel, F. ... Function and functional redundancy in microbial systems Nat. Ecol. Evol. 2018; 2 :936-943 Crossref Scopus (326) PubMed Google Scholar ), the genes or pathways present are often observed to be stable across communities in similar environments ( Louca et al., 2018 65. Louca, S. ∙ Polz, M.F. ∙ Mazel, F. ... Function and functional redundancy in microbial systems Nat. Ecol. Evol. 2018; 2 :936-943 Crossref Scopus (326) PubMed Google Scholar ; Human Microbiome Project Consortium, 2012 44. Human Microbiome Project Consortium Structure, function and diversity of the healthy human microbiome Nature. 2012; 486 :207-214 Crossref Scopus (6048) PubMed Google Scholar ). For example, aquatic communities native to bromeliads contain prokaryotes from several functional groups (e.g., methanogens, fermenters, and photoautotrophs). The strain or species representing each functional group varies widely from one plant to the next, but the relative abundance of each functional group is remarkably stable across plants ( Louca et al., 2016a 63. Louca, S. ∙ Jacques, S.M.S. ∙ Pires, A.P.F. ... High taxonomic variability despite stable functional structure across microbial communities Nat. Ecol. Evol. 2016; 1 :15 Crossref PubMed Google Scholar ). Similarly, studies in oceans and soils that measure both gene content and nutrient levels have found that the relative abundances of specific metabolic genes are better predictors of nutrient levels than the abundances of specific taxa ( Jones and Hallin, 2010 48. Jones, C.M. ∙ Hallin, S. Ecological and evolutionary factors underlying global and local assembly of denitrifier communities ISME J. 2010; 4 :633-641 Crossref Scopus (174) PubMed Google Scholar ; Fierer et al., 2012 24. Fierer, N. ∙ Lauber, C.L. ∙ Ramirez, K.S. ... Comparative metagenomic, phylogenetic and physiological analyses of soil microbial communities across nitrogen gradients ISME J. 2012; 6 :1007-1017 Crossref Scopus (909) PubMed Google Scholar ; Louca et al., 2016b 64. Louca, S. ∙ Parfrey, L.W. ∙ Doebeli, M. Decoupling function and taxonomy in the global ocean microbiome Science. 2016; 353 :1272-1277 Crossref Scopus (723) PubMed Google Scholar ). These results suggest that the availability of nutrients, such as organic carbon, oxygen, nitrate, carbon dioxide, and light, constrain the composition of the community in terms of the abundances of specific metabolic capabilities more so than they constrain the taxa possessing those capabilities. One implication of this finding is that communities with similar genomic composition, in terms of the metabolic pathways they possess, might exhibit similar rates and productivity of the associated metabolic process, but any such correspondence is yet to be demonstrated.
Corroborating the idea that nutrient availability strongly determines community composition, experiments in fixed nutrient conditions have shown that the metabolic traits of bacterial strains in assembled communities can be highly reproducible. To show this, several groups have sampled complex communities from natural environments and grown them under defined nutrient conditions in the laboratory ( Datta et al., 2016 18. Datta, M.S. ∙ Sliwerska, E. ∙ Gore, J. ... Microbial interactions lead to rapid micro-scale successions on model marine particles Nat. Commun. 2016; 7 :11965 Crossref Scopus (149) PubMed Google Scholar ; Goldford et al., 2018 31. Goldford, J.E. ∙ Lu, N. ∙ Bajić, D. ... Emergent simplicity in microbial community assembly Science. 2018; 361 :469-474 Crossref Scopus (276) PubMed Google Scholar ). Using this approach, Datta et al. showed that marine microbial communities degrading polysaccharide particles exhibit a succession of bacterial taxa ( Datta et al., 2016 18. Datta, M.S. ∙ Sliwerska, E. ∙ Gore, J. ... Microbial interactions lead to rapid micro-scale successions on model marine particles Nat. Commun. 2016; 7 :11965 Crossref Scopus (149) PubMed Google Scholar ). Succession on these particles arises from initial colonizers that cleave polysaccharides, followed by strains that compete for the resulting oligosaccharides or consume byproducts of sugar metabolism. Similarly, bacterial communities sampled from leaf surfaces and enriched in glucose minimal medium reproducibly yield communities comprising both consumers of glucose and consumers of glucose metabolic byproducts ( Goldford et al., 2018 31. Goldford, J.E. ∙ Lu, N. ∙ Bajić, D. ... Emergent simplicity in microbial community assembly Science. 2018; 361 :469-474 Crossref Scopus (276) PubMed Google Scholar ).
Although the traits of organisms in an assembled community appear to be strongly influenced by the available nutrients, quantitatively relating genomic structure to the rates and productivity of metabolic processes at the community level remains a challenge. Phenotyping mutants of model organisms has done much to uncover the molecular basis of specific metabolic processes such as denitrification ( Zumft, 1997 117. Zumft, W.G. Cell biology and molecular basis of denitrification Microbiol. Mol. Biol. Rev. 1997; 61 :533-616 Crossref PubMed Google Scholar ). However, it is unclear how to use a detailed molecular characterization of metabolism in a few model organisms to understand the metabolic traits of organisms in natural communities that possess high levels of genomic diversity ( Sakoparnig et al., 2021 92. Sakoparnig, T. ∙ Field, C. ∙ Nimwegen, E. van. Whole genome phylogenies reflect the distributions of recombination rates for many bacterial species eLife. 2021; 10 :e65366 Crossref Scopus (2) PubMed Google Scholar ). Additionally, we lack an understanding of how this genomic diversity drives variation in metabolic traits and how phenotypes of individual taxa combine to give rise to metabolite fluxes through a community.
Here, we address the challenge of mapping gene content to metabolite dynamics by quantifying the flux of metabolites in an ensemble of genomically diverse communities composed of non-model organisms (see Figure 1 for a summary of the approach). We used bacterial denitrification, an essential metabolic process in the global nitrogen cycle that is performed by diverse and culturable bacterial taxa ( Lycus et al., 2017 67. Lycus, P. ∙ Lovise Bøthun, K. ∙ Bergaust, L. ... Phenotypic and genotypic richness of denitrifiers revealed by a novel isolation strategy ISME J. 2017; 11 :2219-2232 Crossref Scopus (72) PubMed Google Scholar ), as a model metabolic process. We isolated an ensemble of denitrifiers and measured the dynamics of metabolite consumption and production for each isolate under controlled conditions. We then parameterized metabolite dynamics using a consumer-resource model. The genomic diversity of the ensemble of isolates enabled a simple linear regression approach to mapping gene content to consumer-resource model parameters, which resulted in a sparse and generalizable mapping of gene presence and absence to metabolic phenotypes. Finally, the consumer-resource model captured interactions between strains mediated by resource competition, yielding predictions for community-level metabolite dynamics that we verified experimentally.

Section: Results

We used denitrification as a model metabolic process because it is performed by diverse bacterial taxa, it is well characterized at the molecular level, and the relevant metabolites are readily quantifiable ( Zumft, 1997 117. Zumft, W.G. Cell biology and molecular basis of denitrification Microbiol. Mol. Biol. Rev. 1997; 61 :533-616 Crossref PubMed Google Scholar ). Because denitrifiers are easily isolated and cultured ( Lycus et al., 2017 67. Lycus, P. ∙ Lovise Bøthun, K. ∙ Bergaust, L. ... Phenotypic and genotypic richness of denitrifiers revealed by a novel isolation strategy ISME J. 2017; 11 :2219-2232 Crossref Scopus (72) PubMed Google Scholar ), we can capture substantial genomic diversity in an ensemble of natural isolates.
Denitrification is a form of anaerobic respiration whereby microbes use oxidized nitrogen compounds as electron acceptors, driving a cascade of four successive reduction reactions, N ⁢ O − 3 → N ⁢ O − 2 → NO → N 2 O → N 2 ( Zumft, 1997 117. Zumft, W.G. Cell biology and molecular basis of denitrification Microbiol. Mol. Biol. Rev. 1997; 61 :533-616 Crossref PubMed Google Scholar ) ( Figure 2 A). As a biogeochemical process, denitrification is essential to nitrogen cycling at a global scale through activity in soils, freshwater systems, and marine environments ( Seitzinger et al., 2006 98. Seitzinger, S. ∙ Harrison, J.A. ∙ Böhlke, J.K. ... Denitrification across landscapes and waterscapes: a synthesis Ecol. Appl. 2006; 16 :2064-2090 Crossref Scopus (1092) PubMed Google Scholar ). In addition, denitrification impacts human health through activity in wastewater treatment plants ( Lu et al., 2014 66. Lu, H. ∙ Chandran, K. ∙ Stensel, D. Microbial ecology of denitrification in biological wastewater treatment Water Res. 2014; 64 :237-254 Crossref Scopus (362) PubMed Google Scholar ) and in the human gut ( Irrazábal et al., 2014 46. Irrazábal, T. ∙ Belcheva, A. ∙ Girardin, S.E. ... The multifaceted role of the intestinal microbiota in colon cancer Mol. Cell. 2014; 54 :309-320 Full Text Full Text (PDF) Scopus (190) PubMed Google Scholar ). The process is performed by taxonomically diverse bacteria ( Graf et al., 2014 33. Graf, D.R.H. ∙ Jones, C.M. ∙ Hallin, S. Intergenomic comparisons highlight modularity of the denitrification pathway and underpin the importance of community structure for N2O emissions PLoS ONE. 2014; 9 :e114118 Crossref Scopus (234) PubMed Google Scholar ) that are typically facultative anaerobes. The denitrification pathway is known to be modular, with some strains performing all four steps in the cascade and others performing one or a nearly arbitrary subset of reduction reactions ( Lycus et al., 2017 67. Lycus, P. ∙ Lovise Bøthun, K. ∙ Bergaust, L. ... Phenotypic and genotypic richness of denitrifiers revealed by a novel isolation strategy ISME J. 2017; 11 :2219-2232 Crossref Scopus (72) PubMed Google Scholar ) ( Figure 2 A). Denitrification in nature is, therefore, a collective process, wherein a given strain can produce electron acceptors that can be utilized by other strains ( Lilja and Johnson, 2016 60. Lilja, E.E. ∙ Johnson, D.R. Segregating metabolic processes into different microbial cells accelerates the consumption of inhibitory substrates ISME J. 2016; 10 :1568-1578 Crossref Scopus (43) PubMed Google Scholar ).
Denitrification is well understood at the molecular level. The process couples the reduction of oxidized nitrogen compounds to the electron transport chain and, therefore, ATP production. The enzymes (reductases) that perform each step in the cascade are shown in Figure 2 B. Reduction of nitrate to nitrite can occur either in the cytoplasm, by the Nar reductase, or the periplasm, using Nap. Inner membrane NarK transporters (NarK1, NarK2, and NarK1K2) facilitate the exchange of nitrate and nitrite between the cytoplasm and the periplasm. The remaining three reactions all occur exclusively in the periplasmic space ( Figure 2 B). The regulatory elements that control the expression of denitrification genes are also well characterized and include two-component systems that sense the oxidized nitrogen compounds and regulators that detect the loss of oxygen from the environment ( Zumft, 1997 117. Zumft, W.G. Cell biology and molecular basis of denitrification Microbiol. Mol. Biol. Rev. 1997; 61 :533-616 Crossref PubMed Google Scholar ; Rodionov et al., 2005 89. Rodionov, D.A. ∙ Dubchak, I.L. ∙ Arkin, A.P. ... Dissimilatory metabolism of nitrogen oxides in bacteria: comparative reconstruction of transcriptional networks PLoS Comput. Biol. 2005; 1 e55, 17 Crossref Scopus (60) PubMed Google Scholar ). Because most of these reactions occur in the periplasm, substrates can readily leak into the surrounding environment, enabling cross-feeding between denitrifiers ( Lilja and Johnson, 2016 60. Lilja, E.E. ∙ Johnson, D.R. Segregating metabolic processes into different microbial cells accelerates the consumption of inhibitory substrates ISME J. 2016; 10 :1568-1578 Crossref Scopus (43) PubMed Google Scholar ).
We focused experimentally on the first two steps of denitrification: the conversion of nitrate ( N ⁢ O − 3 ) to nitrite ( N ⁢ O − 2 ) and subsequently nitric oxide (NO) ( Figure 2 A). Nitrate and nitrite are soluble, enabling high-throughput measurements of metabolite dynamics ( Miranda et al., 2001 75. Miranda, K.M. ∙ Espey, M.G. ∙ Wink, D.A. A rapid, simple spectrophotometric method for simultaneous detection of nitrate and nitrite Nitric Oxide. 2001; 5 :62-71 Crossref Scopus (2479) PubMed Google Scholar ). To obtain a genomically diverse ensemble of non-model organisms, we isolated 78 bacterial strains spanning α -, β -, and γ -proteobacteria from local soils using established techniques ( Tables S1–S3 ; STAR Methods ). Each strain was obtained in axenic culture and was characterized as performing one or both of the first two steps of denitrification. Therefore, strains were classified into one of three possible phenotypes ( Figures 2 A and 3 A): (1) Nar/Nir strains that perform both nitrate and nitrite reduction ( N ⁢ O − 3 → N ⁢ O − 2 → NO), (2) Nar strains that perform only nitrate reduction ( N ⁢ O − 3 → N ⁢ O − 2 ), and (3) Nir strains that perform only nitrite reduction ( N ⁢ O − 2 → NO). In addition to these 78 isolates, our strain library also included the model denitrifier Paracoccus denitrificans (ATCC 19367).
We first set out to quantify the metabolic phenotypes of each isolate in our diverse strain library (Step 1, Figure 1 ). We focused our efforts on quantifying the dynamics of the relevant metabolites, nitrate and nitrite. To accomplish this, strains were inoculated at low starting densities into 96-well plates containing a chemically defined, electron-acceptor-limited medium containing succinate as the sole non-fermentable carbon source (succinate-defined medium, SDM; Table S4 ; STAR Methods ), with either nitrate or nitrite provided as the sole electron acceptor. Cultures were then incubated under anaerobic conditions ( STAR Methods ). Small samples (10 μL) were taken at logarithmically spaced time intervals over a period of 64 h and assayed for nitrate and nitrite concentrations ( STAR Methods ). At the end of the time course, optical density was assayed. The measurement resulted in a time series of nitrate and nitrite production/consumption dynamics in batch culture (points, Figure 3 A). Contamination between wells using this culturing and sampling approach was assessed to be low ( STAR Methods ).
To parameterize the metabolite dynamics of each strain within a common framework, we utilized a consumer-resource model, which explicitly relates the growth of each strain to the dynamics of metabolite production and consumption ( Figure 3 B; Equation 3 ; STAR Methods ). The model contains up to six parameters: rates ( 𝑟 ∗ , mM/OD/h), biomass yields ( 𝛾 ∗ , OD/mM), and affinities ( 𝐾 ∗ , mM), for the substrates nitrate ( A ) and nitrite ( I ). For each strain in monoculture, we parameterized the consumer-resource model using measured denitrification dynamics across a range of initial biomass densities and nitrate/nitrite concentrations ( Figures 3 A and S1 A–S1E; STAR Methods ). These data allowed us to quantify rates ( 𝑟 ∗ ) and biomass yields ( 𝛾 ∗ ) but not the affinity parameters ( 𝐾 ∗ ) , which require measuring growth rates at very low substrate concentrations. Because the results of parameter fits were not sensitive to the values of 𝐾 ∗ across a broad range ( Figures S1 F–S1I; STAR Methods ), we fixed the affinity parameter to a small constant value. Therefore, we captured the phenotype of each strain in the library using at most four parameters: 𝑟 𝐴 , 𝑟 𝐼 , 𝛾 𝐴 , and 𝛾 𝐼 (the models for Nar and Nir strains correspond to setting 𝑟 𝐼 , 𝛾 𝐼 = 0 or 𝑟 𝐴 , 𝛾 𝐴 = 0 , respectively). Yields ( 𝛾 ∗ ) were inferred using optical density measurements at 𝑡 = 64 h, and rates ( 𝑟 ∗ ) were inferred by fitting the observed nitrate and nitrite dynamics to the consumer-resource model ( Figure 3 B). For the majority of strains in our library (62 out of 79), a single set of parameters quantitatively described metabolite dynamics across a range of initial biomass densities and nitrate/nitrite concentrations. The consumer-resource model captured metabolite dynamics over a restricted set of initial conditions for the remaining 17 strains ( Figures S1 J–S1L; Table S5 ; STAR Methods ). Using a representative subset of four strains, we confirmed that biomass density dynamics were well predicted by the consumer-resource parameters, despite the fact that biomass density was not directly measured over time ( Figure S1 M; STAR Methods ).
Fitting our consumer-resource model to data for each strain yielded a quantitative description of the metabolic traits (i.e., denitrification rates and yields) of each strain in the library ( Figure 3 C). We observed large variability between taxa, with coefficients of variation for rate constants ( 𝑟 𝐴 , 𝑟 𝐼 ) around 70% and yields ( 𝛾 𝐴 , 𝛾 𝐼 ) around 100%. We also observed some patterns of phylogenetic conservation, for example, α -proteobacteria produced generally higher yields than β - or γ -proteobacteria did, and a clade of Pseudomonas sp. isolates showed consistently higher rates of nitrite reduction than most other strains (PDM17-23, Figure 3 C). Despite these patterns, the prevalence of each of the three qualitative phenotypes is not strongly dependent on phylogeny, with each present across the tree ( Figure 3 C). The latter observation is consistent with pervasive horizontal gene transfer of denitrifying enzymes ( Heylen et al., 2006 42. Heylen, K. ∙ Gevers, D. ∙ Vanparys, B. ... The incidence of nirS and nirK and their genetic heterogeneity in cultivated denitrifiers Environ. Microbiol. 2006; 8 :2012-2021 Crossref Scopus (192) PubMed Google Scholar ; Jones et al., 2008 49. Jones, C.M. ∙ Stres, B. ∙ Rosenquist, M. ... Phylogenetic analysis of nitrite, nitric oxide, and nitrous oxide respiratory enzymes reveal a complex evolutionary history for denitrification Mol. Biol. Evol. 2008; 25 :1955-1966 Crossref Scopus (335) PubMed Google Scholar ). Finally, neither did we observe a correlation between rates and yields, nor was there an obvious bound on these parameters, suggesting that they are not subjected to a trade-off.
Understanding how genomic variation impacts metabolite dynamics at the community level requires first learning how genomic variation impacts the metabolic traits of individual strains. Therefore, we sought to determine how genomic variation across the strains in our library is related to variation in denitrification rates and yields ( Figure 3 C). One common approach to the problem of relating genomes to metabolite dynamics is constraint-based modeling. Constraint-based models infer the set of all metabolic reactions performed by an organism from an annotated genome, and then predict growth rates and metabolite fluxes, assuming the metabolic network is in steady state and is subject to biologically motivated constraints ( Orth et al., 2010 83. Orth, J.D. ∙ Thiele, I. ∙ Palsson, B.Ø. What is flux balance analysis? Nat. Biotechnol. 2010; 28 :245-248 Crossref Scopus (1994) PubMed Google Scholar ). Constraint-based methods have found some success in predicting collective metabolism from genomes ( Klitgord and Segrè, 2010 53. Klitgord, N. ∙ Segrè, D. Environments that induce synthetic microbial ecosystems PLoS Comput. Biol. 2010; 6 :e1001002 Crossref Scopus (201) PubMed Google Scholar ; Mori et al., 2016 79. Mori, M. ∙ Hwa, T. ∙ Martin, O.C. ... Constrained allocation flux balance analysis PLoS Comput. Biol. 2016; 12 :e1004913 Crossref Scopus (75) PubMed Google Scholar ; Harcombe et al., 2014 35. Harcombe, W.R. ∙ Riehl, W.J. ∙ Dukovski, I. ... Metabolic resource allocation in individual microbes determines ecosystem interactions and spatial dynamics Cell Rep. 2014; 7 :1104-1115 Full Text Full Text (PDF) Scopus (280) PubMed Google Scholar ), but these methods require significant manual refinement ( Norsigian et al., 2020 82. Norsigian, C.J. ∙ Fang, X. ∙ Seif, Y. ... A workflow for generating multi-strain genome-scale metabolic models of prokaryotes Nat. Protoc. 2020; 15 :1-14 Crossref Scopus (13) PubMed Google Scholar ), complicating the prospect of making predictions from the genomes of non-model organisms. As a result, successfully constructing constraint-based models of denitrification for all strains in our library is a daunting task.
We took an alternative approach to the problem of mapping genomes to metabolite dynamics. We asked whether the variation in metabolic phenotypes across strains in our library can be quantitatively predicted simply from knowledge of the genes possessed by each strain. Our conjecture was motivated by two observations. First the metabolic traits of bacteria correlate strongly with environmental variables in marine microbial communities ( Louca et al., 2016a 63. Louca, S. ∙ Jacques, S.M.S. ∙ Pires, A.P.F. ... High taxonomic variability despite stable functional structure across microbial communities Nat. Ecol. Evol. 2016; 1 :15 Crossref PubMed Google Scholar ). For example, the relative abundance of taxa capable of nitrate reduction are strongly correlated with local temperature, phosphate, and nitrate levels, suggesting that the presence of genes responsible for those traits might also be predictable from nutrient levels and temperature. Second, the statistics of gene presence and absence across large numbers of sequenced genomes provides insights into the functional roles that genes play in pathways, such as the coupling between dihydrofolate reductase and thymidylate synthase activity in the folate metabolism pathway ( Schober et al., 2019 96. Schober, A.F. ∙ Mathis, A.D. ∙ Ingle, C. ... A two-enzyme adaptive unit within bacterial folate metabolism Cell Rep. 2019; 27 :3359-3370.e7 Full Text Full Text (PDF) Scopus (13) PubMed Google Scholar ). Together, these observations suggest that the genes a strain possesses could allow for predictions of metabolic traits. Therefore, rather than building constraint-based metabolic models for all of our strains, each of which would require significant manual refinement, we took a simple regression approach.
We used linear regression to predict the consumer-resource model parameters ( Figure 3 C) of each strain from gene presence and absence (Step 2, Figure 1 ). To accomplish this, we performed whole genome sequencing on all 79 strains in the library. Then, we assembled and annotated each genome ( STAR Methods ) and determined the complement of 17 denitrification-related genes possessed by each strain ( Table S6 ), exploiting the fact that the molecular and genetic basis of denitrification is well understood ( Zumft, 1997 117. Zumft, W.G. Cell biology and molecular basis of denitrification Microbiol. Mol. Biol. Rev. 1997; 61 :533-616 Crossref PubMed Google Scholar ). We identified not only the reductases that perform the reduction of the oxidized nitrogen compounds but also the sensors/regulators ( Rodionov et al., 2005 89. Rodionov, D.A. ∙ Dubchak, I.L. ∙ Arkin, A.P. ... Dissimilatory metabolism of nitrogen oxides in bacteria: comparative reconstruction of transcriptional networks PLoS Comput. Biol. 2005; 1 e55, 17 Crossref Scopus (60) PubMed Google Scholar ) and transporters ( Moir and Wood, 2001 76. Moir, J.W.B. ∙ Wood, N.J. Nitrate and nitrite transport in bacteria Cell. Mol. Life Sci. 2001; 58 :215-224 Crossref PubMed Google Scholar ) known to be involved in denitrification ( STAR Methods ). We intentionally excluded genes encoding structural subunits and chaperones required for the functioning of any reductase ( Table S7 ) because such genes have the same presence/absence pattern as the corresponding reductases and, therefore, would have identical predictive power. The presence and absence the denitrification-related genes in each genome are presented in Figure 4 A. Patterns of gene presence and absence agree well with known features of the denitrification pathway, including the mutual exclusion (Pearson correlation −1.0 among nitrite reducers) of the two reductases performing nitrite reduction, NirS and NirK ( Jones et al., 2008 49. Jones, C.M. ∙ Stres, B. ∙ Rosenquist, M. ... Phylogenetic analysis of nitrite, nitric oxide, and nitrous oxide respiratory enzymes reveal a complex evolutionary history for denitrification Mol. Biol. Evol. 2008; 25 :1955-1966 Crossref Scopus (335) PubMed Google Scholar ; Jones and Hallin, 2010 48. Jones, C.M. ∙ Hallin, S. Ecological and evolutionary factors underlying global and local assembly of denitrifier communities ISME J. 2010; 4 :633-641 Crossref Scopus (174) PubMed Google Scholar ).
Next, we showed that the presence and absence of denitrification genes in each strain were sufficient to quantitatively predict metabolite dynamics in monoculture. Specifically, we constructed a linear regression where the measured phenotypic parameters of our consumer-resource model were predicted on the basis of gene presence and absence ( Figure 4 B). Consistent with the observation that bacterial genomes are streamlined ( Lynch, 2006 68. Lynch, M. Streamlining and simplification of microbial genome architecture Annu. Rev. Microbiol. 2006; 60 :327-349 Crossref Scopus (149) PubMed Google Scholar ), almost all strains possessing nitrate and/or nitrite reductase performed the associated reactions in culture (the only exception being the Nar strain Acidovorax sp. ACV01, which possesses both nitrate and nitrite reductase, Figure 4 A). Therefore, we carried out independent regressions for each consumer-resource model parameter using only strains that performed the associated reaction (i.e., Nar and Nar/Nir strains for the 𝑟 𝐴 and 𝛾 𝐴 regressions, and Nir and Nar/Nir strains for the 𝑟 𝐼 and 𝛾 𝐼 regressions). The regression coefficients for each gene quantify the impact of the presence of the gene on a given phenotypic parameter. We used 𝐿 1 -regularized regression (least absolute shrinkage and selection operator, LASSO) to avoid overfitting, performing independent regressions for each of the phenotypic parameters in our consumer-resource model ( Figures 4 C–4J; STAR Methods ). By design, LASSO searches for a level of sparsity that optimizes predictive power, often selecting a few variables to make predictions while forcing other coefficients ( β j ) to zero. The result can then be a sparse model that makes predictions using a handful of variables. It is important to note that LASSO does not first presume that a few variables are sufficient to make a prediction (in contrast to forward stepwise and best subset regression approaches). In the situation where strong predictive power does not exist, e.g., a phenotypic parameter cannot be predicted well from gene presence and absence, LASSO would effectively fail to identify a predictive model by returning 𝛽 𝑗 = 0 for all genes ( Fraebel et al., 2020 26. Fraebel, D.T. ∙ Gowda, K. ∙ Mani, M. ... Evolution of generalists by phenotypic plasticity iScience. 2020; 23 :101678 Full Text Full Text (PDF) Scopus (0) PubMed Google Scholar ).
Performing LASSO regressions on our dataset revealed that the presence and absence of a small set of genes is highly predictive of the consumer-resource parameters for all strains in our library ( Figures 4 C–4J). The in-sample coefficients of determination ( 𝑅 2 𝑓 ⁢ 𝑖 ⁢ 𝑡 ) of our regressions were between 0.55 and 0.74 depending on the phenotypic parameter. Crucially, our regression approach generalized out-of-sample, as determined by iterated 4-fold cross-validation ( 1 × 1 0 4 iterations; STAR Methods ), albeit with a slightly lower predictive power ( ̅ 𝑅 2 𝐶 ⁢ 𝑉 between 0.36 and 0.56). Therefore, across a diverse set of natural isolates, knowledge of the full complement of genes a denitrifying strain possesses is sufficient to accurately predict the rates and biomass yields of that strain on nitrate and/or nitrite.
Our regression approach leveraged biological knowledge of the denitrification pathway to predict metabolite dynamics, in effect presuming that denitrification gene content is the only significant genomic feature for prediction. To investigate whether this assumption is correct, we asked whether other genomic properties could better predict metabolite dynamics and also examined the role that phylogenetic correlations played in our predictions.
First, we tested the predictive capability of sets of randomly selected genes. To do this, we chose sets of 17 random genes that were not strongly correlated with any denitrification genes but retained the same marginal frequency distribution in the population as the denitrification genes. We found that regressions using these randomly selected genes had, on average, much less predictive power than regressions using the denitrification genes ( Figures S2 A–S2C; STAR Methods ). We also tested augmented sets of up to 2,048 predictors that were generated by adding varying numbers of randomly selected genes to the 17 denitrification genes. We found that the prediction quality changed remarkably little as more genes were added and that even sets of 2,048 predictors (representing approximately 30%–50% of genes in each genome) contained about as much predictive power as the regressions using the 17 denitrification genes alone ( Figure S2 D; STAR Methods ). This result indicates that the 17 denitrification genes harbor the majority of gene presence and absence predictive power.
Second, we tested whether 16S rRNA copy number, genome size, or GC-content improves the predictive ability of denitrification gene presence/absence regressions. We tested these genomic features because: (1) 16S rRNA copy number has been observed to correlate positively with maximal growth rate in nutrient-rich conditions ( Roller et al., 2016 90. Roller, B.R.K. ∙ Stoddard, S.F. ∙ Schmidt, T.M. Exploiting rRNA operon copy number to investigate bacterial reproductive strategies Nat. Microbiol. 2016; 1 :16160 Crossref Scopus (154) PubMed Google Scholar ; Li et al., 2019 59. Li, J. ∙ Mau, R.L. ∙ Dijkstra, P. ... Predictive genomic traits for bacterial growth in culture versus actual growth in soil ISME J. 2019; 13 :2162-2172 Crossref Scopus (27) PubMed Google Scholar ), (2) smaller genomes are associated with faster growth ( Lynch, 2006 68. Lynch, M. Streamlining and simplification of microbial genome architecture Annu. Rev. Microbiol. 2006; 60 :327-349 Crossref Scopus (149) PubMed Google Scholar ; Li et al., 2019 59. Li, J. ∙ Mau, R.L. ∙ Dijkstra, P. ... Predictive genomic traits for bacterial growth in culture versus actual growth in soil ISME J. 2019; 13 :2162-2172 Crossref Scopus (27) PubMed Google Scholar ), and (3) GC-content has been investigated as a correlate for numerous bacterial phenotypes, such as optimal growth temperature ( Galtier and Lobry, 1997 27. Galtier, N. ∙ Lobry, J.R. Relationships between genomic G+C content, RNA secondary structures, and optimal growth temperature in prokaryotes J. Mol. Evol. 1997; 44 :632-636 Crossref Scopus (0) PubMed Google Scholar ), and can serve as a baseline for spurious phylogenetic correlations because it is a slowly evolving genomic property that exhibits a high degree of phylogenetic correlation ( Haywood-Farmer and Otto, 2003 39. Haywood-Farmer, E. ∙ Otto, S.P. The evolution of genomic base composition in bacteria Evolution. 2003; 57 :1783-1792 Crossref Scopus (20) PubMed Google Scholar ). We found that including these additional predictors in our regressions alongside the 17 denitrification genes did not meaningfully improve predictive ability or alter the inferred coefficients ( STAR Methods ). Thus, denitrification gene presence and absence outperformed these coarse genomic features.
Third, we examined the role of correlations in consumer-resource parameters between closely related strains in the success of our regressions. We quantified the extent of phylogenetic correlation in our 79-strain library by computing the autocorrelation (Moran’s I ) for each consumer-resource parameter as a function of phylogenetic distance ( STAR Methods ). We observed that the rate parameter 𝑟 𝐴 was correlated to a small degree ( m a x ⁡ ( 𝐼 ) = 0 . 1 6 ) over short a phylogenetic distance (16S distance 0.01), whereas the parameters 𝛾 𝐴 , 𝑟 𝐼 , and 𝛾 𝐼 showed a modest degree of correlation ( m a x ⁡ ( 𝐼 ) = 0 . 3 3 , 0.27, and 0.48, respectively) over relatively longer distances (16S distance 0.16, 0.06, and 0.12, respectively). Pruning clades of closely related strains (e.g., ENS01–08, PDM20–23, Figure 3 C) from the dataset decreased the correlation of 𝛾 𝐴 , 𝑟 𝐼 , and 𝛾 𝐼 ( m a x ⁡ ( 𝐼 ) = 0 . 3 0 , 0.21, and 0.39, respectively; 16S distance 0.05, 0.06, and 0.09, respectively) but had little impact on the correlation of 𝑟 𝐴 . Thus, some of the phylogenetic correlation is attributable to the over-representation of close relatives. Finally, we showed that the presence of these close relatives in our dataset did not skew the results of our regressions. We performed regressions on the pruned dataset (comprising 64 strains) and found that the predictive power and regression coefficients were similar to those for the full dataset ( STAR Methods ). From this, we concluded that the over-representation of close relatives did not have a large impact on the results of our regressions on the consumer-resource parameters.
Having mapped gene content to metabolite dynamics in a medium with succinate supplied as the carbon source, we next asked whether our regression approach would generalize to other media conditions. Of the 79 strains in our library, 64 grew on a defined medium with acetate supplied as the sole (non-fermentable) carbon source (acetate-defined medium, ADM; Table S1 ; STAR Methods ). We assayed nitrate and nitrite dynamics for the 64 strains in this medium and inferred consumer-resource parameters. We observed that the consumer-resource parameters in the SDM and ADM conditions were strongly correlated (Pearson correlations 0.52–0.93, Figure 5 A). Furthermore, LASSO regressions to predict consumer-resource model parameters measured in ADM from gene presence and absence achieved predictive power similar to what we observed in SDM ( STAR Methods ). The regression coefficients were correlated between nutrient conditions ( Figure 5 B), suggesting that the impacts of genes on phenotypes were conserved between conditions. We note, however, that rates and yields in ADM were systematically lower relative to SDM ( Figure 5 A), consistent with what has been observed previously for relative growth rates on these carbon sources ( Forchhammer and Lindahl, 1971 25. Forchhammer, J. ∙ Lindahl, L. Growth rate of polypeptide chains as a function of the cell growth rate in a mutant of Escherichia coli 15 J. Mol. Biol. 1971; 55 :563-568 Crossref Scopus (120) PubMed Google Scholar ; Hempfling and Mainzer, 1975 40. Hempfling, W.P. ∙ Mainzer, S.E. Effects of varying the carbon source limiting growth on yield and maintenance characteristics of Escherichia coli in continuous culture J. Bacteriol. 1975; 123 :1076-1087 Crossref PubMed Google Scholar ). Consequently, the magnitudes of regression coefficients were generally smaller in ADM than in SDM ( Figure 5 B). This indicates that, while conserved genotype to phenotype relationships may generally underlie predictive power across different environments and media conditions, predictions for a particular environment will be more accurate when trained using data measured in that environment.
Why did gene presence and absence alone hold such strong predictive power for metabolite dynamics, and why did the regressions select specific genes in the denitrification pathway as informative predictors? We propose that by characterizing metabolic phenotypes in terms of rates and yields, we captured the salient features of the metabolic process for each strain and that this enabled the regressions to succeed by exploiting the conserved correlations between the presence of specific genes and metabolic phenotypes. In some cases, these correlations appear to be related to the functional roles of specific genes in the pathway. We found that, for some genes, the sign and magnitude of the regression coefficients agree qualitatively with known properties of the associated enzymes. For example, previous comparisons between membrane-bound and periplasmic nitrate reductases (encoded by narG and napA , respectively; Figure 2 B) in multiple bacterial strains showed that the membrane-bound enzyme exhibits higher nitrate reduction activity in vitro than the periplasmic enzyme ( Stewart et al., 2002 104. Stewart, V. ∙ Lu, Y. ∙ Darwin, A.J. Periplasmic nitrate reductase (NapABC enzyme) supports anaerobic respiration by Escherichia coli K-12 J. Bacteriol. 2002; 184 :1314-1323 Crossref Scopus (99) PubMed Google Scholar ; Van Alst et al., 2009 111. Van Alst, N.E. ∙ Sherrill, L.A. ∙ Iglewski, B.H. ... Compensatory periplasmic nitrate reductase activity supports anaerobic growth of Pseudomonas aeruginosa PAO1 in the absence of membrane nitrate reductase Can. J. Microbiol. 2009; 55 :1133-1144 Crossref Scopus (24) PubMed Google Scholar ; Ikeda et al., 2009 45. Ikeda, E. ∙ Andou, S. ∙ Iwama, U. ... Physiological roles of two dissimilatory nitrate reductases in the deep-sea denitrifier Pseudomonas sp. strain MT-1 Biosci. Biotechnol. Biochem. 2009; 73 :896-900 Crossref Scopus (13) PubMed Google Scholar ; Bell et al., 1990 5. Bell, L.C. ∙ Richardson, D.J. ∙ Ferguson, S.J. Periplasmic and membrane-bound respiratory nitrate reductases in Thiosphaera pantotropha : the periplasmic enzyme catalyzes the first step in aerobic denitrification FEBS Lett. 1990; 265 :85-87 Crossref Scopus (0) PubMed Google Scholar ; Warnecke-Eberz and Friedrich, 1993 114. Warnecke-Eberz, U. ∙ Friedrich, B. Three nitrate reductase activities in Alcaligenes eutrophus Arch. Microbiol. 1993; 159 :405-409 Crossref Scopus (0) Google Scholar ). This accords with the large positive coefficient for narG in the nitrate reduction rate regression ( Figure 4 G). Similarly, in the nitrite reduction rate regression, we observed a large positive coefficient for the gene encoding the copper-based nitrite reductase ( nirK ) ( Figure 4 I), which in previous studies, showed markedly higher activity in vitro ( Abraham et al., 1993 1. Abraham, Z.H.L. ∙ Lowe, D.J. ∙ Smith, B.E. Purification and characterization of the dissimilatory nitrite reductase from Alcaligenes xylosoxidans subsp . xylosoxidans (N.C.I.M.B. 11015): evidence for the presence of both type 1 and type 2 copper centres Biochem. J. 1993; 295 :587-593 Crossref Scopus (0) PubMed Google Scholar ; Masuko et al., 1984 70. Masuko, M. ∙ Iwasaki, H. ∙ Sakurai, T. ... Characterization of nitrite reductase from a denitrifier, Alcaligenes sp. NCIB 11015. A novel copper protein J. Biochem. 1984; 96 :447-454 Crossref Scopus (0) PubMed Google Scholar ; Iwasaki and Matsubara, 1972 47. Iwasaki, H. ∙ Matsubara, T. A nitrite reductase from Achromobacter cyclastes J. Biochem. 1972; 71 :645-652 PubMed Google Scholar ; Liu et al., 1986 62. Liu, M.Y. ∙ Liu, M.C. ∙ Payne, W.J. ... Properties and electron transfer specificity of copper proteins from the denitrifier “Achromobacter cycloclastes” J. Bacteriol. 1986; 166 :604-608 Crossref PubMed Google Scholar ; Kakutani et al., 1981 50. Kakutani, T. ∙ Watanabe, H. ∙ Arima, K. ... Purification and properties of a copper-containing nitrite reductase from a denitrifying bacterium, Alcaligenes faecalis strain S-6 J. Biochem. 1981; 89 :453-461 Crossref Scopus (124) PubMed Google Scholar ; Kukimoto et al., 1994 55. Kukimoto, M. ∙ Nishiyama, M. ∙ Murphy, M.E. ... X-ray structure and site-directed mutagenesis of a nitrite reductase from Alcaligenes faecalis S-6: roles of two copper atoms in nitrite reduction Biochemistry. 1994; 33 :5246-5252 Crossref PubMed Google Scholar ; Michalski and Nicholas, 1985 73. Michalski, W.P. ∙ Nicholas, D. Molecular characterization of a copper-containing nitrite reductase from Rhodopseudomonas sphaeroides forma sp. denitrificans Biochim. Biophys. Acta Protein Struct. Mol. Enzymol. 1985; 828 :130-137 Crossref Scopus (0) Google Scholar ; Sawada et al., 1978 94. Sawada, E. ∙ Toshio, S. ∙ Kitamura, H. Purification and properties of a dissimilatory nitrite reductase of a denitrifying phototrophic bacterium Plant Cell Physiol. 1978; 19 :1339-1351 Google Scholar ; Denariaz et al., 1991 19. Denariaz, G. ∙ Payne, W.J. ∙ LeGall, J. The denitrifying nitrite reductase of Bacillus halodenitrificans Biochim. Biophys. Acta Bioenerg. 1991; 1056 :225-232 Crossref Scopus (0) Google Scholar ) and in vivo ( Glockner et al., 1993 28. Glockner, A.B. ∙ Jüngst, A. ∙ Zumft, W.G. Copper-containing nitrite reductase from Pseudomonas aureofaciens is functional in a mutationally cytochrome cd1-free background (NirS-) of Pseudomonas stutzeri Arch. Microbiol. 1993; 160 :18-26 PubMed Google Scholar ) compared with the alternate nitrite reductase enzyme encoded by nirS ( Zumft, 1997 117. Zumft, W.G. Cell biology and molecular basis of denitrification Microbiol. Mol. Biol. Rev. 1997; 61 :533-616 Crossref PubMed Google Scholar ; Timkovich et al., 1982 109. Timkovich, R. ∙ Dhesi, R. ∙ Martinkus, K.J. ... Isolation of Paracoccus denitrificans cytochrome cd1: comparative kinetics with other nitrite reductases Arch. Biochem. Biophys. 1982; 215 :47-58 Crossref Scopus (0) PubMed Google Scholar ; Gordon et al., 2003 32. Gordon, E.H.J. ∙ Sjögren, T. ∙ Löfqvist, M. ... Structure and kinetic properties of Paracoccus pantotrophus cytochrome cd1 nitrite reductase with the d1 heme active site ligand tyrosine 25 replaced by serine J. Biol. Chem. 2003; 278 :11773-11781 Full Text Full Text (PDF) Scopus (0) PubMed Google Scholar ; Besson et al., 1995 7. Besson, S. ∙ Carneiro, C. ∙ Moura, J.J. ... A cytochrome cd1-type nitrite reductase isolated from the marine denitrifier Pseudomonas nautica 617: purification and characterization Anaerobe. 1995; 1 :219-226 Crossref Scopus (0) PubMed Google Scholar ; Sawhney and Nicholas, 1978 95. Sawhney, V. ∙ Nicholas, D.J.D. Sulphide-linked nitrite reductase from Thiobacillus denitrificans with cytochrome oxidase activity: purification and properties J. Gen. Microbiol. 1978; 106 :119-128 Crossref Google Scholar ). Further, our regression coefficients showed larger contributions of narG versus napA to yield on nitrate ( Figure 4 H) and, similarly, cnor versus qnor to yield on nitrite ( Figure 4 J). Both of these observations are consistent with the fact that the genes encoded by narG and cnor contribute more to the proton motive force (and, therefore, to ATP generation) than their alternatives ( napA and qnor , respectively) do ( Ferguson and Richardson, 2004 23. Ferguson, S.J. ∙ Richardson, D.J. The enzymes and bioenergetics of bacterial nitrate, nitrite, nitric oxide and nitrous oxide respiration Zannoni, D. (Editor) Respiration in Archaea and Bacteria: Diversity of Prokaryotic Respiratory Systems Springer, 2004; 169-206 Crossref Google Scholar ). Finally, the transporter encoded by the gene narK1K2 ( Figure 2 B) is a fusion of the nitrate/ H + symporter NarK1 and the nitrate/nitrite antiporter NarK2, the latter of which is crucial for exchanging nitrate and nitrite between the cytoplasm and periplasm during denitrification when the membrane-bound nitrate reductase is utilized. In Paracoccus denitrificans , this fusion has been shown to have substantially higher affinity for nitrate than NarK2 alone, resulting in higher growth rates under denitrifying conditions ( Goddard et al., 2008 30. Goddard, A.D. ∙ Moir, J.W.B. ∙ Richardson, D.J. ... Interdependence of two NarK domains in a fused nitrate/nitrite transporter Mol. Microbiol. 2008; 70 :667-681 Crossref Scopus (0) PubMed Google Scholar ). This agrees with what we found in the nitrate and nitrite reduction rate regressions, in which we observed large positive contributions of narK1K2 ( Figures 4 G and 4I).
Taken together, these observations suggest that the regressions exploited conserved correlations between gene presence and metabolic traits that reflect known mechanistic properties of the denitrification pathway. It is important to note, however, that for many nonzero coefficients in our regressions, notably those corresponding to regulators, there is no clear mechanistic interpretation. Further, given that our regressions were trained on genomes of wild isolates and not on phenotypes of deletion mutants, we do not expect that the regression can be reliably used to predict mutant phenotypes. Instead, we expect that the regressions exploited the tendency for strains possessing specific genes to have specific traits on average (e.g., strains with NarG tend to have high 𝑟 𝐴 , 𝛾 𝐴 ). These correlations between the presence of specific genes and metabolic traits qualitatively agree with the mechanistic details of some genes in the pathway, but we do not expect the regression coefficients to make causal predictions about the loss of a single gene.
Our statistical approach took two important steps toward mapping genomic structure to metabolic dynamics at the single-strain level. First, by making quantitative measurements in the laboratory, we removed the confounding environmental factors present in sequencing and metabolomic studies of natural communities to reveal that gene content has a conserved impact on dynamic metabolic phenotypes. Second, our results suggest that a statistical approach could be used to discover the key genomic features of pathways that determine other metabolic phenotypes, complementing direct genetic investigation of model organisms ( Nichols et al., 2011 80. Nichols, R.J. ∙ Sen, S. ∙ Choo, Y.J. ... Phenotypic landscape of a bacterial cell Cell. 2011; 144 :143-156 Full Text Full Text (PDF) Scopus (436) PubMed Google Scholar ). Finally, our predictions of metabolic phenotypes from genomes apply across a range of conditions and generalized well out-of-sample, suggesting that this approach can predict metabolite dynamics in settings for strains where only genome sequence data are available. These insights were made possible by parameterizing metabolic phenotypes across a genomically diverse strain library of non-model organisms, thereby exploiting genomic variation to learn the mapping from genotype to metabolic phenotypes.
Predicting community metabolite dynamics from genomic structure requires mapping single-strain phenotypes to collective behavior. Previous studies have found some success in predicting metabolite dynamics in consortia from knowledge of the monoculture metabolite consumption dynamics ( Erbilgin et al., 2017 21. Erbilgin, O. ∙ Bowen, B.P. ∙ Kosina, S.M. ... Dynamic substrate preferences predict metabolic properties of a simple microbial consortium BMC Bioinformatics. 2017; 18 :57 Crossref Scopus (13) PubMed Google Scholar ; Medlock et al., 2018 72. Medlock, G.L. ∙ Carey, M.A. ∙ McDuffie, D.G. ... Inferring metabolic mechanisms of interaction within a defined gut microbiota Cell Syst. 2018; 7 :245-257.e7 Full Text Full Text (PDF) Scopus (35) PubMed Google Scholar ). These approaches used simple assumptions, such as a fixed rate of metabolite production or consumption for each strain ( Medlock et al., 2018 72. Medlock, G.L. ∙ Carey, M.A. ∙ McDuffie, D.G. ... Inferring metabolic mechanisms of interaction within a defined gut microbiota Cell Syst. 2018; 7 :245-257.e7 Full Text Full Text (PDF) Scopus (35) PubMed Google Scholar ), rather than a dynamic model of metabolites. To predict community metabolite dynamics, we used the consumer-resource modeling formalism that describes metabolite dynamics for each strain to make quantitative predictions for metabolite dynamics in communities of multiple strains (Step 3, Figure 1 ). Since the consumer-resource parameters were sparsely encoded by the genomes of each strain ( Figure 4 ), predicting community metabolite dynamics from the consumer-resource model would provide a mapping from gene content to community metabolism.
Therefore, we extended to our modeling formalism to N -strain communities by adding the rate contributions of each strain to the dynamics of nitrate and nitrite ( Figure 6 B; Equation 10 ; STAR Methods ). This “additive” model assumes that strains interact only via cross-feeding and resource competition for electron acceptors. This model also assumes that the rates and yields on nitrate and nitrite for strains in pair culture are the same as in monoculture. As a result, the model provides predictions for N -strain community metabolite dynamics given the consumer-resource model parameters for individual strains without any free parameters.
To evaluate the ability of our consumer-resource model to make predictions of metabolite dynamics in communities, we used measured consumer-resource parameter values ( Figure 3 C) and not the values predicted by gene presence and absence ( Figures 4 C–4F). This allowed us to disambiguate the errors associated with the failure of the model to predict metabolite dynamics from the errors associated with predicting phenotypic parameters from genomes. However, as we subsequently discuss, using consumer-resource model parameters predicted from genomes has, at most, a modest impact on errors in our predictions of community metabolite dynamics.
We tested the ability of this approach to predict metabolite dynamics in all pair combinations of 12 strains from our library (4 Nar/Nir, 4 Nar, and 4 Nir). We assembled communities in 96-well plates containing SDM, supplying either nitrate or nitrite initially in two separate experimental conditions and then sampled over a 64-h period to measure concentrations of nitrate and nitrite ( STAR Methods ). Remarkably, we found that the additive model accurately predicted the metabolic dynamics for most 2-strain communities ( Figures 6 , S3 A, and S3B) using only the measured consumer-resource parameters for individual strains. Specifically, the third column of Figure 6 A shows the zero-free-parameter predictions (curves) of denitrification dynamics in 2-strain communities, which agreed well with measurements (points). The 2-strain community predictions include non-trivial dynamics, such as a transient increase in nitrite for a Nar/Nir + Nar community. In addition, we observed that the additive model accurately predicted total endpoint optical densities and community compositions ( Figure S4 ; STAR Methods ) in most cases, indicating that the model generally captures strain abundance dynamics in communities.
We quantified the quality of the additive model predictions for metabolite dynamics by computing a normalized root-mean-square error (NRMSE; see caption of Figure 6 ; Equation 12 ; STAR Methods ). We found that most 2-strain communities have NRMSE between 0 and 2, indicating that our model successfully predicted metabolite dynamics given only the measured consumer-resource parameters for each strain. Predictions of metabolite dynamics in pair cultures were also accurate when using consumer-resource parameters predicted from genomes via regression ( Figures S5 A and S5B; STAR Methods ). Further, the success or failure of the model predictions depended on the phenotypes of the strains present. The model successfully predicted 2-strain metabolite dynamics for most combinations of phenotypes (e.g., Nar/Nir + Nar or Nar + Nar) but failed only in the case where Nar strains were cultured with Nir strains ( Figures 6 A, 6C, S3 C, and S3D). The failure of our model predictions in Nar + Nir communities followed the common pattern that the rate of nitrate reduction was slower than expected (bottom row, Figures 6 A and S6 ). We speculate that this failure of the model to predict metabolite dynamics in Nar + Nir communities was caused by excretion of nitric oxide by the Nir strain. Nitric oxide can be cytotoxic ( Braun and Zumft, 1991 9. Braun, C. ∙ Zumft, W.G. Marker exchange of the structural genes for nitric oxide reductase blocks the denitrification pathway of Pseudomonas stutzeri at nitric oxide J. Biol. Chem. 1991; 266 :22785-22788 Abstract Full Text (PDF) PubMed Google Scholar ), which may explain slower rates of nitrate reduction for Nar strains. For further exploration of this phenomenon, see the discussion section.
Next, we asked whether dynamical metabolic phenotypes measured from monocultures could be used to predict metabolite dynamics in 3–5-strain communities. We applied the additive model to predicting the nitrate and nitrite dynamics in 81 combinations of 3 strains, 21 combinations of 4 strains, and 6 combinations of 5 strains from the 12-strain subset ( STAR Methods ). As with pair cultures, 3–5-strain communities were cultured in SDM with either nitrate or nitrite supplied initially in two separate experimental conditions. In communities that did not contain a Nar + Nir pair (e.g., Figure 7 A), we found that prediction accuracy was high (gray symbols, Figures 7 B and S3 E). This again indicated that in most combinations of phenotypes, community dynamics were predictable from the consumer-resource parameters of each strain in the community. However, in communities that contained a Nar + Nir pair, predictions were relatively poor (yellow symbols, Figures 7 B and S3 E), suggesting that interactions between Nar and Nir phenotypes that were not captured in the additive model were again driving low prediction accuracy. Finally, we note that the additional error in community metabolite dynamics predictions associated with predicting phenotypes from genomes was typically modest (median increase in NRMSE ≈ 0 . 5 –1.4) for 3–5-strain communities ( Figure S5 C; STAR Methods ).
To address the impact of interactions between Nar and Nir strains not accounted for by our additive model in 3–5-strain communities, we took a coarse-graining approach. We asked whether the metabolic contributions of Nar + Nir pairs could be treated as modules within larger communities. To do this, we re-fitted nitrate and nitrite reduction rates ( 𝑟 𝐴 , 𝑟 𝐼 ) to pair culture data (cultured in SDM with nitrate) for each Nar + Nir pair, leaving yields fixed ( Figures 7 C and S7 A; STAR Methods ). This resulted in effective nitrate and nitrite reduction rates ( ̃ 𝑟 𝐴 , ̃ 𝑟 𝐼 ) for each Nar + Nir pair. In every case, we observed that the re-fitted nitrate reduction rates ̃ 𝑟 𝐴 were lower than the monoculture nitrate reduction rates ( Figure S7 B), demonstrating quantitatively that Nar strains were consistently slowed by the presence of Nir strains. This observation is consistent with the hypothesis of excretion of cytotoxic nitric oxide by the Nir strain.
We then used the re-fitted rates for Nar + Nir pairs to make predictions for communities (cultured in SDM with nitrate) that included such pairs (e.g., Figure 7 D). For communities that included multiple Nar + Nir pairs, we developed a simple averaging rule for determining the effective rates from the rates for each Nar + Nir pair present ( STAR Methods ). For example, in a Nar + Nar + Nir community, there are two sets of Nar + Nir pair interactions, with a different effective nitrite reduction rate ̃ 𝑟 𝐼 measured for the Nir strain in its interactions with the two Nar strains. In this example, we would take the mean of these two effective reduction rates as the value used for prediction. We found that the metabolite dynamics in 3–5-strain communities containing Nar + Nir pairs were quantitatively well predicted by this coarse-graining approach (yellow symbols, Figure 7 B). We concluded that treating Nar + Nir pairs as effective modules within larger communities recovered the predictive power of the additive consumer-resource model.

Section: Discussion

Quantifying the metabolic phenotypes of a diverse library of natural isolates using a consumer-resource model allowed us to take a statistical approach to connecting genotypes to dynamical metabolic phenotypes. The outcome was a sparse mapping from gene content to single-strain metabolite dynamics that exploited conserved correlations between metabolic traits and gene presence, some of which reflect the known mechanistic properties of enzymes in the denitrification pathway. The resource-based modeling formalism then permitted quantitative predictions of community-level metabolite dynamics. As a result, the approach yielded a mapping from genomic structure to metabolite dynamics at the community level for denitrifying bacterial communities.
A key contribution of this study is the demonstration of a quantitative mapping between gene content and metabolic traits for a model metabolic process. One might expect that gene presence and absence is too coarse a genomic feature to predict dynamic metabolic traits and that other genomic features, such as promoter sequences, synteny, or allelic variation, would be necessary to make predictions. We instead found that that the association between gene presence/absence and metabolic traits is strong. This result suggests that selection for specific metabolic traits in bacteria may primarily favor genomes with specific complements of genes ( Cordero et al., 2012 15. Cordero, O.X. ∙ Ventouras, L.A. ∙ DeLong, E.F. ... Public good dynamics drive evolution of iron acquisition strategies in natural bacterioplankton populations Proc. Natl. Acad. Sci. USA. 2012; 109 :20059-20064 Crossref Scopus (194) PubMed Google Scholar ; Sakoparnig et al., 2021 92. Sakoparnig, T. ∙ Field, C. ∙ Nimwegen, E. van. Whole genome phylogenies reflect the distributions of recombination rates for many bacterial species eLife. 2021; 10 :e65366 Crossref Scopus (2) PubMed Google Scholar ) and that more granular details of the genome, such as promoter sequences or allelic variation, are less important.
At the community level, we found that interactions beyond those described by the additive consumer-resource model are not idiosyncratic but instead exhibit a general pattern (i.e., they occur only when Nar and Nir strains are both present). This suggests that interactions beyond resource competition may exhibit patterns that can be discovered in the laboratory. The fact that community-level metabolite dynamics departed from the additive model in Nar + Nir communities suggests that such interactions may be more likely to occur when specific metabolic processes, such as facilitation via the exchange of a metabolite, are at work.
There are some important caveats that apply to our prediction of single-strain metabolic traits from genomes and community-level metabolism from monocultures. For one, by parameterizing metabolite dynamics using a consumer-resource model, we assumed that the model could approximate the metabolic phenotypes of wild isolates. For most of our library (62/79 strains), this approximation worked well, but in some cases (17/79 strains), the model failed for at least some initial conditions ( Figures S1 J–S1L; Table S5 ; STAR Methods ). These failures may have occurred because the model does not capture phenomena such as the inhibition of reduction rates by reaction products. Going forward, the assumptions of the model could be relaxed by applying methods to learn the appropriate phenotypic parameters directly from the data ( Berman et al., 2014 6. Berman, G.J. ∙ Choi, D.M. ∙ Bialek, W. ... Mapping the stereotyped behaviour of freely moving fruit flies J. R. Soc. Interface. 2014; 11 :20140672 Crossref Scopus (180) PubMed Google Scholar ; Daniels and Nemenman, 2015 17. Daniels, B.C. ∙ Nemenman, I. Automated adaptive inference of phenomenological dynamical models Nat. Commun. 2015; 6 :8133 Crossref Scopus (82) PubMed Google Scholar ).
Although we set out to obtain a diverse strain library for the purpose of mapping genomic variation to dynamic metabolic phenotypes, it is important to note that our library is composed solely of Proteobacteria and does not contain representatives from other phyla. This limitation means that it is unclear whether our regression approach can predict phenotypes of distantly related strains (e.g., gram-positive bacteria). In addition to the 79 strains described in this study, we attempted to assay the denitrification dynamics for three gram-positive Nar strains from the phylum Actinobacteria. We found their reduction rates to be slower than any strain in our library ( ∼ 0.1 mM/OD/h), resulting in almost negligible nitrate reduction over 64 h. This observation suggests that denitrification phenotypes in clades distant from Proteobacteria may be distinct, with rates that are potentially much slower than what we observed for Proteobacteria. Supporting this idea, denitrification in gram-positive bacteria is poorly understood ( Verbaendert et al., 2011 112. Verbaendert, I. ∙ De Vos, P. ∙ Boon, N. ... Denitrification in Gram-positive bacteria: an underexplored trait Biochem. Soc. Trans. 2011; 39 :254-258 Crossref Scopus (37) PubMed Google Scholar ), and previous studies that collected phenotypic data similar to ours characterized only Proteobacteria ( Lycus et al., 2017 67. Lycus, P. ∙ Lovise Bøthun, K. ∙ Bergaust, L. ... Phenotypic and genotypic richness of denitrifiers revealed by a novel isolation strategy ISME J. 2017; 11 :2219-2232 Crossref Scopus (72) PubMed Google Scholar ; Liu et al., 2013 61. Liu, B. ∙ Mao, Y. ∙ Bergaust, L. ... Strains in the genus Thauera exhibit remarkably different denitrification regulatory phenotypes Environ. Microbiol. 2013; 15 :2816-2828 PubMed Google Scholar ). Therefore, extending our results to more diverse strains would require phenotyping a phylogenetically expanded library.
Considering the broader applicability of our statistical approach, there are some limitations to the types of metabolic processes and interactions that can be readily studied. Denitrification is a well-studied metabolic process, with the relevant enzymes known and easily annotated. Extending our method to less well-studied metabolic traits would require new approaches to learn the appropriate genomic features from data, since it may be challenging in those contexts to choose genes based on mechanistic knowledge. High-throughput mutant screens on wild isolates, for instance, via barcoded transposon mutant libraries ( Price et al., 2018 87. Price, M.N. ∙ Wetmore, K.M. ∙ Waters, R.J. ... Mutant phenotypes for thousands of bacterial genes of unknown function Nature. 2018; 557 :503-509 Crossref Scopus (173) PubMed Google Scholar ), could be used to discover unannotated or poorly annotated genes that are important for metabolic traits and potentially useful as predictors for metabolic phenotypes ( Vaccaro et al., 2016 110. Vaccaro, B.J. ∙ Thorgersen, M.P. ∙ Lancaster, W.A. ... Determining roles of accessory genes in denitrification by mutant fitness analyses Appl. Environ. Microbiol. 2016; 82 :51-61 Crossref Scopus (21) PubMed Google Scholar ).
Bridging the gap between the synthetic communities studied here and communities in the wild will require engaging with the chemical and spatial complexity of natural denitrifying communities. First, it is unclear whether the additive and non-additive interactions described here are relevant to wild communities. One way to determine the relevance of these interactions would be to measure co-occurrence between genotypes in natural contexts. Second, it remains to be seen how our approach generalizes to the complex nutrient environments, such as mixtures of organic carbon sources ( Tiedje et al., 1982 108. Tiedje, J.M. ∙ Sexstone, A.J. ∙ Myrold, D.D. ... Denitrification: ecological niches, competition and survival Antonie van Leeuwenhoek. 1982; 48 :569-583 Crossref Scopus (423) PubMed Google Scholar ), that are characteristic of natural communities. One approach to this problem would be to quantify nitrate and nitrite dynamics directly in soils and ask whether gene content can predict metabolite dynamics in this context. Finally, denitrification in nature occurs in the presence of other metabolic processes, where it often depends on nitrate from nitrifiers and competes with dissimilatory nitrate reduction to ammonia for electron acceptors ( Tiedje et al., 1982 108. Tiedje, J.M. ∙ Sexstone, A.J. ∙ Myrold, D.D. ... Denitrification: ecological niches, competition and survival Antonie van Leeuwenhoek. 1982; 48 :569-583 Crossref Scopus (423) PubMed Google Scholar ). Extending the approach taken here to a broader ecological context that includes other metabolic fluxes is an important avenue to pursue.
At the single-strain level, the apparent mechanistic relevance of the regression coefficients in this study suggests that a statistical approach, coupled with large-scale culturing and phenotyping on libraries of isolates ( Connon and Giovannoni, 2002 14. Connon, S.A. ∙ Giovannoni, S.J. High-throughput methods for culturing microorganisms in very-low-nutrient media yield diverse new marine isolates Appl. Environ. Microbiol. 2002; 68 :3878-3885 Crossref Scopus (0) PubMed Google Scholar ; Kehe et al., 2019 52. Kehe, J. ∙ Kulesa, A. ∙ Ortiz, A. ... Massively parallel screening of synthetic microbial communities Proc. Natl. Acad. Sci. USA. 2019; 116 :12804-12809 Crossref Scopus (68) PubMed Google Scholar ), can be exploited to discover the salient features of genomes that determine community metabolism. Higher-throughput measurements will enable a more detailed investigation of genomic features, allowing us to extend our statistical approach to variation in gene sequences and synteny.
Further, statistical predictions similar to those employed here could be used to help specify constraint-based metabolic models. Constraint-based metabolic models are refined using experimental measurements of metabolic traits ( Norsigian et al., 2020 82. Norsigian, C.J. ∙ Fang, X. ∙ Seif, Y. ... A workflow for generating multi-strain genome-scale metabolic models of prokaryotes Nat. Protoc. 2020; 15 :1-14 Crossref Scopus (13) PubMed Google Scholar ), but measuring these traits is challenging, especially for unculturable taxa or strains that are difficult to isolate from complex communities. Since our approach enables the prediction of metabolic phenotypes from genomes, these predictions could be used to refine constraint-based models of metabolic networks using genomic data alone and, thus, circumventing the need to experimentally measure metabolic phenotypes.
At the community level, our approach could eventually enable the prediction of metabolite dynamics in communities where gene presence and absence for individual genomes is known ( Sieber et al., 2018 102. Sieber, C.M.K. ∙ Probst, A.J. ∙ Sharrar, A. ... Recovery of genomes from metagenomes via a dereplication, aggregation and scoring strategy Nat. Microbiol. 2018; 3 :836-843 Crossref Scopus (238) PubMed Google Scholar ). Soils and host-associated communities typically contain hundreds of bacterial taxa; therefore, it may be necessary to test the predictive power of the consumer-resource formalism in communities of many taxa. However, data from soils suggest that denitrification may occur locally, on 10–20 μm grains ( Lensi et al., 1995 58. Lensi, R. ∙ Clays-Josserand, A. ∙ Jocteur Monrozier, L. Denitrifiers and denitrifying activity in size fractions of a mollisol under permanent pasture and continuous cultivation Soil Biol. Biochem. 1995; 27 :61-69 Crossref Scopus (70) Google Scholar ). At this small scale, it is possible that communities are composed of just a few strains. If this is indeed the case, our results for communities of 2–5 strains ( Figures 6 and 7 ) might apply to denitrifying communities in soil.
It is striking that communities containing both Nar and Nir phenotypes departed from the expectation of an additive consumer-resource model ( Figures 6 C and 7 B). We proposed that the inhibition of nitrate reduction in Nar + Nir communities may be caused by nitric oxide produced by the Nir strains. Consistent with this hypothesis, the most strongly inhibited Nar strains (PDM12 and PNT03, Figure S7 ) lack nitric oxide reductase ( Figure 4 A); therefore, they likely cannot alleviate this toxicity. In addition, the strongly inhibited Nar strains possess the periplasmic nitrate reductase ( Figure 2 B), which is exposed to the toxic effects of extracellular nitric oxide, whereas the weakly inhibited Nar strain ACV02 possesses the membrane-bound nitrate reductase, which is shielded from nitric oxide in the cytoplasm. Although Nir strains possess nitric oxide reductase and, therefore, could alleviate toxicity by reducing nitric oxide to nitrous oxide, Nir strains often transiently accumulate nitric oxide transiently ( Lycus et al., 2017 67. Lycus, P. ∙ Lovise Bøthun, K. ∙ Bergaust, L. ... Phenotypic and genotypic richness of denitrifiers revealed by a novel isolation strategy ISME J. 2017; 11 :2219-2232 Crossref Scopus (72) PubMed Google Scholar ). Consistent with this idea, when we measured relative abundances of Nar and Nir strains in co-culture, we observed smaller fractions of Nar strains relative to our model predictions in most cases ( Figure S4 B).
To describe metabolite dynamics in communities where both Nar and Nir strains were present, we chose not to expand our modeling formalism to include our hypothesized mechanism of Nar strain inhibition. Instead, we used measurements from Nar + Nir pair cultures to describe community-level metabolite dynamics ( Figure 7 ). The advantage of this approach was to maintain a small number of model parameters, but it came at the expense of mechanistic interpretation. Another possible disadvantage of our approach was the challenge of modeling communities with multiple Nar and Nir pairs. However, we found that a simple averaging method ( STAR Methods ) succeeded in describing community metabolite dynamics, even when multiple Nar + Nir pairs were present in communities of 3–5 strains ( Figure 7 B).
We note that Nar + Nir pair cultures are metabolically distinct from Nar/Nir monocultures, in that the former splits the denitrification pathway across two genomes resulting in obligate cross-feeding. It is notable that our model fails only in the case where cross-feeding is required, suggesting that our formalism is most relevant for competitive interactions and that accurately predicting obligate cross-feeding from monoculture information alone may require additional parameters. The ecological context of denitrification pathway splitting at nitrite reduction is believed to be associated with environmental pH, with low pH favoring a split pathway. This hypothesis comes from a previous study ( Lilja and Johnson, 2016 60. Lilja, E.E. ∙ Johnson, D.R. Segregating metabolic processes into different microbial cells accelerates the consumption of inhibitory substrates ISME J. 2016; 10 :1568-1578 Crossref Scopus (43) PubMed Google Scholar ) showing that the transient accumulation of nitrite during denitrification can be reduced by segregating the processes of nitrate and nitrite reduction across genomes. Reducing transient nitrite accumulation is advantageous in low pH environments, where nitrite forms toxic intermediates ( Lilja and Johnson, 2016 60. Lilja, E.E. ∙ Johnson, D.R. Segregating metabolic processes into different microbial cells accelerates the consumption of inhibitory substrates ISME J. 2016; 10 :1568-1578 Crossref Scopus (43) PubMed Google Scholar ). Because we observe Nar + Nir communities escaping the transient accumulation of nitrite ( Figures 6 A and S6 ), our results are consistent with splitting of the denitrification pathway at nitrite reduction as an adaptation to acidic environments.

Section: Conclusion

We find it striking that a statistical approach can uncover a simple relationship between gene content and metabolite dynamics in communities of diverse wild isolates. It is our hope that future work can leverage this approach to understand and predict the metabolic activity of microbial communities in natural settings.
We assumed that metabolic phenotypes can be captured by a consumer-resource model, an assumption that breaks down for a fraction of our isolates and limits the direct applicability of our approach to strains and processes that can be modeled using a simple phenomenology. For example, our modeling formalism works well when the electron acceptor is limiting but may fail when the donor (organic carbon) is limiting.
Our regression approach exploits correlations between genotype and phenotype to make predictions. To some extent, these correlations reflect conserved phenotypic impact of certain genes, but phylogenetic correlation also plays a role. Therefore, we do not expect the regression to make causal predictions of the impact of single-gene knockout mutations on phenotypes.
Our library of isolates comprises strains from the phylum Proteobacteria. We do not expect our results to generalize to distantly related denitrifiers in other phyla, such as gram-positive bacteria. Expanding the library is likely necessary to predict phenotypes of distantly related strains.
Our approach has been demonstrated for comparatively simple nutrient conditions in well-mixed conditions. It remains to be seen how well this statistical approach will work in natural contexts, where spatial structure and complex chemical environments are present.

Section: Methodology

REAGENT or RESOURCE SOURCE IDENTIFIER Bacterial and virus strains Bacterial isolates This paper Table S2 Paracoccus denitrificans ATCC Cat#19367 Biological samples Soils for bacterial isolation This paper Table S1 Chemicals, peptides, and recombinant proteins N -(1-Naphthyl)ethylenediamine dihydrochloride Sigma-Aldrich Cat#222488-10G Sulfanilamide Sigma-Aldrich Cat#S9251-100G Vanadium(III) chloride Fisher Scientific Cat#AC197000050 Critical commercial assays DNeasy UltraClean Microbial Kit Qiagen Cat#12224-250 MiSeq Reagent Kit v3 (600 cycle) Illumina Cat#MS-102-3003 Nextera DNA CD Indexes Illumina Cat#20018707 Nextera DNA Flex Library Prep Kit Illumina Cat#20018704 PhiX Control v3 Illumina Cat#FC-110-3001 Platinum Hot Start PCR Master Mix Invitrogen Cat#13000013 QIAquick PCR Purification Kit Qiagen Cat#28106 Qubit dsDNA BR Assay Invitrogen Cat#Q32853 Deposited data Metabolite dynamics data, consumer-resource parameters, genome annotations This paper https://doi.org/10.17605/osf.io/t3prd Paracoccus denitrificans complete genome Si et al., 2019 101. Si, Y.-Y. ∙ Xu, K.-H. ∙ Yu, X.-Y. ... Complete genome sequence of Paracoccus denitrificans ATCC 19367 and its denitrification characteristics Can. J. Microbiol. 2019; 65 :486-495 Crossref Scopus (2) PubMed Google Scholar BioProject ID PRJNA513156 Raw sequencing data and draft genome assemblies This paper BioProject ID PRJNA660495 Oligonucleotides 16S rRNA universal primer (27F) Integrated DNA Technologies AGAGTTTGATCMTGGCTCAG 16S rRNA universal primer (806R) Integrated DNA Technologies GGACTACNVGGGTWTCTAAT Software and algorithms MATLAB R2017B Mathworks https://www.mathworks.com/products/matlab.html R 3.6.1 R Core Team https://www.r-project.org/ Original code This paper https://doi.org/10.17605/osf.io/t3prd CASEU 0.1.2 Cermak et al., 2020 12. Cermak, N. ∙ Datta, M.S. ∙ Conwill, A. Rapid, inexpensive measurement of synthetic bacterial community composition by Sanger sequencing of amplicon mixtures iScience. 2020; 23 :100915 Full Text Full Text (PDF) Scopus (0) PubMed Google Scholar https://bitbucket.org/DattaManoshi/caseu MEGA X 10.1.8 Kumar et al., 2018 56. Kumar, S. ∙ Stecher, G. ∙ Li, M. ... MEGA X: molecular evolutionary genetics analysis across computing platforms Mol. Biol. Evol. 2018; 35 :1547-1549 Crossref Scopus (11440) PubMed Google Scholar https://www.megasoftware.net/ phylosignal 1.3 Keck et al., 2016 51. Keck, F. ∙ Rimet, F. ∙ Bouchez, A. ... phylosignal: an R package to measure, test, and explore the phylogenetic signal Ecol. Evol. 2016; 6 :2774-2780 Crossref Scopus (177) PubMed Google Scholar https://cran.r-project.org/web/packages/phylosignal QUAST 5.02 Gurevich et al., 2013 34. Gurevich, A. ∙ Saveliev, V. ∙ Vyahhi, N. ... QUAST: quality assessment tool for genome assemblies Bioinformatics. 2013; 29 :1072-1075 Crossref Scopus (2977) PubMed Google Scholar https://github.com/ablab/quast RAST Brettin et al., 2015 10. Brettin, T. ∙ Davis, J.J. ∙ Disz, T. ... RASTtk: a modular and extensible implementation of the RAST algorithm for building custom annotation pipelines and annotating batches of genomes Sci. Rep. 2015; 5 :8365 Crossref Scopus (988) PubMed Google Scholar http://rast.theseed.org selectiveInference 1.2.5 Taylor and Tibshirani, 2015 107. Taylor, J. ∙ Tibshirani, R.J. Statistical learning and selective inference Proc. Natl. Acad. Sci. USA. 2015; 112 :7629-7634 Crossref Scopus (121) PubMed Google Scholar https://cran.r-project.org/web/packages/selectiveInference/ SILVA ACT Pruesse et al., 2012 88. Pruesse, E. ∙ Peplies, J. ∙ Glöckner, F.O. SINA: accurate high-throughput multiple sequence alignment of ribosomal RNA genes Bioinformatics. 2012; 28 :1823-1829 Crossref Scopus (1834) PubMed Google Scholar http://www.arb-silva.de/ SPAdes 3.13.0 Bankevich et al., 2012 3. Bankevich, A. ∙ Nurk, S. ∙ Antipov, D. ... SPAdes: a new genome assembly algorithm and its applications to single-cell sequencing J. Comput. Biol. 2012; 19 :455-477 Crossref Scopus (10972) PubMed Google Scholar https://github.com/ablab/spades Trimmomatic 0.39 Bolger et al., 2014 8. Bolger, A.M. ∙ Lohse, M. ∙ Usadel, B. Trimmomatic: a flexible trimmer for Illumina sequence data Bioinformatics. 2014; 30 :2114-2120 Crossref Scopus (21176) PubMed Google Scholar https://github.com/usadellab/Trimmomatic Other Anaerobic glove box Coy Laboratory Products Cat#7601-110/220 Breathe-Easier membranes Diversified Biotech Cat#BERM-2000 Deepwell plates Axygen Cat#PDW20C Digital mass flow controllers Sierra Instruments SmartTrak 50 High-throughput DNA sequencing system Illumina MiSeq Liquid handling robot Formulatrix Mantis Microplate reader BMG CLARIOstar Plate shaker Troemner Talboys Professional 1000MP Open table in a new tab
Further information and requests for resources should be directed to and will be fulfilled by the lead contact, Seppe Kuehn ( seppe.kuehn@gmail.com ).
Strains isolated in this study will be made available on request. No new or unique reagents were generated in this study.
The bacterial strains and isolates used in this study are listed in Table S1 .
Denitrifying bacteria were isolated from soil samples following a modified version of the protocol developed by Lycus et al. ( Lycus et al., 2017 67. Lycus, P. ∙ Lovise Bøthun, K. ∙ Bergaust, L. ... Phenotypic and genotypic richness of denitrifiers revealed by a novel isolation strategy ISME J. 2017; 11 :2219-2232 Crossref Scopus (72) PubMed Google Scholar ). 5–10 g soil samples were collected from local prairie and forest environments, agricultural land, and manicured lawns ( Table S2 ). Samples were stored separately in 50 mL centrifuge tubes at 4°C for no longer than three months before use.
Each soil sample was prepared for isolation by combining with 25 mL PBS (pH 7.4) and 5–10 g sterile 4 mm glass beads. Additionally 0.5 mL cycloheximide solution (10 mg/mL) and 20 μL nystatin solution (25 mg/mL) were added to prevent fungal growth. In certain rounds of isolation ( Table S2 ), sterile NaNO 2 solution (1 M) was added to enrich for nitrite-reducing bacteria. Tubes were then vortexed (Vortex-Genie 2) at high speed for 1 min to homogenize the samples. In certain rounds of isolation ( Table S2 ), homogenized soils were incubated at either room temperature or 30°C for up to two weeks, and then briefly re-vortexed before further processing.
Supernatants from homogenized soils were then diluted and plated. After vortexing, large particles in homogenized soil samples were allowed to settle for 20–30 min before transferring 1 mL of supernatant to sterile 1.7 mL microcentrifuge tubes. Soil supernatants were then serially-diluted in PBS to obtain 1 0 − 4 -fold and 1 0 − 5 -fold dilutions. 100 μL of the 1 0 − 4 and 1 0 − 5 soil supernatant dilutions were plated on 1/10X tryptic soy agar (1/10X TSA, 1.5 g/L tryptone, 0.5 g/L soytone, 0.5 g/L NaCl, 15 g/L agar), with two replicates for each dilution. Plates were then incubated under aerobic conditions at 30°C for 48 h.
Colonies from plated soil supernatants were picked and streaked to purity. Plated soil dilutions were examined for growth after incubation. Plates showing little or no growth were incubated for an additional 24–48 h until colonies appeared. Plates showing likely fungal growth were discarded. For each set of plates derived from a soil sample, 5–15 well-separated colonies were picked and streaked to purity on 1/10X TSA plates, again incubating at 30°C. Whenever possible, colonies were selected which varied in morphology, size, and color, in order to enhance the diversity of the isolate collection.
Bacterial isolates were assayed for nitrate and/or nitrite-reduction capability. Isolates were first cultured aerobically in sterile 96-deepwell plates (Axygen PDW20C) containing 1 mL per well 1/10X tryptic soy broth liquid medium (1/10X TSB), inoculated directly from streak plate colonies. Deepwell plates were sealed with a gas-permeable membrane (Diversified Biotech BERM-2000) and incubated/shaken at 30°C/950RPM (Talboys Professional 1000MP) for 48 h. 1 μL of each dense aerobic culture was then passaged to fresh 96-deepwell plates containing 1 mL per well 1/10X TSB supplemented with either sterile NaNO 3 or NaNO 2 solution (1 M) to yield a final concentration of 2 mM N ⁢ O − 3 or N ⁢ O − 2 , with two replicates of each condition per isolate. Plates were sealed with gas-permeable membranes (Diversified Biotech BEM-1) and transferred to an N 2 -purged anaerobic glove box (Coy Laboratory Products 7601-110/220). Plates were incubated/shaken at 30°C/950RPM for 48 h under anaerobic conditions. After incubation, plates were sampled to determine endpoint concentrations of nitrate and nitrite.
Nitrate and nitrite-reduction capability for each isolate was determined by comparing endpoint concentrations of N ⁢ O − 3 and N ⁢ O − 2 in each culture with the corresponding concentrations in uninoculated controls. Isolates showing lower endpoint levels of nitrate and/or nitrite than the uninoculated controls were identified as nitrate and/or nitrite reducers, respectively. Strains that performed both nitrate and nitrite reduction were classified as “Nar/Nir” strains, while strains that performed nitrate or nitrite reduction only were classified as “Nar” or “Nir” strains, respectively. These isolates were cryopreserved by mixing 500 μL of saturated culture grown in 1/10X TSB under aerobic conditions with 500 μL filter-sterilized 50% glycerol solution in 2 mL cryotubes, and freezing/storing at -80°C.
In order to eliminate the possibility of fermentative metabolism in subsequent (post-isolation) denitrification experiments, defined growth media based on the medium designed by Heylen et al. (2006) 43. Heylen, K. ∙ Vanparys, B. ∙ Wittebolle, L. ... Cultivation of denitrifying bacteria: optimization of isolation conditions and diversity study Appl. Environ. Microbiol. 2006; 72 :2637-2643 Crossref Scopus (0) PubMed Google Scholar for the cultivation of diverse denitrifying bacteria were used ( Table S4 ). A succinate-defined medium (SDM) that contained 25 mM succinate (100 mM C) as the sole (non-fermentable) carbon source was used for most denitrification experiments. The medium also contained trace metals and vitamins, 15 mM ammonium as the assimilatory nitrogen source, and a 40 mM phosphate buffer with the final medium pH adjusted to 7.3. It was expected that nitrate and nitrite assimilation were inhibited by high concentrations of ammonia ( Zumft, 1997 117. Zumft, W.G. Cell biology and molecular basis of denitrification Microbiol. Mol. Biol. Rev. 1997; 61 :533-616 Crossref PubMed Google Scholar ). Additionally an acetate defined medium (ADM) containing 50 mM acetate (100 mM C) in place of succinate was used for some experiments, with all other medium components unchanged. In ADM, acetate served as the sole non-fermentable carbon source.
In denitrification experiments using defined media, nitrate or nitrite was provided in at most 2 mM concentrations, and it was expected that growth was nitrate and/or nitrite limited. This expectation was corroborated by measurements of endpoint biomass densities for strains in axenic culture, in which typically higher biomass densities were observed in conditions where 2 mM nitrate or nitrite was supplied (and completely reduced) than when 1 mM was supplied. Moreover, in a previous study, growth experiments using a mineral medium containing 5 mM acetate (10 mM C), 3.7 mM ammonia, and 1.5 mM phosphate, demonstrated that nitrate and nitrite were limiting at up to a 5 mM concentration for the strains Paracoccus denitrificans and Pseudomonas stutzeri ( Strohm et al., 2007 105. Strohm, T.O. ∙ Griffin, B. ∙ Zumft, W.G. ... Growth yields in bacterial denitrification and nitrate ammonification Appl. Environ. Microbiol. 2007; 73 :1420-1424 Crossref Scopus (174) PubMed Google Scholar ). For comparison, SDM and ADM supplied carbon, ammonia, and phosphate in significantly greater concentrations, and nitrate and nitrite in lower concentrations, further supporting the claim that nitrate and/or nitrite were growth limiting under denitrifying conditions.
Denitrifying isolates were screened for growth on SDM under aerobic conditions by first growing axenically from freezer stocks in 1/10X TSB, passaging 1:300 into 300 μL SDM in 96-well plates (with two replicates per isolate), and culturing at 30°C for 48 h. Endpoint optical density was measured to assess growth on SDM using a microplate reader (BMG CLARIOstar). Denitrifying isolates unable to grow on SDM (approximately 36% of isolates) were excluded from further experimentation and analysis. Strains that grew on SDM were also further screened for growth on ADM ( Table S1 ).
Post-isolation denitrification experiments were performed in a vinyl glove box (Coy Laboratory Products 7601-110/220) purged of oxygen with a 99%/1% N 2 /CO 2 gas mixture. Provision of CO 2 was necessary to support the growth of cultures from low initial biomass densities (OD600 0 ≪ 0.01), likely due to the CO 2 -fixation requirements of core anaplerotic metabolism ( White et al., 2012 115. White, D. ∙ Drummond, J. ∙ Fuqua, C. The Physiology and Biochemistry of Prokaryotes Oxford University Press, 2012 Google Scholar ). Gas mixing and a purge rate of 20 SLPM were controlled using digital mass flow controllers (Sierra Instruments SmartTrak 50). Oxygen and CO 2 concentrations inside the glove box were continually monitored using Arduino-attached ( Mathupala et al., 2016 71. Mathupala, S.P. ∙ Kiousis, S. ∙ Szerlip, N.J. A lab assembled microcontroller-based sensor module for continuous oxygen measurement in portable hypoxia chambers PLoS ONE. 2016; 11 :e0148923 Crossref PubMed Google Scholar ) optical sensors (SST Sensing LOX-02, Gas Sensing Solutions EXPLORIR-M-20). Gaseous oxygen concentration was maintained around 200 ppm, which was sufficient to prevent growth via aerobic respiration. This was verified using two denitrifying isolates, the Nar strain Paracoccus sp. PAR01 and the Nir strain Pseudomonas sp. PDM13, which were grown under denitrifying conditions for 64h with and without a suitable electron acceptor (i.e., nitrate for the Nar strain and nitrite for the Nir strain). The Nar strain PAR01 was inoculated at biomass density OD600 0 = 0 . 0 1 1 and grew to OD600 64 = 0 . 0 7 2 with nitrate and remained at OD600 64 = 0 . 0 1 3 without nitrate. Similarly, the Nir strain PDM13 was inoculated at biomass density OD600 0 = 0 . 0 1 0 and grew to OD600 64 = 0 . 0 2 6 with nitrite and remained at OD600 64 = 0 . 0 1 0 without nitrite.
Concentrations of nitrate and nitrite were measured using a microplate reader (BMG CLARIOstar) following a modified version of the protocol by Miranda et al. (2001) 75. Miranda, K.M. ∙ Espey, M.G. ∙ Wink, D.A. A rapid, simple spectrophotometric method for simultaneous detection of nitrate and nitrite Nitric Oxide. 2001; 5 :62-71 Crossref Scopus (2479) PubMed Google Scholar , where the conventional Griess assay for detection of nitrite is coupled with the chemical reduction of nitrate to nitrite using vanadium (III) chloride. Stock solutions of N -(1-Napthyl)ethylenediamine dihydrochloride (NEDD), sulfanilamide (SULF, in 5% HCl), and VCl 3 (in 1 M HCl) were prepared and stored as described in Miranda et al. (2001) 75. Miranda, K.M. ∙ Espey, M.G. ∙ Wink, D.A. A rapid, simple spectrophotometric method for simultaneous detection of nitrate and nitrite Nitric Oxide. 2001; 5 :62-71 Crossref Scopus (2479) PubMed Google Scholar . Griess reagent was freshly prepared on the day of each assay by mixing NEDD and SULF stock solutions with ultrapure H 2 O in a 5:5:9 ratio.
Nitrate and nitrite were measured using 10 μL samples of analyte in a 96-well microplate. Nitrite was first quantified by adding 190 μL of Griess reagent to each sample and recording blank-corrected maximum absorbance within the interval 450 to 650 nm, denoted 𝐴 ⁢ 𝑏 ⁢ 𝑠 𝐺 𝑚 ⁢ 𝑎 ⁢ 𝑥 . Then nitrate was chemically reduced to nitrite by adding 50 μL of VCl 3 solution to each sample and incubating at 30°C for 6–7 h, which was sufficient time for complete reduction of nitrate to nitrite. After incubation, the maximum blank-corrected absorbance within the interval 450 to 650 nm, denoted 𝐴 ⁢ 𝑏 ⁢ 𝑠 𝑉 𝑚 ⁢ 𝑎 ⁢ 𝑥 , was recorded to quantify the sum total of nitrate and nitrite in the sample.
Concentrations of nitrate and nitrite were determined using 8-point standard curves. Separate two-fold dilutions of NaNO 2 and NaNO 3 standards spanning 31 μM–2 mM were prepared, and 10 μL samples of these standards were dispensed in triplicate into a 96-well plate, along with 10 μL samples of ultrapure water that served as blanks. Griess reagents were used as described above to measure nitrite in the NaNO 2 standards, and these data were parameterized by fitting the equation: 𝐴 ⁢ 𝑏 ⁢ 𝑠 𝐺 𝑚 ⁢ 𝑎 ⁢ 𝑥 ⁡ ( 𝐼 ) = 𝑎 0 + 𝑎 1 ⁢ 𝐼 + 𝑎 2 ⁢ 𝐼 2 , (Equation 1) where I is the concentration of N ⁢ O − 2 . A quadratic term was included to account for the slight nonlinearity of the absorbance at high values of concentration. Then VCl 3 solution was used as described above to measure nitrate in the NaNO 3 standards, and these data were parameterized by fitting the equation: 𝐴 ⁢ 𝑏 ⁢ 𝑠 𝑉 𝑚 ⁢ 𝑎 ⁢ 𝑥 ⁡ ( 𝐴 ) = 𝑏 0 + 𝑏 1 ⁢ 𝐴 + 𝑏 2 ⁢ 𝐴 2 , (Equation 2) where A is the concentration of N ⁢ O − 3 . Standard curves were run in triplicate on each day that an assay was performed.
The nitrate and nitrite concentrations in a new sample, for which 𝐴 ⁢ 𝑏 ⁢ 𝑠 𝐺 𝑚 ⁢ 𝑎 ⁢ 𝑥 and 𝐴 ⁢ 𝑏 ⁢ 𝑠 𝑉 𝑚 ⁢ 𝑎 ⁢ 𝑥 were recorded, were then determined by: 1. Solving Equation 1 to determine I from 𝐴 ⁢ 𝑏 ⁢ 𝑠 𝐺 𝑚 ⁢ 𝑎 ⁢ 𝑥 ⁡ ( 𝐼 ) , 2. Solving Equation 2 to determine the quantity 𝐴 + 𝐼 from 𝐴 ⁢ 𝑏 ⁢ 𝑠 𝑉 𝑚 ⁢ 𝑎 ⁢ 𝑥 ⁢ ( 𝐴 + 𝐼 ) (since this step of the assay measures the sum total of nitrate and nitrite in a sample), 3. Subtracting the result of step 1 from the result of step 2 to obtain A.
This approach was validated using mixed standards containing both nitrate and nitrite in a 1:1 ratio, and relative error was found to be typically less than ± 5% for concentrations ≥ 62.5 μM.
In this study, nitrate and nitrite assays were performed directly on samples taken from denitrifying cultures (i.e., without first removing cells via filtration or centrifugation). To verify that neither the presence of cells nor molecules secreted by strains during denitrification interfere with the assay, measurement error was evaluated in standards combined with samples taken from denitrifying cultures of four representative strains. The strains Achromobacter sp. ACM01, Ensifer sp. ENS09, Paracoccus denitrificans ATCC 19367 (PAR19367), and Pseudomonas sp. PDM21 were grown in a succinate defined medium under denitrifying conditions from low initial abundance (OD600 0 ≈ 0.01) for 64 h, by which time cells were in stationary phase (OD600 64 = 0.052–0.148). 10 μL samples of these cultures were then then combined with 10 μL samples of nitrate and nitrite standards and then assayed as described above. In standards containing nitrate or nitrite separately, relative error of the assay was typically less than ± 5% for concentrations ≥ 125 μM, with relative error ± 10% at 62.5 μM. In standards containing mixtures of both nitrate and nitrite in a 1:1 ratio, relative error was again found to be typically less than ± 5% for concentrations ≥ 125 μM, with relative error ± 10% at 62.5 μM. This indicates that presence of cells and/or molecules secreted by strains during denitrification do not appreciably increase measurement error above concentrations of 125 μM.
Strains were pre-cultured under aerobic conditions (using first broth then defined medium) prior to growth under denitrifying (anaerobic) conditions in defined medium. Strains were first grown axenically to saturation from freezer stocks in 1/5X TSB, then passaged 1:100 into defined medium and again grown to saturation. All pre-cultures were grown in 24-well plates containing 1.7 mL medium per well and incubated/shaken at 30°C/400RPM under aerobic conditions. Since strains in the library vary widely in the time required to grow to saturation in 1/5X TSB and defined medium (12–96 h), inoculation and passaging of strains was timed so that defined medium aerobic cultures would enter stationary phase within 12 h of the start of an experiment in denitrifying conditions.
Experiments to measure the nitrate/nitrite-reduction dynamics of strains in monoculture were performed with multiple initial media and biomass density conditions: (a) 2 mM N ⁢ O − ∗ , OD600 0 = 0.01, (b) 1 mM N ⁢ O − ∗ , OD600 0 = 0.01, (c) 2 mM N ⁢ O − ∗ , OD600 0 = 0.001, where Nar/Nir strains were cultured with N ⁢ O − 3 and N ⁢ O − 2 separately (6 conditions total), Nar strains were cultured with N ⁢ O − 3 (3 conditions total), and Nir strains were cultured with N ⁢ O − 2 (3 conditions total). Medium containing (separately) 2 mM N ⁢ O − 3 , 1 mM N ⁢ O − 3 , 2 mM N ⁢ O − 2 , and 1 mM N ⁢ O − 2 were prepared by supplementing fresh defined medium with sterile NaNO 3 or NaNO 2 (1 M) solutions. Aerobic defined medium pre-cultures were normalized to two levels of optical density (OD600 ≈ 1.2 and 0.12) by diluting with PBS, and these normalized densities were recorded. 96-deepwell plates containing 1.2 mL of N ⁢ O − 3 or N ⁢ O − 2 -supplemented defined medium were then inoculated with 10 μL of density-normalized culture, resulting in OD600 ≈ 0.01 and 0.001 cell density conditions. 2–4 replicates were used for each combination of media and cell density conditions.
Inoculated plates were sealed with gas-permeable membranes (Diversified Biotech BERM-2000) and transferred to an anaerobic glove box for incubation/shaking at 30°C/950RPM. Cultures were manually sampled with a multichannel pipette (10 μL per well) at 2, 4, 6, 8, 16, 32, and 64 h from the start of anaerobic culture. Samples were stored in clean 96-well plates, and immediately sealed (Bio-Rad MSB1001) and frozen at -20°C for later assay of nitrate and nitrite. Additionally, at 64 h, 300 μL per well of culture was sampled into clean 96-well plates and the optical density (pathlength normalized to 1 cm) immediately measured to quantify endpoint biomass density. Strains observed to form excessive cell aggregation (to the extent that quantification of endpoint biomass by optical density was not possible) were at this point excluded from further experimentation and analysis ( Table S3 ).
Additional experiments to measure nitrate/nitrite-reduction dynamics on communities of 2–5 strains (including monoculture controls) were performed in separate 2 mM N ⁢ O − 3 and 2 mM N ⁢ O − 2 conditions. Aerobic pre-cultures were normalized to OD600 ≈ 1.2 with PBS. Using liquid handling robotics (Formulatrix Mantis), 96-deepwell plates containing 1.2 mL of 2 mM N ⁢ O − 3 or N ⁢ O − 2 SDM was inoculated with 10 μL droplets of density-normalized culture in defined combinations (e.g., a pair community containing strains A and B would be inoculated with separate 10 μL droplets of strain A and strain B). Following inoculation, all culture and sampling details were the same as described above.
Measurements were post-processed to correct for gradual evaporation of H 2 O that increased apparent concentrations with time. 3–8 uninoculated controls containing nitrate or nitrite-supplemented medium were used on each culture plate to quantify the effect of evaporation. Raw nitrate and nitrite measurements for cultures were scaled at each time point by the concentration of initially supplied nitrate or nitrite divided by the median concentration across blank measurements at that time point.
Denitrifying strains were grown axenically from freezer stocks or plated colonies in 1/10X TSB incubated at 30°C with shaking. Saturated cell cultures were harvested and DNA extracted using the DNeasy UltraClean Microbial Kit (Qiagen). DNA concentrations were quantified using the Qubit dsDNA BR Assay Kit (Invitrogen).
Library preparation for sequencing of DNA extracts was performed using the Nextera DNA Flex Library Prep Kit (Illumina) and the Nextera DNA CD Indexes (Illumina). Barcoded libraries for each strain were pooled in groups of 21–24 strains and quantified using the Qubit dsDNA BR kit and an Agilent 2100 Bioanalyzer (Carver Biotechnology Center, University of Illinois at Urbana-Champaign). Each pooled library was then separately sequenced using a MiSeq Reagent Kit v3 (Illumina, 2 × 300 bp paired-end), with a 12 pM library loading concentration and a 1% spike-in of PhiX Control v3 (Illumina). Sequencing was performed on a locally maintained and operated Illumina MiSeq system.
Raw paired-end reads were trimmed of low-quality regions and Illumina adapters using Trimmomatic 0.39 ( Bolger et al., 2014 8. Bolger, A.M. ∙ Lohse, M. ∙ Usadel, B. Trimmomatic: a flexible trimmer for Illumina sequence data Bioinformatics. 2014; 30 :2114-2120 Crossref Scopus (21176) PubMed Google Scholar ). Trimmed reads were assembled into contigs de novo using SPAdes 3.13.0 ( Bankevich et al., 2012 3. Bankevich, A. ∙ Nurk, S. ∙ Antipov, D. ... SPAdes: a new genome assembly algorithm and its applications to single-cell sequencing J. Comput. Biol. 2012; 19 :455-477 Crossref Scopus (10972) PubMed Google Scholar ) with k-mer lengths of 21, 33, 55, 77, 99, and 127 and the error-correction option “careful” enabled. Assembly quality was assessed using QUAST 5.02 ( Gurevich et al., 2013 34. Gurevich, A. ∙ Saveliev, V. ∙ Vyahhi, N. ... QUAST: quality assessment tool for genome assemblies Bioinformatics. 2013; 29 :1072-1075 Crossref Scopus (2977) PubMed Google Scholar ). The draft assembly of the laboratory strain Paracoccus denitrificans ATCC 19367 was compared to a complete assembly of the same strain by Si et al. ( Si et al., 2019 101. Si, Y.-Y. ∙ Xu, K.-H. ∙ Yu, X.-Y. ... Complete genome sequence of Paracoccus denitrificans ATCC 19367 and its denitrification characteristics Can. J. Microbiol. 2019; 65 :486-495 Crossref Scopus (2) PubMed Google Scholar ), which served as a reference. The comparison indicated a 97.8% genome fraction (percentage of bases in the reference that align to the draft assembly), with one 30.8 kbp relocation misassembly, 7.02 mismatches (sequencing errors or single nucleotide polymorphisms) per 100 kbp, and 0.43 indels per 100 kbp. The draft assembly produced 4635 predicted genes relative to 4644 genes predicted in the reference. The coverage depth of the P. denitrificans draft assembly was 32X, compared to a median of 35X for the other strains in the library. Together these analyses suggest that the draft assemblies are likely to cover the vast majority of the protein-coding sequences, with relatively few errors that would affect the inference of gene presence or absence.
Contigs were uploaded for gene annotation on the RAST Server ( http://rast.theseed.org ) using the RASTtk pipeline ( Brettin et al., 2015 10. Brettin, T. ∙ Davis, J.J. ∙ Disz, T. ... RASTtk: a modular and extensible implementation of the RAST algorithm for building custom annotation pipelines and annotating batches of genomes Sci. Rep. 2015; 5 :8365 Crossref Scopus (988) PubMed Google Scholar ). Denitrification gene presence and absence information was obtained from annotation files by a text search of gene function labels ( Table S6 ). The NarXL two-component nitrate/nitrite sensing system was considered “present” if a gene encoding the sensor ( narX ) and/or the response regulator ( narL ) were identified in the annotation. Each gene identified as a NarK-type nitrate transporter was classified post-annotation as encoding either a nitrate/ H + symporter ( narK1 ), a nitrate/nitrite antiporter ( narK2 ), or a fusion of both transporters ( narK1K2 ). This classification was performed by locally aligning each transporter sequence with the narK1K2 gene previously identified in Paracoccus denitrificans PD1222 ( Goddard et al., 2017 29. Goddard, A.D. ∙ Bali, S. ∙ Mavridou, D.A. ... The Paracoccus denitrificans NarK-like nitrate and nitrite transporters-probing nitrate uptake and nitrate/nitrite exchange mechanisms Mol. Microbiol. 2017; 103 :117-133 Crossref Scopus (15) PubMed Google Scholar ), for which the N-terminal domain has been identified to be NarK1 and the C-terminal domain NarK2. From this it was determined which RAST gene function labels correspond to narK1 , narK2 , and narK1K2 .
Additionally annotation files were searched for the cytochrome c nitrite reductase gene ( nrfA ) associated with dissimilatory nitrate reduction to ammonia (DNRA). Strains possessing this gene were excluded from further experimentation and analysis ( Table S3 ).
Phylogenetic analysis of denitrifying strains was performed using full 16S rRNA sequences identified in annotated draft genome assemblies. 16S sequences were uploaded for classification up to the genus level using the SILVA ACT service ( http://www.arb-silva.de/ ) ( Pruesse et al., 2012 88. Pruesse, E. ∙ Peplies, J. ∙ Glöckner, F.O. SINA: accurate high-throughput multiple sequence alignment of ribosomal RNA genes Bioinformatics. 2012; 28 :1823-1829 Crossref Scopus (1834) PubMed Google Scholar ). A maximum-likelihood phylogenetic tree was computed using MEGA X 10.1.8 ( Kumar et al., 2018 56. Kumar, S. ∙ Stecher, G. ∙ Li, M. ... MEGA X: molecular evolutionary genetics analysis across computing platforms Mol. Biol. Evol. 2018; 35 :1547-1549 Crossref Scopus (11440) PubMed Google Scholar ).
The N -strain consumer-resource model provides predictions of the relative abundances of each strain in a community. These predictions were tested by measuring relative abundances for a set of 2-strain communities using the package CASEU 0.1.2 in R 3.6.1 ( Cermak et al., 2020 12. Cermak, N. ∙ Datta, M.S. ∙ Conwill, A. Rapid, inexpensive measurement of synthetic bacterial community composition by Sanger sequencing of amplicon mixtures iScience. 2020; 23 :100915 Full Text Full Text (PDF) Scopus (0) PubMed Google Scholar ). Compositional Analysis by Sanger Electropherogram Unmixing (CASEU) infers relative abundances in communities via Sanger sequencing amplicons of a marker gene that distinguishes the different strains (e.g., the 16S rRNA gene). The approach works by deconvolving mixed Sanger electropherograms of amplicons from a community using the pure electropherograms obtained by sequencing amplicons from axenic cultures. Therefore the approach requires that (a) the constituents of a community can be cultured axenically, and (b) the electropherograms of a marker gene for each strain individually be sufficiently distinct (i.e., having pairwise electropherogram correlations less or equal to than approximately 0.8; Cermak et al., 2020 12. Cermak, N. ∙ Datta, M.S. ∙ Conwill, A. Rapid, inexpensive measurement of synthetic bacterial community composition by Sanger sequencing of amplicon mixtures iScience. 2020; 23 :100915 Full Text Full Text (PDF) Scopus (0) PubMed Google Scholar ).
All pair combinations and monocultures of six taxonomically and phenotypically representative strains, Achromobacter sp. ACM01 (Nar/Nir), Ensifer sp. ENS09 (Nar/Nir), Paracoccus sp. PAR01 (Nar), Pantoea sp. PNT03 (Nar), Agrobacterium sp. AGB01 (Nir), and Pseudomonas sp. PDM13 (Nir), were inoculated, grown, and periodically sampled in denitrifying conditions. All cultures were initiated with 2 mM N ⁢ O − 3 , with the exception of monocultures of Nir strains AGB01 and PDM13 and the pair culture of these two strains, which were initiated with 2 mM N ⁢ O − 2 . Cultures were harvested at 64 h, at which time optical densities were measured. In order to calibrate a conversion from relative biomass density (as measured by OD600) and relative abundance of 16S amplicons, equal volume (450 μL) synthetic mixtures of all pairs of monocultures were also prepared with known relative abundances of each strain.
DNA was extracted from monocultures, pair cultures, and synthetic pair mixtures using the DNeasy UltraClean Microbial Kit. A fragment of the 16S rRNA gene was amplified using the 27F (AGAGTTTGATCMTGGCTCAG) and 806R (GGACTACNVGGGTWTCTAAT) universal primers. The following reagents were used for each reaction: 22 μL nuclease-free H 2 O, 1 μL 27F primer (10 μM), 1 μL 807R primer (10 μM), 1 μL DNA extract, 25 μL Platinum Hot Start PCR Master Mix (Invitrogen). The following thermocycler settings were used: initial denaturation, 2 min at 94°C; amplification (35 cycles), 30 sec at 94°C, 30 sec at 53°C, 60 sec at 72°C; final extension, 10 min at 72°C. PCR products were cleaned using the QIAquick PCR Purification Kit (Qiagen). Sanger sequencing of cleaned PCR products was performed at the University of Chicago Comprehensive Cancer Center DNA Sequencing and Genotyping Facility.
Resulting AB1 files containing electropherogram signals were analyzed using CASEU to infer relative abundances in each sample. First, it was verified that the six pure electropherograms from monocultures of the different strains were sufficiently distinct to distinguish signals in mixed electropherograms. Pairwise correlations between pure electropherograms were computed using CASEU, and were generally found to be much smaller than 0.8, with the exception of the Alphaproteobacteria ENS09, PAR01, and AGB01, pairs of which had electropherogram correlations of approximately 0.8. It was therefore concluded that these strains could be distinguished in a community using the CASEU approach.
Next, the six pure electropherograms were used to infer relative abundances in the pair cultures. In order to assess the extent of cross-contamination in these pair cultures, CASEU was allowed infer relative abundance using all six pure electropherograms for each pair culture, in essence assuming that any of the six strains could be present in any given pair culture. In every community, no evidence of cross-contamination was observed (i.e., in each pair community, only the intended pair of strains was measured at non-zero relative abundance. Though the CASEU approach cannot reliably resolve relative abundances below 1–2% ( Cermak et al., 2020 12. Cermak, N. ∙ Datta, M.S. ∙ Conwill, A. Rapid, inexpensive measurement of synthetic bacterial community composition by Sanger sequencing of amplicon mixtures iScience. 2020; 23 :100915 Full Text Full Text (PDF) Scopus (0) PubMed Google Scholar ), if cross-contamination was present at these levels, it would have little to no impact on community metabolite dynamics. Therefore it was concluded that cross-contamination was generally negligible in denitrification experiments.
A consumer-resource model was used to parameterize the dynamics of nitrate and nitrite-reduction. For a single strain that performs both nitrate and nitrite reduction (Nar/Nir strain), the model is as follows: 𝑑 ⁢ 𝑥 𝑑 ⁢ 𝑡 = ( 𝛾 𝐴 ⁢ 𝑟 𝐴 ⁢ 𝐴 𝐾 𝐴 + 𝐴 + 𝛾 𝐼 ⁢ 𝑟 𝐼 ⁢ 𝐼 𝐾 𝐼 + 𝐼 ) ⁢ 𝑥 , 𝑑 ⁢ 𝐴 𝑑 ⁢ 𝑡 = − 𝑟 𝐴 ⁢ 𝐴 𝐾 𝐴 + 𝐴 ⁢ 𝑥 , 𝑑 ⁢ 𝐼 𝑑 ⁢ 𝑡 = ( 𝑟 𝐴 ⁢ 𝐴 𝐾 𝐴 + 𝐴 − 𝑟 𝐼 ⁢ 𝐼 𝐾 𝐼 + 𝐼 ) ⁢ 𝑥 . (Equation 3)
The variable x (in units of OD at 600 nm) is the biomass density of a single population, and A and I (mM) are the concentrations of nitrate and nitrite respectively. The model is parameterized by reduction rates 𝑟 𝐴 and 𝑟 𝐼 (mM/OD/h), yields 𝛾 𝐴 and 𝛾 𝐼 (OD/mM), and substrate affinities and 𝐾 𝐴 and 𝐾 𝐼 (mM), for growth on nitrate and nitrite, respectively.
The model, which resembles the Monod model for bacterial growth ( Monod, 1949 78. Monod, J. The growth of bacterial cultures Annu. Rev. Microbiol. 1949; 3 :371-394 Crossref Google Scholar ), assumes that growth of the population occurs at a rate proportional to the reduction rates of nitrate and nitrite, with the two resources treated as substitutable. Nitrite is the direct product of nitrate reduction (in a 1:1 stoichiometry). Nitric oxide, the product of nitrite reduction, is not explicitly modeled, and thus mass leaves the system when nitrite is reduced. For a strain that performs only nitrate reduction (Nar strain), the model simplifies by setting 𝑟 𝐼 , 𝛾 𝐼 = 0 . Likewise for a strain that performs only nitrite reduction (Nir strain), 𝑟 𝐴 , 𝛾 𝐴 = 0 . This model assumes that nitrate and/or nitrite are the growth-limiting nutrients and therefore the concentration of electron donors (e.g., succinate) is not explicitly modeled.
Monoculture experiments were performed for 78 soil isolates and one reference strain Paracoccus denitrificans ATCC 19367 under denitrifying conditions in succinate defined medium (SDM) in order to estimate parameters of the consumer-resource model ( Equation 3 ). Monoculture experiments were also performed in acetate defined medium (ADM) for the 64 strains that grew aerobically on ADM ( Table S1 ).
The yield parameters 𝛾 𝐴 and/or 𝛾 𝐼 were directly measured for each strain from endpoint measurements of optical density and nitrate/nitrite concentration.
To demonstrate how this is possible, Equation 3 gives: 𝑑 ⁢ 𝑥 𝑑 ⁢ 𝑡 = − 𝛾 𝐴 ⁢ 𝑑 ⁢ 𝐴 𝑑 ⁢ 𝑡 − 𝛾 𝐼 ⁢ ( 𝑑 ⁢ 𝐴 𝑑 ⁢ 𝑡 + 𝑑 ⁢ 𝐼 𝑑 ⁢ 𝑡 ) . (Equation 4)
Therefore it follows from the fundamental theorem of calculus that: 𝑇 ∫ 0 𝑑 ⁢ 𝑥 𝑑 ⁢ 𝑡 𝑑 𝑡 = 𝑥 𝑇 − 𝑥 0 = − 𝛾 𝐴 ⁢ 𝑇 ∫ 0 𝑑 ⁢ 𝐴 𝑑 ⁢ 𝑡 𝑑 𝑡 − 𝛾 𝐼 ⁢ ( 𝑇 ∫ 0 𝑑 ⁢ 𝐴 𝑑 ⁢ 𝑡 𝑑 𝑡 + 𝑇 ∫ 0 𝑑 ⁢ 𝐼 𝑑 ⁢ 𝑡 𝑑 𝑡 ) = 𝛾 𝐴 ⁢ ( 𝐴 0 − 𝐴 𝑇 ) + 𝛾 𝐼 ⁢ ( 𝐴 0 − 𝐴 𝑇 + 𝐼 0 − 𝐼 𝑇 ) , (Equation 5) where the subscripts 0 and T denote the values of the variables at 𝑡 = 0 and T , respectively.
Equation 5 indicates that 𝛾 𝐴 and 𝛾 𝐼 can be inferred using measurements of biomass density and nitrate/nitrite concentrations at some time 𝑡 = 𝑇 , given knowledge of the experimentally-specified initial values of these variables. Because this equation is linear with up to two unknowns (recall that 𝛾 𝐼 = 0 for Nar strains and 𝛾 𝐴 = 0 for Nir strains), fitting this equation could in principle be accomplished using data from a single experimental condition for Nar and Nir strains or two experimental conditions for Nar/Nir strains. Instead 𝛾 𝐴 and 𝛾 𝐼 were fit to data from many conditions in order to obtain more robust estimates. Specifically, monocultures were grown in the following conditions: (a) 2 mM N ⁢ O − ∗ , OD600 0 = 0.01, (b) 1 mM N ⁢ O − ∗ , OD600 0 = 0.01, (c) 2 mM N ⁢ O − ∗ , OD600 0 = 0.001, where Nar/Nir strains were cultured with N ⁢ O − 3 and N ⁢ O − 2 separately (6 conditions total), Nar strains were cultured with N ⁢ O − 3 (3 conditions total), and Nir strains were cultured with N ⁢ O − 2 (3 conditions total). Then the equation O D 6 0 0 6 4 − O D 6 0 0 0 = 𝛾 0 + 𝛾 𝐴 ⁢ ( 𝐴 0 − 𝐴 6 4 ) + 𝛾 𝐼 ⁢ ( 𝐴 0 − 𝐴 6 4 + 𝐼 0 − 𝐼 6 4 ) , (Equation 6) was fit via ordinary least squares regression using endpoint measurements from all conditions taken at 𝑡 = 64 h. The intercept term 𝛾 0 was included in Equation 6 to account for small systematic measurement errors, and was typically close to zero ( Figure S1 A). Examples of fits to Equation 6 are shown in Figures S1 B–S1D.
Parameterizing Equation 3 in terms of OD assumed that biomass (g dry weight/L) is proportional to OD600, and that the constant of proportionality is the same for all strains in the library. Previous literature reports that the ratio g dry weight/L/OD is typically 0.4 ( Coultate and Sundaram, 1975 16. Coultate, T.P. ∙ Sundaram, T.K. Energetics of Bacillus stearothermophilus growth: molar growth yield and temperature effects on growth efficiency J. Bacteriol. 1975; 121 :55-64 Crossref PubMed Google Scholar ; Rosenberger and Elsden, 1960 91. Rosenberger, R.F. ∙ Elsden, S.R. The yields of Streptococcus faecalis grown in continuous culture J. Gen. Microbiol. 1960; 22 :726-739 Crossref PubMed Google Scholar ; Hassen et al., 1998 36. Hassen, A. ∙ Saidi, N. ∙ Cherif, M. ... Effects of heavy metals on Pseudomonas aeruginosa and Bacillus thuringiensis Bioresour. Technol. 1998; 65 :73-82 Crossref Scopus (113) Google Scholar ; Péquignot et al., 1998 84. Péquignot, C. ∙ Larroche, C. ∙ Gros, J.B. A spectrophotometric method for determination of bacterial biomass in the presence of a polymer Biotechnol. Tech. 1998; 12 :899-903 Crossref Scopus (9) Google Scholar ; Nikel et al., 2021 81. Nikel, P.I. ∙ Fuhrer, T. ∙ Chavarría, M. ... Reconfiguration of metabolic fluxes in Pseudomonas putida as a response to sub-lethal oxidative stress ISME J. 2021; 15 :1751-1766 Crossref Scopus (11) PubMed Google Scholar ; Lee et al., 2007 57. Lee, K.H. ∙ Park, J.H. ∙ Kim, T.Y. ... Systems metabolic engineering of Escherichia coli for L-threonine production Mol. Syst. Biol. 2007; 3 :149 Crossref Scopus (345) PubMed Google Scholar ). In order to test whether some strains might secrete optically active compounds that absorb strongly at 600 nm, and thereby corrupt the biomass to OD conversion, four representative strains ( Achromobacter sp. ACM01, Ensifer sp. ENS09, Paracoccus denitrificans ATCC 19367, and Pseudomonas sp. PDM21) were cultured in SDM under denitrifying conditions for 64 h. Cells were then removed from the endpoint cultures by filtration and OD600 of the filtered medium was measured. It was observed that absorbance levels were at or below that of fresh medium. It was therefore concluded that secretion of optically active molecules likely does not impact the inference of biomass from OD, and that using OD600 as a proxy for biomass incurs only a modest error. However, it is important to recognize that directly measuring the biomass of each strain in the library may improve the quality of model fits to data and alter regression results.
For each strain, having determined the yield parameters, the rate parameters 𝑟 𝐴 and 𝑟 𝐼 were then globally (simultaneously) fit to nitrate/nitrite dynamics data across all experimental conditions by minimizing the sum of squared residuals between the data and numerical solutions to Equation 3 (see example in Figure S1 E). Equation 3 was solved numerically using the differential equation solver ode23s in MATLAB R2017b. The solver was initialized at 𝑡 = 𝑡 1 (where 𝑡 1 is the time point of first nitrate/nitrite measurement, approximately 2 h), setting initial conditions 𝑁 ⁡ ( 𝑡 1 ) = O D 6 0 0 0 , and 𝐴 ⁡ ( 𝑡 1 ) and 𝐼 ⁡ ( 𝑡 1 ) to the median measured values of nitrate and nitrite concentration at 𝑡 = 𝑡 1 over experimental replicates within a given condition. The constrained optimization function fmincon was used in conjunction with the global minimum search function GlobalSearch to minimize the sum of squared residuals and obtain optimal values of 𝑟 𝐴 and 𝑟 𝐼 . Values of 𝑟 𝐴 and 𝑟 𝐼 were constrained between 0 and 50 mM/OD/h.
Initially, this approach was used to simultaneously fit both rates ( 𝑟 𝐴 and 𝑟 𝐼 ) and substrate affinities ( 𝐾 𝐴 and 𝐾 𝐼 ), but it was observed in nonparametric bootstrap estimates of parameter error that the affinities 𝐾 𝐴 and 𝐾 𝐼 were not well constrained by experimental measurements ( Figure S1 F, median fractional errors of 30.0% and 26.5% for 𝐾 𝐴 and 𝐾 𝐼 in SDM, respectively). This is likely because the true values are small relative to the typical scale of substrate concentrations in the experiments: values for nitrate/nitrite affinity constants between 0.003–0.055 mM have been identified for denitrifying cultures previously ( Beccari et al., 1983 4. Beccari, M. ∙ Passino, R. ∙ Ramadori, R. ... Kinetics of dissimilatory nitrate and nitrite reduction in suspended growth culture J. Water Pollut. Control Fed. 1983; 55 :58-64 Google Scholar ; Claus and Kutzner, 1985 13. Claus, G. ∙ Kutzner, H. Physiology and kinetics of autotrophic denitrification by Thiobacillus denitrificans Appl. Microbiol. Biotechnol. 1985; 22 :283-288 Google Scholar ; Kornaros et al., 1996 54. Kornaros, M. ∙ Zafiri, C. ∙ Lyberatos, G. Kinetics of denitrification by Pseudomonas denitrificans under growth conditions limited by carbon and/or nitrate or nitrite Water Environ. Res. 1996; 68 :934-945 Crossref Scopus (60) Google Scholar ; Dinçer and Kargı, 2000 20. Dinçer, A.R. ∙ Kargı, F. Kinetics of sequential nitrification and denitrification processes Enzyme Microb. Technol. 2000; 27 :37-42 Crossref Scopus (85) PubMed Google Scholar ), while cultures were initialized with 1–2 mM nitrate/nitrite. In the dynamical regimes of Equation 3 where substrate concentrations are much greater than affinity constants (i.e., 𝐴 ≫ 𝐾 𝐴 , 𝐼 ≫ 𝐾 𝐼 ), the dependence of Equation 3 on 𝐾 𝐴 and 𝐾 𝐼 vanishes. This restricts identifiability of the affinity parameters to the regime where 𝐴 , 𝐼 are on the same scale as 𝐾 𝐴 , 𝐾 𝐼 (likely in the micromolar range). This regime typically occurs only briefly during the experiments, just before the substrates are exhausted, and sampling this regime for all strains would require a much greater sampling frequency than what was attempted in this study. Alternatively, the affinity parameters could be measured by comparing differences in growth/reduction rates at very low substrate concentrations, so that growth occurs in a regime where these rates depend more strongly on the affinity parameters (i.e., 𝐴 0 ≪ 𝐾 𝐴 , 𝐼 0 ≪ 𝐾 𝐼 ). Doing this would require much more sensitive measurement of biomass density or nitrate/nitrite concentration than what was attempted in this study. Regardless, it was observed in nonparametric bootstrap estimates of parameter error that fitted values of 𝑟 𝐴 and 𝑟 𝐼 were insensitive to 𝐾 𝐴 and 𝐾 𝐼 ( Figure S1 G, median fractional errors of 3.8% and 4.2% for 𝑟 𝐴 and 𝑟 𝐼 in SDM, respectively), as was the qualitative model behavior ( Figure S1 H) and the fit quality ( Figure S1 I). Therefore 𝐾 𝐴 and 𝐾 𝐼 were fixed to 0.01 mM.
By fitting metabolite dynamics across multiple initial media and biomass density conditions to the model Equation 3 , it was assumed that this simple model is a good representation of the metabolic phenotypes of denitrifying strains, with a few parameters capturing the full extent of the metabolite dynamics. In the majority of cases it was observed that the model fit the metabolite dynamics well (see example in Figure S1 E), indicating that the assumptions of model Equation 3 were appropriate. However in some cases (e.g., Figures S1 J and S1K) the observed metabolite dynamics departed significantly from the optimal model fits. Often it appeared that different parameterizations were necessary for different initial conditions, e.g., nitrite reduction rates appeared to differ depending on whether nitrite was initially supplied (for example Figure S1 J). In these cases, while the model apparently failed to capture the metabolite dynamics phenotypes across all conditions simultaneously, it appeared that it was still possible to estimate consumer-resource parameters for a subset of initial conditions.
Therefore a pipeline was developed for parameterizing the model Equation 3 on a subset of experimental conditions if poor fits were obtained when fitting to all conditions. First yields on nitrate and nitrite were fit using all experimental conditions. Then the pipeline proceeded as follows for each strain: 1. Fit reduction rates to all experimental conditions. If the root-mean-square error (RMSE) evaluated between observed data and model solutions across all experimental conditions and replicates exceeds a threshold T , then proceed to step 2. If not, accept the parameter fit. 2. Fit reduction rates only to experimental conditions where OD600 0 = 0 . 0 1 . If the RMSE evaluated across these high biomass-density conditions exceeds T , proceed to step 3. If not, accept the parameter fit. 3. (Nar/Nir strains only) Fit reduction rates only to experimental conditions where nitrate was initially supplied. If the RMSE evaluated across these conditions exceeds T , then proceed to step 4. If not, accept the parameter fit. 4. (Nar/Nir strains only) Fit reduction rates only to experimental conditions where OD600 0 = 0 . 0 1 and nitrate was initially supplied. If the RMSE evaluted across these conditions is less than or equal to T , accept the parameter fit.
This pipeline was used with 𝑇 = 0 . 1 7 to obtain fits for monocultures of all 79 strains in SDM and 64 strains in ADM. The RMSEs for strains at each step in the fitting pipeline are shown in Table S5 . An example of a fit obtained using the first three steps of the pipeline is shown in Figure S1 J, and a fit obtained using the first two steps is shown in Figure S1 K. Only the first three steps of the pipeline were necessary to produce parameter fits with error less than 𝑇 = 0 . 1 7 for the monocultures in SDM, while step 4 was necessary for only 4 out of 64 ADM monocultures ( Table S5 ).
Finally, there were 7 Nar strains (PDM26–PDM32) for which nitrate concentrations appeared to asymptotically approach nonzero values in SDM (see example in Figure S1 L). However, since it was possible to fit consumer-resource parameters to these cases with relatively low error ( Table S5 ), these parameter fits were accepted for use in subsequent analyses.
Although the rate parameters 𝑟 𝐴 and 𝑟 𝐼 for each strain were fit by directly measuring the dynamics of nitrate and nitrite reduction, only endpoint measurements were used to fit the yield parameters 𝛾 𝐴 and 𝛾 𝐼 , and biomass density dynamics were not directly measured. Though the yield parameters are identifiable via endpoint measurements ( Equation 5 ), the accuracy of predictions for biomass density dynamics depends on the consumer-resource model ( Equation 3 ) being reasonably well-specified. For instance, if mortality is an important factor that causes biomass density to change significantly on the timescale of the experiment, then the measurement of yields would lead to poor biomass predictions because cell death is not accounted for in the model.
To validate the inference of yields and model predictions for biomass density dynamics, these dynamics were directly measured for a set of four taxonomically-representative Nar/Nir strains: Achromobacter sp. ACM01, Ensifer sp. ENS09, Paracoccus denitrificans ATCC 19367, and Pseudomonas sp. PDM21. These four strains were cultured in SDM under denitrifying conditions with 2 mM N ⁢ O − 3 , OD600 0 = 0 . 0 1 , and 21 experimental replicates. Cultures were manually sampled (300 μL) from 3 replicates at 7 time points (2, 4, 6, 8, 16, 32, and 64 h from the start of anaerobic culture), with different replicates sampled at each time point. Optical density was measured immediately after sampling, and measurements were post-processed to correct for evaporation.
The measured values of biomass density are shown in Figure S1 M, alongside predictions of the model Equation 3 using previous inferences of rate and yield parameters for these strains in SDM. Predicted biomass dynamics agree well with the measured optical densities, both in the exponential and stationary phases. The errors of predicted biomass density relative to measurements at 𝑡 = 64 h are all less than 10%, indicating that the yields were well-estimated by the fitting protocol. No appreciable evidence for mortality was observed, with little to no decline in biomass density observed after nitrate and nitrite were exhausted. This is consistent with previous measurements of low-density starving cultures of Escherischia coli K12, where negligible cell death was observed after approximately 50 h ( Phaiboun et al., 2015 86. Phaiboun, A. ∙ Zhang, Y. ∙ Park, B. ... Survival kinetics of starving bacteria is biphasic and density-dependent PLoS Comput. Biol. 2015; 11 :e1004198 Crossref Scopus (28) PubMed Google Scholar ). It was concluded that the fitting procedure for rates and yields faithfully captures biomass density dynamics, despite the fact that biomass density is only measured at 𝑡 = 64 h.
A nonparametric bootstrap was used to estimate the sampling distributions of { 𝑟 𝐴 , 𝛾 𝐴 , 𝑟 𝐼 , 𝛾 𝐼 } for the 79-strain library in SDM. Bootstrap datasets were generated by resampling (with replacement) among replicates; that is, for an experimental condition (e.g., 𝐴 0 = 2 mM, 𝐼 0 = 0 mM, OD600 0 = 0.01) performed with four replicates, a new dataset was created by randomly selecting a set of four replicates with replacement, doing this for all conditions. Then { 𝑟 𝐴 , 𝑟 𝐼 , 𝛾 𝐴 , 𝛾 𝐼 } were refit to these bootstrap resamples. This was repeated 100 times for each strain to obtain sampling distributions for these parameters. Fractional errors, defined as the ratio of the interquartile range to the value of the parameter, are less than 10% for the vast majority of inferred parameters. Since 𝛾 𝐴 and 𝛾 𝐼 inferences are error-prone when measured biomass densities (and therefore yields) are low, a yield parameter was set identically to zero if its estimate was negative or within one standard error of zero.
Linear regression was used to predict the measured consumer-resource parameters { 𝑟 𝐴 , 𝛾 𝐴 , 𝑟 𝐼 , 𝛾 𝐼 } from the presence and absence of denitrification-related genes in the genomes of each strain. The regression problem was formulated as follows: 𝑦 𝑖 = 𝛽 0 + ∑ 𝑃 𝑗 = 1 𝛽 𝑗 ⁢ 𝑔 𝑖 ⁢ 𝑗 + 𝜀 𝑖 f o r 𝑖 = 1 , … , 𝑁 . (Equation 7)
The response variable 𝑦 𝑖 is the observed value of a consumer-resource model parameter (e.g., 𝑟 𝐴 ) for strain i , with N such observations in total. The predictors 𝑔 𝑖 ⁢ 𝑗 are indicator variables that take the value 1 if strain I has gene j and take 0 otherwise, with 𝑃 = 1 7 predictors in total. The coefficients 𝛽 𝑗 and intercept 𝛽 0 are fit by the regression, which determines the residual term 𝜀 𝑖 . This formulation assumes that genes contribute additively (and not quadratically, etc.) to the value of a phenotypic parameter. While in principle there may exist a formulation of this regression with greater predictive power that takes into account the nonlinear interactions between predictors (e.g., a model with quadratic terms), a linear formulation was chosen to keep the number of fitting parameters small relative to the number of observations.
The LASSO regression method ( Hastie et al., 2008 37. Hastie, T. ∙ Tibshirani, R. ∙ Friedman, J. The Elements of Statistical Learning Springer, 2008 Google Scholar ; Hastie et al., 2016 38. Hastie, T. ∙ Tibshirani, R.J. ∙ Wainwright, R. Statistical learning with sparsity CRC Press, 2016 Google Scholar ) was used to solve Equation 7 . For given gene presence/absence vectors → 𝑔 𝑖 and response vector y , LASSO regression solves: m i n 𝛽 0 , → 𝛽 ⁢ { 1 2 ⁢ 𝑁 ⁢ ∑ 𝑁 𝑖 = 1 ( 𝑦 𝑖 − 𝛽 0 − → 𝑔 𝑇 𝑖 ⁢ → 𝛽 ) 2 + 𝜆 ⁢ ∣ ∣ → 𝛽 ∣ ∣ 1 } , (Equation 8) performing both variable selection and regularization by penalizing the sum of squared residuals by the 𝐿 1 norm of the coefficient vector → 𝛽 . The strength of the penalty is controlled by the hyperparameter λ , which at moderate values sets the coefficients of poor predictors identically to zero, thus resulting in a sparse model. Typically the hyperparameter value 𝜆 = ̂ 𝜆 is selected by minimizing prediction error in cross-validation, which optimizes the ability of the model to generalize out of sample, and makes the method suitable for datasets where overfitting via an approach such as ordinary least squares (OLS) is likely because the number of predictors and the number of observations are on the same order of magnitude.
LASSO regressions were performed in MATLAB R2017b for each consumer-resource parameter measured in SDM separately, obtaining different → 𝛽 and 𝛽 0 for each regression. The fits and coefficients for regressions on consumer-resource parameters measured in SDM are shown in Figures 4 C–4J. Note that for nitrate-related parameters ( 𝑟 𝐴 and 𝛾 𝐴 ), only strains capable of nitrate reduction (Nar and Nar/Nir phenotypes) were included in the predictor-response datasets. Similarly for the nitrite-related parameters, only strains with Nar/Nir and Nir phenotypes were included in the predictor-response datasets. Prior to fitting, all predictors were standardized to have zero mean and unit variance.
For each regression of the form given in Equation 7 , iterated K -fold cross-validation was used to determine the value 𝜆 = ̂ 𝜆 that minimizes estimated prediction error. Optimal hyperparameter values were determined for each regression individually, rather determining than one hyperparameter value to be used for all regressions. This was done because the hyperparameter controls the level of sparsity in the resulting solution (i.e., the number of genes that are nonzero in the optimal set of regression coefficients), and a priori the optimal level of sparsity may differ among the different regressions on consumer-resource parameters. Choosing an optimal value of λ for each regression individually ensured that the best LASSO solution for each regression was identified.
Let 𝛬 be a set of discrete values of λ for which Equation 8 is solved. Each iteration of cross-validation proceeds in the following way: 1. Randomly partition the data into K subsamples of roughly equal size. 2. For each 𝑘 = 1 , 2 , … , 𝐾 : (a) Holding out the k th fold (test set), solve Equation 8 at each 𝜆 ∈ 𝛬 using the union of the remaining remaining 𝐾 − 1 folds of data (training set). (b) Use the resulting regression coefficients to predict the responses in the test set. (c) Evaluate root-mean-square error of the test set prediction.
This process is iterated M times, each time choosing a new random partition of the data into K subsamples. The average over the 𝐾 ⁢ 𝑀 estimates of prediction error was recorded at each value of 𝜆 ∈ 𝛬 , and the optimal value 𝜆 = ̂ 𝜆 was then selected as that which minimized this estimate of error. An iterated K -fold cross-validation approach was chosen over either basic K -fold ( 𝑀 = 1 ) or leave-one-out ( 𝐾 = 𝑁 ) cross-validation because iterated cross-validation averages over the sampling variability inherent in randomly partitioning the dataset into groups, and also because partitioning into 𝐾 ≠ 𝑁 folds allows the estimation the out-of-sample performance of the model through statistics such as the coefficient of determination between observed and predicted values on each test set.
A value of 𝐾 = 4 for iterated cross-validation ( 𝑀 = 1 0 4 iterations) was chosen to balance the relative sizes of training and test sets for the purpose of evaluating out-of-sample performance; as K increases, the size of the cross-validation training set increases, while the size of test set decreases. It was observed that ̂ 𝜆 was insensitive to the choice of K .
The out-of-sample performance of regressions on each consumer-resource parameter was estimated during iterated K -fold cross-validation by computing the coefficient of determination ( 𝑅 2 ) between observed and predicted response values in each test set. The median values of 𝑅 2 obtained via iterated 4-fold cross-validation ( 𝑀 = 1 0 4 iterations) at 𝜆 = ̂ 𝜆 , denoted ̅ 𝑅 2 𝐶 ⁢ 𝑉 , is positive for all regressions.
The significance of ̅ 𝑅 2 𝐶 ⁢ 𝑉 for regressions on each consumer-resource parameter was evaluated under the null hypothesis that there is no relationship between the predictor and the response via a permutation test. The response variable for each regression was repeatedly permuted ( 1 × 1 0 3 permutations) and regression coefficients were re-fitted, using iterated 4-fold cross-validation ( 𝑀 = 1 0 2 iterations) to select the hyperparameter for each permutation. Under the null distributions of ̅ 𝑅 2 𝐶 ⁢ 𝑉 computed using this approach for regressions on SDM consumer-resource parameters, 𝑝 < 0 . 0 0 1 in all cases.
When the data used for model training via LASSO are also used for inference of significant regression coefficients, it is necessary to account for the fact that LASSO performs variable selection (i.e., selects some coefficients to be nonzero over others) ( Hastie et al., 2016 38. Hastie, T. ∙ Tibshirani, R.J. ∙ Wainwright, R. Statistical learning with sparsity CRC Press, 2016 Google Scholar ; Taylor and Tibshirani, 2015 107. Taylor, J. ∙ Tibshirani, R.J. Statistical learning and selective inference Proc. Natl. Acad. Sci. USA. 2015; 112 :7629-7634 Crossref Scopus (121) PubMed Google Scholar ). Because LASSO preferentially selects variables with high predictive power in the training set, neglecting this selection results in overoptimistic confidence intervals and p -values.
To illustrate how and why this was done, first consider the simpler case of inference on regression coefficients determined by OLS. If the residuals 𝜀 𝑖 are normally distributed, it can be shown that the sampling distribution of a coefficient 𝛽 𝑗 is also normal, with a sampling variance that can be estimated from the data. This sampling distribution can then be used to test the hypothesis that the true value of 𝛽 𝑗 is zero. In contrast, in the case where LASSO regression is used and the coefficient 𝛽 𝑗 is selected to be nonzero, it can be shown that a normal distribution is not appropriate for the sampling distribution of 𝛽 𝑗 ( Taylor and Tibshirani, 2015 107. Taylor, J. ∙ Tibshirani, R.J. Statistical learning and selective inference Proc. Natl. Acad. Sci. USA. 2015; 112 :7629-7634 Crossref Scopus (121) PubMed Google Scholar ). Instead the appropriate distribution is a truncated normal distribution, i.e., a normal distribution only defined along a finite interval. Intuitively, the distribution is truncated because the likely range of 𝛽 𝑗 must be conditioned upon the knowledge that LASSO selected it (along with a set of other elements of → 𝛽 ) to be nonzero. The bounds of the truncated distribution are determined by both the data and by the set of other nonzero elements of → 𝛽 via analytical relations, and can be computed using the package selectiveInference 1.2.5 in R 3.6.1 to estimate the sampling distributions for each nonzero element of → 𝛽 . An intuitive description of this post-selection inference approach applied to the simpler context of forward stepwise regression can be found in Taylor and Tibshirani (2015) 107. Taylor, J. ∙ Tibshirani, R.J. Statistical learning and selective inference Proc. Natl. Acad. Sci. USA. 2015; 112 :7629-7634 Crossref Scopus (121) PubMed Google Scholar , and a technical description of the approach applied to LASSO can be found in Hastie et al. (2016) 38. Hastie, T. ∙ Tibshirani, R.J. ∙ Wainwright, R. Statistical learning with sparsity CRC Press, 2016 Google Scholar .
The function fixedLassoInf in the selectiveInference package was used to compute 90% confidence intervals and to obtain p -values under the null hypothesis the true value is zero for each nonzero coefficient for regressions on SDM consumer-resource parameters, evaluated at the hyperparameter value 𝜆 = ̂ 𝜆 selected by cross-validation.
Microbial phenotypic traits exhibit varying degrees of phylogenetic correlation as a result of shared evolutionary history ( Martiny et al., 2015 69. Martiny, J.B.H. ∙ Jones, S.E. ∙ Lennon, J.T. ... Microbiomes in light of traits: a phylogenetic perspective Science. 2015; 350 :aac9323 Crossref Scopus (314) PubMed Google Scholar ). To characterize the extent of phylogenetic correlation in the consumer-resource parameters { 𝑟 𝐴 , 𝛾 𝐴 , 𝑟 𝐼 , 𝛾 𝐼 } , the function phyloCorrelogram in the package phylosignal 1.3 for R 3.6.1 ( Keck et al., 2016 51. Keck, F. ∙ Rimet, F. ∙ Bouchez, A. ... phylosignal: an R package to measure, test, and explore the phylogenetic signal Ecol. Evol. 2016; 6 :2774-2780 Crossref Scopus (177) PubMed Google Scholar ) was used. This function estimates autocorrelation in trait values by computing Moran’s I index as a function of phylogenetic distance, measured here using the 16S rRNA phylogenetic tree. Statistically significant correlation (95% confidence intervals estimated using 1 × 1 0 3 bootstrap replicates) was observed over varying levels of phylogenetic distance for the different parameters. The rate 𝑟 𝐴 was correlated to a small degree ( m a x ⁡ ( 𝐼 ) = 0 . 1 6 ) over a relatively short interval of phylogenetic distance (16S tree distance 0.01), while 𝛾 𝐴 , 𝑟 𝐼 , and 𝛾 𝐼 were correlated to a modest degree ( m a x ⁡ ( 𝐼 ) = 0 . 3 3 , 0.27 and 0.48, respectively) over longer intervals (0.16, 0.06 and 0.12, respectively).
Because the strain library contains a few clades of very closely related strains (e.g., ENS01–08, PDM20–23, Figure 3 C), it is possible that some of the phylogenetic correlation measured in the full 79-strain library is attributable to the over-representation of these close relatives. In addition, the over-representation of these close relatives could in principle skew the results of the regressions. To estimate the influence of over-represented close relatives in the strain library on phylogenetic correlations and regression results, clades comprising strains with identical 16S rRNA sequences were pruned by randomly selecting one representative and removing the remaining strains from the dataset. This removed 15 strains from the library, resulting in a subsampled dataset of 64 strains. Phylogenetic correlograms were then computed for the SDM consumer-resource parameters on this pruned dataset. Pruning the dataset reduced correlations for 𝛾 𝐴 , 𝑟 𝐼 , and 𝛾 𝐼 , with maximum correlations decreasing for all three parameters ( m a x ⁡ ( 𝐼 ) = 0 . 3 0 , 0.21 and 0.39, respectively), and significant correlation lengths decreasing for 𝛾 𝐴 and 𝛾 𝐼 (0.05 and 0.09, respectively). The correlogram for the rate 𝑟 𝐴 in the pruned dataset, which showed a small degree of correlation in the full dataset, changed little. It was concluded that some of the phylogenetic correlation estimated for the full dataset was attributable to the over-representation of close relatives, but it is still the case that there exists statistically significant phylogenetic correlations at short distances. Next LASSO regressions were performed on the pruned dataset. Both in-sample and out-of-sample metrics of model performance ( 𝑅 2 𝑓 ⁢ 𝑖 ⁢ 𝑡 and ̅ 𝑅 2 𝐶 ⁢ 𝑉 , respectively) changed little relative to the corresponding values for regressions on the full dataset. Similarly, the regression coefficients did not change substantially. From this it was concluded that the over-representation of close relatives did not have a large impact on the results of regressions on the consumer-resource parameters.
In order to assess whether denitrification genes make better predictor variables than other possible sets of genes, the SDM consumer-resource parameters { 𝑟 𝐴 , 𝛾 𝐴 , 𝑟 𝐼 , 𝛾 𝐼 } were regressed onto the presence and absence of randomly-selected genes from the set of all annotated genes in strains in the library.
First the set of all uniquely-labelled protein-encoding genes present in the RAST annotations were identified for the 79-strain library. From this set of 13415 unique genes, 51 genes associated with denitrification were removed; this included not only terminal reductases, sensors/regulators, and transporters that were used as variables in the regression ( Table S6 ), but also related chaperones, structural genes, and biosynthesis genes that frequently occur in clusters with the denitrification genes ( Table S7 ).
New sets of predictor variables were then generated by randomly selecting genes from the set of 13364 non-denitrification genes and constructing binary presence/absence matrices as for denitrification-related genes. In order to create a fair comparison between these randomly-selected predictors and the denitrification gene predictors, (a) sets of only 17 genes were selected, matching the dimensionality of the denitrification gene presence/absence matrix, and (b) rejection sampling was performed to match the gene presence frequency (fraction of strains that possess a given gene) distribution of the denitrification genes. The latter was a necessary consideration because the distribution of presence frequencies of non-denitrification genes is heavily skewed toward zero relative to the frequencies of denitrification genes ( Figure S2 A), indicating that a large portion of genes occur only in a small number of strains.
To perform rejection sampling, densities for the gene frequency distributions were estimated, and these densities were used to define acceptance probabilities for random samples. Let 𝑓 ⁡ ( 𝑥 ) denote the probability density of gene frequencies for non-denitrification genes and similarly 𝑔 ⁡ ( 𝑥 ) for denitrification genes, where x here denotes gene presence frequency, and set the constant H so that 𝑔 ⁡ ( 𝑥 ) / 𝑓 ⁡ ( 𝑥 ) / 𝐻 ≤ 1 for all 𝑥 ∈ [ 0 , 1 ] . Rejection sampling was then performed in the following way: 1. With uniform probability, randomly sample a candidate gene from the set of non-denitrification genes. Denote the frequency of this gene as 𝑥 0 . 2. Accept the candidate gene as a predictor with probability 𝑔 ⁡ ( 𝑥 0 ) / 𝑓 ⁡ ( 𝑥 0 ) / 𝐻 . Otherwise reject the candidate and return to step 1. 3. Return to step 1 until 17 genes are accepted.
This process results in a set of 17 predictors that have a gene presence frequency distribution approximately equal to 𝑔 ⁡ ( 𝑥 ) . The ksdensity function in MATLAB R2017b was used to estimate 𝑓 ⁡ ( 𝑥 ) and 𝑔 ⁡ ( 𝑥 ) using a bandwidth parameter value of 0.4 ( Figure S2 A). This rejection sampling approach was used to generate 1 × 1 0 3 different sets of 17 predictors for regressing against each of the SDM consumer-resource parameters { 𝑟 𝐴 , 𝛾 𝐴 , 𝑟 𝐼 , 𝛾 𝐼 } .
LASSO regressions were performed on each of the SDM consumer-resource parameters { 𝑟 𝐴 , 𝛾 𝐴 , 𝑟 𝐼 , 𝛾 𝐼 } using the rejection-sampled sets of gene predictors, where the optimal hyperparameter value 𝜆 = ̂ 𝜆 was selected via iterated 4-fold cross-validation ( 𝑀 = 1 0 3 iterations). Out-of-sample performance of each regression was also evaluated in cross-validation by computing ̅ 𝑅 2 𝐶 ⁢ 𝑉 , the median coefficient of determination value computed across cross-validation test sets. The distributions of these ̅ 𝑅 2 𝐶 ⁢ 𝑉 values across different sets of random genes are shown in ( Figure S2 B), alongside the values of ̅ 𝑅 2 𝐶 ⁢ 𝑉 obtained via the regressions onto denitrification-related genes. The denitrification genes performed better than the typical set of random genes in regressions on two out of four consumer-resource parameters ( 𝑟 𝐴 and 𝛾 𝐴 ), and as well as random genes for one parameter ( 𝛾 𝐼 ). On the whole, this analysis suggested that denitrification genes were better predictors than arbitrary genes, but it remains unclear why arbitrary genes tend have modest predictive power ( ̅ 𝑅 2 𝐶 ⁢ 𝑉 > 0 ) , and why the denitrification genes performed worse than the typical set of random genes for the 𝑟 𝐼 parameter. One possible explanation is that some random genes served as good predictors only because they resemble the denitrification genes in terms of presence and absence.
To investigate whether the predictive power of random genes arises because of correlations (in terms of presence and absence) with the denitrification genes, new sets of random gene predictors were constructed via rejection sampling as described above, but this time sampling only from the set of genes that have low or non-significant correlation with denitrification genes. Specifically, for each of the non-denitrification gene presence/absence vectors, the Pearson correlation ρ was computed with each of the denitrification gene presence/absence vectors. This identified the set of non-denitrification genes that have large correlations ( | 𝜌 | ≥ 0 . 5 ) with any of the denitrification genes that are significant at the 1% level, where significance was evaluated by generating a zero-correlation null distribution via a permutation test. The latter consideration is important for evaluating correlations between very high or very low-frequency genes, for which the probability of spurious large correlations can be high. These denitrification gene-correlates were excluded from sampling when generating the new sets of random gene predictors. As before, 1 × 1 0 3 different sets of 17 predictors for regressing against each of the consumer-resource parameters were generated.
LASSO regressions on each of the SDM consumer-resource parameters { 𝑟 𝐴 , 𝛾 𝐴 , 𝑟 𝐼 , 𝛾 𝐼 } were again performed using the rejection-sampled genes that exclude denitrification gene correlates. The distributions of the resulting ̅ 𝑅 2 𝐶 ⁢ 𝑉 values are shown in Figure S2 C. The following changes in these distributions relative to Figure S2 B were observed: (a) the median predictive power for all random gene regressions decreased substantially (i.e., ̅ 𝑅 2 𝐶 ⁢ 𝑉 decreased), indicating that indeed a substantial part of the predictive power of random genes arises due to large correlations with denitrification genes, and (b) denitrification genes now outperformed the typical set of random genes as predictors for even the 𝑟 𝐼 regression, demonstrating the superiority of denitrification genes as predictors for regressions on all consumer-resource parameters.
While the superior predictive power of the 17 denitrification genes was demonstrated in direct comparisons with sets of 17 randomly-selected genes, there may exist genes outside of the denitrification pathway with complementary predictive power when added to the denitrification genes. Therefore it was investigated whether adding additional randomly-selected genes to the denitrification genes further improves the predictive power of regressions on the consumer-resource parameters. To address this question, sets of predictor variables were generated by randomly sampling (without replacement) 𝑃 − 1 7 genes from the set of 13364 non-denitrification-related genes and constructing binary presence/absence matrices using the denitrification genes as the first 17 predictors and the randomly-selected genes as the subsequent 𝑃 − 1 7 predictors. P was varied between 32 and 2048 to investigate the dependence of prediction quality on the number of additional genes added. 10 sets of predictor variables were randomly generated for each value of P. Then LASSO regressions on each of the SDM consumer-resource parameters { 𝑟 𝐴 , 𝛾 𝐴 , 𝑟 𝐼 , 𝛾 𝐼 } were performed using these predictors. The distributions of ̅ 𝑅 2 𝐶 ⁢ 𝑉 as a function of P are shown in Figure S2 D. Adding additional predictors beyond the 17 denitrification genes did not substantially improve the predictive power of the models, regardless of how many additional predictors were added. This indicates that the 17 denitrification genes harbor the majority of gene presence/absence predictive power.
It was investigated whether either 16S rRNA copy number, genome size, or GC-content could serve as better predictor variables for the consumer-resource parameters { 𝑟 𝐴 , 𝛾 𝐴 , 𝑟 𝐼 , 𝛾 𝐼 } than denitrification genes. Previous work demonstrates a positive relationship between 16S copy number and maximum potential growth rate across diverse taxa in nutrient-replete conditions ( Roller et al., 2016 90. Roller, B.R.K. ∙ Stoddard, S.F. ∙ Schmidt, T.M. Exploiting rRNA operon copy number to investigate bacterial reproductive strategies Nat. Microbiol. 2016; 1 :16160 Crossref Scopus (154) PubMed Google Scholar ; Li et al., 2019 59. Li, J. ∙ Mau, R.L. ∙ Dijkstra, P. ... Predictive genomic traits for bacterial growth in culture versus actual growth in soil ISME J. 2019; 13 :2162-2172 Crossref Scopus (27) PubMed Google Scholar ), likely because increased ribosome production allows a higher rate of protein synthesis, thereby increasing growth rate ( Scott et al., 2010 97. Scott, M. ∙ Gunderson, C.W. ∙ Mateescu, E.M. ... Interdependence of cell growth and gene expression: origins and consequences Science. 2010; 330 :1099-1102 Crossref Scopus (698) PubMed Google Scholar ). A negative relationship between growth rate and genome size has also been observed ( Li et al., 2019 59. Li, J. ∙ Mau, R.L. ∙ Dijkstra, P. ... Predictive genomic traits for bacterial growth in culture versus actual growth in soil ISME J. 2019; 13 :2162-2172 Crossref Scopus (27) PubMed Google Scholar ), possibly due to a reduced nutrient burden required by smaller genomes ( Hessen et al., 2010 41. Hessen, D.O. ∙ Jeyasingh, P.D. ∙ Neiman, M. ... Genome streamlining and the elemental costs of growth Trends Ecol. Evol. 2010; 25 :75-80 Full Text Full Text (PDF) Scopus (90) PubMed Google Scholar ). GC-content has been investigated as a genomic predictor for various bacterial phenotypes such as optimal growth temperature ( Galtier and Lobry, 1997 27. Galtier, N. ∙ Lobry, J.R. Relationships between genomic G+C content, RNA secondary structures, and optimal growth temperature in prokaryotes J. Mol. Evol. 1997; 44 :632-636 Crossref Scopus (0) PubMed Google Scholar ), and can serve as a baseline for spurious phylogenetic correlations because it is a slowly-evolving genomic property ( Haywood- Farmer and Otto, 2003 39. Haywood-Farmer, E. ∙ Otto, S.P. The evolution of genomic base composition in bacteria Evolution. 2003; 57 :1783-1792 Crossref Scopus (20) PubMed Google Scholar ).
16S copy number was estimated for all 79 strains in the library using the 16Stimator pipeline ( Perisin et al., 2016 85. Perisin, M. ∙ Vetter, M. ∙ Gilbert, J.A. ... 16Stimator: statistical estimation of ribosomal gene copy numbers from draft genome assemblies ISME J. 2016; 10 :1020-1024 Crossref Scopus (4) PubMed Google Scholar ). This approach uses Illumina sequencing reads and annotated draft assemblies to compute the coverage ratio of the 16S gene relative to a curated set of single-copy genes. The genome size was estimated for all strains in the library by summing the lengths of all assembled contigs for each strain. Genomic GC-content was computed from draft assemblies using QUAST 5.02 ( Gurevich et al., 2013 34. Gurevich, A. ∙ Saveliev, V. ∙ Vyahhi, N. ... QUAST: quality assessment tool for genome assemblies Bioinformatics. 2013; 29 :1072-1075 Crossref Scopus (2977) PubMed Google Scholar ). For the reference strain Paracoccus denitrificans ATCC 19367, a complete genome assembly ( Si et al., 2019 101. Si, Y.-Y. ∙ Xu, K.-H. ∙ Yu, X.-Y. ... Complete genome sequence of Paracoccus denitrificans ATCC 19367 and its denitrification characteristics Can. J. Microbiol. 2019; 65 :486-495 Crossref Scopus (2) PubMed Google Scholar ) showed 3 copies of the 16S gene, a genome size of 5.24 mb, and a GC-content of 66.80%, and 3.36 16S copies; a genome size of 5.15 mb, and a GC-content of 66.81% were estimated using the draft assembly.
First the relationships between 16S copy number, genome size, GC-content, and the SDM consumer-resource parameters { 𝑟 𝐴 , 𝛾 𝐴 , 𝑟 𝐼 , 𝛾 𝐼 } were considered. No significant (permutation test) correlations were observed between 16S copy number and the consumer-resource parameters, significant positive correlations were observed between genome size and 𝛾 𝐴 ( 𝜌 = 0 . 4 0 , 𝑝 < 1 × 1 0 − 4 ) and 𝛾 𝐼 ( 𝜌 = 0 . 6 3 , 𝑝 < 1 × 1 0 − 4 ), and significant but weak positive correlations were observed between GC-content and 𝛾 𝐴 ( 𝜌 = 0 . 2 4 , 𝑝 = 0 . 0 2 ) and 𝑟 𝐼 ( 𝜌 = 0 . 2 3 , 𝑝 = 0 . 0 4 ). These data suggest that genome size may be a good predictor for the yields 𝛾 𝐴 and 𝛾 𝐼 .
In order to compare consumer-resource parameter measurements to previous findings relating growth rate to 16S copy number and genome size, growth rates on nitrate and nitrite were computed for each strain. Equation 3 can be recast in terms of growth rates 𝜇 ∗ (1/h) by setting 𝑟 ∗ = 𝜇 ∗ / 𝛾 ∗ : 𝑑 ⁢ 𝑥 𝑑 ⁢ 𝑡 = ( 𝜇 𝐴 ⁢ 𝐴 𝐾 𝐴 + 𝐴 + 𝜇 𝐼 ⁢ 𝐼 𝐾 𝐼 + 𝐼 ) ⁢ 𝑥 , 𝑑 ⁢ 𝐴 𝑑 ⁢ 𝑡 = − 𝜇 𝐴 𝛾 𝐴 ⁢ 𝐴 𝐾 𝐴 + 𝐴 ⁢ 𝑥 , 𝑑 ⁢ 𝐼 𝑑 ⁢ 𝑡 = ( 𝜇 𝐴 𝛾 𝐴 ⁢ 𝐴 𝐾 𝐴 + 𝐴 − 𝜇 𝐼 𝛾 𝐼 ⁢ 𝐼 𝐾 𝐼 + 𝐼 ) ⁢ 𝑥 . (Equation 9)
In this form the 𝜇 ∗ represent the exponential growth rates when substrates are not limiting (e.g., when 𝐴 ≫ 𝐾 𝐴 or 𝐼 ≫ 𝐾 𝐼 ). Therefore 𝜇 ∗ = 𝑟 ∗ ⁢ 𝛾 ∗ were computed using the SDM consumer-resource parameters.
No significant positive correlations were observed between either of the growth rates with 16S copy number. This differs from what has been previously observed under aerobic, nutrient-replete conditions ( Roller et al., 2016 90. Roller, B.R.K. ∙ Stoddard, S.F. ∙ Schmidt, T.M. Exploiting rRNA operon copy number to investigate bacterial reproductive strategies Nat. Microbiol. 2016; 1 :16160 Crossref Scopus (154) PubMed Google Scholar ; Li et al., 2019 59. Li, J. ∙ Mau, R.L. ∙ Dijkstra, P. ... Predictive genomic traits for bacterial growth in culture versus actual growth in soil ISME J. 2019; 13 :2162-2172 Crossref Scopus (27) PubMed Google Scholar ), where ribosomal production is likely to be growth limiting. This may be because these previous studies were based on maximum potential growth rates (measured across a variety of medium and culturing conditions), whereas maximum potential growth rates were not systematically identified for strains in the library. Moreover it is likely that most of the measured growth rates in denitrifying conditions with a succinate defined medium are much smaller than maximum potential growth rates, because denitrification is generally a significantly lower ATP-yielding process than aerobic respiration ( Strohm et al., 2007 105. Strohm, T.O. ∙ Griffin, B. ∙ Zumft, W.G. ... Growth yields in bacterial denitrification and nitrate ammonification Appl. Environ. Microbiol. 2007; 73 :1420-1424 Crossref Scopus (174) PubMed Google Scholar ), and also because succinate defined medium likely imposes more stringent biosynthesis demands than a complex, rich medium ( Scott et al., 2010 97. Scott, M. ∙ Gunderson, C.W. ∙ Mateescu, E.M. ... Interdependence of cell growth and gene expression: origins and consequences Science. 2010; 330 :1099-1102 Crossref Scopus (698) PubMed Google Scholar ). Therefore the relative benefit of high gene copy number of rRNA for many strains under denitrifying growth conditions may be small. However significant (permutation test) positive correlations were observed between genome size and 𝜇 𝐴 ( 𝜌 = 0 . 2 1 , 𝑝 = 0 . 0 4 ), and 𝜇 𝐼 ( 𝜌 = 0 . 6 3 0.52, 𝑝 < 1 × 1 0 − 4 ). This finding also differs the previous observation of a negative relationship between genome size and growth rate ( Li et al., 2019 59. Li, J. ∙ Mau, R.L. ∙ Dijkstra, P. ... Predictive genomic traits for bacterial growth in culture versus actual growth in soil ISME J. 2019; 13 :2162-2172 Crossref Scopus (27) PubMed Google Scholar ).
Finally, the potential of 16S copy number, genome size, and GC-content as predictor variables was evaluated in a head-to-head comparison with denitrification genes by using all these predictors simultaneously in LASSO regressions on the SDM consumer-resource parameters { 𝑟 𝐴 , 𝛾 𝐴 , 𝑟 𝐼 , 𝛾 𝐼 } (4-fold cross-validation, iterated 1 × 1 0 4 times). As before, all predictors were standardized to have zero mean and unit variance before fitting. The following was observed: (a) 16S copy number, genome size, and GC-content were not assigned large coefficients in any regression, (b) the statistics of fitting and generalization quality ( 𝑅 2 𝑓 ⁢ 𝑖 ⁢ 𝑡 and ̅ 𝑅 2 𝐶 ⁢ 𝑉 ) were essentially the same as those obtained in the original regressions, and (c) the coefficients for denitrification genes were very similar to those obtained in the original regressions. It was concluded that the denitrification genes hold greater predictive power than 16S copy number, genome size, and GC-content, since the latter predictors are not selected as important variables by LASSO regression.
Regressions for the consumer-resource parameters measured in ADM were performed as for those parameters measured in SDM. The median values of 𝑅 2 obtained via iterated 4-fold cross-validation ( 𝑀 = 1 0 4 iterations) ( ̅ 𝑅 2 𝐶 ⁢ 𝑉 ) were positive for all regressions. The p -values of ̅ 𝑅 2 𝐶 ⁢ 𝑉 (permutation test) were all < 0 . 0 1 .
The consumer-resource model ( Equation 3 ) was extended to generate predictions for community (i.e., multi-strain) metabolite dynamics. For an N -strain community, the extended model is as follows: 𝑑 ⁢ 𝑥 𝑖 𝑑 ⁢ 𝑡 = ( 𝛾 𝐴 ⁢ 𝑟 𝑖 𝐴 ⁢ 𝐴 𝐾 𝐴 + 𝐴 + 𝛾 𝑖 𝐼 ⁢ 𝑟 𝑖 𝐼 ⁢ 𝐼 𝐾 𝐼 + 𝐼 ) ⁢ 𝑥 𝑖 , f o r 𝑖 = 1 , … , 𝑁 𝑑 ⁢ 𝐴 𝑑 ⁢ 𝑡 = − ∑ 𝑖 = 1 𝑁 𝑟 𝑖 𝐴 ⁢ 𝐴 𝐾 𝐴 + 𝐴 ⁢ 𝑥 𝑖 , 𝑑 ⁢ 𝐼 𝑑 ⁢ 𝑡 = ∑ 𝑁 𝑖 = 1 ( 𝑟 𝑖 𝐴 ⁢ 𝐴 𝐾 𝐴 + 𝐴 − 𝑟 𝑖 𝐼 ⁢ 𝐼 𝐾 𝐼 + 𝐼 ) ⁢ 𝑥 𝑖 . (Equation 10)
For each strain i , which has biomass density 𝑥 𝑖 , the parameters { 𝑟 𝑖 𝐴 , 𝛾 𝑖 𝐴 , 𝑟 𝑖 𝐼 , 𝛾 𝑖 𝐼 } were measured in monoculture. Note that, as before, 𝐾 𝐴 = 𝐾 𝐼 = 0.01 mM for all strains. This “additive” model sums the independent rate contributions of each strain to the nitrate and nitrite differential equations, in effect assuming that strains only interact via cross-feeding and competition for extracellular nitrate and nitrite. The model does not assume that strains interact through Lotka-Volterra-type (quadratic) terms in the biomass density equations, nor does it assume that the parameters { 𝑟 𝑖 𝐴 , 𝛾 𝑖 𝐴 , 𝑟 𝑖 𝐼 , 𝛾 𝑖 𝐼 } , measured in monoculture, are modulated by the presence of any other strain. Thus Equation 10 represents a null model for community metabolite dynamics where each strain in a community behaves as it does in monoculture, and as a result provides a prediction requiring no additional free parameters.
Simple communities were assembled and cultured to test the predictions of Equation 10 , drawing from a representative 12-strain subset of the 79-strain library: Nar/Nir strains Achromobacter sp. ACM01, Ensifer sp. ENS09, Paracoccus denitrificans , Pseudomonas sp. PDM21; Nar strains Acidovorax sp. ACV02, Paracoccus sp. PAR01, Pseudomonas sp. PDM12, Pantoea sp. PNT03; Nir strains Agrobacterium sp. AGB01, Pseudomonas sp. PDM13, Pseudomonas sp. PDM14, and Pseudoxanthomonas sp. PXM03. Nitrate/nitrite dynamics and endpoint optical density were measured for (a) all 66 2-strain combinations, (b) a random set of 81 three-strain combinations, (c) 21 four-strain combinations, (d) 6 five-strain combinations, and (e) controls of each strain in monoculture. 6 of the four-strain combinations were chosen randomly from the set of 12 strains, while the remaining 15 four-strain combinations and all five-strain combinations were exhaustive combinations of the six strains ACM01, ENS09, PAR01, PNT03, AGB01, and PDM13. All communities/controls were cultured in SDM in each of two media conditions, 2 mM nitrate and 2 mM nitrite, with 2–3 experimental replicates per condition. Initial biomass densities were OD600 0 = 0.01 for each strain in a given community.
First endpoint biomass densities were compared with the values predicted by the additive model, Equation 10 . Since the optical density measurement cannot discern between strains in a mixed population, a model prediction for total endpoint biomass density was computed by summing the endpoint biomass densities of each strain. Endpoint biomass densities were well-predicted by Equation 10 ( Figure S4 A). This gives one indication that the additive consumer-resource model in Equation 10 accurately predicts community behavior using only information from monocultures.
The ability of the additive model to predict relative abundances for a subset of pair cultures was evaluated. All pair combinations and monocultures of six taxonomically and phenotypically representative strains (Nar/Nir strains Achromobacter sp. ACM01 and Ensifer sp. ENS09; Nar strains Paracoccus sp. PAR01 and Pantoea sp. PNT03; Nir strains Agrobacterium sp. AGB01 and Pseudomonas sp. PDM13) were cultured and periodically sampled. All cultures were initiated with 2 mM N ⁢ O − 3 , with the exception of monocultures of Nir strains AGB01 and PDM13 and the pair culture of these two strains, which were initiated with 2 mM N ⁢ O − 2 . Then the relative abundance of 16S rRNA amplicons in the pair cultures was measured using CASEU ( Cermak et al., 2020 12. Cermak, N. ∙ Datta, M.S. ∙ Conwill, A. Rapid, inexpensive measurement of synthetic bacterial community composition by Sanger sequencing of amplicon mixtures iScience. 2020; 23 :100915 Full Text Full Text (PDF) Scopus (0) PubMed Google Scholar ). In order to enable a comparison with the predictions of the model, Equation 10 , which makes predictions in terms of biomass density (in units of OD), conversion constants were measured to transform 16S amplicon relative abundances to OD600 relative abundances. Doing so is necessary because (a) strains generally differ in 16S rRNA gene copy number per cell (ranging from 4–7 copies per cell for these strains), and (b) strains will have generally different conversion factors from OD600 to cells/mL, arising for instance due to differences in cell size. Therefore, the ratios of 16S amplicon abundances will be related to the ratio of biomass densities by the equation: 𝑎 𝑖 𝑎 𝑗 = 𝑏 𝑖 ⁢ 𝑐 𝑖 ⁢ 𝑥 𝑖 𝑏 𝑗 ⁢ 𝑐 𝑗 ⁢ 𝑥 𝑗 = 𝐾 𝑖 , 𝑗 ⁢ 𝑥 𝑖 𝑥 𝑗 , (Equation 11) where for strain i , 𝑎 𝑖 is the 16S amplicon relative abundance, 𝑥 𝑖 the biomass density relative abundance, and 𝑏 𝑖 and 𝑐 𝑖 are respectively the 16S rRNA gene copy number (16S rRNA copies/cell) and cell density to OD600 conversion factor (cells/mL/OD). This means that the ratio of 16S amplicon abundances for strains i and j will be related to the ratio of OD600 abundances by the conversion factor 𝐾 𝑖 , 𝑗 . Therefore 𝐾 𝑖 , 𝑗 was directly measured for each pair of strains by growing monocultures of each strain in denitrifying conditions, harvesting cells after 64 h, measuring OD600, combining monocultures in equal-volume (450 μL) mixtures, and then processing, sequencing, and analyzing mixtures. Relative amplicon abundances of these mixtures along with OD600 measurements of the constituent monocultures were used to solve Equation 11 for the parameters 𝐾 𝑖 , 𝑗 for each pair. Then these conversion factors were used to transform the 16S amplicon relative abundances for pair cultures to OD600 relative abundances. These measurements were compared with the OD600 relative abundance predictions of Equation 10 ( Figure S4 B). In general, the model predictions for strain relative abundances closely matched the observed values, indicating that the model accurately predicts community compositions in the majority of cases using only information from monocultures. There were a small number of pair cultures with modest differences between predicted and observed relative abundances, mainly involving combinations of the Nar strains PAR01 and PNT03 and the Nir strains AGB01 and PDM13. These lower quality predictions may reflect interactions between these phenotypes not captured in the model ( Equation 10 ).
Finally the ability of additive model to predict community nitrate and nitrite dynamics from individual strain consumer-resource parameters was evaluated. To do this, a normalized root-mean-square error (NRMSE) was computed for a given N -strain community as: N R M S E 1 , … , 𝑁 = R M S E 1 , … , 𝑁 ( 1 𝑁 ⁢ ∑ 𝑁 𝑖 = 1 R M S E 2 𝑖 ) 1 / 2 , (Equation 12) where R ⁢ M ⁢ S ⁢ E 1 , … , 𝑁 is the root-mean-square error between measurements and predictions for the community, and RMSE i is the error for each constituent strain in monoculture, with errors averaged over experimental replicates. The monoculture RMSEs of each strain were used in this normalization in order to correct for variations in monoculture fit quality. NRMSE in the range 0–2 indicates errors in 2-strain communities that are within twofold of fits associated with their constituent monocultures, while values of NRMSE much greater than this indicate low quality predictions. It should be noted that, because the denominator of Equation 12 depends on the RMSE of the constituent monocultures in a community, a potential pathology is that NRMSEs can be modestly inflated when the RMSEs for constituent monocultures are all small (indicating a strong correspondence between the data and the model). However, this pathology is expected to be rare because it requires all monoculture RMSEs to be small.
The NRMSEs for all pairs of 12 strains cultured in separate nitrate and nitrite medium conditions are shown in Figures S3 A and S3B. For most pair communities, typically low values of NRMSE indicated that Equation 10 made high quality predictions in most cases. The apparent exception to this was Nar + Nir communities (comprising any combination of Nar strain and Nir strain) initialized with nitrate ( Figure S6 ), for which NRMSE values appeared much higher than for any other group. Permutation tests were then performed on the mean NRMSE values within phenotypic groups to determine whether the Nar + Nir group had significantly higher NRMSE than other groups ( 1 × 1 0 5 permutations). Since 10 hypothesis tests were performed in this manner, a Bonferroni-corrected threshold of 𝑝 = 0 . 0 5 / 1 0 = 0 . 0 0 5 was used for testing at the 5% significance level. These tests indicated that only the Nar + Nir group in nitrate medium conditions had a significantly large mean NRMSE value ( 𝑝 < 1 × 1 0 − 5 ) .
The NRMSEs for 108 3–5-strain communities cultured in separate nitrate and nitrite medium conditions are shown in Figure S3 E. As with pair cultures, many 3–5-strain communities communities have low values of NRMSE indicating that Equation 10 made high quality predictions of nitrate and nitrite dynamics. Also, most apparent failures of the model predictions occurred when a community contains both a Nar strain and a Nir strain.
Up to this point, to test the ability of the consumer-resource model to predict community metabolic dynamics, directly measured values of the consumer-resource parameters were used to make community predictions. Using regressions instead to make predictions of single-strain phenotypes from gene presence/absence would be expected to add some degree of error to community metabolite dynamics predictions. To quantify this additional error, regressions on each of the SDM consumer-resource parameters ( Figures 4 C–4F) were used to predict these parameters for the each of the 12 strains, and then these parameters were used to predict community dynamics in the pair cultures and 3–5-strain communities. The NRMSEs evaluating the accuracy of these predictions relative to observed community metabolite dynamics are shown in Figure S5 . For pair cultures ( Figures S5 A and S5B), NRMSEs changed little relative to using the directly measured parameters to make predictions; the median difference between NRMSEs using regression predicted parameters versus measured parameters for pair cultures in nitrate was -0.1, and for pair cultures in nitrite the median difference was approximately zero. NRMSEs increased modestly for 3–5-strain communities ( Figure S5 C); the median difference was 0.5 for communities in nitrate, and 1.4 for communities in nitrite.
The additive N -strain consumer-resource model, Equation 10 , generally failed to predict the dynamics of communities initialized with nitrate that included both a Nar and a Nir strain (see plots of all Nar + Nir pairs in Figure S6 ). In every instance, the nitrate reduction rate of the Nar strain appears to be diminished relative to the rate in monoculture, and in some instances the nitrite reduction rate for the Nir strain appears to be increased relative to monoculture. Since Nar and Nir strains utilize different electron acceptors and therefore do not plausibly compete for any resource under these experimental conditions, it was concluded that interactions aside from resource competition must be taking place.
It was therefore investigated whether the predictions of the additive model in Equation 10 could be improved by correcting for interactions between Nar and Nir strains. To do this, the nitrate and nitrite reduction parameters 𝑟 𝑖 𝐴 and 𝑟 𝑗 𝐼 of the Nar strain i and the Nir strain j , respectively, were refit using the measured metabolite dynamics data from the pair cultures of these strains. Changes to the reduction rate parameters rather than the yields ( 𝛾 𝑖 𝐴 and 𝛾 𝑗 𝐼 ) were investigated because the additive model accurately predicted endpoint optical densities in all pair communities ( Figure S4 A), and therefore there was no evidence that interactions between Nar and Nir strains involved a change in yields. However, given the hypothesis that Nir strains inhibit Nar strains via excretion of cytotoxic nitric oxide (see discussion ), it is plausible that interactions may involve a change in yields that are not detectable given the precision of the optical density measurement.
Nitrate and nitrite reduction rate parameters for each Nar + Nir pair culture were refit in the following way: 1. Refit 𝑟 𝑖 𝐴 for the Nar strain i , holding all other parameters fixed. Record the NRMSE for the resulting prediction. 2. Refit both 𝑟 𝑖 𝐴 for the Nar strain i and 𝑟 𝑗 𝐼 for the Nir strain j , holding all other parameters fixed. Record the NRMSE for the resulting prediction. 3. If the NRMSE obtained in step 2 was more than 10% smaller than the NRMSE in step 1, then accept the refit parameters obtained in step 2, denoting these values as ̃ 𝑟 𝑖 , 𝑗 𝐴 and ̃ 𝑟 𝑗 , 𝑖 𝐼 . Otherwise, accepted the refit parameter obtained in step 1 as ̃ 𝑟 𝑖 , 𝑗 𝐴 , and let ̃ 𝑟 𝑗 , 𝑖 𝐼 = 𝑟 𝑗 𝐼 .
Refitting was performed as described above for Equation 3 . In step 3, improvements in fit quality obtained by refitting only 𝑟 𝐴 versus refitting both 𝑟 𝐴 and 𝑟 𝐼 were compared in order to identify cases where increases in nitrite reduction rate were necessary to improve fits of Equation 10 to the data.
The results of this refitting procedure are shown in Figure S7 . These results demonstrate that, in all cases, the nitrate reduction rate of the Nar strain was slowed ( ̃ 𝑟 𝐴 < 𝑟 𝐴 ) in Nar + Nir pair culture. Additionally, in several cases the nitrite reduction rate of the Nir strain was increased ( ̃ 𝑟 𝐼 > 𝑟 𝐼 ) in Nar + Nir pair culture. Each Nar strain is affected in essentially the same way by every Nir strain (e.g., the nitrate reduction rate of Nar strain PAR01 diminished by approximately 50% in every pair culture with a Nir strain). This observation is consistent with the proposal that nitric oxide toxicity impacted nitrate reduction by the Nar-strain in a manner that is specific to each Nar strain (see discussion ).
These refit parameter values were then used in Equation 10 to generate new predictions for 3–5-strain communities containing at least one Nar + Nir pair. To do so, the following rules were employed for replacing 𝑟 𝐴 and 𝑟 𝐼 in Equation 10 , which depend on the number of Nar and Nir strains in the community: 1. One Nar strain i and one Nir strain j : 𝑟 𝑖 𝐴 = ̃ 𝑟 𝑖 , 𝑗 𝐴 , 𝑟 𝑗 𝐼 = ̃ 𝑟 𝑗 , 𝑖 𝐼 . 2. Two Nar strains i and j and one Nir strain k : 𝑟 𝑖 𝐴 = ̃ 𝑟 𝑖 , 𝑘 𝐴 , 𝑟 𝑗 𝐴 = ̃ 𝑟 𝑗 , 𝑘 𝐴 , 𝑟 𝑘 𝐼 = ( ̃ 𝑟 𝑘 , 𝑖 𝐼 + ̃ 𝑟 𝑘 , 𝑗 𝐼 ) / 2 . 3. One Nar strain i and two Nir strains j and k : 𝑟 𝑖 𝐴 = ( ̃ 𝑟 𝑖 , 𝑗 𝐴 + ̃ 𝑟 𝑖 , 𝑘 𝐴 ) / 2 , 𝑟 𝑗 𝐼 = ̃ 𝑟 𝑗 , 𝑖 𝐼 , 𝑟 𝑘 𝐼 = ̃ 𝑟 𝑘 , 𝑖 𝐼 . 4. General case with N Nar strains in the set 𝒮 𝑁 ⁢ 𝑎 ⁢ 𝑟 and M Nir strains in the set 𝒮 𝑁 ⁢ 𝑖 ⁢ 𝑟 :
𝑟 𝑖 𝐴 = 1 / 𝑀 ⁢ ∑ 𝑗 ∈ 𝒮 𝑁 ⁢ 𝑖 ⁢ 𝑟 ̃ 𝑟 𝑖 , 𝑗 𝐴 for all 𝑖 ∈ 𝒮 𝑁 ⁢ 𝑎 ⁢ 𝑟 and 𝑟 𝑗 𝐼 = 1 / 𝑁 ⁢ ∑ 𝑖 ∈ 𝒮 𝑁 ⁢ 𝑎 ⁢ 𝑟 ̃ 𝑟 𝑗 , 𝑖 𝐼 for all 𝑗 ∈ 𝒮 𝑁 ⁢ 𝑖 ⁢ 𝑟 .
The results of using refit Nar and Nir parameters to predict 3–5-strain cultures are shown in Figure 7 B (yellow points). Correcting predictions using refit 𝑟 𝐴 and 𝑟 𝐼 parameters substantially improved prediction quality, reducing median NRMSE values from 1.68 to 0.92. These results did not appreciably change if a min or max function is used instead of a mean.

Section: Acknowledgements

We thank Laura Troyer for assistance with isolating bacterial strains and Elizabeth Ujhelyi and Annette Wells for assistance with sequencing. We acknowledge Cameron Pittelkow for access to corn and soybean fields in Savoy, Illinois, and the laboratory of Julie Zilles for providing the bacterial strain Paracoccus denitrificans ATCC 19367. We also thank Rama Ranganathan, David Pincus, James Sethna, William Metcalf, Jun Song, Sara Clifton, and members of the Kuehn laboratory and Mani group for helpful discussions. This work was supported by the National Science Foundation Division of Emerging Frontiers EF 2025293 (S.K.) and EF 2025521 (M.M.), the National Science Foundation Physics Frontiers Center Program PHY 0822613 and PHY 1430124 (S.K.), James S. McDonnell Foundation Postdoctoral Fellowship Award 220020499 (K.G.), and the Simons Foundation Investigator Award 597491 (M.M.).
