Title: Behavior- and Modality-General Representation of Confidence in Orbitofrontal Cortex


Abstract: Summary

Every decision we make is accompanied by a sense of confidence about its likely outcome. This sense informs subsequent behavior, such as investing more—whether time, effort, or money—when reward is more certain. A neural representation of confidence should originate from a statistical computation and predict confidence-guided behavior. An additional requirement for confidence representations to support metacognition is abstraction: they should emerge irrespective of the source of information and inform multiple confidence-guided behaviors. It is unknown whether neural confidence signals meet these criteria. Here, we show that single orbitofrontal cortex neurons in rats encode statistical decision confidence irrespective of the sensory modality, olfactory or auditory, used to make a choice. The activity of these neurons also predicts two confidence-guided behaviors: trial-by-trial time investment and cross-trial choice strategy updating. Orbitofrontal cortex thus represents decision confidence consistent with a metacognitive process that is useful for mediating confidence-guided economic decisions.

Section: Introduction

In the face of uncertainty, any organism that can perform statistical computations gains an adaptive advantage. An elementary statistical computation is confidence, estimating the probability that a chosen option is correct. An accurate estimate of confidence can confer benefits for a broad range of behaviors, from the essential to the mundane to the sophisticated: deciding between fight and flight, choosing which drink to order, or managing a stock portfolio. As humans, we assess our confidence in our percepts, memories, and decisions all the time, as part of a self-monitoring, reflective process termed metacognition, which is deeply personal and subjective ( Dunlosky and Metcalfe, 2009 16. Dunlosky, J. ∙ Metcalfe, J. Metacognition Sage Publications, 2009 Google Scholar ). Consequently, confidence judgments have been studied as a central aspect of metacognition, and thought to require neural architectures unique to higher primates ( Dehaene et al., 2017; Metcalfe and Son, 2013 14. Dehaene, S. ∙ Lau, H. ∙ Kouider, S. What is consciousness, and could machines have it? Science. 2017; 358 :486-492 Crossref Scopus (371) PubMed Google Scholar 50. Metcalfe, J. ∙ Son, L.K. Anoetic, noetic, and autonoetic metacognition Beran, M.J. ∙ Brandl, J.L. ∙ Perner, J. ... (Editors) Foundations of Metacognition Oxford University Press, 2013 Crossref Google Scholar ). Even though many organisms leverage probabilistic computations to guide behavior ( Fetsch et al., 2013; Knill and Pouget, 2004; Körding and Wolpert, 2004; Pouget et al., 2003; Wystrach et al., 2015 18. Fetsch, C.R. ∙ DeAngelis, G.C. ∙ Angelaki, D.E. Bridging the gap between theories of sensory cue integration and the physiology of multisensory neurons Nat. Rev. Neurosci. 2013; 14 :429-442 Crossref Scopus (223) PubMed Google Scholar 37. Knill, D.C. ∙ Pouget, A. The Bayesian brain: the role of uncertainty in neural coding and computation Trends Neurosci. 2004; 27 :712-719 Full Text Full Text (PDF) Scopus (1621) PubMed Google Scholar 41. Körding, K.P. ∙ Wolpert, D.M. Bayesian integration in sensorimotor learning Nature. 2004; 427 :244-247 Crossref Scopus (1367) PubMed Google Scholar 65. Pouget, A. ∙ Dayan, P. ∙ Zemel, R.S. Inference and computation with population codes Annu. Rev. Neurosci. 2003; 26 :381-410 Crossref Scopus (350) PubMed Google Scholar 93. Wystrach, A. ∙ Mangan, M. ∙ Webb, B. Optimal cue integration in ants Proc. Biol. Sci. 2015; 282 :20151484 Crossref Scopus (94) PubMed Google Scholar ), it remains unknown what neural architectures support these ( Meyniel et al., 2015a 51. Meyniel, F. ∙ Sigman, M. ∙ Mainen, Z.F. Confidence as Bayesian Probability: From Neural Origins to Behavior Neuron. 2015; 88 :78-92 Full Text Full Text (PDF) Scopus (178) PubMed Google Scholar ; Ott et al., 2018 60. Ott, T. ∙ Masset, P. ∙ Kepecs, A. The Neurobiology of Confidence: From Beliefs to Neurons Cold Spring Harb. Symp. Quant. Biol. 2018; 83 :9-16 Crossref Scopus (11) PubMed Google Scholar ; Pouget et al., 2016 66. Pouget, A. ∙ Drugowitsch, J. ∙ Kepecs, A. Confidence and certainty: distinct probabilistic quantities for different goals Nat. Neurosci. 2016; 19 :366-374 Crossref Scopus (295) PubMed Google Scholar ).
What are the required properties for a neural representation of confidence? First, neural activity should reflect a confidence computation; i.e., reflect the statistical likelihood that a proposition is correct, P(choice = correct | subjective evidence, choice) (“statistical decision confidence,” the type of confidence studied here, henceforth “confidence”) ( Kepecs et al., 2008; Pouget et al., 2016 34. Kepecs, A. ∙ Uchida, N. ∙ Zariwala, H.A. ... Neural correlates, computation and behavioural impact of decision confidence Nature. 2008; 455 :227-231 Crossref Scopus (586) PubMed Google Scholar 66. Pouget, A. ∙ Drugowitsch, J. ∙ Kepecs, A. Confidence and certainty: distinct probabilistic quantities for different goals Nat. Neurosci. 2016; 19 :366-374 Crossref Scopus (295) PubMed Google Scholar ). Second, neural activity should be correlated with decisions based on confidence; i.e., predict confidence-guided behavior. These two criteria follow from computational considerations, but psychological theories of metacognition provide additional desiderata. A prerequisite for metacognition is an abstract and centralized confidence representation: Abstract confidence representations should generalize both across the source of information used for probability computations and across different types of confidence-guided behaviors.
Previous studies in human and non-human animals have identified representations of confidence that fulfill a subset of these criteria ( Fleming and Dolan, 2012; Hanks and Summerfield, 2017 21. Fleming, S.M. ∙ Dolan, R.J. The neural basis of metacognitive ability Philos. Trans. R. Soc. Lond. B Biol. Sci. 2012; 367 :1338-1349 Crossref Scopus (448) PubMed Google Scholar 30. Hanks, T.D. ∙ Summerfield, C. Perceptual Decision Making in Rodents, Monkeys, and Humans Neuron. 2017; 93 :15-31 Full Text Full Text (PDF) Scopus (189) PubMed Google Scholar ; Ott et al., 2018 60. Ott, T. ∙ Masset, P. ∙ Kepecs, A. The Neurobiology of Confidence: From Beliefs to Neurons Cold Spring Harb. Symp. Quant. Biol. 2018; 83 :9-16 Crossref Scopus (11) PubMed Google Scholar ; Shadlen and Kiani, 2013 80. Shadlen, M.N. ∙ Kiani, R. Decision making as a window on cognition Neuron. 2013; 80 :791-806 Full Text Full Text (PDF) Scopus (346) PubMed Google Scholar ). In animals asked to report their degree of confidence by opting out of a difficult task or placing a bet on their decision, neurons in frontal ( Kepecs et al., 2008; Middlebrooks and Sommer, 2012 34. Kepecs, A. ∙ Uchida, N. ∙ Zariwala, H.A. ... Neural correlates, computation and behavioural impact of decision confidence Nature. 2008; 455 :227-231 Crossref Scopus (586) PubMed Google Scholar 53. Middlebrooks, P.G. ∙ Sommer, M.A. Neuronal correlates of metacognition in primate frontal cortex Neuron. 2012; 75 :517-530 Full Text Full Text (PDF) Scopus (95) PubMed Google Scholar ) and parietal cortex ( Kiani and Shadlen, 2009 35. Kiani, R. ∙ Shadlen, M.N. Representation of confidence associated with a decision by neurons in the parietal cortex Science. 2009; 324 :759-764 Crossref Scopus (678) PubMed Google Scholar ), as well as the pulvinar ( Komura et al., 2013 39. Komura, Y. ∙ Nikkuni, A. ∙ Hirashima, N. ... Responses of pulvinar neurons reflect a subject’s confidence in visual categorization Nat. Neurosci. 2013; 16 :749-755 Crossref Scopus (140) PubMed Google Scholar ) and superior colliculus ( Basso and Wurtz, 1997; Grimaldi et al., 2018 4. Basso, M.A. ∙ Wurtz, R.H. Modulation of neuronal activity by target uncertainty Nature. 1997; 389 :66-69 Crossref Scopus (291) PubMed Google Scholar 28. Grimaldi, P. ∙ Cho, S.H. ∙ Lau, H. ... Superior colliculus signals decisions rather than confidence: analysis of single neurons J. Neurophysiol. 2018; 120 :2614-2629 Crossref Scopus (10) PubMed Google Scholar ), signal the uncertainty in perceptual decisions. In humans, single neurons in the parietal and temporal lobes represent the accuracy of memory recalls ( Rutishauser et al., 2015, 2018 73. Rutishauser, U. ∙ Ye, S. ∙ Koroma, M. ... Representation of retrieval confidence by single neurons in the human medial temporal lobe Nat. Neurosci. 2015; 18 :1041-1050 Crossref Scopus (96) PubMed Google Scholar 74. Rutishauser, U. ∙ Aflalo, T. ∙ Rosario, E.R. ... Single-Neuron Representation of Memory Strength and Recognition Confidence in Left Human Posterior Parietal Cortex Neuron. 2018; 97 :209-220.e3 Full Text Full Text (PDF) Scopus (60) PubMed Google Scholar ). Although these reports demonstrate that single neurons encode probability estimates about choice correctness, they probed confidence estimates with a single source of uncertain evidence (i.e., one sensory modality or one type of memory recall) and a single confidence-guided behavior (e.g., saccade-based opt-out). Therefore, these studies do not establish whether these neural representations have the properties of abstract confidence.
Here, we set out to test whether single neurons in orbitofrontal cortex (OFC) represent abstract decision confidence by addressing the four key properties for abstract confidence representations: (1) statistical computation of probability of being correct, (2) prediction of confidence-guided choices, (3) independence of the source of information, and (4) generalization across multiple confidence-guided behaviors. We developed a behavioral task in which we could measure choice and confidence reports for decisions based in two sensory modalities and evaluate the neural encoding of single neurons in OFC, a key area for value-based decisions ( Hirokawa et al., 2019; Kepecs et al., 2008; Padoa-Schioppa and Conen, 2017; Stalnaker et al., 2015; Wallis, 2007 31. Hirokawa, J. ∙ Vaughan, A. ∙ Masset, P. ... Frontal cortex neuron types categorically encode single decision variables Nature. 2019; 576 :446-451 Crossref Scopus (105) PubMed Google Scholar 34. Kepecs, A. ∙ Uchida, N. ∙ Zariwala, H.A. ... Neural correlates, computation and behavioural impact of decision confidence Nature. 2008; 455 :227-231 Crossref Scopus (586) PubMed Google Scholar 62. Padoa-Schioppa, C. ∙ Conen, K.E. Orbitofrontal Cortex: A Neural Circuit for Economic Decisions Neuron. 2017; 96 :736-754 Full Text Full Text (PDF) Scopus (169) PubMed Google Scholar 81. Stalnaker, T.A. ∙ Cooch, N.K. ∙ Schoenbaum, G. What the orbitofrontal cortex does not do Nat. Neurosci. 2015; 18 :620-627 Crossref Scopus (364) PubMed Google Scholar 90. Wallis, J.D. Orbitofrontal cortex and its contribution to decision-making Annu. Rev. Neurosci. 2007; 30 :31-56 Crossref Scopus (659) PubMed Google Scholar ). We trained rats to make perceptual choices based on either an ambiguous smell or sound and invited them to invest variable time for a potential reward after each decision. Post-decision time investment predicted choice accuracy and served as a behavioral report of confidence. We found that time investments reflected a statistically appropriate use of decision confidence. We show that single neurons in OFC encode confidence, predict rats’ time investment across both modalities, and predict choice strategy updating across trials. Taken together, our results show that OFC neurons represent decision confidence generalized across sensory modality and behavior, consistent with the notion of metacognitive confidence as described in psychology ( Dehaene et al., 2017; Dunlosky and Metcalfe, 2009 14. Dehaene, S. ∙ Lau, H. ∙ Kouider, S. What is consciousness, and could machines have it? Science. 2017; 358 :486-492 Crossref Scopus (371) PubMed Google Scholar 16. Dunlosky, J. ∙ Metcalfe, J. Metacognition Sage Publications, 2009 Google Scholar ).

Section: Results

We trained rats to perform auditory and olfactory perceptual decisions and incentivized them to invest their time in proportion to their decision confidence. Rats initiated a trial by entering the center port where they received a stimulus ( Figure 1 A). An olfactory or an auditory stimulus was presented in each trial, and trial modality and trial difficulty were randomly interleaved. In olfactory trials, rats had to determine which of two stereoisomers was most prevalent in an odor mixture delivered in one of seven possible ratios ( Uchida and Mainen, 2003 87. Uchida, N. ∙ Mainen, Z.F. Speed and accuracy of olfactory discrimination in the rat Nat. Neurosci. 2003; 6 :1224-1229 Crossref Scopus (522) PubMed Google Scholar ). In auditory trials, rats had to determine which of two auditory click trains delivered binaurally had the greater number of clicks ( Brunton et al., 2013; Sanders and Kepecs, 2012 6. Brunton, B.W. ∙ Botvinick, M.M. ∙ Brody, C.D. Rats and humans can optimally accumulate evidence for decision-making Science. 2013; 340 :95-98 Crossref Scopus (374) PubMed Google Scholar 76. Sanders, J.I. ∙ Kepecs, A. Choice ball: a response interface for two-choice psychometric discrimination in head-fixed mice J. Neurophysiol. 2012; 108 :3416-3423 Crossref Scopus (36) PubMed Google Scholar ; see STAR Methods ). For both modalities, rats performed close to perfect performance on the easiest trials ( Figure 1 B and 1C) and their accuracy varied with the strength of sensory evidence (average accuracy per session: Acc olf = 0.75 ± 0.05 and Acc aud = 0.81 ± 0.04).
Rats provided post-decision confidence reports by investing their time to earn an uncertain, delayed reward after making perceptual decisions ( Lak et al., 2014 43. Lak, A. ∙ Costa, G.M. ∙ Romberg, E. ... Orbitofrontal cortex is required for optimal waiting based on decision confidence Neuron. 2014; 84 :190-201 Full Text Full Text (PDF) Scopus (128) PubMed Google Scholar ). Water reward after correct choices was randomly delayed so that rats had to make an additional decision about how long to wait for potential reward at a choice port. This waiting time in anticipation of a reward is a time investment into their perceptual decision, which can reflect their subjective confidence. On each trial, the timing of the reward delivery was sampled from an exponential distribution with a time constant τ = 1.5 s, offset by 600 ms and truncated at 8 s ( Figure 1 D, light blue line, mean delay = 2.1 s). On a subset of trials (10% probe trials) we withheld the reward to assess how much time rats would be willing to invest for correct choices. On these probe trials, rats waited on average 5.3 s after olfactory choices and 5.5 s for auditory choices ( Figure 1 D). This task design allowed us to simultaneously obtain a binary decision and a continuous measure of post-decision time investment in single trials.
We first show that rats’ time investment in decisions based on both sensory modalities qualitatively reflects an appropriate use of statistical decision confidence. To operationalize the subjective notion of confidence, we used a statistical definition of decision confidence (“statistical decision confidence”), the probability of choice correctness, P(choice = correct | subjective evidence, choice) ( Hangya et al., 2016; Meyniel et al., 2015a; Pouget et al., 2016 29. Hangya, B. ∙ Sanders, J.I. ∙ Kepecs, A. A Mathematical Framework for Statistical Decision Confidence Neural Comput. 2016; 28 :1840-1858 Crossref Scopus (46) PubMed Google Scholar 51. Meyniel, F. ∙ Sigman, M. ∙ Mainen, Z.F. Confidence as Bayesian Probability: From Neural Origins to Behavior Neuron. 2015; 88 :78-92 Full Text Full Text (PDF) Scopus (178) PubMed Google Scholar 66. Pouget, A. ∙ Drugowitsch, J. ∙ Kepecs, A. Confidence and certainty: distinct probabilistic quantities for different goals Nat. Neurosci. 2016; 19 :366-374 Crossref Scopus (295) PubMed Google Scholar ). We tested whether time investment behavior followed three key signatures predicted by the statistical decision confidence model that describe the relationship between confidence, sensory evidence, and choice ( Hangya et al., 2016 29. Hangya, B. ∙ Sanders, J.I. ∙ Kepecs, A. A Mathematical Framework for Statistical Decision Confidence Neural Comput. 2016; 28 :1840-1858 Crossref Scopus (46) PubMed Google Scholar ).
The first signature, the calibration curve, describes how reported confidence predicts accuracy ( Figures 1 E and 1H): the measure of confidence, time investment in catch trials, should predict accuracy. The second signature is the vevaiometric curve (from the Greek βεβαιος, vevaios, meaning certain), which describes the average confidence report as a function of the strength of evidence and choice ( Figures 1 F and 1I): the measure of confidence should increase with evidence strength for correct trials (measured in correct probe trials) and decrease with evidence strength for error trials (measured in all error trials). The third signature, the conditioned psychometric curve, describes choice accuracy as a function of the strength of evidence for different confidence levels ( Figures 1 G and 1J, measured in catch trials): for a given stimulus discriminability, higher confidence trials are more accurate on average. Rats’ time investment behavior followed all three signatures in both sensory modalities.
We show that rats’ time investment quantitatively matches statistically appropriate use of confidence. How would an ideal observer make confidence-guided time investments in perceptual decisions? In sensory decisions, the strength of evidence is controlled by the discriminability of the stimulus ( x olf or x aud , Figure 2 A, upper left). However, a decision maker only perceives a “percept” ̂ 𝑥 , a noisy, subjective version of the provided evidence x ( Figure 2 A, lower left). We assumed that the decision maker decides based on its internal percept without additional noise (f( ̂ 𝑥 ), Figure 2 A, lower center left). Errors therefore arise when, due to noise, percepts fall into the incorrect category with respect to the provided sensory evidence (i.e., when 𝑥 and ̂ 𝑥 are on different sides of the decision boundary). Although choices do not reveal perceptual noise to the observer on a trial-to-trial basis, average choice accuracy provides an estimate of the total perceptual noise (σ, inverse slopes of the psychometric functions, Figure 2 A, upper middle). On the other hand, a decision maker has access to its perceived strength of evidence on each trial, which can be used to predict the average accuracy (i.e., probability of being correct) for this given percept. This requires learning a calibration function that maps percepts to average accuracy ( Figure 2 A, lower center right). Until this point, the computation of the estimated probability of correct, i.e., decision confidence, is specific to the type of sensory evidence. Once computed, the sensory-specific probability estimates might be combined into a single variable and represented in a modality-general manner. The decision-maker would then use its degree of confidence and map it to a time investment amount through a mapping function ( m(c) , Figure 2 A, lower right) to invest time appropriately ( Figure 2 A, upper right).
To estimate the perceptual noise σ, we fitted the psychometric function with a cumulative Gaussian distribution ( Figure 2 B, left; see STAR Methods ). The standard deviation of this distribution provides an estimate of the perceptual noise ( Figure 2 B, center). Under the assumption of Gaussian perceptual noise, we inferred the distribution of confidence for a given strength of evidence and choice using the normative statistical model of confidence ( Hangya et al., 2016 29. Hangya, B. ∙ Sanders, J.I. ∙ Kepecs, A. A Mathematical Framework for Statistical Decision Confidence Neural Comput. 2016; 28 :1840-1858 Crossref Scopus (46) PubMed Google Scholar ). In other words, we generated percepts based on the observed perceptual noise (σ, Figure 2 B, center) and calculated the degree of confidence, P(correct| ̂ 𝑥 ,choice), associated with each percept. Next, we converted each confidence estimate to a time investment prediction by remapping confidence c monotonically into a time investment TI using a mapping function TI = m(c) by using the empirical cumulative time investment distribution ( Figure 2 B, right; see STAR Methods ). This approach allowed us to isolate the contribution of a confidence computation that informs single-trial time investment behavior.
For all rats and both modalities, model-predicted optimal time investment matched the rats’ behavior well ( Figures 2 C–2E and S1 , solid lines for model predictions mostly fall within error bars of observed time investment behavior). Shuffling single-trial time investment data while retaining the same model parameters (perceptual noise σ and mapping function m(c) , i.e., single trials are not informed by decision confidence) produced uninformative relationships between time investments and task variables that were qualitatively distinct from observed time investment data ( Figure S1 , dashed lines). These results show that the rats’ time investment reflected an appropriate use of decision confidence in two sensory modalities.
How can we determine if a neuron’s activity is informed by a statistical decision confidence computation? We searched for neural signatures of statistical decision confidence, shown in Figures 1 E–1J and 2 C–2E, which can be viewed as “confidence tuning curves” that constrain the possible underlying computational process ( Fleming and Daw, 2017; Hangya et al., 2016 20. Fleming, S.M. ∙ Daw, N.D. Self-evaluation of decision-making: A general Bayesian framework for metacognitive computation Psychol. Rev. 2017; 124 :91-114 Crossref Scopus (292) PubMed Google Scholar 29. Hangya, B. ∙ Sanders, J.I. ∙ Kepecs, A. A Mathematical Framework for Statistical Decision Confidence Neural Comput. 2016; 28 :1840-1858 Crossref Scopus (46) PubMed Google Scholar ). We recorded 1,593 well-isolated single neurons from six rats in OFC using custom-built 32- or 64-channel tetrode micro-drives ( Figure S2 ; see STAR Methods ) and analyzed a subset of 1,211 neurons with an average firing rate above 1 s −1 . We focused our initial analysis on the beginning 2 s of the waiting time period, after rats had entered the choice port and started to invest time into their decision (“anticipation period”). Figures 3 A, S3 A, and S3B show three example neurons that are tuned to statistical decision confidence across both sensory modalities.
Figure 3 Ai shows a neuron whose activity increased after the entry into the choice port and was graded according to olfactory evidence supporting the choice. Activity was highest for easy correct choices, the trials with the highest average confidence, whereas activity was lowest for easy error choices, the trials with the lowest average confidence ( cf. Figure 2 C). We computed confidence tuning curves using the average firing rate in the anticipation period (see STAR Methods ). Choice accuracy systematically increased with firing rate in olfactory trials (calibration curve, Figure 3 Aii, left panel, cf. Figure 2 C). Firing rate increased with evidence for correct trials and decreased with evidence for error trials (vevaiometric curve, Figure 3 Aii, right panel, cf. Figure 2 D). The same neuron also encoded decision confidence for auditory trials ( Figures 3 Aiii and 3Aiv). In two other neurons, we observed confidence encoding across sensory modalities, albeit with inverted tuning and different time courses; i.e., they were negatively tuned to confidence and therefore increased their firing rates with decreasing confidence ( Figures S3 A and S3Bi–iv).
To identify OFC neurons that encode decision confidence during the anticipation period, we computed an outcome prediction index (OPI, a normalized area under the receiver operating characteristic [auROC], see STAR Methods ) as a proxy metric for decision confidence. We identified outcome-predictive neurons with significant positive or negative OPI (n selective = 459, p < 0.025 in either sensory modality using shuffling test). We split the population of outcome-predictive neurons into neurons with positive OPI (confidence(+), i.e., higher firing rate for correct trials, n = 205, sign of OPI measured using trials of both modalities) and negative OPI (confidence(−), i.e., higher firing rate for error trials, n = 254). For both sensory modalities, confidence(−) and confidence(+) neuronal populations showed a graded increase of activity at the beginning of the anticipation period according to choice and difficulty ( Figures 3 B, 3E, S4 A, and S4B) and the confidence tuning curves in the anticipation period followed the signatures of decision confidence ( Figures 3 C, 3D, 3F–3I, and S4 C–S4H).
To assess whether single neurons generalize outcome prediction across sensory modalities, we show that OPIs were strongly correlated across sensory modalities; i.e., outcome-predictive neurons for one modality tended to be also outcome-predictive in the other while preserving tuning direction ( Figure 3 J, r = 0.56, p < 0.0001, t test). Visual examination ( Figures S3 C and S3D) and quantitative tests of self-consistency suggest that the remaining variability of OPIs across sensory modalities could be constrained by our ability to estimate it (see STAR Methods ). Together, these results reveal that single neurons in OFC encode decision confidence generalized across both sensory modalities tested.
We next show that OFC neurons predict time investment, our behavioral report of confidence, in single trials. Figures 4 A i and 4A iii show that, for the same neuron shown in Figure 3 A, the increase in activity after choice port entry in both modalities was proportional to the rat’s eventual time investment. Its firing rate in the anticipation period predicted trial-by-trial time investment in both modalities ( Figures 4 Aii and 4Aiv, Pearson correlation r olf (59) = 0.42, p = 0.0008, r aud (38) = 0.39, p = 0.012). The firing rate in the anticipation period of the two neurons negatively tuned to decision confidence was negatively correlated with the time investment ( Figure S3 A and S3Bv–S3Bviii). We observed similar signatures for both the confidence(−) and confidence(+) populations ( Figures 4 B–4E and S5 A–S5D, respectively).
We tested whether time investment predictions of single neurons were similar across sensory modalities. We computed the correlation between firing rates in the anticipation period and time investments independently for each neuron and modality. The prediction metrics were strongly correlated across both sensory modalities ( Figure 4 F, r = 0.76, p < 0.0001, t test). Thus, a neuron predicting time investment in one modality tended to also predict time investment in the other modality the same way.
We developed a measure for firing rate behavior co-variations to determine the contribution of single neurons to time investment beyond what can be predicted based on their tuning, conceptually similar to choice probability analysis ( Britten et al., 1996 5. Britten, K.H. ∙ Newsome, W.T. ∙ Shadlen, M.N. ... A relationship between behavioral choice and the visual responses of neurons in macaque MT Vis. Neurosci. 1996; 13 :87-100 Crossref Scopus (808) PubMed Google Scholar ). We first calculated each neuron’s firing rate not explained by the strength of evidence for a choice by taking the residuals of a linear model expressing firing rate as a function of evidence strength and choice. We then calculated the correlation between residual firing rates and residual time investments across trials separately for each sensory modality (see STAR Methods ). For olfactory trials, there was a strong correlation between the time investment metric computed using the residuals and the time investment metric computed using neutral evidence trials only ( Figure 4 G, r = 0.64, p < 0.0001 and r = −0.04, p = 0.47 for shuffled trials, t test). The time investment metrics based on residuals were strongly correlated across both modalities ( Figure 4 H, r = 0.75, p < 0.0001 and r = −0.05, p = 0.34 for shuffled trials, t test). Thus, firing rates of single neurons predict time investment on a trial-by-trial basis beyond the information provided by stimulus difficulty and choice.
We further investigated the similarity in neuronal time investment representations across sensory modalities using a cross-modal decoding approach. Using simultaneously recorded neurons, decoders trained to predict time investment in one sensory modality predicted time investments equally well for trials in the other, untrained, sensory modality. To assess decoding quality, we computed the correlation between predicted and observed time investments (10-fold cross-validation, see STAR Methods ). Irrespective of the modality used to train the decoder, single-session decoding quality was similar for both sensory modalities (p > 0.05, Kolmogorov-Smirnov test, Bonferroni corrected), while they were statistically better than decoders predicting shuffled trials ( Figure 5 A). Furthermore, single-session decoding quality was strongly correlated across sensory modalities ( Figures 5 B and 5C) and improved with the number of cells used ( Figures S5 E and S5F). Together, these analyses reveal that the firing pattern of OFC neurons is predictive of trial-by-trial time investment across both sensory modalities.
So far, we have considered a specific behavioral report of confidence: time investment, which was incentivized by our task design. We also noticed that rats showed small systematic changes in perceptual decision strategy after rewarded trials. Reinforcement learning models that incorporate perceptual ambiguity predict similar choice strategy updating driven by confidence-scaled reward prediction errors ( Drugowitsch et al., 2019 15. Drugowitsch, J. ∙ Mendonça, A.G. ∙ Mainen, Z.F. ... Learning optimal decisions with confidence Proc. Natl. Acad. Sci. USA. 2019; 116 :24872-24880 Crossref Scopus (36) PubMed Google Scholar ; Lak et al., 2017 44. Lak, A. ∙ Nomoto, K. ∙ Keramati, M. ... Midbrain Dopamine Neurons Signal Belief in Choice Accuracy during a Perceptual Decision Curr. Biol. 2017; 27 :821-832 Full Text Full Text (PDF) Scopus (93) PubMed Google Scholar , Lak et al., 2020b 46. Lak, A. ∙ Okun, M. ∙ Moss, M.M. ... Dopaminergic and Prefrontal Basis of Learning from Sensory Confidence and Reward Value Neuron. 2020; 105 :700-711.E6 Full Text Full Text (PDF) Scopus (72) PubMed Google Scholar ). These models predict that when decision confidence is low, but the choice is rewarded—a surprising outcome—there is a prediction error that produces a bias in the subsequent trial’s choice ( Figures 6 A–6C and S6 A–S6C; see STAR Methods ).
We found that rats’ choices were systematically modulated depending on the previous outcome and trial difficulty. If the previous trial was rewarded, rats tended to repeat the same choice again; i.e., they tended to choose the same side (left or right) again, which produced a shift in the psychometric function depending on the previous choice ( Figures 6 D, 6E, 6G, and 6H). Choice updating scaled with the evidence strength of the previous trial both within and across sensory modalities—albeit this effect was less pronounced across sensory modalities—and was therefore consistent with confidence-scaled updating of choice values ( Figures 6 F, 6I, S6 D, and S6G for within modality choices, and Figures S6 E, S6F, S6H, and S6I for choices across modalities; p < 10 −6 for evidence for choice effect on predicting choice updating; logistic regression, see STAR Methods ). We ruled out that choice updating was due to slow drifts in choice bias: there was no systematic relationship between choice updating and the choice in the subsequent trial in either modality ( Figure S6 J).
This behavioral phenomenon enabled us to examine whether OFC neurons encoding decision confidence and predicting time investments also predict cross-trial choice strategy updating. We split trials according to the firing rate of the confidence(+) neurons by their median firing rate in each session and compared choice updating, i.e., the tendency to repeat the same choice, in the subsequent trial. When the activity of confidence(+) neurons was high, we observed almost no choice updating in the subsequent trials, whereas when the activity of confidence(+) neurons was low, we observed strong choice updating in the subsequent trial ( Figures 6 J–6M). We observed this effect both within ( Figures 6 J and 6K, p < 0.003 and p < 0.03 for olfactory and auditory trials respectively, logistic regression) and across ( Figures 6 L and 6M, p < 0.008 auditory to olfactory and olfactory to auditory respectively, logistic regression) sensory modalities. Since the activity of confidence(+) neurons is modulated by the sensory evidence, we repeated this analysis by using a model that considered sensory evidence in addition to confidence-neuron firing rates in the previous trial, which revealed a significant additional contribution of firing rates to the prediction of choice updating (ΔAIC = −813 [−805] when omitting firing rate for predicting choice updating in olfactory [auditory] trials, p < 0.001, bootstrapping, see STAR Methods ). Curiously, the confidence(−) neuronal population did not predict choice updating on average, suggesting that a specialized OFC subpopulation might be specifically involved in choice updating ( Figure S6 K).
Lastly, we assessed the time course and tuning similarities across sensory modalities throughout each trial. Firing rate dynamics during a trial were similar across sensory modalities both during the anticipation and the outcome periods, as assessed by peak averaged firing rate ( Figures 7 A–7D; see STAR Methods ) and by the distribution of spike density correlations across modalities ( Figure S7 A, p < 2e-16 for choice period, and Figure S7 B, p < 1.41e-17 for outcome period, Kolmogorov-Smirnoff test). Similarly, the temporal dynamics of confidence tuning ( Figures 7 E and 7F) and time investment prediction ( Figures 7 G and 7H) were correlated across modalities ( Figures S7 C–S7E; see STAR Methods ).
To further separate the dynamics of confidence encoding from the overall activity dynamics in OFC, we trained a generalized linear model (GLM) to predict the firing rate of single neurons across time based on several task variables such as chosenside and evidenceforchoice (see STAR Methods ). For both olfactory and auditory trials, confidence encoding (captured by the coefficient β EvidenceForChoice ) arose at the beginning of the choice period and remained sustained during the anticipation period, unlike the coefficient for chosen side or trial outcome ( Figures 7 I and 7J). Coding similarity across modalities emerged late in the movement period and plateaued within the first 2 s of the time investment period ( Figure 7 K). Activity at the time of the outcome (reward or leaving) was best captured by the binary outcome variable rather than the graded evidence for choice ( Figure 7 L).
Taken together, these results show that both the overall activity dynamics, as well as confidence encoding and time investment predictions that emerge after the rats’ choice, are shared across sensory modalities.

Section: Discussion

Here, we showed that neuronal representations of decision confidence in rat OFC satisfy characteristics expected for an abstract confidence signal that could mediate metacognition. First, neural activity reflected a statistical confidence computation and predicted behavioral reports of confidence. Further, these confidence signals generalized across the sensory modalities and predicted distinct confidence-guided behaviors: time investment and cross-trial choice updating.
Our claim about confidence representations relies on several lines of evidence that allow us to distinguish abstract confidence representations from other signals. First, we showed that OFC firing rates during the time investment period reflect critical signatures of a statistical confidence computation ( Hangya et al., 2016; Sanders et al., 2016 29. Hangya, B. ∙ Sanders, J.I. ∙ Kepecs, A. A Mathematical Framework for Statistical Decision Confidence Neural Comput. 2016; 28 :1840-1858 Crossref Scopus (46) PubMed Google Scholar 78. Sanders, J.I. ∙ Hangya, B. ∙ Kepecs, A. Signatures of a Statistical Computation in the Human Sense of Confidence Neuron. 2016; 90 :499-506 Full Text Full Text (PDF) Scopus (145) PubMed Google Scholar ). While statistical confidence computations normatively predict the observed signatures ( Hangya et al., 2016 29. Hangya, B. ∙ Sanders, J.I. ∙ Kepecs, A. A Mathematical Framework for Statistical Decision Confidence Neural Comput. 2016; 28 :1840-1858 Crossref Scopus (46) PubMed Google Scholar ), there may be other confidence-unrelated processes (e.g., attention, motivation) that could lead to similar patterns, although modeling studies suggest that they are unlikely to produce all three signatures of decision confidence ( Sanders, 2014 75. Sanders, J.I., 2014. A computational framework for understanding decision confidence. PhD thesis. Watson School of Biological Sciences, Cold Spring Harbor Laboratory. Google Scholar ).
Second, OFC firing rates predict time investment on a trial-to-trial basis, beyond what is expected from confidence tuning alone. This suggests that OFC activity drives confidence-guided time investments, consistent with previous observations that OFC inactivation specifically impairs rats’ ability to invest time in their decisions according to their confidence level ( Lak et al., 2014 43. Lak, A. ∙ Costa, G.M. ∙ Romberg, E. ... Orbitofrontal cortex is required for optimal waiting based on decision confidence Neuron. 2014; 84 :190-201 Full Text Full Text (PDF) Scopus (128) PubMed Google Scholar ), and reminiscent to findings that frontal cortical regions determine action timing in rats ( Murakami et al., 2014, 2017 56. Murakami, M. ∙ Vicente, M.I. ∙ Costa, G.M. ... Neural antecedents of self-initiated actions in secondary motor cortex Nat. Neurosci. 2014; 17 :1574-1582 Crossref Scopus (185) PubMed Google Scholar 57. Murakami, M. ∙ Shteingart, H. ∙ Loewenstein, Y. ... Distinct Sources of Deterministic and Stochastic Components of Action Timing Decisions in Rodent Frontal Cortex Neuron. 2017; 94 :908-919.e7 Full Text Full Text (PDF) Scopus (58) PubMed Google Scholar ).
Third, we used two sensory modalities to test the generality of confidence representations, a first step toward showing metacognitive representations of confidence. Nevertheless, confidence about other decisions, such as a value-guided ( De Martino et al., 2013 13. De Martino, B. ∙ Fleming, S.M. ∙ Garrett, N. ... Confidence in value-based choice Nat. Neurosci. 2013; 16 :105-110 Crossref Scopus (355) PubMed Google Scholar ) or memory-based choices ( Miyamoto et al., 2017, 2018 54. Miyamoto, K. ∙ Osada, T. ∙ Setsuie, R. ... Causal neural network of metamemory for retrospection in primates Science. 2017; 355 :188-193 Crossref Scopus (71) PubMed Google Scholar 55. Miyamoto, K. ∙ Setsuie, R. ∙ Osada, T. ... Reversible Silencing of the Frontopolar Cortex Selectively Impairs Metacognitive Judgment on Non-experience in Primates Neuron. 2018; 97 :980-989.e6 Full Text Full Text (PDF) Scopus (41) PubMed Google Scholar ) and novel experiences may require different brain regions. OFC has a well-established role in value-guided decisions ( Padoa-Schioppa and Conen, 2017; Stalnaker et al., 2015; Wallis, 2007; Xie and Padoa-Schioppa, 2016 62. Padoa-Schioppa, C. ∙ Conen, K.E. Orbitofrontal Cortex: A Neural Circuit for Economic Decisions Neuron. 2017; 96 :736-754 Full Text Full Text (PDF) Scopus (169) PubMed Google Scholar 81. Stalnaker, T.A. ∙ Cooch, N.K. ∙ Schoenbaum, G. What the orbitofrontal cortex does not do Nat. Neurosci. 2015; 18 :620-627 Crossref Scopus (364) PubMed Google Scholar 90. Wallis, J.D. Orbitofrontal cortex and its contribution to decision-making Annu. Rev. Neurosci. 2007; 30 :31-56 Crossref Scopus (659) PubMed Google Scholar 94. Xie, J. ∙ Padoa-Schioppa, C. Neuronal remapping and circuit persistence in economic decisions Nat. Neurosci. 2016; 19 :855-861 Crossref Scopus (46) PubMed Google Scholar ; van Duuren et al., 2009 89. van Duuren, E. ∙ van der Plasse, G. ∙ Lankelma, J. ... Single-cell and Population Coding of Expected Reward Probability in the Orbitofrontal Cortex of the Rat J. Neurosci. 2009; 29 :8965-8976 Crossref Scopus (58) PubMed Google Scholar ), and therefore, we consider it likely that our results will generalize beyond sensory-based decisions.
Finally, we showed that OFC neurons predict confidence-guided choice strategy updating. Appropriately estimating confidence is essential for learning in probabilistic environments ( Drugowitsch et al., 2019 15. Drugowitsch, J. ∙ Mendonça, A.G. ∙ Mainen, Z.F. ... Learning optimal decisions with confidence Proc. Natl. Acad. Sci. USA. 2019; 116 :24872-24880 Crossref Scopus (36) PubMed Google Scholar ; Lak et al., 2020a 45. Lak, A. ∙ Hueske, E. ∙ Hirokawa, J. ... Reinforcement biases subsequent perceptual decisions when confidence is low, a widespread behavioral phenomenon eLife. 2020; 9 :1-33 Crossref Scopus (52) Google Scholar , Lak et al., 2020b 46. Lak, A. ∙ Okun, M. ∙ Moss, M.M. ... Dopaminergic and Prefrontal Basis of Learning from Sensory Confidence and Reward Value Neuron. 2020; 105 :700-711.E6 Full Text Full Text (PDF) Scopus (72) PubMed Google Scholar ; Meyniel et al., 2015b 52. Meyniel, F. ∙ Schlunegger, D. ∙ Dehaene, S. The Sense of Confidence during Probabilistic Learning: A Normative Account PLoS Comput. Biol. 2015; 11 :e1004305 Crossref Scopus (94) PubMed Google Scholar ), and dopamine neurons have been shown to represent confidence-scaled prediction errors that are used for choice updating ( Lak et al., 2017 44. Lak, A. ∙ Nomoto, K. ∙ Keramati, M. ... Midbrain Dopamine Neurons Signal Belief in Choice Accuracy during a Perceptual Decision Curr. Biol. 2017; 27 :821-832 Full Text Full Text (PDF) Scopus (93) PubMed Google Scholar , Lak et al., 2020b 46. Lak, A. ∙ Okun, M. ∙ Moss, M.M. ... Dopaminergic and Prefrontal Basis of Learning from Sensory Confidence and Reward Value Neuron. 2020; 105 :700-711.E6 Full Text Full Text (PDF) Scopus (72) PubMed Google Scholar ). These results raise the intriguing possibility that confidence computations in OFC relay this information to neuromodulatory systems to enable confidence-guided learning, consistent with recent evidence that frontal cortex relays information about expected reward to ventral tegmental area ( Starkweather et al., 2018; Takahashi et al., 2011 82. Starkweather, C.K. ∙ Gershman, S.J. ∙ Uchida, N. The Medial Prefrontal Cortex Shapes Dopamine Reward Prediction Errors under State Uncertainty Neuron. 2018; 98 :616-629.e6 Full Text Full Text (PDF) Scopus (77) PubMed Google Scholar 85. Takahashi, Y.K. ∙ Roesch, M.R. ∙ Wilson, R.C. ... Expectancy-related changes in firing of dopamine neurons depend on orbitofrontal cortex Nat. Neurosci. 2011; 14 :1590-1597 Crossref Scopus (195) PubMed Google Scholar ). How the dynamic activity patterns across sensory modalities enable linking abstract confidence representations to subsequent behaviors for both learning and time investment remains an open question.
Our observation that rat OFC neurons signal decision confidence across modalities supports OFC’s conceptualization in outcome prediction and valuation. OFC is known to represent reward expectancies and value of choice options ( Hirokawa et al., 2019; Padoa-Schioppa and Assad, 2006; Rudebeck and Murray, 2014; Stalnaker et al., 2015; Wallis, 2007 31. Hirokawa, J. ∙ Vaughan, A. ∙ Masset, P. ... Frontal cortex neuron types categorically encode single decision variables Nature. 2019; 576 :446-451 Crossref Scopus (105) PubMed Google Scholar 61. Padoa-Schioppa, C. ∙ Assad, J.A. Neurons in the orbitofrontal cortex encode economic value Nature. 2006; 441 :223-226 Crossref Scopus (1152) PubMed Google Scholar 71. Rudebeck, P.H. ∙ Murray, E.A. The orbitofrontal oracle: cortical mechanisms for the prediction and evaluation of specific behavioral outcomes Neuron. 2014; 84 :1143-1156 Full Text Full Text (PDF) Scopus (281) PubMed Google Scholar 81. Stalnaker, T.A. ∙ Cooch, N.K. ∙ Schoenbaum, G. What the orbitofrontal cortex does not do Nat. Neurosci. 2015; 18 :620-627 Crossref Scopus (364) PubMed Google Scholar 90. Wallis, J.D. Orbitofrontal cortex and its contribution to decision-making Annu. Rev. Neurosci. 2007; 30 :31-56 Crossref Scopus (659) PubMed Google Scholar ; van Duuren et al., 2009 89. van Duuren, E. ∙ van der Plasse, G. ∙ Lankelma, J. ... Single-cell and Population Coding of Expected Reward Probability in the Orbitofrontal Cortex of the Rat J. Neurosci. 2009; 29 :8965-8976 Crossref Scopus (58) PubMed Google Scholar ; Constantinople et al., 2019 11. Constantinople, C.M. ∙ Piet, A.T. ∙ Brody, C.D. An Analysis of Decision under Risk in Rats Curr. Biol. 2019; 29 :2066-2074.e5 Full Text Full Text (PDF) Scopus (33) PubMed Google Scholar ; Roitman and Roitman, 2010 70. Roitman, J.D. ∙ Roitman, M.F. Risk-preference differentiates orbitofrontal cortex responses to freely chosen reward outcomes Eur. J. Neurosci. 2010; 31 :1492-1500 Crossref Scopus (0) PubMed Google Scholar ; Sul et al., 2010 84. Sul, J.H. ∙ Kim, H. ∙ Huh, N. ... Distinct roles of rodent orbitofrontal and medial prefrontal cortex in decision making Neuron. 2010; 66 :449-460 Full Text Full Text (PDF) Scopus (258) PubMed Google Scholar ). OFC lesions have been shown to affect a number of goal-directed behaviors in which values have to be inferred ( Jones et al., 2012; Rudebeck and Murray, 2014; Stalnaker et al., 2015 32. Jones, J.L. ∙ Esber, G.R. ∙ McDannald, M.A. ... Orbitofrontal cortex supports behavior and learning using inferred but not cached values Science. 2012; 338 :953-956 Crossref Scopus (206) PubMed Google Scholar 71. Rudebeck, P.H. ∙ Murray, E.A. The orbitofrontal oracle: cortical mechanisms for the prediction and evaluation of specific behavioral outcomes Neuron. 2014; 84 :1143-1156 Full Text Full Text (PDF) Scopus (281) PubMed Google Scholar 81. Stalnaker, T.A. ∙ Cooch, N.K. ∙ Schoenbaum, G. What the orbitofrontal cortex does not do Nat. Neurosci. 2015; 18 :620-627 Crossref Scopus (364) PubMed Google Scholar ; Gremel and Costa, 2013 27. Gremel, C.M. ∙ Costa, R.M. Orbitofrontal and striatal circuits dynamically encode the shift between goal-directed and habitual actions Nat. Commun. 2013; 4 :2264 Crossref Scopus (0) PubMed Google Scholar ). OFC has also been shown to support economic decisions where the value of each option is estimated either based on past experience or subjective preference between options ( Padoa-Schioppa and Conen, 2017; Steiner and Redish, 2014 62. Padoa-Schioppa, C. ∙ Conen, K.E. Orbitofrontal Cortex: A Neural Circuit for Economic Decisions Neuron. 2017; 96 :736-754 Full Text Full Text (PDF) Scopus (169) PubMed Google Scholar 83. Steiner, A.P. ∙ Redish, A.D. Behavioral and neurophysiological correlates of regret in rat decision-making on a neuroeconomic task Nat. Neurosci. 2014; 17 :995-1002 Crossref Scopus (119) PubMed Google Scholar ). OFC activity has been studied less under perceptual ambiguity, when the cues that predict reward are uncertain. In these situations, the value of a choice should reflect the probability of making a correct perceptual decision; i.e., decision confidence. Thus, a confidence computation transforms a proposition about ambiguous evidence into a proposition about outcome likelihood, indispensable for any valuation process and hence consistent with a hidden state representation of task space in OFC ( Gershman, 2018; Wilson et al., 2014 23. Gershman, S.J. The successor representation: its computational logic and neural substrates J. Neurosci. 2018; 38 :7193-7200 Crossref Scopus (82) PubMed Google Scholar 92. Wilson, R.C. ∙ Takahashi, Y.K. ∙ Schoenbaum, G. ... Orbitofrontal cortex as a cognitive map of task space Neuron. 2014; 81 :267-279 Full Text Full Text (PDF) Scopus (549) PubMed Google Scholar ). Abstract confidence signals could thus serve as a basis to make economic decisions and guide actions based on values inferred from perceptual uncertainty.
A sensory-modality-general representation of decision confidence might have been promoted by our task space, which is indifferent to the sensory modality after making a choice. It remains an open question whether situations in which sensory modality information is required for learning would promote a sensory-modality-specific representation of decision confidence. On the other hand, we observed stronger within-modality than cross-modality choice updating, suggesting that rats considered stimulus identity and statistics across trials for within-modality learning (“model based”) in addition to learning about choice values irrespective of sensory stimuli (“model free”). Our task design included trials that were never rewarded (probe trials), which could incentivize model-based learning. These observations suggest that state space representations reflect a mixture of model-based and model-free learning processes, as has been reported in complex behavioral tasks ( Kim et al., 2019; Kool et al., 2016 36. Kim, D. ∙ Park, G.Y. ∙ O Doherty, J.P. ... Task complexity interacts with state-space uncertainty in the arbitration between model-based and model-free learning Nat. Commun. 2019; 10 :5738 Crossref Scopus (36) PubMed Google Scholar 40. Kool, W. ∙ Cushman, F.A. ∙ Gershman, S.J. When Does Model-Based Control Pay Off? PLoS Comput. Biol. 2016; 12 :e1005090 Crossref Scopus (105) PubMed Google Scholar ). However, we did not observe a difference in neuronal predictions of choice updating within or across sensory modalities ( Figures 6 J–6M), supporting the notion that confidence-encoding neurons in OFC generalize across sensory modalities, consistent with a model-free state-space representation.
In humans, representations of confidence have been reported in agranular posterior medial cingulate cortex ( Bang and Fleming, 2018; Fleming et al., 2018; Rushworth and Behrens, 2008 3. Bang, D. ∙ Fleming, S.M. Distinct encoding of decision confidence in human medial prefrontal cortex Proc. Natl. Acad. Sci. USA. 2018; 115 :6082-6087 Crossref Scopus (121) PubMed Google Scholar 22. Fleming, S.M. ∙ van der Putten, E.J. ∙ Daw, N.D. Neural mediators of changes of mind about perceptual decisions Nat. Neurosci. 2018; 21 :617-624 Crossref Scopus (88) PubMed Google Scholar 72. Rushworth, M.F.S. ∙ Behrens, T.E.J. Choice, uncertainty and value in prefrontal and cingulate cortex Nat. Neurosci. 2008; 11 :389-397 Crossref Scopus (649) PubMed Google Scholar ). Indeed, a precise homology between rodent and primate OFC remains to be established due to differences in criteria as well as methodological discrepancies across studies ( Uylings et al., 2003; Wallis, 2011 88. Uylings, H.B.M. ∙ Groenewegen, H.J. ∙ Kolb, B. Do rats have a prefrontal cortex? Behav. Brain Res. 2003; 146 :3-17 Crossref Scopus (825) PubMed Google Scholar 91. Wallis, J.D. Cross-species studies of orbitofrontal cortex and value-based decision-making Nat. Neurosci. 2011; 15 :13-19 Crossref Scopus (269) PubMed Google Scholar ; Ongür and Price, 2000 59. Ongür, D. ∙ Price, J.L. The organization of networks within the orbital and medial prefrontal cortex of rats, monkeys and humans Cereb. Cortex. 2000; 10 :206-219 Crossref Scopus (2158) PubMed Google Scholar ). Moreover, increased parcellation of frontal cortex in primates could lead to a separation of functions that are intermingled within rodent OFC ( Carlén, 2017 7. Carlén, M. What constitutes the prefrontal cortex? Science. 2017; 358 :478-482 Crossref Scopus (319) PubMed Google Scholar ). Nevertheless, a number of studies have found similar functional properties across species in OFC, such as reward value and risk ( Kuwabara et al., 2020; Li et al., 2016; O’Neill and Schultz, 2010; Padoa-Schioppa and Assad, 2006; Wallis, 2011 42. Kuwabara, M. ∙ Kang, N. ∙ Holy, T.E. ... Neural mechanisms of economic choices in mice Elife. 2020; 9 , e49669 Crossref Scopus (26) PubMed Google Scholar 47. Li, Y. ∙ Vanni-Mercier, G. ∙ Isnard, J. ... The neural dynamics of reward value and risk coding in the human orbitofrontal cortex Brain. 2016; 139 :1295-1309 Crossref Scopus (38) PubMed Google Scholar 58. O’Neill, M. ∙ Schultz, W. Coding of reward risk by orbitofrontal neurons is mostly distinct from coding of reward value Neuron. 2010; 68 :789-800 Full Text Full Text (PDF) Scopus (186) PubMed Google Scholar 61. Padoa-Schioppa, C. ∙ Assad, J.A. Neurons in the orbitofrontal cortex encode economic value Nature. 2006; 441 :223-226 Crossref Scopus (1152) PubMed Google Scholar 91. Wallis, J.D. Cross-species studies of orbitofrontal cortex and value-based decision-making Nat. Neurosci. 2011; 15 :13-19 Crossref Scopus (269) PubMed Google Scholar ; Constantinople et al., 2019 11. Constantinople, C.M. ∙ Piet, A.T. ∙ Brody, C.D. An Analysis of Decision under Risk in Rats Curr. Biol. 2019; 29 :2066-2074.e5 Full Text Full Text (PDF) Scopus (33) PubMed Google Scholar ; van Duuren et al., 2009 89. van Duuren, E. ∙ van der Plasse, G. ∙ Lankelma, J. ... Single-cell and Population Coding of Expected Reward Probability in the Orbitofrontal Cortex of the Rat J. Neurosci. 2009; 29 :8965-8976 Crossref Scopus (58) PubMed Google Scholar ; Rudebeck and Murray, 2014 71. Rudebeck, P.H. ∙ Murray, E.A. The orbitofrontal oracle: cortical mechanisms for the prediction and evaluation of specific behavioral outcomes Neuron. 2014; 84 :1143-1156 Full Text Full Text (PDF) Scopus (281) PubMed Google Scholar ).
Our core observations that OFC neurons represent decision confidence and predict confidence reports fit into a statistical framework of decision confidence ( Hangya et al., 2016; Ott et al., 2018 29. Hangya, B. ∙ Sanders, J.I. ∙ Kepecs, A. A Mathematical Framework for Statistical Decision Confidence Neural Comput. 2016; 28 :1840-1858 Crossref Scopus (46) PubMed Google Scholar 60. Ott, T. ∙ Masset, P. ∙ Kepecs, A. The Neurobiology of Confidence: From Beliefs to Neurons Cold Spring Harb. Symp. Quant. Biol. 2018; 83 :9-16 Crossref Scopus (11) PubMed Google Scholar ). Beyond the study of neural mechanisms, this framework has been used to argue that pre-verbal infants use metacognitive evaluation to adapt their behavior ( Goupil and Kouider, 2016; Goupil et al., 2016 25. Goupil, L. ∙ Kouider, S. Behavioral and Neural Indices of Metacognitive Sensitivity in Preverbal Infants Curr. Biol. 2016; 26 :3038-3045 Full Text Full Text (PDF) Scopus (65) PubMed Google Scholar 26. Goupil, L. ∙ Romand-Monnier, M. ∙ Kouider, S. Infants ask for help when they know they don’t know Proc. Natl. Acad. Sci. USA. 2016; 113 :3492-3496 Crossref Scopus (122) PubMed Google Scholar ). However, such statistical framework does not constrain the neural architecture that realizes confidence computations and therefore is not sufficient to account for our observation that confidence representations are centralized (i.e., within one brain area) and abstract (i.e., generalized across sensory modalities and behavioral outputs). These observations are consistent with key predictions from metacognitive notions of confidence in psychology that conjecture a “metacognitive bottleneck” for computing abstract confidence ( Ais et al., 2016; Dehaene et al., 2017; Dunlosky and Metcalfe, 2009 1. Ais, J. ∙ Zylberberg, A. ∙ Barttfeld, P. ... Individual consistency in the accuracy and distribution of confidence judgments Cognition. 2016; 146 :377-386 Crossref Scopus (81) PubMed Google Scholar 14. Dehaene, S. ∙ Lau, H. ∙ Kouider, S. What is consciousness, and could machines have it? Science. 2017; 358 :486-492 Crossref Scopus (371) PubMed Google Scholar 16. Dunlosky, J. ∙ Metcalfe, J. Metacognition Sage Publications, 2009 Google Scholar ). Our results provide evidence that, in rodents, OFC supports metacognitive abilities with a centralized, abstract representation of decision confidence.

Section: STAR★Methods

REAGENT or RESOURCE SOURCE IDENTIFIER Chemicals, Peptides, and Recombinant Proteins Fluriso (Isoflurane) VetOne Fluriso Lidocaine Henry Schien LidoJect Ketoprofen Zoetis Ketofen DiI fluorescent labeling Invitrogen D3911 +2-octanol Sigma-Aldrich SKU 147982 −2-octanol Sigma-Aldrich SKU 147990 Experimental Models: Organisms/Strains Long Evans Rat Taconic LONGEV-M (discontinued) Software and Algorithms MATLAB Mathworks https://www.mathworks.com/products/matlab.html MountainSort Chung et al., 2017 9. Chung, J.E. ∙ Magland, J.F. ∙ Barnett, A.H. ... A Fully Automated Approach to Spike Sorting Neuron. 2017; 95 :1381-1394.e6 Full Text Full Text (PDF) Scopus (242) PubMed Google Scholar https://github.com/flatironinstitute/mountainsort_examples Cheetah Neuralynx N/A Other Bpod State Machine r1 Sanworks https://www.sanworks.io/ PulsePal Sanworks https://www.sanworks.io/ 64 port olfactometer Island Motion P/N 109-024 Tetrode wire (RO800, 1/4 hard PAC) Sandvik N/A Digital Lynx system Neuralynx N/A Open table in a new tab
Further information and requests for resources and reagents should be directed to and will be fulfilled by the Lead Contact, Adam Kepecs ( akepecs@wustl.edu ).
This study did not generate new unique reagents.
The data and custom code that support the findings from this study are available from the Lead Contact upon request.
We used 6 adults male Long Evans rats (Taconic). Rats were housed in pairs during training and then single-housed after implantation of the microdrive and maintained on a reverse 12 h light/dark cycle. The rats had ad libitum access to food and were under a liquid restriction schedule with daily monitoring of water intake to maintain a body weight of at least 85% of free-drinking weight. Rats obtained water during daily training sessions and received ad libitum water on weekends and as needed. All procedures involving animals were carried out in accordance with National Institute of Health standards and were approved by the Cold Spring Harbor Laboratory Institutional Animal Care and Use Committee.
Behavioral procedures were conducted similarly as previously described ( Kepecs et al., 2008; Lak et al., 2014 34. Kepecs, A. ∙ Uchida, N. ∙ Zariwala, H.A. ... Neural correlates, computation and behavioural impact of decision confidence Nature. 2008; 455 :227-231 Crossref Scopus (586) PubMed Google Scholar 43. Lak, A. ∙ Costa, G.M. ∙ Romberg, E. ... Orbitofrontal cortex is required for optimal waiting based on decision confidence Neuron. 2014; 84 :190-201 Full Text Full Text (PDF) Scopus (128) PubMed Google Scholar ). A rectangular behavioral box contained three ports aligned on one wall equipped with LEDs, infrared photodiodes, and phototransistors. Interruption of the infrared photo beam was used to determine port entries and port exits. The two side ports (choice ports) were additionally equipped with valve-controlled water spouts for reward delivery. The center port (stimulus port) was used to deliver olfactory stimuli through a custom-built olfactometer. During olfactory stimulus presentation, odor solutions (+/− 2-octanol, Sigma Aldrich) were placed daily on fresh filters to mix 1:10 with pure air and delivered at the stimulus port at an overall flow rate of 1 l/min. Air delivery without odors was maintained during the trial. For auditory stimuli, two speakers were placed symmetrically outside of the behavioral box at the left and right panel, aligned to the animal’s head. The olfactometer, speakers, water valves, LEDs and phototransistors were controlled by the behavioral measurement system Bpod and Pulse Pal (Sanworks, NY) ( Sanders and Kepecs, 2014 77. Sanders, J.I. ∙ Kepecs, A. A low-cost programmable pulse generator for physiology and behavior Front. Neuroeng. 2014; 7 :43 Crossref Scopus (45) PubMed Google Scholar ) and custom software (MATLAB).
Six naive rats were trained on a post-decision temporal wager task to assess the rats’ level of confidence in their decision. The first part of the trial was constructed as a two-alternative forced choice task. Rats self-initiated each trial by entering the central stimulus port. After a random delay of 0.2–0.4 s, either an olfactory or auditory stimulus was presented (randomly interleaved). For olfactory stimuli, rats had to determine the dominant odor of a mix of pure odorants +2-octanol and –2-octanol. Odor stimuli were delivered for at least 0.35 s or until the rat left the center port (max. 3 s). Odor mixtures were fixed at 7 concentration ratios, which we adjusted to match the performance levels for each mixture ratio across animals. We always included a ratio of 5/95 (easiest discrimination, left side rewarded), 50/50 (randomly rewarded) and 5/95 (easy discrimination, right side rewarded). Intermediate discrimination difficulty were typically around 42/58 (intermediate discrimination, left rewarded, presented ratio were 44/56 42/58, 40/60, 35/65 or 30/70 depending on the animal) and 58/42 (intermediate discrimination, right rewarded, presented ratio was 56/44, 58/42, 60/40, 65/35 or 70/30 depending on the animal) as well as 47/53 (difficult discrimination, left rewarded, presented ratio was 48/52, 47/53, 46/54, 45/55 or 44/56 depending on the animal) and 53/47 (difficult discrimination, right rewarded, presented ratio was 52/48, 53/47, 54/46, 55/45 or 56/44 depending on the animal). After a variable odor sampling time, rats exited the stimulus port, which terminated odor delivery, and indicated their choice by entering one of two choice ports (left or right) with a maximum response time of 3 s after leaving the stimulus port. Choices were rewarded according to the dominant odor component in the mixture: Left port entries were rewarded for mixture ratio < 50; right port entries were rewarded for mixture ratios > 50. 50/50 ratios were randomly rewarded. For auditory stimuli, rats had to determine the side with the higher number of clicks in binaural streams of clicks. Auditory stimuli were random Poisson-distributed click trains played binaurally at the two speakers placed outside of the behavioral box for a fixed time of 0.25 s. For each rat, we chose a maximum click rate click max according to the performance of the animal, typically 50 clicks/s (full range 40–100 clicks/s). This maximum click rate was fixed for each animal. For each trial, we randomly chose a delta click rate between left and right from a uniform distribution between 0 and click max . The sum of the left and right click rate was kept constant at click max . Rats indicated their choice by exiting the stimulus port and entering one of two choice ports (left or right) with a maximum response time of 3 s after leaving the stimulus port. Choices were rewarded according the higher number of clicks presented between the left and right click train (equal number of licks were randomly rewarded). Exiting the stimulus port during the pre-stimulus delay or during the stimulus time (first 0.25 s) were followed by a white noise and a time out of 3–7 s.
To assess the rats’ degree of confidence, we asked the rats to place a temporal wager on their decision by investing a self-determined amount of time after committing to a choice. For correct choices, we withheld reward delivery for a random time between 0.6–8 s drawn from an exponential distribution with time constant 1.5 s, shifted by 0.6 s and truncated at 8 s. We chose the exponential distribution to maintain a relatively constant reward expectation, i.e., a flat hazard rate. Rats had to keep poking the choice ports during the entire time period. On a subset of trials (10% probe trials), we withheld reward entirely by setting the reward timing to 20 s. In addition, there was no feedback on error trials. Consequently, rats decided to leave the choice ports after a variable amount of time to initiate the next trial. To avoid false detections of leaving decisions rats had a grace period of 0.2-0.4 s in which reentry into the choice ports was not considered as a leaving decision. After a leaving decision was complete, a short auditory tone indicated to the rat that the trial was over. This provided us with a continuous time investment as well as a binary choice on each non-rewarded trial (probe trials and error trials). Time investment served as an index of the rats’ confidence estimate in their decision (see Statistical Confidence Model and Figures 1 and 2 ).
We initially trained naive rats to enter the central stimulus port and subsequently collect a water reward at either of the two choice ports (left or right). Rats learned to enter the stimulus port for at least 0.5 s. Subsequently we introduced one sensory modality only, starting with stimuli of high discriminability. After performance levels reached above ∼90% we introduced stimuli with decreasing discriminability, i.e., increasing difficulty, to sample the full range of the rats’ choice behavior. During this early training stage, all correct choices were rewarded and for incorrect choices we provided a feedback of white noise and a time out (3–7 s). After stable performance levels (lapse rates < 5%–10%) we removed feedback for error trials and introduced randomly delayed rewards gradually, starting from a maximum of 2 s to a maximum of 8 s over the course of several sessions. We never reinforced leaving behavior at the choice port. Note that during training with one sensory modality we sampled ∼5% of trials from the other sensory modality. Subsequently, we repeated training procedure for the second modality. Finally, we randomly interleaved trials of both modalities. Shortly before recording sessions started, we introduced probe trials. We switched the order of modalities in the training procedure between animals. Overall training took typically between 40–60 training sessions over the course of 8–12 weeks. Each session lasted about 2-3 h, in which the rats typically performed 700–1000 trials. The first 50 trials of each session were sampled from easier stimuli, no probe trials were provided and the reward delay distribution was shortened. This ensured stable choice and time investments across both modalities.
We collected 89,406 trials from six rats across 119 behavioral sessions (rats performed between 15 and 28 sessions each, number of trials within a session varied from 375 to 1172, mean = 751). We did not analyze the first 75 trials of each session (50 trials with easy contingencies – see Training – and an additional 25 trials to ensure the rats had reach plateau behavior) and trials with a time investment shorter than 0.6 s (< 3% of trials). For olfactory trials, we ranked stimuli according to their mixture ratio yielding a common evidence strength measure across rats. For auditory trials, we computed the binaural contrast x A = (N Left -N Right )/ (N Left +N Right ) using the number of clicks presented in each trial. Psychometric curves for auditory trials ( Figures 1 C, 2 B, and S1 ) were fitted using the model presented in Figure 2 A, left lower panel. We fitted the center (bias b ) and standard deviation of a cumulative truncated Gaussian distribution as binaural contrast was constrained by definition between −1 and 1: 𝑃 ⁡ ( 𝑐 ⁢ ℎ ⁢ 𝑜 ⁢ 𝑖 ⁢ 𝑐 ⁢ 𝑒 = 1 | ⁢ x , b , 𝜎 ) = Φ ⁡ ( x , b , 𝜎 ) − Φ ⁡ ( − 1 , b , 𝜎 ) Φ ⁡ ( 1 , b , 𝜎 ) − Φ ⁡ ( − 1 , b , 𝜎 ) Where Φ(x, μ , 𝜎 ) is the cumulative density function of the normal distribution of mean μ and standard deviation σ evaluated at point x : Φ ⁡ ( x , 𝜇 , 𝜎 ) = 1 𝜎 ⁢ √ 2 ⁢ 𝜋 ⁢ 𝑥 ∫ − ∞ 𝑒 − ( 𝑡 − μ ) 2 2 ⁢ 𝜎 𝑑 𝑡
We used the fit function in MATLAB to find the parameters μ and σ that minimized the mean squared error. Error bars represent SEM across trials unless otherwise noted.
For the calibration and conditioned psychometric curves ( Figures 1 E, 1G, 1H, and 1J), we restricted our analysis to probe trials to keep the average accuracy equivalent to the rest of the trials. For the vevaiometric curve ( Figures 1 F and 1I), we included correct probe trials or all error trials with time investment longer than two seconds. Data analysis was performed using custom software (MATLAB).
We developed a model-based approach to isolate the contribution of statistical decision confidence to time investment behavior, without requiring the fitting of several free parameters related to subjective valuations that were not explicitly measured, such as opportunity cost ( Lak et al., 2014 43. Lak, A. ∙ Costa, G.M. ∙ Romberg, E. ... Orbitofrontal cortex is required for optimal waiting based on decision confidence Neuron. 2014; 84 :190-201 Full Text Full Text (PDF) Scopus (128) PubMed Google Scholar ). To isolate the confidence computation, we first estimate the perceptual noise and the mapping function between time investment and confidence and then predict the statistically appropriate time investment in each trial.
We used a statistical model of confidence to evaluate if the rats’ time investment behavior reflects an appropriate use of decision confidence ( Hangya et al., 2016; Sanders et al., 2016 29. Hangya, B. ∙ Sanders, J.I. ∙ Kepecs, A. A Mathematical Framework for Statistical Decision Confidence Neural Comput. 2016; 28 :1840-1858 Crossref Scopus (46) PubMed Google Scholar 78. Sanders, J.I. ∙ Hangya, B. ∙ Kepecs, A. Signatures of a Statistical Computation in the Human Sense of Confidence Neuron. 2016; 90 :499-506 Full Text Full Text (PDF) Scopus (145) PubMed Google Scholar ). In our model approach (for details see below), sensory evidence is first transformed into an internal percept, i.e., a noisy representation of the evidence. The percept determines a choice (left or right) and a probability of being correct using a statistical definition of confidence. Confidence is then mapped onto a time investment in a calibration step. To isolate the confidence computation, we estimate the amount of perceptual noise using the animal’s choices and we estimate the calibration function that maps confidence to time investment using the animal’s empirical time investment distribution. This allows us to predict an optimal time investment for each trial that we can compare against the data and models with noise-corrupted confidence values to assess the optimality of time investment behavior.
We defined a generative model for our perceptual decision task by assuming that the percept ̂ 𝑥 is a noisy representation of the evidence strength x (Gaussian noise, i.e., ̂ 𝑥 ∼ 𝒩 ⁡ ( 𝑥 , 𝜎 ) ), and that the choice d is based on the percept alone, by comparing the percept to a decision boundary b (i.e., d = 1 (left choice) for ̂ 𝑥 > b , d = –1 (right choice) otherwise) ( cf. Figure 2 ). Confidence c was defined as the probability of being correct given the subjective level of evidence (percept ̂ 𝑥 ) and choice d , i.e., 𝑐 = 𝑃 ⁡ ( 𝐶 , 𝑜 , 𝑟 , 𝑟 , 𝑒 , 𝑐 , 𝑡 , | , ̂ 𝑥 , , , 𝑑 ) . We can then generate a percept ̂ 𝑥 , choice d , and confidence c for each evidence strength x, for which the confidence c is given by 𝑐 = 0 . 5 * ( 1 , + , 𝑒 , 𝑟 , 𝑓 , | ̂ 𝑥 − 𝑏 | , / , 𝜎 , √ 2 ) ( Lak et al., 2014; Hangya et al., 2016 29. Hangya, B. ∙ Sanders, J.I. ∙ Kepecs, A. A Mathematical Framework for Statistical Decision Confidence Neural Comput. 2016; 28 :1840-1858 Crossref Scopus (46) PubMed Google Scholar 43. Lak, A. ∙ Costa, G.M. ∙ Romberg, E. ... Orbitofrontal cortex is required for optimal waiting based on decision confidence Neuron. 2014; 84 :190-201 Full Text Full Text (PDF) Scopus (128) PubMed Google Scholar ). To arrive at a non-parametric mapping function between confidence c and time investment TI , we matched the rats’ empirical time investment distribution h TI and the model confidence distribution h c . Specifically, we define a mapping function TI = m(c) given by m(c) = H TI -1 ( H c ( c )) with H TI and H c the cumulative distribution functions of empirical time investment and model confidence distributions, respectively. This calibration of confidence to time investment values captures the rats’ subjective cost of time and utility function, which we did not independently measure, without making assumptions about the shape of this mapping function. Importantly, this mapping function recovers any monotonic function between confidence and time investment. This calibration step is entirely agnostic to the appropriate use of confidence in a given trial (i.e., independent of a given x , d ). Thus, model time investment predictions reflect an optimal use of statistical confidence in our generative decision model given a specific amount of perceptual noise σ and given an empirical time investment distribution h TI , i.e., optimal time investment is given by TI opt = m(c). Note that optimality in this context refers to an optimal use of statistical confidence to maximize reward rate. Since we did not independently determine the cost of time and reward utility, we cannot make any claims about maximization of subjective reward value. Therefore, our claim about optimality refers to the statistically correct use of evidence, which is required for a reward maximization strategy. Model predictions can then be evaluated for three key signatures of confidence (calibration curve, vevaiometric curve, and conditioned psychometric curve, cf. Figure 2 ) against the rats’ time investment behavior.
For each rat, we defined the difficulty level x for auditory trials as the binaural contrast x A = (N Left -N Right )/ (N Left +N Right ) . For olfactory trials, we transformed odor mixture ratios (ranging from 5% to 95%) onto a common, continuous axis as the inverse cumulative density function of the standard normal distribution at the percentage of left choices ( d = 1) for each odor mixture ratio, i.e., 𝑥 𝑂 = Φ − 1 ⁢ ( P ⁡ ( l e f t | o d o r r a t i o ) ) ⁢ ( 𝜇 = 0 , 𝜎 = 1 ) . We then fitted each rat’s psychometric function using a Gaussian cumulative distribution with parameters σ (perceptual noise) and b (bias) using the same procedure described above (without truncation). Next, we generated 100,000 model samples using the same evidence strength x as used in behavioral sessions. We then generated model percepts ̂ 𝑥 ( ̂ 𝑥 ∼ 𝒩 ⁡ ( 𝑥 , 𝜎 ) ), choices d (choice function f: 𝑓 ⁡ ( ̂ 𝑥 ) = 1 if ̂ 𝑥 > 0 and 𝑓 ⁡ ( ̂ 𝑥 ) = − 1 if ̂ 𝑥 < 0 ), and confidence values c ( 𝑐 , = , 0 , . , 5 , * , 1 , + , 𝑒 , 𝑟 , 𝑓 , ( | ̂ 𝑥 | , / , 𝜎 , √ 2 ) (note that we simplified equations using b = 0 since bias in all subjects was close to zero). Model confidence and empirical time investment (in probe trials) distributions were estimated using kernel density estimators with standard normal kernels ( ksdensity function in MATLAB) evaluated at 30 points. Cumulative distribution functions were estimated by the cumulative sum of densities and inverse functions were estimated using MATLAB’s quantile function to arrive at a mapping function TI = m(c) . This procedure yielded model time investment prediction TI for each trial, together with a percept ̂ 𝑥 and choice d for a given difficulty level x .
Note that the ‘optimal’ duration of time investment will vary with numerous internal factors, such as the cost of time and reward utility, which we treated as stable in our model. Lacking an independent assessment of these factors it is not possible to conclude whether the specific durations of time investment are overall optimal from the organism’s perspective ( Bach and Dolan, 2012; Constantinople et al., 2019; Dasgupta and Maskin, 2005; Kable and Glimcher, 2009; Richards et al., 1997 2. Bach, D.R. ∙ Dolan, R.J. Knowing how much you don’t know: a neural organization of uncertainty estimates Nat. Rev. Neurosci. 2012; 13 :572-586 Crossref Scopus (236) PubMed Google Scholar 11. Constantinople, C.M. ∙ Piet, A.T. ∙ Brody, C.D. An Analysis of Decision under Risk in Rats Curr. Biol. 2019; 29 :2066-2074.e5 Full Text Full Text (PDF) Scopus (33) PubMed Google Scholar 12. Dasgupta, P. ∙ Maskin, E. Uncertainty and Hyperbolic Discounting Am. Econ. Rev. 2005; 95 :1290-1299 Crossref Scopus (157) Google Scholar 33. Kable, J.W. ∙ Glimcher, P.W. The neurobiology of decision: consensus and controversy Neuron. 2009; 63 :733-745 Full Text Full Text (PDF) Scopus (646) PubMed Google Scholar 67. Richards, J.B. ∙ Mitchell, S.H. ∙ de Wit, H. ... Determination of discount functions in rats with an adjusting-amount procedure J. Exp. Anal. Behav. 1997; 67 :353-366 Crossref Scopus (339) PubMed Google Scholar ). Nevertheless, we kept reward and time contingencies constant, so that we could evaluate whether variations in time investment reflected an optimal use of sensory evidence, i.e., statistical decision confidence.
After animals were fully trained, we implanted micro-drives for tetrode recordings under general anesthesia (2%–3% isoflurane, VetOne) in 6 rats. We stereotactically implanted custom-built micro-drives with 32 or 64 channels in the left OFC (target coordinates: +3.7 mm AP; 3.2 mm ML; –2.8 mm DV). Individual tetrodes were custom-made from four twisted polyimide-coated nichrome wires with 12 μm diameter (Sandvik AB). Wires were gold plated to a final impedance of 200–300 kOhm and organized in 2–4 independently movable bundles of 4 tetrodes each. After post-surgery recovery and analgesics (5 mg/kg ketoprofen) of at least 7 days, we started behavioral sessions and extracellular recordings by attaching a weight-balanced tether cable to the microdrive’s electrical interface board while the rat was in the behavioral chamber. Voltage signals were first amplified using a unity-gain op-amp preamplifier fitted to the microdrive and subsequently digitized at 32,556 Hz (DigiLynx, Neuralynx) using Cheetah software (Neuralynx). Behavioral event pulses were generated by the behavioral control system (Bpod, Sanworks, NY) and recorded by Cheetah. After each recording session, we advanced tetrode bundles by at least 40 μm.
Single units were clustered using the automated clustering platform MountainSort (Simons Foundation, NY) ( Chung et al., 2017; Magland and Barnett, 2015 9. Chung, J.E. ∙ Magland, J.F. ∙ Barnett, A.H. ... A Fully Automated Approach to Spike Sorting Neuron. 2017; 95 :1381-1394.e6 Full Text Full Text (PDF) Scopus (242) PubMed Google Scholar 48. Magland, J.F. ∙ Barnett, A.H. Unimodal clustering using isotonic regression: ISO-SPLIT 2015 1-29 Google Scholar ). Continuously sampled data for each tetrode was bandpass-filtered (300 Hz–6,000 Hz) and normalized removing correlations between individual leads of one tetrode. Subsequently, events with negative voltage deflections were detected by thresholding normalized voltage signals at three standard deviations. Extracted events (event width of 1.67 ms) were clustered using a non-parametric, density-based clustering algorithm (ISO-SPLIT), which clusters individual events based on their representation in a low-dimensional feature space ( Magland and Barnett, 2015 48. Magland, J.F. ∙ Barnett, A.H. Unimodal clustering using isotonic regression: ISO-SPLIT 2015 1-29 Google Scholar ). Subsequently, we manually evaluated each sorted cluster based on several cluster quality metrics. We used MountainSort’s isolation metric ( Chung et al., 2017 9. Chung, J.E. ∙ Magland, J.F. ∙ Barnett, A.H. ... A Fully Automated Approach to Spike Sorting Neuron. 2017; 95 :1381-1394.e6 Full Text Full Text (PDF) Scopus (242) PubMed Google Scholar ), which quantifies how well each cluster is isolated from neighboring clusters using a non-parametric nearest-neighbor approach. Next, we used MountainSort’s noise overlap metric ( Chung et al., 2017 9. Chung, J.E. ∙ Magland, J.F. ∙ Barnett, A.H. ... A Fully Automated Approach to Spike Sorting Neuron. 2017; 95 :1381-1394.e6 Full Text Full Text (PDF) Scopus (242) PubMed Google Scholar ), which quantifies the similarity between each cluster and with randomly chosen events (noise events). Both metrics roughly correspond to the fraction of events overlapping with another cluster (isolation) or noise cluster (noise overlap). In general, we only included clusters with an isolation larger than 0.96 and a noise overlap of less than 0.05. In addition, we carefully inspected the auto-correlogram for each cluster, excluding clusters without a clear dip in their respective auto-correlograms (more than 0.1% events within an inter-spike interval of 1.5 ms). In some instances, we manually merged two clusters which showed a clear dip in their respective cross-correlogram as well as a pairwise low isolation metric (indicating a high cluster overlap) after evaluation of waveform shape and spread. Overall, this procedure ensured that we only analyzed well-isolated clusters considered to be single units.
After finishing recordings, rats were euthanized with pentobarbital and transcardially perfused with saline and 4% paraformaldehyde. Brains were removed and post-fixed in paraformaldehyde for several days. Coronal brain sections with 100-150 μm thickness were prepared using a vibratome. Recording tracks and sites were localized by coating tetrode bundles with fluorescent dye (DiI, Invitrogen) before implantation and/or by targeted electrolytic lesions before perfusion applying 20 μA for 5 s at 1–4 leads.
We recorded from 1593 well-isolated single units in the OFC of six rats. 1211 neurons with an average firing rate above 1 s –1 entered subsequent analyses. Data analysis was performed using custom software (MATLAB).
We only used sessions in which average choice accuracy was above 60% for both modalities. We obtained average activity time courses for single neurons, its spike density function, by computing the mean firing rate across trials within a condition for each time point using time bins of size d t = 10 ms. The resulting time courses were smoothed using a σ = 50 ms Gaussian window. For olfactory trials, difficult trials included neutral trials and the hardest odor ratio. For auditory trials, difficult trials were defined as an absolute value of the binaural contrast smaller than 0.2. The time investment duration bins used to compare time courses in single neuron examples and population averages were 2.5 s < TI < 4 s, 4 s < TI < .5.5 s, 5.5 s < TI < 6.5 s and 6.5 s < TI (We only used trials in which the time investment was above 2 s). To compute population time courses, we z -scored the values of the single neuron time courses and averaged the activity across the population.
For confidence and time investment tuning, we used the average firing rate in the first two seconds of the reward anticipation period (‘anticipation period’). We did not include trials where rats waited less than 2 s, since we observed that very short waiting times were indicative of low task engagement. Note that rats usually waited substantially longer than 2 s (up to 12 s, mean time investments were 5.3 s after olfactory choices and 5.5 s for auditory choices, see Figures 1 D and 2 B). For the calibration curve, we used probe trials and error trials and resampled the trials to match the behavioral session’s average accuracy. For the firing rate time investment correlation, we fitted a linear model and plotted the model prediction and computed the correlation coefficient ( Figures 4 A ii , 4A iv , S3 A–S3C, S3D vi and S3D viii ).
The outcome prediction indices (OPI) provides a simple scalar measure that captures a critical aspect of confidence, yet outcome prediction could also arise from alternative computational mechanisms such as error detection or recall of past experiences based on the strength of evidence ( Kepecs et al., 2008; Teichert et al., 2014; Yeung and Summerfield, 2012 34. Kepecs, A. ∙ Uchida, N. ∙ Zariwala, H.A. ... Neural correlates, computation and behavioural impact of decision confidence Nature. 2008; 455 :227-231 Crossref Scopus (586) PubMed Google Scholar 86. Teichert, T. ∙ Yu, D. ∙ Ferrera, V.P. Performance monitoring in monkey frontal eye field J. Neurosci. 2014; 34 :1657-1671 Crossref Scopus (28) PubMed Google Scholar 95. Yeung, N. ∙ Summerfield, C. Metacognition in human decision-making: confidence and error monitoring Philos. Trans. R. Soc. Lond. B Biol. Sci. 2012; 367 :1310-1321 Crossref Scopus (400) PubMed Google Scholar ). To compute OPI we computed the area under the receiver operating characteristic (auROC) between the average firing rate in the anticipation period for correct and error trials re-scaled from −1 to 1, i.e., OPI = 0 corresponds to zero outcome prediction. Statistical significance was assessed using bootstrap (n = 200), resampling trials with replacement trials each category and defining outcome predictive neurons with OPI different from zero with p < 0.025 in either category. To obtain time investment predictions, we computed the Spearman correlation between the spike density function and time investments across probe and error trials.
The correlation of the OPIs across modalities was strong, albeit not perfect, with some neurons appearing to predict outcome differently for olfactory and auditory decisions. Therefore, we examined whether the correlation was limited by the noise due to low firing rates and trial numbers (trials with time investments longer than 2 s, olfactory trials: n = 169+/−44 and auditory trials: n = 124+/−35). For each neuron, we divided the trials for each modality in half and re-computed outcome prediction indices for each subset of trials. We then computed the correlation within modality across the two subsets of trials. For outcome predictive neurons, the average Pearson correlation for olfactory decisions was r olf = 0.76 ± 0.02 and the average Pearson correlation for auditory decisions was r aud = 0.67 ± 0.02 (average correlation over 200 random partitions, p < 1e-10). This reveals that the variability in the outcome prediction index across modalities is in part constrained by our ability to estimate it. Furthermore, visual examination of neurons that were apparently incoherent in their OPI across modalities are consistent with this interpretation ( Figures S3 C and S3D).
For population tuning curves ( Figures 3 B–3I, 4 C, and 4E), we first z -scored the firing rates of outcome-predictive neurons, computed their tuning curves, and averaged these across neurons.
Confidence-encoding neurons, by definition, are expected to predict confidence-guided time investments, because confidence is determined by the amount of evidence supporting a choice. Therefore, to determine whether confidence-encoding neurons contribute to confidence-guided time investments, we developed measures of firing rate and behavior co-variation that take into account their correlation with the strength of sensory evidence supporting a choice. This is conceptually similar to choice probability analysis (which estimates the probability of predicting the choice from a single neuron’s activity) for determining the contribution of single neurons to binary decisions ( Britten et al., 1996 5. Britten, K.H. ∙ Newsome, W.T. ∙ Shadlen, M.N. ... A relationship between behavioral choice and the visual responses of neurons in macaque MT Vis. Neurosci. 1996; 13 :87-100 Crossref Scopus (808) PubMed Google Scholar ). Using a two-step linear model, we first calculated each neuron’s firing rate not explained by the strength of evidence by taking the residuals of a linear model expressing firing rate as a function of evidence strength.
To quantify the contribution of the firing rates to time investment behavior we considered how well firing rates predicted time investment duration after taking the information provided by the strength of evidence into account. Because time investments provide a continuous measure of decision confidence we used a linear model to analyze the contribution of each neuron’s firing rate to the rats’ time investments after accounting for evidence strength (signed value of the evidence supporting the choice: +1 indicates an easy correct trial while −1 indicates an easy error trial). For olfactory trials we acquired a sufficient number of trials with neutral evidence (50% odor mixture trials) to determine the contribution of neural activity to time investments with uninformative sensory evidence. For these trials the choice is driven by internal noise as there is no sensory evidence to support one choice over the other, and we thus computed the correlation between firing rate and time investment directly. For trials in which there was evidence to support the choice, we built two linear models to remove the contribution of the strength of evidence to both the firing rates and the time investments. One expressed firing rate as a function of evidence strength, and the other expressed time investment as a function of evidence strength. The residuals of these models provided the portion of neuronal firing rate and time investment not explained by evidence strength.
For each trial we remove the linear contribution of the strength of evidence supporting the choice to the firing rate and the time investment. For olfactory trial, we used the ranked difficulty of the trials and uniformly distributed it between −0.95 to 0.95. An easy error trial will have a strength of evidence of −0.95 while an easy correct trial will have an evidence for the choice of 0.95. For auditory trials we used the value of the binaural contrast supporting the choice: Evidence = (N for -N against )/(N for +N against ) . We used the evidence value to build linear models to estimate both the firing rate and the time investments independently for each modality using the following models: 𝐹 ⁢ 𝑖 ⁢ 𝑟 ⁢ 𝑖 ⁢ 𝑛 ⁢ 𝑔 ⁢ 𝑅 ⁢ 𝑎 ⁢ 𝑡 ⁢ 𝑒 = 𝛽 0 , 𝑒 ⁢ 𝑣 + 𝛽 1 , 𝑒 ⁢ 𝑣 · 𝐸 ⁢ 𝑣 ⁢ 𝑖 ⁢ 𝑑 ⁢ 𝑒 ⁢ 𝑛 ⁢ 𝑐 ⁢ 𝑒 𝑇 ⁢ 𝑖 ⁢ 𝑚 ⁢ 𝑒 ⁢ 𝐼 ⁢ 𝑛 ⁢ 𝑣 ⁢ 𝑒 ⁢ 𝑠 ⁢ 𝑡 ⁢ 𝑚 ⁢ 𝑒 ⁢ 𝑛 ⁢ 𝑡 = 𝛽 0 , 𝑡 ⁢ 𝑖 + 𝛽 1 , 𝑡 ⁢ 𝑖 · 𝐸 ⁢ 𝑣 ⁢ 𝑖 ⁢ 𝑑 ⁢ 𝑒 ⁢ 𝑛 ⁢ 𝑐 ⁢ 𝑒
We denote FR evidence and TI evidence the estimated firing rate and time investment respectively. We then compute the residual metrics (firing rate or time investment) by subtracting the estimated value of the metric according to the linear model from the true value of the metric: 𝑅 ⁢ 𝑒 ⁢ 𝑠 ⁢ 𝑖 ⁢ 𝑑 ⁢ 𝑢 ⁢ 𝑎 ⁢ 𝑙 𝐹 ⁢ 𝑅 = 𝐹 ⁢ 𝑖 ⁢ 𝑟 ⁢ 𝑖 ⁢ 𝑛 ⁢ 𝑔 ⁢ 𝑅 ⁢ 𝑎 ⁢ 𝑡 ⁢ 𝑒 − 𝐹 ⁢ 𝑅 𝑒 ⁢ 𝑣 ⁢ 𝑖 ⁢ 𝑑 ⁢ 𝑒 ⁢ 𝑛 ⁢ 𝑐 ⁢ 𝑒 𝑅 ⁢ 𝑒 ⁢ 𝑠 ⁢ 𝑖 ⁢ 𝑑 ⁢ 𝑢 ⁢ 𝑎 ⁢ 𝑙 𝑇 ⁢ 𝐼 = 𝑇 ⁢ 𝑖 ⁢ 𝑚 ⁢ 𝑒 ⁢ 𝐼 ⁢ 𝑛 ⁢ 𝑣 ⁢ 𝑒 ⁢ 𝑠 ⁢ 𝑡 ⁢ 𝑚 ⁢ 𝑒 ⁢ 𝑛 ⁢ 𝑡 − 𝑇 ⁢ 𝐼 𝑒 ⁢ 𝑣 ⁢ 𝑖 ⁢ 𝑑 ⁢ 𝑒 ⁢ 𝑛 ⁢ 𝑐 ⁢ 𝑒
We then used the residual metrics to estimate the contribution of the firing rates to the time investment behavior. 𝑅 ⁢ 𝑒 ⁢ 𝑠 ⁢ 𝑖 ⁢ 𝑑 ⁢ 𝑢 ⁢ 𝑎 ⁢ 𝑙 𝑇 ⁢ 𝐼 = 𝛽 0 , 𝑟 ⁢ 𝑒 ⁢ 𝑠 + 𝛽 1 , 𝑟 ⁢ 𝑒 ⁢ 𝑠 · 𝑅 ⁢ 𝑒 ⁢ 𝑠 ⁢ 𝑖 ⁢ 𝑑 ⁢ 𝑢 ⁢ 𝑎 ⁢ 𝑙 𝐹 ⁢ 𝑅
In Figures 7 E and 7F, we analyze the spearman correlation between the values of 𝛽 1 , 𝑟 ⁢ 𝑒 ⁢ 𝑠 across modalities.
For the time investment decoding analysis ( Figure 5 ) we constructed a linear predictor of the time investment for each session by using the neurons simultaneously recorded in a given session. For stability reasons, we only used sessions (n sessions = 94 out of 119) with more than 50 auditory and 50 olfactory trials with a time investment superior to 2 s leading to a decision to leave (excluding rewarded trials). For each neuron, we used the firing rate in the anticipation period (2 s after entry in choice port) and we excluded neurons with an average firing rate below 1 s –1 over the whole session. We used the MATLAB function stepwiselm to construct an estimate of the time investment on each trial given simultaneously recorded neurons (n neurons = 7.7 ± 6.1). To avoid overfitting and lack of generalization, the linear model only used a neuron as predictor if adding the neuron would decrease the Akaike information criterion (AIC). We used a ten-fold cross-validation procedure ( Cohen et al., 2011 10. Cohen, J.R. ∙ Asarnow, R.F. ∙ Sabb, F.W. ... Decoding continuous variables from neuroimaging data: basic and clinical applications Front. Neurosci. 2011; 5 :75 Crossref Scopus (32) PubMed Google Scholar ) to compute estimates of time investment for each trial. For each session we computed the Spearman correlation between predicted time investment and observed time investment as a measure of the quality of the decoding. For each session and for each of the ten partitions, we inferred two decoders: One trained on 90% of the olfactory trials and one trained on 90% of the auditory trials. We then tested the decoders on the remaining 10% of the trials. The comparison was performed on sessions in which the decoders used at least one neuron on average (n sessions = 59). To assess the significance of the decoding quality between two conditions across sessions we computed a two-sample Kolmogorov-Smirnov test one the distribution of session-wise correlations and corrected for multiple comparisons (Bonferroni correction).
For time course analyses ( Figure 7 ), we normalized variable time periods of the trials (pre-stimulus delay, stimulus sampling period and movement period). The number of time bins used for these period in the spike density function was matched to the mean duration of those epochs across all trials (see Figure 10 in ( Kobak et al., 2016 38. Kobak, D. ∙ Brendel, W. ∙ Constantinidis, C. ... Demixed principal component analysis of neural population data eLife. 2016; 5 :1-37 Crossref Scopus (280) Google Scholar )). We used a time bin of 10 ms and the lengths of the time normalized epochs were as follows: pre-stimulus delay: 30 time bins; stimulus sampling period: 35 time bins; movement period: 30 time bins. To assess the neurons’ overall time course ( Figures 7 A–7D), we normalized each neuron to its peak activity. We then sorted neurons according to the time point of the peak activity for olfactory trials. We used the same sorting order for auditory trials. For the early stage plot ( Figures 7 A and 7B) we used the time from choice port entry to the first 2 s of time investment (unnormalized). For the late stage ( Figures 7 C and 7D), we did not use time normalization and used the last 3 s of the time investment and 750 ms after outcome reveal (reward or decision to leave).
For OPI and time investment prediction time courses, we computed OPI and the correlation between firing rates and time investment in each time bin separately. We sorted neurons according to their average outcome prediction index in the anticipation period based on olfactory trials only ( Figure 7 E). Although sorted based on their olfactory selectivity, OPIs for auditory trials were similar to olfactory trials ( Figure 7 F). Next, we quantified each neuron’s ability to predict time investment separately for each sensory modality and time point ( Figures 7 G and 7H). We sorted neurons according to the strength of the correlation between the anticipation period firing rates and time investments based on olfactory trials only ( Figure 7 G). Although sorted based on their correlation during olfactory trials, correlations between firing rate and time investments for auditory trials were similar to olfactory trials ( Figure 7 H).
To assess the difference in the time course of the correlation across modalities of the outcome prediction indices and the time investment correlations we performed a bootstrap analysis ( Figure S7 E). We perform 200 runs by subsampling the neuronal population by 50% and computed the cross-correlation between outcome prediction indices and time investment correlations across the sub-population (diagonal of Figures S7 C and S7D). We smoothed the resulting correlations using a moving average (5 time bins) and to assess how time courses differed, we computed an area under the ROC measure the ability to discriminate at a given time point whether a given time course was from the outcome prediction index or time investment correlation. The green bar indicate in Figure S7 E indicates an area under the ROC above 0.975.
In order to analyze the simultaneous coding of different task variables, we implemented a GLM using the spike density function presented above (See section Analysis of neuronal data ). For each neuron and at each time point, the model attempts to fit the following equation to the spike density. The fit is done using the MATLAB function fitglm and is performed independently for olfactory and auditory trials: 𝑆 ⁢ 𝑝 ⁢ 𝑖 ⁢ 𝑘 ⁢ 𝑒 ⁢ 𝐷 ⁢ 𝑒 ⁢ 𝑛 ⁢ 𝑠 ⁢ 𝑖 ⁢ 𝑡 ⁢ 𝑦 ( 𝑡 ) = 𝛽 𝐵 ⁢ 𝑎 ⁢ 𝑠 ⁢ 𝑒 ⁢ 𝑙 ⁢ 𝑖 ⁢ 𝑛 ⁢ 𝑒 ⁡ ( 𝑡 ) + 𝛽 𝐶 ⁢ ℎ ⁢ 𝑜 ⁢ 𝑠 ⁢ 𝑒 ⁢ 𝑛 ⁢ 𝑆 ⁢ 𝑖 ⁢ 𝑑 ⁢ 𝑒 ⁡ ( 𝑡 ) · 𝐶 ⁢ ℎ ⁢ 𝑜 ⁢ 𝑠 ⁢ 𝑒 ⁢ 𝑛 ⁢ 𝑆 ⁢ 𝑖 ⁢ 𝑑 ⁢ 𝑒 + 𝛽 𝐸 ⁢ 𝑣 ⁢ 𝑖 ⁢ 𝑑 ⁢ 𝑒 ⁢ 𝑛 ⁢ 𝑐 ⁢ 𝑒 ⁢ 𝐹 ⁢ 𝑜 ⁢ 𝑟 ⁢ 𝐶 ⁢ ℎ ⁢ 𝑜 ⁢ 𝑖 ⁢ 𝑐 ⁢ 𝑒 ⁡ ( 𝑡 ) · 𝐸 ⁢ 𝑣 ⁢ 𝑖 ⁢ 𝑑 ⁢ 𝑒 ⁢ 𝑛 ⁢ 𝑐 ⁢ 𝑒 ⁢ 𝐹 ⁢ 𝑜 ⁢ 𝑟 ⁢ 𝐶 ⁢ ℎ ⁢ 𝑜 ⁢ 𝑖 ⁢ 𝑐 ⁢ 𝑒 + 𝛽 𝑂 ⁢ 𝑢 ⁢ 𝑡 ⁢ 𝑐 ⁢ 𝑜 ⁢ 𝑚 ⁢ 𝑒 ⁡ ( 𝑡 ) · 𝑂 ⁢ 𝑢 ⁢ 𝑡 ⁢ 𝑐 ⁢ 𝑜 ⁢ 𝑚 ⁢ 𝑒 + 𝛽 𝐸 ⁢ 𝑣 ⁢ 𝑖 ⁢ 𝑑 ⁢ 𝑒 ⁢ 𝑛 ⁢ 𝑐 ⁢ 𝑒 ⁡ ( 𝑡 ) · 𝐸 ⁢ 𝑣 ⁢ 𝑖 ⁢ 𝑑 ⁢ 𝑒 ⁢ 𝑛 ⁢ 𝑐 ⁢ 𝑒
The factor β Baseline (t) captures the variation in the firing rate that is not captured by the other task-relevant variables, for example, a neuron could increase its activity when entering a port but there could be no information in this activity about the sensory evidence or the identity of the port. The factor β ChosenSide (t) captures the contribution of the side (left or right) that the animal chooses to the firing rate. The factor β EvidenceForChoice (t) captures the contribution of the strength of the evidence for the chosen side to the firing rate. An easy correct trial would correspond to a strength of evidence for the chosen side of 1 while an easy error trial would correspond to a strength of evidence for the chosen side of −1. The factor β Outcome (t) captures the contribution of the accuracy of the choice to the firing rate. The factor β Evidence (t) captures the contribution of the sensory evidence to the firing rate.
For the choice period analysis ( Figures 7 I–7K), the normalized coefficients were obtained as follow: for β EvidenceForChoice and β outcome , we used +β for neurons belonging to the confidence (+) population and - β for neurons belonging to the confidence(–) population. For β ChosenSide , we used +β ChosenSide for neurons that were right selective in the anticipation period and – β ChosenSide for neurons that were left selective in the anticipation period. For Figure 7 K we smoothed the spike density functions with a moving window average with a window of 20 time steps (200ms) before computing cross-temporal correlations.
For the outcome period analysis ( Figure 7 L), we used the sign of the Reward Index (RI) to normalize the coefficient. A positive reward index indicated higher firing in rewarded trials and negative index indicated higher firing in unrewarded trials. We normalized the parameters for β EvidenceForChoice and β outcome using +β for positive RI and –β for neurons with negative RI. For β ChosenSide , we used side selectivity on the outcome period.
Perceptual choices can be biased by past experience through reward-based learning mechanisms. We quantified the degree to which rats biased their choices based by splitting trials according to whether the previous correct choice was ‘left’ or ‘right’ separately for olfactory and auditory trials ( Figures 6 B and 6F) pooling all trials from all recording sessions (same sessions as above). We quantified choice updating by calculating the probability of repeating the same choice (previous correct trial) considering all four possible sensory-modality transitions (olfactory-to-olfactory, olfactory-to-auditory, auditory-to-auditory, auditory-to-olfactory) ( Figures 6 C and 6G). We assessed different predictors on repeating a choice, namely evidence for choice (β 1 ) in the current trial k , previous trial’s evidence (β 2 ), and a constant term (β 0 ) using a logistic regression model ( f is the logistic function): 𝑅 ⁢ 𝑒 ⁢ 𝑝 ⁢ 𝑒 ⁢ 𝑎 ⁢ 𝑡 𝑘 = 𝑓 ⁡ ( 𝛽 0 + 𝛽 1 · 𝐸 ⁢ 𝑣 ⁢ 𝑖 ⁢ 𝑑 ⁢ 𝑒 ⁢ 𝑛 ⁢ 𝑐 ⁢ 𝑒 𝑘 + 𝛽 2 · 𝐸 ⁢ 𝑣 ⁢ 𝑖 ⁢ 𝑑 ⁢ 𝑒 ⁢ 𝑛 ⁢ 𝑐 ⁢ 𝑒 𝑘 − 1 )
We assessed whether confidence encoding neurons predicted choice updating using the same logistic regression model adding a firing rate term (β 3 ) (average firing rate of confidence encoding neurons in each trial) and an interaction term (not shown): 𝑅 ⁢ 𝑒 ⁢ 𝑝 ⁢ 𝑒 ⁢ 𝑎 ⁢ 𝑡 𝑘 = 𝑓 ⁡ ( 𝛽 0 + 𝛽 1 · 𝐸 ⁢ 𝑣 ⁢ 𝑖 ⁢ 𝑑 ⁢ 𝑒 ⁢ 𝑛 ⁢ 𝑐 ⁢ 𝑒 𝑘 + 𝛽 2 · 𝐸 ⁢ 𝑣 ⁢ 𝑖 ⁢ 𝑑 ⁢ 𝑒 ⁢ 𝑛 ⁢ 𝑐 ⁢ 𝑒 𝑘 − 1 + 𝛽 3 · 𝐹 ⁢ 𝑖 ⁢ 𝑟 ⁢ 𝑖 ⁢ 𝑛 ⁢ 𝑔 𝑘 − 1 )
We assessed whether firing rate added explanatory power to this model by calculating the change in Akaike information criterion (AIC), a measure to compare model quality that considers the different number of free parameters. We compared AIC of this model with a model omitting firing rates and used bootstrap to calculate statistical significance.
Trial-history dependent choice updating can be explained by reinforcement learning models. In perceptual decisions there is no overt learning after subjects are proficient in the task. Nevertheless, choice biases based on past trial’s outcome are still prevalent even in perceptual decision tasks. To explain this phenomenon, we used a reinforcement learning model that used a perceptual belief state to learn about action values (‘left’ or ‘right’). This model produced confidence-scaled prediction errors that are used to update state values, therefore resulting in confidence-dependent choice biases in the next trial.
We used a temporal difference reinforcement learning model as previously described ( Lak et al., 2017, 2020 44. Lak, A. ∙ Nomoto, K. ∙ Keramati, M. ... Midbrain Dopamine Neurons Signal Belief in Choice Accuracy during a Perceptual Decision Curr. Biol. 2017; 27 :821-832 Full Text Full Text (PDF) Scopus (93) PubMed Google Scholar 46. Lak, A. ∙ Okun, M. ∙ Moss, M.M. ... Dopaminergic and Prefrontal Basis of Learning from Sensory Confidence and Reward Value Neuron. 2020; 105 :700-711.E6 Full Text Full Text (PDF) Scopus (72) PubMed Google Scholar ). In brief, subjects made a left ( L ) or right ( R ) choice by a greedy policy selecting the action ( L or R ) which maximizes action values Q (i.e., Q L or Q R ). In each trial, Q was given by stored action values V weighed by the subjective probability of receiving a reward at the left or right port p : Q L = p L ⋅ V L and Q R = p R ⋅ V R . Similar to our perceptual decision model (see above), p R represents the probability of the stimulus x being on the right side of the decision boundary b based on the subjective percept ̂ 𝑥 , the noisy representation of the sensory evidence, i.e., 𝑝 𝑅 = 𝑃 ⁡ ( 𝑥 , > , 𝑏 , | , ̂ 𝑥 ) and analogous for p L ). The outcome of a trial is thus choice d ( L or R ), decision confidence c = p d and predicted value Q d .
After a reward r , the prediction error is given by δ = r – Q d . Choice values V are updated according to a learning rule: V d ← V d + αδ, where α is the learning rate. For simplicity, this model does not include temporal discounting. We ran this model for 3,000,000 trials with α = 0.5, r = 1 for correct trials, initial action values Q L = Q R = 0.5, and producing a percept in each trial according to ̂ 𝑥 ∼ 𝒩 ⁡ ( 𝑥 , 𝜎 ) with σ = 0.2 (perceptual noise) and used the last 100,000 trials for plots.
Potential slow drifts in choice bias could lead to similar behavioral patterns in choice updating as observed here ( Lak et al., 2020 45. Lak, A. ∙ Hueske, E. ∙ Hirokawa, J. ... Reinforcement biases subsequent perceptual decisions when confidence is low, a widespread behavioral phenomenon eLife. 2020; 9 :1-33 Crossref Scopus (52) Google Scholar ). Slow drifts in choice bias will be observed in a sequence of trials both before and after a rewarded trial and can therefore be isolated by calculating the choice bias conditioned on the subsequent trial’s choice. In a control analysis quantifying the influence of a slow drift in choice bias across trials we did not observe strong or systematic slow drifts in choice bias in either modality transition ( Figure S6 J).
OFC has also been implicated in the control of impulsivity, compulsivity and addictive behaviors ( Feil et al., 2010; Fineberg et al., 2010; Gillan and Robbins, 2014; Pascoli et al., 2018; Schoenbaum et al., 2006 17. Feil, J. ∙ Sheppard, D. ∙ Fitzgerald, P.B. ... Addiction, compulsive drug seeking, and the role of frontostriatal mechanisms in regulating inhibitory control Neurosci. Biobehav. Rev. 2010; 35 :248-275 Crossref Scopus (266) PubMed Google Scholar 19. Fineberg, N.A. ∙ Potenza, M.N. ∙ Chamberlain, S.R. ... Probing compulsive and impulsive behaviors, from animal models to endophenotypes: a narrative review Neuropsychopharmacology. 2010; 35 :591-604 Crossref Scopus (501) PubMed Google Scholar 24. Gillan, C.M. ∙ Robbins, T.W. Goal-directed learning and obsessive-compulsive disorder Philos. Trans. R. Soc. Lond. B Biol. Sci. 2014; 369 Crossref Scopus (241) PubMed Google Scholar 63. Pascoli, V. ∙ Hiver, A. ∙ Van Zessen, R. ... Stochastic synaptic plasticity underlying compulsion in a model of addiction Nature. 2018; 564 :366-371 Crossref Scopus (116) PubMed Google Scholar 79. Schoenbaum, G. ∙ Roesch, M.R. ∙ Stalnaker, T.A. Orbitofrontal cortex, decision-making and drug addiction Trends Neurosci. 2006; 29 :116-124 Full Text Full Text (PDF) Scopus (371) PubMed Google Scholar ). It has been suggested that the role of OFC in reversal learning or delay discounting could mediate these effects ( Chamberlain et al., 2008; Mar et al., 2011 8. Chamberlain, S.R. ∙ Menzies, L. ∙ Hampshire, A. ... Orbitofrontal dysfunction in patients with obsessive-compulsive disorder and their unaffected relatives Science. 2008; 321 :421-422 Crossref Scopus (442) PubMed Google Scholar 49. Mar, A.C. ∙ Walker, A.L.J. ∙ Theobald, D.E. ... Dissociable effects of lesions to orbitofrontal cortex subregions on impulsive choice in the rat J. Neurosci. 2011; 31 :6398-6404 Crossref Scopus (174) PubMed Google Scholar ) and single unit recordings in both rodents and monkeys have shown that valuation due to reward size and time discounting are encoded in OFC ( Roesch and Olson, 2005; Roesch et al., 2006 68. Roesch, M.R. ∙ Olson, C.R. Neuronal activity in primate orbitofrontal cortex reflects the value of time J. Neurophysiol. 2005; 94 :2457-2471 Crossref Scopus (127) PubMed Google Scholar 69. Roesch, M.R. ∙ Taylor, A.R. ∙ Schoenbaum, G. Encoding of time-discounted rewards in orbitofrontal cortex is independent of value representation Neuron. 2006; 51 :509-520 Full Text Full Text (PDF) Scopus (243) PubMed Google Scholar ). In our work, the activity in the later stages of the investment period (see Figures 7 C, 7D, and S7 E) supports a contribution of OFC to appropriately sustain confidence or value information from decision to outcome. Perturbation of this process could lead to inability to act on delayed rewards depending on the appropriate value or confidence. The observation that OFC inactivation impairs the ability of rats to invest time according to their confidence, while keeping the mean time investment unchanged ( Lak et al., 2014 43. Lak, A. ∙ Costa, G.M. ∙ Romberg, E. ... Orbitofrontal cortex is required for optimal waiting based on decision confidence Neuron. 2014; 84 :190-201 Full Text Full Text (PDF) Scopus (128) PubMed Google Scholar ), supports this view.
Error bars indicate mean ± SEM unless otherwise noted. Statistical tests and associated p value are reported in the Results or associated Methods sections for data presented in the main Figures and in Supplemental Figure legends or associated Methods section for data presented in Supplemental Figures. All statistical tests were two-sided.

Section: Acknowledgments

We thank members of the Kepecs lab, as well as Michael Lagler, Thomas Klausberger, and Anqi Zhang for comments on an earlier version of this manuscript. We thank Barry Burbach and Rob Eifert for technical help. This research was supported by NIH R01DA038209 and R01MH097061 to A.K., by the Deutsche Forschungsgemeinschaft (DFG) OT 562/1-1 to T.O., and by Wellcome Trust grant 213465 to A.L.
P.M. and A.K. designed the experiments. P.M. and J.H. conducted pilot experiments. P.M. and T.O. conducted the experiments. P.M., T.O., A.L., and A.K. performed analyses. P.M., T.O., and A.K. wrote the manuscript with input from A.L. and J.H.
The authors declare no competing interests.
