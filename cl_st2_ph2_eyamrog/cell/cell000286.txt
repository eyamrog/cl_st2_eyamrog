Title: A modular master regulator landscape controls cancer transcriptional identity


Abstract: Summary

Despite considerable efforts, the mechanisms linking genomic alterations to the transcriptional identity of cancer cells remain elusive. Integrative genomic analysis, using a network-based approach, identified 407 master regulator (MR) proteins responsible for canalizing the genetics of individual samples from 20 cohorts in The Cancer Genome Atlas (TCGA) into 112 transcriptionally distinct tumor subtypes. MR proteins could be further organized into 24 pan-cancer, master regulator block modules (MRBs), each regulating key cancer hallmarks and predictive of patient outcome in multiple cohorts. Of all somatic alterations detected in each individual sample, >50% were predicted to induce aberrant MR activity, yielding insight into mechanisms linking tumor genetics and transcriptional identity and establishing non-oncogene dependencies. Genetic and pharmacological validation assays confirmed the predicted effect of upstream mutations and MR activity on downstream cellular identity and phenotype. Thus, co-analysis of mutational and gene expression profiles identified elusive subtypes and provided testable hypothesis for mechanisms mediating the effect of genetic alterations.

Section: Introduction

Our understanding of cancer as a complex system is constantly evolving: in particular, it is increasingly appreciated that the steady-state transcriptional identity (see Glossary in Box 1 ) of a cancer cell is tightly regulated—akin to homeostatic regulation in their physiologic counterparts—albeit via distinct and aberrant (i.e., dystatic) regulatory mechanisms ( Califano and Alvarez, 2017 14. Califano, A. ∙ Alvarez, M.J. The recurrent architecture of tumour initiation, progression and drug sensitivity Nat. Rev. Cancer. 2017; 17 :116-130 Crossref Scopus (130) PubMed Google Scholar ). These mechanisms play a key role in determining non-oncogene dependencies, which transcriptional identities might be compatible with the specific set of somatic and germline variants harbored by each cell, as well as cancer cell plasticity across molecularly distinct identities.
Although some mutations effectively restrict the transcriptional identity repertoire accessible to a cancer cell—for instance, activating mutations in ESR1, FOXA1, and GATA3 are observed almost exclusively in the luminal subtype of breast cancer ( Curtis et al., 2012 23. Curtis, C. ∙ Shah, S.P. ∙ Chin, S.F. ..., METABRIC Group The genomic and transcriptomic architecture of 2,000 breast tumours reveals novel subgroups Nature. 2012; 486 :346-352 Crossref Scopus (4225) PubMed Google Scholar )—many are far less deterministic. In glioblastoma (GBM), for instance, there is only weak association between mutational and transcriptional states ( Neftel et al., 2019 52. Neftel, C. ∙ Laffy, J. ∙ Filbin, M.G. ... An Integrative Model of Cellular States, Plasticity, and Genetics for Glioblastoma Cell. 2019; Full Text Full Text (PDF) Scopus (1253) PubMed Google Scholar ). Despite a number of insightful studies, however, the molecular logic that determines the cancer cell identity as a function of its mutational and exogenous signal landscape remains elusive and largely based on statistical associations.
The Oncotecture Hypothesis ( Califano and Alvarez, 2017 14. Califano, A. ∙ Alvarez, M.J. The recurrent architecture of tumour initiation, progression and drug sensitivity Nat. Rev. Cancer. 2017; 17 :116-130 Crossref Scopus (130) PubMed Google Scholar )—an earlier, cancer-specific equivalent of the Omnigene Hypothesis ( Boyle et al., 2017 10. Boyle, E.A. ∙ Li, Y.I. ∙ Pritchard, J.K. An expanded view of complex traits: from polygenic to omnigenic Cell. 2017; 169 :1177-1186 Full Text Full Text (PDF) Scopus (1720) PubMed Google Scholar )—proposes the existence of tumor-specific master regulator (MR) modules (also known as tumor checkpoints) responsible for integrating the effect of mutations and aberrant signals in upstream pathways, thus determining a tumor’s transcriptional identity; see Califano and Alvarez (2017) 14. Califano, A. ∙ Alvarez, M.J. The recurrent architecture of tumour initiation, progression and drug sensitivity Nat. Rev. Cancer. 2017; 17 :116-130 Crossref Scopus (130) PubMed Google Scholar for a recent perspective. Thus, MR analysis might help elucidate mechanisms responsible for implementing and maintaining the transcriptional identity of cancer cells, as a function of their mutational landscape, and for plastically reprogramming across distinct identities.
To study MR modularity and genetic drivers in 9,738 samples in The Cancer Genome Atlas (TCGA) ( Weinstein et al., 2013 81. Weinstein, J.N. ∙ Collisson, E.A. ∙ Mills, G.B. ..., Cancer Genome Atlas Research Network The Cancer Genome Atlas Pan-Cancer analysis project Nat. Genet. 2013; 45 :1113-1120 Crossref Scopus (5356) PubMed Google Scholar ), on a sample-by-sample basis, we developed Multi-omics Master-Regulator Analysis (MOMA). MOMA integrates gene expression and genomic alterations profiles to identify MR proteins and MR modules that represent the key effectors of a tumor’s mutational landscape and are thus responsible for implementing its associated cancer cell identity.
MOMA ( Paull et al., 2020b 55. Paull, E.O. ∙ Brennan, C. ∙ Jones, S. ... MOMA: Multi Omic Master Regulator Analysis. R Package V1.0.2 2020 https://bioconductor.org/packages/release/bioc/html/MOMA.html Google Scholar ) can be accessed on Bioconductor ( Gentleman et al., 2004 29. Gentleman, R.C. ∙ Carey, V.J. ∙ Bates, D.M. ... Bioconductor: open software development for computational biology and bioinformatics Genome Biol. 2004; 5 :R80 Crossref PubMed Google Scholar ), thus allowing analysis of virtually any cancer cohort of interest, for which patient-matched transcriptional and mutational profiles are available. In addition, the MOMA web application ( Paull et al., 2020a 54. Paull, E.O. ∙ Brennan, C. ∙ Jones, S. ... MOMA Web App V1.0 2020 http://MR-graph.org Google Scholar ) provides interactive access to all results reported by this manuscript.

Section: Results

The MOMA framework is shown in both a simplified ( Figures 1 A–1C) and a detailed ( Figure S1 A–S1E) conceptual workflow. Briefly, gene expression profiles from 20 TCGA cohorts ( Table S1 ) were first transformed to protein activity profiles by using the Virtual Proteomics by Enriched Regulon Analysis (VIPER) algorithm ( Alvarez et al., 2016 1. Alvarez, M.J. ∙ Shen, Y. ∙ Giorgi, F.M. ... Functional characterization of somatic mutations in cancer using network-based inference of protein activity Nat. Genet. 2016; 48 :838-847 Crossref Scopus (498) PubMed Google Scholar ) (step 1) ( Figure S1 B). Candidate MR proteins were then identified by Fisher’s integration of p values from (1) their VIPER-measured activity, (2) functional genetic alterations in their upstream pathways by Driver-Gene Inference by Genetical-Genomic Information Theory (DIGGIT) analysis ( Chen et al., 2014 18. Chen, J.C. ∙ Alvarez, M.J. ∙ Talos, F. ... Identification of causal genetic drivers of human disease through systems-level analysis of regulatory networks Cell. 2014; 159 :402-414 Full Text Full Text (PDF) Scopus (146) PubMed Google Scholar ), and (3) additional structure and literature-based evidence supporting direct protein-protein interactions between MRs and proteins harboring genetic alterations, via the Predicting Protein-Protein Interactions (PrePPI) algorithm ( Zhang et al., 2012 85. Zhang, Q.C. ∙ Petrey, D. ∙ Deng, L. ... Structure-based prediction of protein-protein interactions on a genome-wide scale Nature. 2012; 490 :556-560 Crossref Scopus (564) PubMed Google Scholar ) (steps 2 and 3) ( Figure S1 C). We used the vector of integrated (Log_10 p) 2 (MOMA scores) to weigh each MR’s contribution in a tumor subtype clustering step (step 4) ( Figure S1 D). Finally, genomic saturation analysis upstream of top candidate MRs identified those most likely to control the subtype transcriptional identity (step 5) ( Figure S1 D). Finally, this was followed by identification and functional characterization of MR block sub-modules, termed MR-Blocks (MRBs), recurring across multiple subtypes (step 6) ( Figure S1 E). See STAR methods for a detailed description of each step.
Somatic genomic alterations considered by the analysis include single nucleotide variants and small indels (SNVs), as well as somatic copy number alterations (SCNAs) from the Broad TCGA Firehose pipeline, and fusion events (FUSs) reported by Pipeline for RNA-Sequencing Data Analysis (PRADA) ( Torres-García et al., 2014 76. Torres-García, W. ∙ Zheng, S. ∙ Sivachenko, A. ... PRADA: pipeline for RNA sequencing data analysis Bioinformatics. 2014; 30 :2224-2226 Crossref Scopus (121) PubMed Google Scholar ) ( STAR methods ). Alternative or complementary algorithms can be easily incorporated into MOMA, for instance to integrate the effect of germline variants, epigenetic alterations, or extracellular signals.
VIPER has been extensively validated as an accurate methodology to measure a protein’s activity, on the basis of the enrichment of its tissue-specific activated and repressed transcriptional targets (regulon) in over and under-expressed genes ( Alvarez et al., 2016 1. Alvarez, M.J. ∙ Shen, Y. ∙ Giorgi, F.M. ... Functional characterization of somatic mutations in cancer using network-based inference of protein activity Nat. Genet. 2016; 48 :838-847 Crossref Scopus (498) PubMed Google Scholar )—i.e., akin to a highly multiplexed gene-reporter assay. To generate accurate regulons for 2,506 regulatory proteins annotated as transcription factors (TFs) and co-transcription factors (co-TFs) in Gene Ontology (GO) ( Ashburner et al., 2000 3. Ashburner, M. ∙ Ball, C.A. ∙ Blake, J.A. ..., The Gene Ontology Consortium Gene ontology: tool for the unification of biology Nat. Genet. 2000; 25 :25-29 Crossref Scopus (30823) PubMed Google Scholar ; The Gene Ontology Consortium, 2019 72. The Gene Ontology Consortium The Gene Ontology Resource: 20 years and still GOing strong Nucleic Acids Res. 2019; 47 :D330-D338 Crossref Scopus (2884) PubMed Google Scholar ), we used Algorithm for the Reconstruction of Accurate Cellular Networks (ARACNe) ( Basso et al., 2005 6. Basso, K. ∙ Margolin, A.A. ∙ Stolovitzky, G. ... Reverse engineering of regulatory networks in human B cells Nat. Genet. 2005; 37 :382-390 Crossref Scopus (1131) PubMed Google Scholar ); see STAR methods for ARACNe and VIPER accuracy metrics.
For each candidate MR, we first identified candidate upstream modulator proteins by using the Conditional Inference of Network Dynamics (CINDy) algorithm ( Giorgi et al., 2014 30. Giorgi, F.M. ∙ Lopez, G. ∙ Woo, J.H. ... Inferring protein modulation from gene expression data using conditional mutual information PLoS ONE. 2014; 9 :e109569 Crossref Scopus (19) PubMed Google Scholar ) and then assessed whether the presence of genomic alterations in their encoding genes was associated with differential MR activity (activity Quantitative Trait Locus analysis [aQTL]). These two steps comprise the DIGGIT algorithm, which was highly effective in elucidating key driver mutations missed by prior analyses in GBM ( Chen et al., 2014 18. Chen, J.C. ∙ Alvarez, M.J. ∙ Talos, F. ... Identification of causal genetic drivers of human disease through systems-level analysis of regulatory networks Cell. 2014; 159 :402-414 Full Text Full Text (PDF) Scopus (146) PubMed Google Scholar ).
MOMA was used to analyze 9,738 primary samples, from 20 TCGA tumor cohorts (with n ≥ 100 samples) ( Table S1 ). Minimum cohort size reflected the need to generate accurate regulatory network models by using the ARACNe algorithm ( Basso et al., 2005 6. Basso, K. ∙ Margolin, A.A. ∙ Stolovitzky, G. ... Reverse engineering of regulatory networks in human B cells Nat. Genet. 2005; 37 :382-390 Crossref Scopus (1131) PubMed Google Scholar ). To identify tumor subtypes representing distinct transcriptional tumor identities regulated by the same MR proteins, we performed partitioning around medioids clustering (PAM) ( Park and Jun, 2009 53. Park, H.S. ∙ Jun, C.H. A simple and fast algorithm for K-medoids clustering Expert Syst. Appl. 2009; 36 :3336-3341 Crossref Scopus (1591) Google Scholar ), based on protein activity profile similarity between samples, after each protein was weighted by its cohort-specific, integrated MOMA Score ( STAR methods ). Proteins with more functional mutations in their upstream pathways were deemed more likely determinants of tumor subtype identity and provided greater weight to the clustering solution. Within each cohort, the optimal number of clusters was determined by using a cluster reliability score (CRS) ( Figure 2 A; STAR methods ). Using identical approaches, MR-based clustering outperformed expression-based clustering in all 20 cohorts (p < 2.2 × 10 −16 in all but the SKCM cohort, p ≤ 1.8 × 10 −8 ), by 1-tail Wilcoxon rank sum test of sample Silhouette scores (SS) ( Rousseeuw, 1987 64. Rousseeuw, P.J. Silhouettes - a Graphical Aid to the Interpretation and Validation of Cluster-Analysis J. Comput. Appl. Math. 1987; 20 :53-65 Crossref Scopus (12710) Google Scholar ) ( Figure 2 B). Indeed, a majority of samples clustered by expression-based analysis had SS ≤ 0.25—a value generally used as a threshold for statistical significance ( Rousseeuw, 1987 64. Rousseeuw, P.J. Silhouettes - a Graphical Aid to the Interpretation and Validation of Cluster-Analysis J. Comput. Appl. Math. 1987; 20 :53-65 Crossref Scopus (12710) Google Scholar ). In contrast, the vast majority of samples clustered by MR-based analysis had SS ≥ 0.25 ( Figure 2 B).
Solutions ranged from k = 2 to 8 clusters per cohort. Whenever multiple statistically equivalent solutions were identified, the one yielding the best survival stratification was selected ( Table S1 ). The five-cluster solution for kidney renal clear cell carcinoma (KIRC) is shown as an illustrative example ( Figure 2 C), including differential outcome for cluster 5 (worst) versus cluster 3 (best) ( Figure 2 D) (p = 1.1 × 10 −16 ). Equivalent analyses for all cohorts can be accessed via the MOMA web app; see also Figure S2 A and Table S1 . MOMA identified 112 subtypes, representing the stratification of cancer into transcriptional identities regulated by distinct tumor checkpoints ( Figures 2 A and S1 D; Tables S1 , S2 , and S6 ).
MOMA identified subtypes and differential outcome in cohorts that had been previously challenging from a gene-expression analysis perspective. For example, except for the neuroendocrine subtype, expression-based stratification of prostate cancer outcome has been elusive, requiring additional metrics (e.g., Gleason Score [GS]) or assessment of spatial tumor heterogeneity from multiple biopsies ( Berglund et al., 2018 9. Berglund, E. ∙ Maaskola, J. ∙ Schultz, N. ... Spatial maps of prostate cancer transcriptomes reveal an unexplored landscape of heterogeneity Nat. Commun. 2018; 9 :2419 Crossref Scopus (318) PubMed Google Scholar ), which might not be available for all tumors. In contrast, MOMA identified transcriptional clusters presenting statistically significant outcome differences in 19 out of 20 cohorts ( Figures 2 A and S2 A). Even in colon adenocarcinoma (COAD), a clear trend was detected (p = 0.07). Considering the significant improvement in cluster statistics ( Figure 2 B), this suggests that MOMA significantly outperforms expression-based subtype analysis leading to a more granular subtype structure that improves outcome stratification.
Despite its unsupervised nature, MR-based clustering recapitulated established molecular subtypes and outcome differences. In breast cancer, concordance with luminal A, luminal B and triple-negative subtypes was highly significant (p = 2.2 × 10 −16 by χ 2 test) ( Figure S2 B). Similarly, in GBM, MOMA subtypes recapitulated previously published subtypes (p = 2.2 × 10 −16 ) ( Brennan et al., 2013 11. Brennan, C.W. ∙ Verhaak, R.G. ∙ McKenna, A. ..., TCGA Research Network The somatic genomic landscape of glioblastoma Cell. 2013; 155 :462-477 Full Text Full Text (PDF) Scopus (3581) PubMed Google Scholar ), with similar outcome stratification based on activity of established MR proteins, CEBPβ, CEBPδ, and STAT3 ( Carro et al., 2010 15. Carro, M.S. ∙ Lim, W.K. ∙ Alvarez, M.J. ... The transcriptional network for mesenchymal transformation of brain tumours Nature. 2010; 463 :318-325 Crossref Scopus (978) PubMed Google Scholar ) ( Figures S2 B and S2C). Best and worst survival were associated with proneural (p = 3.0 × 10 −6 , by Fisher’s exact test [FET]) and mesenchymal (p = 1.3 × 10 −3 ) tumors, consistent with prior literature ( Brennan et al., 2013 11. Brennan, C.W. ∙ Verhaak, R.G. ∙ McKenna, A. ..., TCGA Research Network The somatic genomic landscape of glioblastoma Cell. 2013; 155 :462-477 Full Text Full Text (PDF) Scopus (3581) PubMed Google Scholar ; Carro et al., 2010 15. Carro, M.S. ∙ Lim, W.K. ∙ Alvarez, M.J. ... The transcriptional network for mesenchymal transformation of brain tumours Nature. 2010; 463 :318-325 Crossref Scopus (978) PubMed Google Scholar ; Chen et al., 2014 18. Chen, J.C. ∙ Alvarez, M.J. ∙ Talos, F. ... Identification of causal genetic drivers of human disease through systems-level analysis of regulatory networks Cell. 2014; 159 :402-414 Full Text Full Text (PDF) Scopus (146) PubMed Google Scholar ). Virtually identical results emerged for FOXM1 and CENPF in prostate cancer, previously validated as synergistic master regulators of aggressive disease ( Aytes et al., 2014 4. Aytes, A. ∙ Mitrofanova, A. ∙ Lefebvre, C. ... Cross-species regulatory network analysis identifies a synergistic interaction between FOXM1 and CENPF that drives prostate cancer malignancy Cancer Cell. 2014; 25 :638-651 Full Text Full Text (PDF) Scopus (251) PubMed Google Scholar ). Prior analyses were performed by pre-selecting genes, for instance by differential expression in best versus worst survival samples (supervised analysis), whereas MOMA is completely unsupervised. Notably, subtype S 6 (poorest outcome), in prostate adenocarcinoma (PRAD), comprises only nine samples—because TCGA is restricted to primary samples at diagnosis—and was thus missed by prior studies.
A tumor checkpoint is defined as a module with the minimum MR repertoire necessary to implement a tumor’s transcriptional identity by canalizing genomic events in its upstream pathways. We thus used saturation analysis to refine the initial ranked-list of subtype-specific proteins produced by MOMA analysis to a small set of candidate MRs that optimally account for the subtype’s genetic landscape ( STAR methods ). By “accounting for an alteration” we mean that it is either harbored by the MR or by proteins upstream of the MR.
If driver mutations occurred mostly in or upstream of tumor checkpoint MRs, saturation should be achieved rapidly, with only few MRs. In contrast, if mutations were randomly distributed, saturation should be very gradual. To test this hypothesis, we considered all previously described genomic events (SNV, SCNA, and FUS). To avoid over counting, we consolidated same-amplicon SCNAs upstream of MRs into single regional events, and further refined these by selecting genomic events identified by Genomic Identification of Significant Targets in Cancer (GISTIC) 2.0. We then plotted the fraction of all such events predicted to be in or upstream of the top n candidate MRs, on a sample by sample basis—averaged over all samples in the same subtype ( Figure 3 A)—and defined the tumor checkpoint as the MR set needed to achieve a predefined saturation threshold in each subtype ( STAR methods ). Finally, we identified 407 recurrent MRs ( Table S2 ) occurring in m ≥ 4 subtypes, a statistical threshold determined by a null hypothesis model ( Figure S3 A; STAR methods ). Of these, 37 were highly recurrent, occurring in m ≥ 15 subtypes ( Figure 3 B). The H3/H4 histone chaperone ASF1B emerged as the most pleiotropic MR (m = 31 subtypes), followed by MYBL2 (m = 30), JUP (m = 29), TOP2A (m = 25), and TRIP13 (m = 25).
Consistent with the tumor checkpoint hypothesis, we observed rapid genomic event saturation in all but 3 subtypes (subtypes S 1 , S 3 , and S 4 of ovarian cancer). For the vast majority, saturation was achieved with very few MRs, starting at n = 4 for thyroid carcinoma (THCA) subtype S 6 . Overall, between 14 and 52 MRs (i.e., 0.6% to 2% of 2,506 transcriptional regulators, respectively) were sufficient to account for the first and third quantile of each sample’s mutational burden, with a median of 33 MRs (1.3% of regulatory proteins). Ovarian cancer was an outlier with 170, 140, and 140 MRs needed to account for the mutations in subtypes S 1 , S 3 , and S 4 , respectively, likely because of the very large number of likely passenger structural events in this cohort. In contrast, when MRs were chosen at random from all transcriptional regulators, saturation increased very gradually with only 0.4% of the events found upstream of 100 randomly selected MRs ( Figure 3 A).
At the saturation point, ∼50% of all genomic events were accounted for, with a ratio of genomic events/MRs ranging from r = 0.02 (i.e., one event affecting 50 MRs) to r = 32 (i.e., 32 events affecting a single MR) and an average of 5 events per MR. This supports the role of tumor checkpoints as regulatory bottlenecks responsible for canalizing upstream mutations and suggests that < 50% of all genomic events might be actual passengers.
To further assess MOMA’s ability to differentiate between driver and passenger events, we assessed the differential enrichment of mutations upstream of MRs in either GISTIC2.0 and CHASM-predicted driver events or all genomic events reported by the TCGA Firehose pipeline (STAR methods). When averaged across all MOMA-inferred subtypes of a specific TCGA cancer cohort, differential enrichment of the former was highly statistically significant across all but the acute myeloid leukemia cohort (LAML); p values ranged from p = 10 −7 to p = 10 −156 ( Figures S3 B and S3C; STAR methods ). This suggests that low SNV and high fusion-event rates might have contributed to the LAML discrepancy, given that CHASM only assesses candidate SNVs. Even though a majority of inferred events were previously unreported, MOMA effectively recovered all but one (RQCD1) of the 200 high-confidence pancancer driver genes reported in ( Bailey et al., 2018 5. Bailey, M.H. ∙ Tokheim, C. ∙ Porta-Pardo, E. ... Comprehensive characterization of cancer driver genes and mutations Cell. 2018; 173 :371-385 Full Text Full Text (PDF) Scopus (1275) PubMed Google Scholar ), as well as 82.3% of the high-confidence, tumor-specific driver genes, averaged across all subtypes (min: 50%, max: 100%) ( Table S3 ).
In COAD, for instance, eight subtypes were identified, including four enriched in MSI High samples (S 2 , S 3 , S 7 , and S 8 ), two dominated by single nucleotide variants but not enriched in MSI High samples (S 1 and S 4 ), and two dominated by focal SCNA events (S 5 and S 6 ). The mutational landscape of these subtypes was highly distinct. For instance, the classic tumor suppressor APC was frequently mutated in all subtypes (S 2 = 39% to S 5 = 93%) except S 8 . Similarly, altogether, mismatch repair genes ( MSH2 , MSH6 , and MLH1 ) were mutated in ∼50% of S 2 but not S 3 samples, whereas BRCA2 was disproportionally mutated in S 3 and several other genes were uniquely or disproportionally mutated in either subtype ( Figures 4 A and 4B). Finally, PI3K pathway mutations were frequent in S 2 and S 3 , yet rarely mutated in other subtypes. In contrast S 5 and S 6 were dominated by focal SCNA events, and several genes mutated exclusively or disproportionately in S 5 , whereas virtually all S 6 mutations were also detected in S 5 ( Figure 4 D). Similar mutational co-segregation differences were detected across virtually all cohort subtypes.
Regional (i.e., non-focal) SCNAs have been largely ignored by previous analyses because of their high gene content. However, the DIGGIT analysis module in MOMA is effective at removing regional SCNA genes that are unlikely to modulate MR activity. When DIGGIT-refined regional SCNAs were included, subtypes became highly homogeneous in terms of their mutational repertoire across patients. Consider, for instance, COAD subtype S 5 where, except for APC Mut/Del , already present in 98% of samples, the top 10 regional events increased in frequency from 12.5% to 84%, when focal and regional SCNAs were analyzed together (bold red, Figure 4 E).
Analysis of existing molecular interaction networks confirmed that tumor checkpoints represent hyperconnected modules, compared with equisized protein sets chosen at random from 2,506 regulatory proteins, as a null model. Networks include HumanNet 2.0 ( Hwang et al., 2019 36. Hwang, S. ∙ Kim, C.Y. ∙ Yang, S. ... HumanNet v2: human gene networks for disease research Nucleic Acids Res. 2019; 47 :D573-D580 Crossref Scopus (145) PubMed Google Scholar ) (p < 5.0 × 10 −42 , by Kolmogorov-Smirnov) ( Figure S4 A), Multinet ( Khurana et al., 2013 41. Khurana, E. ∙ Fu, Y. ∙ Chen, J. ... Interpretation of genomic variants using a unified biological network approach PLoS Comput. Biol. 2013; 9 :e1002886 Crossref Scopus (130) PubMed Google Scholar ) (p < 2.0 × 10 −37 ) ( Figure S4 B), and PrePPI ( Zhang et al., 2012 85. Zhang, Q.C. ∙ Petrey, D. ∙ Deng, L. ... Structure-based prediction of protein-protein interactions on a genome-wide scale Nature. 2012; 490 :556-560 Crossref Scopus (564) PubMed Google Scholar ) (p = 9.0 × 10 −44 ) ( Figure S4 C).
We then tested whether subtype-specific tumor checkpoints might be decomposed into finer-grain MR sub-modules—recurrent across multiple subtypes—representing pancancer core-regulatory structures. Clustering of 407 MRs identified by saturation and recurrence analysis yielded 24 MRBs as an optimal solution ( Figure S5 A), with each MR assigned only to a single MRB ( core-set ). Given that individual TFs might perform different functions, depending on interacting co-partners (e.g., MYC/MAX versus MYC/MIZ-1), we used a “fuzzy” clustering algorithm to further refine core-sets with additional non-unique MRs ( Miyamoto et al., 2008 51. Miyamoto, S. ∙ Ichihashi, H. ∙ Honda, K. ... Algorithms for fuzzy clustering Springer, 2008 Google Scholar ) ( Figures S5 B and S5C; Table S4 ; STAR methods ).
Each tumor checkpoint is thus deconstructed into a specific combination of activated or inactivated MRBs ( Figure 5 A), where the MRB activity is computed as the average activity of all of its MRs. Transcriptional targets of individual MRB MRs were statistically significantly enriched in Cancer Hallmarks ( Drake et al., 2016 26. Drake, J.M. ∙ Paull, E.O. ∙ Graham, N.A. ... Phosphoproteome Integration Reveals Patient-Specific Networks in Prostate Cancer Cell. 2016; 166 :1041-1054 Full Text Full Text (PDF) Scopus (169) PubMed Google Scholar ; Liberzon et al., 2015 47. Liberzon, A. ∙ Birger, C. ∙ Thorvaldsdóttir, H. ... The Molecular Signatures Database (MSigDB) hallmark gene set collection Cell Syst. 2015; 1 :417-425 Full Text Full Text (PDF) Scopus (6412) PubMed Google Scholar ) and KEGG/Reactome categories ( Figures 5 B and S5 D; Table S4 ; STAR methods ). For instance, MRB:7—controlling proliferation and DNA repair programs—and MRB:24—controlling inflammation and immune response programs—are differentially active across subtypes ( Figures 5 A and 5B). Consistently, MRB activity effectively stratified outcome in multiple datasets; see Molecular Taxonomy of Breast Cancer International Consortium (METABRIC) BRCA and TCGA SKCM cohorts, for instance ( Figures 5 C and 5D, respectively). Enrichment of Tumor Hallmarks, KEGG, and Reactome categories in genes altered upstream of each MRB was generic and sparser ( Table S4 ), suggesting that functional specificity is manifested after MRB integration, rather than in the upstream genetics.
We further assessed whether inferred tumor checkpoint MRs were enriched in essential proteins, based on Achilles Project data ( Cowley et al., 2014 22. Cowley, G.S. ∙ Weir, B.A. ∙ Vazquez, F. ... Parallel genome-scale loss of function screens in 216 cancer cell lines for the identification of context-specific genetic dependencies Sci. Data. 2014; 1 :140035 Crossref Scopus (299) PubMed Google Scholar ); see Figure S5 E for a conceptual workflow. Specifically, cell lines optimally matching MOMA-inferred subtypes were identified by protein activity analysis ( STAR methods ). Essentiality was then assessed on the basis of Achilles’ score in matched cell lines. Overall, MRs were highly enriched in essential genes (n = 141, p = 7.1 × 10 −6 ) ( Figure S5 F), based on 10 6 random selections of the same number of regulatory proteins for each subtype.
We then tested MRB-specific essentiality. As expected, those most enriched for cell viability hallmarks, such as MRB:2, MRB:3, and MRB:7 ( Figure 5 B) were most enriched in essential MRs (50%, 43.8%, and 30.4%, respectively), including proteins such as E2F1, E2F2, E2F7, TOP2A, PTTG1, FOXM1, MYBL2, UHRF1, DNMT3B, ZNF695, TCF19, RBL1, and ZNF367. Interestingly, essentiality was also prominent in other MRBs, including 31% of MRs in MRB:6 (ZNF436, HES1, HOXB7, TP63, TRIM29, GRHL1, PBX4, IKZF2, RARG, IRX5, HHEX, RUNX2, STAT5A, HDAC1, and HOXC6) and 19% of those in MRB:14 (GRHL2, OVOL1, and ZBTB7B), for instance. As expected, no essential MRS were found in immune-related MRBs (MRB:10, MRB:19, MRB:22, MRB:23, and MRB:24)—consistent with lack of immune function in cell lines. However, the role of many of these MRs in pancancer inflammation was previously reported ( Thorsson et al., 2018 74. Thorsson, V. ∙ Gibbs, D.L. ∙ Brown, S.D. ... The Immune Landscape of Cancer Immunity. 2018; 48 :812-830 Full Text Full Text (PDF) Scopus (3366) PubMed Google Scholar ). This suggests that MOMA can identify MRs that are relevant in a human tumor context but might be missed in viability assays in vitro .
To assess whether MRBs could stratify patient outcome, we used a sparse Lasso COX proportional hazards regression model ( Tibshirani, 1997 75. Tibshirani, R. The lasso method for variable selection in the Cox model Stat. Med. 1997; 16 :385-395 Crossref Scopus (2884) PubMed Google Scholar ), with MRB activities as predictors. Of the 20 TCGA cohorts, 16 could be effectively stratified, often with highly improved p values compared with those of tumor checkpoint stratification ( Figures S6 A and S6B versus S2 A; Table S4 ). For instance, in melanoma we observed striking survival separation (p < 1.6 × 10 −7 ), by using a 6-MRB model—including MRB:10, which controls inflammatory and immune programs ( Figure 5 B). Tumor-checkpoint-based analysis was much less significant (p = 9.4 × 10 −3 ). Similarly, in colorectal cancer, significant outcome separation was achieved by using a 3 MRB model (p = 3.5 × 10 −3 )—with MRB:6 providing the greatest contribution—while tumor checkpoint stratification was not significant ( Figure S2 A). Finally, some MRBs provide complementary stratification. For instance, MRB:6—controlling EMT, KRAS signals, and immune evasion programs—effectively stratified HNSC, GBM, COAD, BRCA, and BLCA, but not UCEC, STAD, SKCM, SARC, LUAD, LIHC, whereas the opposite was true for MRB:3—controlling proliferation and DNA repair programs.
To assess whether TCGA-inferred MRBs generalize to other cohorts, we analyzed the METABRIC breast cancer cohort, including metastatic samples, with long-term survival data ( Curtis et al., 2012 23. Curtis, C. ∙ Shah, S.P. ∙ Chin, S.F. ..., METABRIC Group The genomic and transcriptomic architecture of 2,000 breast tumours reveals novel subgroups Nature. 2012; 486 :346-352 Crossref Scopus (4225) PubMed Google Scholar ). Considering the seven MRBs with highest differential activity in TCGA BRCA (MRB:2, MRB:3, MRB:7, MRB:11, MRB:14, MRB:16, and MRB:21), all of them, but MRB:11, provided significant survival stratification in METABRIC, 5 of 6 with p < 9.1 × 10 −7 (Bonferroni corrected) ( Figure S6 C).
To validate the effect of genetic alterations affecting MRB activity, we selected MRB:2, the most recurrently activated across all subtypes (40 out of 112) ( Figure 5 A). By regularized COX regression, MRB:2 produced some of the largest outcome regression coefficients across TCGA ( Table S4 ), emerging as one of the most significant predictors of poor outcome ( Figure S6 A). Of its 14 proteins, 11 had been previously reported as MRs of malignant prostate cancer (FOXM1, CENPF, UHRF1, TIMELESS, CENPK, TRIP13, ASF1B, E2F7, PTTG1, MYBL2, ASF1B, and TRIP13), including 7 out of 8 in its core-set. FOXM1 and CENPF—the 6 th and 13 th most recurrent MRs ( Figure 3 B)—were validated as synergistic MRs ( Aytes et al., 2014 4. Aytes, A. ∙ Mitrofanova, A. ∙ Lefebvre, C. ... Cross-species regulatory network analysis identifies a synergistic interaction between FOXM1 and CENPF that drives prostate cancer malignancy Cancer Cell. 2014; 25 :638-651 Full Text Full Text (PDF) Scopus (251) PubMed Google Scholar ). Yet, the mutations inducing MRB:2 aberrant activity were not previously elucidated.
MOMA identified seven molecularly distinct prostate adenocarcinoma subtypes, presenting significant survival separation ( Figure 6 A), including S 6 (worse) and S 1 , S 3 and S 5 (best survival) (p = 6 × 10 −3 ), as confirmed by Gleason score and biochemical recurrence analysis ( Figures 6 B and 6C). Consistently, MRB:2 MRs are only activated in S 6 samples ( Figure 6 A). In addition, the S 6 versus S 1 differential expression signature (9 and 149 samples respectively) is enriched in tumor hallmarks associated with MRB:2 ( Figure 6 D). We ranked MOMA-inferred alterations upstream of MRB:2 on the basis of their statistical significance across all TCGA cohorts and selected those with the strongest MRB:2 association ( Figures 6 E and 6F; STAR methods ), most of which were not identified as drivers by MutSig2.CV ( Lawrence et al., 2013 45. Lawrence, M.S. ∙ Stojanov, P. ∙ Polak, P. ... Mutational heterogeneity in cancer and the search for new cancer-associated genes Nature. 2013; 499 :214-218 Crossref Scopus (4130) PubMed Google Scholar ) and mutation assessor ( Reva et al., 2011 60. Reva, B. ∙ Antipin, Y. ∙ Sander, C. Predicting the functional impact of protein mutations: application to cancer genomics Nucleic Acids Res. 2011; 39 :e118 Crossref Scopus (1472) PubMed Google Scholar ) ( Table S3 ).
We selected 6 loss-of-function MRB:2-associated events for experimental validation, including TP53 Mut (top pancancer SNV), PTEN Del and PTEN Mut (top pancancer SCNA), MAP3K7 Del (top PRAD-specific deletion), SORBS3 Del (top integrated pancancer and PRAD-specific deletion) and BCAR1 Del (top pancancer deletion supported by MR physical interaction, with FOXM1) ( Figure 6 E). Of these only PTEN , a classic prostate cancer mutation, and TP53 , a hallmark of advanced, castration-resistant disease, were previously reported. We validated their functional role in 22Rv1 AR-sensitive prostate cancer cells with low MRB:2 activity, thus ideally suited to detecting activity increase in loss-of-function assays. Two short-hairpin RNA (shRNA) hairpins per target were used. Functional and tumorigenic effects were assessed both in vitro and in vivo ( Figure 7 A; Table S5 ; STAR methods ).
VIPER analysis following shRNA-mediated silencing of four of the five candidate genes versus negative controls, revealed statistically significant activity increase of MRB:2 activity, based on its 8 core-set MRs ( Figure 7 B). TP53 silencing, although not significant at the MRB level, induced FOXM1, PTTG1, and UHRF1 activity increase. Functionally, MAP3K7 , SORB3 , PTEN , and TP53 silencing showed significant increase in cell migration, as assessed by wound healing assays at the indicated time points in relation to control cells infected with scramble shRNAs ( Figures 7 C, 7D, S7 A) This was confirmed by Boyden chamber migration assays ( Figures 7 E and S7 B). Finally, 22Rv1 cells were engrafted in immune deficient mice, after target gene and negative control silencing. MAP3K7 , TP53 , and PTEN silencing produced significant growth increase compared with in negative controls (p < 0.01, by two-way Analysis of Variance [ANOVA]) ( Figure 7 F).
We then asked whether MRB activity and associated function might be pharmacologically modulated. We focused on MRB:14, whose activity emerged as critical in establishing and maintaining hormonally mediated luminal epithelial identity and cell adhesion (i.e., anti-migratory) phenotypes. Several MRB:14 proteins (e.g., GRHL2, OVOL1, and ZBTB7B) emerged as essential in MRB:14 active cell lines and in tissue-specific knockout mice studies ( Dai et al., 1998 24. Dai, X. ∙ Schonbaum, C. ∙ Degenstein, L. ... The ovo gene required for cuticle formation and oogenesis in flies is involved in hair formation and spermatogenesis in mice Genes Dev. 1998; 12 :3452-3463 Crossref Scopus (127) PubMed Google Scholar ; Gao et al., 2015 28. Gao, X. ∙ Bali, A.S. ∙ Randell, S.H. ... GRHL2 coordinates regeneration of a polarized mucociliary epithelium from basal stem cells J. Cell Biol. 2015; 211 :669-682 Crossref Scopus (86) PubMed Google Scholar ; Kappes, 2010 40. Kappes, D.J. Expanding roles for ThPOK in thymic development Immunol. Rev. 2010; 238 :182-194 Crossref Scopus (17) PubMed Google Scholar ). Others—SDPEF, GRHL2, JUP (g-catenin), CDH1 (E-cadherin), ZBTB7B, OVOL1, OVOL2, ATP8B1 (FIC1), PPP1R13L (iASPP)—are established regulators of epithelial cell adhesion and anoikis, cellular-apical-basal polarity, luminal epithelial structure maintenance, epithelial mesenchymal transition (EMT), cell migration, and inflammation, as shown in prostate, breast, colon, and skin studies ( Frisch et al., 2013 27. Frisch, S.M. ∙ Schaller, M. ∙ Cieply, B. Mechanisms that link the oncogenic epithelial-mesenchymal transition to suppression of anoikis J. Cell Sci. 2013; 126 :21-29 Crossref Scopus (227) PubMed Google Scholar ; Jolly et al., 2016 39. Jolly, M.K. ∙ Tripathi, S.C. ∙ Jia, D. ... Stability of the hybrid epithelial/mesenchymal phenotype Oncotarget. 2016; 7 :27067-27084 Crossref Scopus (300) PubMed Google Scholar ); see Table S5 for additional references. MOMA analysis recapitulated these roles in terms of hallmark enrichments, including androgen and estrogen response, EMT, apical surface and apical junction, and inflammatory response ( Figure 5 B).
Consistent with our analysis, SPDEF, GRHL2, JUP, and CDH1 protein expression was lost or significantly reduced in AR-insensitive (DU145 and PC-3) versus AR-sensitive (LNCaP) cell lines ( Figure S7 C). LNCaP cells treated with the AR antagonist enzalutamide or dimethyl sulfoxide (DMSO) ( Handle et al., 2019 34. Handle, F. ∙ Prekovic, S. ∙ Helsen, C. ... Drivers of AR indifferent anti-androgen resistance in prostate cancer cells Sci. Rep. 2019; 9 :13786 Crossref Scopus (43) PubMed Google Scholar ) confirmed that MRB:14 genes have AR-dependent expression ( Figure S7 D). Furthermore, their role in luminal epithelial identity maintenance was supported by luminal and basal prostate epithelial cell analysis ( Zhang et al., 2016 87. Zhang, D. ∙ Park, D. ∙ Zhong, Y. ... Stem cell and neurogenic gene-expression profiles link prostate basal cells to aggressive prostate cancer Nat. Commun. 2016; 7 :10798 Crossref Scopus (158) PubMed Google Scholar ) ( Figure S7 E). Indeed, MRB:14 activity effectively stratified luminal versus basal samples in BRCA and BLCA TCGA cohorts, by PAM50 classification ( Figure S7 F), further supporting MRB:14’s role as a positive determinant of hormone-signal-mediated luminal state across tissues and loss of luminal identity when inactivated.
VIPER analysis of patient-matched biopsies pre- and post-androgen deprivation therapy (ADT) ( Rajan et al., 2014 57. Rajan, P. ∙ Sudbery, I.M. ∙ Villasevil, M.E. ... Next-generation sequencing of advanced prostate cancer treated with androgen-deprivation therapy Eur. Urol. 2014; 66 :32-39 Full Text Full Text (PDF) Scopus (116) PubMed Google Scholar ) showed pronounced MRB:14 MR activity suppression ( Figure S7 G). Indeed, metastatic, post-ADT tumors are generally basal-like having undergone EMT, raising the question of whether prolonged ADT might induce loss of adhesion and metastatic progression ( Sun et al., 2012 71. Sun, Y. ∙ Wang, B.E. ∙ Leong, K.G. ... Androgen deprivation causes epithelial-mesenchymal transition in the prostate: implications for androgen-deprivation therapy Cancer Res. 2012; 72 :527-536 Crossref Scopus (284) PubMed Google Scholar ; Tsai et al., 2018 77. Tsai, Y.C. ∙ Chen, W.Y. ∙ Abou-Kheir, W. ... Androgen deprivation therapy-induced epithelial-mesenchymal transition of prostate cancer through downregulating SPDEF and activating CCL2 Biochim Biophys Acta Mol Basis Dis. 2018; 1864 :1717-1727 Crossref Scopus (41) PubMed Google Scholar ). Intermittent testosterone replacement therapy reduced appearance of aggressive tumors ( Chuu et al., 2011 19. Chuu, C.-P. ∙ Kokontis, J.M. ∙ Hiipakka, R.A. ... Androgens as therapy for androgen receptor-positive castration-resistant prostate cancer J. Biomed. Sci. 2011; 18 :63 Crossref Scopus (64) PubMed Google Scholar ; Loeb et al., 2017 48. Loeb, S. ∙ Folkvaljon, Y. ∙ Damber, J.E. ... Testosterone Replacement Therapy and Risk of Favorable and Aggressive Prostate Cancer J. Clin. Oncol. 2017; 35 :1430-1436 Crossref Scopus (60) PubMed Google Scholar ), reflecting potential benefit of periodic, AR-mediated cell adhesion reinforcement.
To test whether pharmacological activation of MRB:14 MRs might reduce the migratory, EMT-related potential of aggressive prostate cancer, we used the OncoTreat algorithm ( Alvarez et al., 2018 2. Alvarez, M.J. ∙ Subramaniam, P.S. ∙ Tang, L.H. ... A precision oncology approach to the pharmacological targeting of mechanistic dependencies in neuroendocrine tumors Nat. Genet. 2018; 50 :979-989 Crossref Scopus (130) PubMed Google Scholar ) to prioritize 120 FDA-approved and 217 late-stage (phase II and III) experimental drugs, on the basis of their overall ability to activate MRB:14 MRs, by using RNA Sequencing (RNA-seq) profiles of AR-resistant DU145 cells at 24 h after treatment ( STAR methods ). Four MRB:14-activating drugs were inferred at physiologically realistic concentrations (<10 μM), including fedratinib, pevonedistat, ENMD-2076, and lexibulin ( Figure 7 G), and their effect was assessed in wound healing assays. All four drugs but none of the negative controls significantly inhibited DU145 cell migration at 24 h ( Figures 7 H and 7I). The latter—triapine, raltiterxed, and dorsomorphin—were randomly selected among drugs with no significant MRB:14 activity effect ( Figure 7 G).

Section: Discussion

The repertoire of transcriptional identities accessible to a cancer cell, which ultimately determine its plasticity potential, is constrained by its mutational, paracrine, and endocrine signaling landscape, as well as its cell-of-origin epigenetics. Yet, the specific mechanisms by which these constraints are implemented are still poorly understood. We thus attempted to establish a more direct link between the proteins that regulate a tumor’s identity and the genomic alterations that induce their aberrant activity by using an algorithm, MOMA, that integrates multiple omics data.
The fine-grain subtype-structure emerging from the analysis revealed a highly modular and recurrent regulatory architecture, implemented by subtype-specific, combinatorial activation or inactivation of 24 master regulator modules (MRBs), each regulating specific tumor hallmarks. It also highlighted highly recurrent and distinct mutational patterns within each subtype that had been missed by gene-expression-based clustering. This suggests a “mutational field effect”—a term borrowed from Ising Spin Fields in ferromagnetism ( Baxter, 1982 7. Baxter, R.J. Exactly solved models in statistical mechanics Harcourt Brace Jovanovich Publishers, London, 1982 Google Scholar )—where many “weak” events that would be unable to dysregulate MR proteins on an individual basis—such as those in regional SCNAs—might cooperate to create a “strong” effect, as discussed for COAD. Weak event cooperativity might have been previously missed because regional SCNA contains dozen to hundreds of potential contributing genes, most of which do not contribute to MR dysregulation and are thus efficiently removed by MOMA’s CINDy and aQTL analyses.
Although most samples lacked a driver event quorum by conventional analyses, MOMA inferred a large number of functionally relevant events contributing to MR dysregulation in most samples, consistent with other complex diseases ( Boyle et al., 2017 10. Boyle, E.A. ∙ Li, Y.I. ∙ Pritchard, J.K. An expanded view of complex traits: from polygenic to omnigenic Cell. 2017; 169 :1177-1186 Full Text Full Text (PDF) Scopus (1720) PubMed Google Scholar ). Despite the remarkable complexity of these mutational patterns, our study suggests that their effect is canalized by only 112 distinct regulatory modules (tumor checkpoints), each representing a combination of only 24 primary MRBs. Consistent with the notion that transcriptional cell states have emerged as more accurate predictors of drug-sensitivity than genetics ( Rydenfelt et al., 2019 65. Rydenfelt, M. ∙ Wongchenko, M. ∙ Klinger, B. ... The cancer cell proteome and transcriptome predicts sensitivity to targeted and cytotoxic drugs Life Sci Alliance. 2019; 2 Crossref Scopus (6) PubMed Google Scholar ), this suggests that MR-based analyses might produce a more tractable landscape of potential therapeutic targets than could be achieved by genetic-based approaches, especially as great strides are being made to target transcriptional regulators by using E3-ligases, covalent binding molecules, or antisense agents. To further support this observation, we show that MRB activity and associated phenotypes can be effectively modulated by drugs predicted to invert the activity of their MRs, suggesting that a relatively small repertoire of MRB-targeting drugs could be developed to support precision combination therapy, as determined by MRB activity on an individual patient basis.
Over the last 50 years, a number of cancer hallmarks, representing programs necessary for cancer cell survival and proliferation, have emerged ( Hanahan and Weinberg, 2011 33. Hanahan, D. ∙ Weinberg, R.A. Hallmarks of cancer: the next generation Cell. 2011; 144 :646-674 Full Text Full Text (PDF) Scopus (49668) PubMed Google Scholar ), thus spurring research aimed at identifying the specific proteins and protein-modules that comprise them. This has led to development of several methods to “decompose” the 20,000+ dimensional gene-expression data space into orthogonal programs, either by using 2-dimentional matrices ( Kim et al., 2017 42. Kim, J.W. ∙ Abudayyeh, O.O. ∙ Yeerna, H. ... Decomposing oncogenic transcriptional signatures to generate maps of divergent cellular states Cell systems. 2017; 5 :105-118 Full Text Full Text (PDF) Scopus (30) PubMed Google Scholar ) or higher dimensional tensors ( Sankaranarayanan et al., 2015 66. Sankaranarayanan, P. ∙ Schomay, T.E. ∙ Aiello, K.A. ... Tensor GSVD of patient- and platform-matched tumor and normal DNA copy-number profiles uncovers chromosome arm-wide patterns of tumor-exclusive platform-consistent alterations encoding for cell transformation and predicting ovarian cancer survival PLoS ONE. 2015; 10 :e0121396 Crossref Scopus (36) PubMed Google Scholar ), thus creating a simplified representation of the underlying cellular states and shared oncogenic alterations ( Kim et al., 2017 42. Kim, J.W. ∙ Abudayyeh, O.O. ∙ Yeerna, H. ... Decomposing oncogenic transcriptional signatures to generate maps of divergent cellular states Cell systems. 2017; 5 :105-118 Full Text Full Text (PDF) Scopus (30) PubMed Google Scholar ; Malta et al., 2018 49. Malta, T.M. ∙ Sokolov, A. ∙ Gentles, A.J. ... Machine learning identifies stemness features associated with oncogenic dedifferentiation Cell. 2018; 173 :338-354 Full Text Full Text (PDF) Scopus (1301) PubMed Google Scholar ). These studies are encouraging and confirm that cancer hallmarks might be indeed implemented by coordinated activity of specific gene modules. However, current hallmark representations are basically tumor-independent gene sets that lack information on what regulates or dysregulates them. MRBs provide a complementary, subtype-specific representation of the proteins that causally regulate cancer hallmark gene sets and, thus, a potential way to modulate them on an individual tumor basis, as confirmed by validation of OncoTreat-predicted drugs.
MRB:2 was selected for experimental validation as the most recurrently activated across clustering solutions, mostly in poor outcome subtypes ( Figures 5 A and S5 C). Although 11 of its 14 proteins, which regulate cell growth, DNA repair, and mitotic programs ( Table S4 ), were previously inferred as MRs of the most aggressive subtype of prostate cancer, including FOXM1 and CENPF validated as synergistic MRs ( Aytes et al., 2014 4. Aytes, A. ∙ Mitrofanova, A. ∙ Lefebvre, C. ... Cross-species regulatory network analysis identifies a synergistic interaction between FOXM1 and CENPF that drives prostate cancer malignancy Cancer Cell. 2014; 25 :638-651 Full Text Full Text (PDF) Scopus (251) PubMed Google Scholar ), their concerted, pancancer role had been missed. Among them, TRIP13 also plays a critical role in chromosomal structure maintenance during meiosis ( Roig et al., 2010 63. Roig, I. ∙ Dowdle, J.A. ∙ Toth, A. ... Mouse TRIP13/PCH2 is required for recombination and normal higher-order chromosome structure during meiosis PLoS Genet. 2010; 6 :e1001062 Crossref Scopus (143) PubMed Google Scholar ), facilitated by the DNA topoisomerase 2-alpha subunit TOP2A, a well-established therapeutic target ( Jain et al., 2013 37. Jain, M. ∙ Zhang, L. ∙ He, M. ... TOP2A is overexpressed and is a therapeutic target for adrenocortical carcinoma Endocr. Relat. Cancer. 2013; 20 :361-370 Crossref Scopus (64) PubMed Google Scholar ) enabling chromosomal condensation and chromatid separation. FOXM1, CENPF, MYBL2, and TRIP13 were implicated as part of a core “proliferation cluster,” associated with poor outcome, whose activity is dependent on p53 inactivation ( Brosh and Rotter, 2010 12. Brosh, R. ∙ Rotter, V. Transcriptional control of the proliferation cluster by the tumor suppressor p53 Mol. Biosyst. 2010; 6 :17-29 Crossref Scopus (25) PubMed Google Scholar ). Indeed, TP53 mutations emerged as the most significant event upstream of MRB:2. Additional proliferation-related proteins, such as E2F2, E2F7, and TIMELESS, contribute to MRB:2’s strong association with proliferative hallmarks such as E2F Targets (p = 8.1 × 10 −76 ), Mitotic Spindle (p = 2.6 × 10 −2 ) and G2/M Checkpoint (p = 3.5 × 10 −45 ), as well as MTORC1 (p = 1.7 × 10 −5 ) and V1 and V2 MYC programs (p = 1.2 × 10 −28 and 3.7 × 10 −10 , respectively) (Table S8). Finally, UHRF1, also a candidate therapeutic target, is overexpressed in many cancers ( Unoki et al., 2009 78. Unoki, M. ∙ Brunet, J. ∙ Mousli, M. Drug discovery targeting epigenetic codes: the great potential of UHRF1, which links DNA methylation and histone modifications, as a drug target in cancers and toxoplasmosis Biochem. Pharmacol. 2009; 78 :1279-1288 Crossref Scopus (92) PubMed Google Scholar ), where it regulates gene expression and peaks in G1 phase, continuing through G2 and M, whereas ASF1B—a core member of the histone chaperone proteins, responsible for providing a constant supply of histones at the site of nucleosome assembly and the most recurrent activated MR, is predictive of outcome in several tumors ( Corpet et al., 2011 21. Corpet, A. ∙ De Koning, L. ∙ Toedling, J. ... Asf1b, the necessary Asf1 isoform for proliferation, is predictive of outcome in breast cancer EMBO J. 2011; 30 :480-493 Crossref Scopus (129) PubMed Google Scholar ). Thus, although the role of these proteins might have been individually established in some cancers, our study identifies them as a hyper-connected, synergistic core module activated in the most aggressive cancer subtypes, from melanoma and GBM, to colorectal, prostate, and ovarian cancer ( Figure 5 A).
Activity of MRB:3 and MRB:7 was also associated with proliferation, yet via complementary MRs such as the E2F family (E2F1, E2F2, E2F7, and E2F8) and chromatin remodeling enzymes involved in mitotic progression (SUV39H1), assembly (CHAF1B), and mini-chromosome maintenance (MCM2, MCM3, MCM6, and MCM7).
At the other end of the functional spectrum, MRB:24—significantly associated with inflammatory response and immune related hallmarks, including via the immune-regulator MR STAT1 ( Figure 5 B)—was activated in 20 subtypes ( Figure 5 A) and highly predictive of outcome (e.g., in SKCM) ( Figure 5 C). MRB:19 was also enriched in immune-related hallmarks ( Figure 5 B), via alternative MRs. These include CIITA, a major histocompatibility complex (MHC) transactivator, whose inactivation abrogates human leukocyte antigen-DR (HLA-DR) presentation and promotes immune-evasion ( Yazawa et al., 1999 83. Yazawa, T. ∙ Kamma, H. ∙ Fujiwara, M. ... Lack of class II transactivator causes severe deficiency of HLA-DR expression in small cell lung cancer J. Pathol. 1999; 187 :191-199 Crossref Scopus (78) PubMed Google Scholar ), CD86, the canonical CTLA-4 ligand involved in immune checkpoint activation, and additional proteins (e.g., NOTCH4, MITF, etc.) associated with an immune-evasive microenvironment ( Thorsson et al., 2018 74. Thorsson, V. ∙ Gibbs, D.L. ∙ Brown, S.D. ... The Immune Landscape of Cancer Immunity. 2018; 48 :812-830 Full Text Full Text (PDF) Scopus (3366) PubMed Google Scholar ).
Altogether, these data suggest that MRBs might provide complementary “molecular recipes” for implementing the same cancer hallmarks in different tumor contexts.
Obviously, there are several limitations to the MOMA analyses, providing options for potential future improvements. Consistent with other high-throughput methods, both experimental and computational, it is reasonable to expect that MOMA will also produce false positive and negative predictions. Moreover, MOMA was not optimized on an individual cohort basis but rather to identify commonalities across different tumor subtypes. As such, it is not intended as a replacement but rather as a complement to existing analyses, specifically to identify proteins that canalize cancer alterations toward subtype implementation. For instance, TP53 mutations are ubiquitous in ovarian cancer, thus providing minimal contribution to its subtypes and failing detection by MOMA. Similarly, the proposed clustering strategy might over- or under-stratify some cohorts, in order to avoid missing rare subtypes across most cohorts. For instance, S 6 , the most aggressive PRAD subtype ( Figure 6 A), would have been missed by a more conservative clustering strategy. Yet, tuning the algorithm for rare subtypes might cause over-stratification of others. Indeed, although most subtypes are molecularly distinct, PAAD subtypes S 3 , S 4 , and S 5 were quite similar, both in terms of MRs and upstream genetics. Conversely, under-stratification was evident in breast cancer, where MOMA identified only four subtypes, a basal-like one (S 4 ), a Luminal-B one (S 2 ), and two molecularly distinct Luminal-A ones (S 1 and S 3 ). Forcing a more granular 8-cluster solution split the basal subtype into Claudin low and Claudin high subtypes ( Figures S2 D, S2E), HER2 + tumors, however, still failed to form a separate cluster and were enriched in either the Luminal B or Basal subtypes ( Figure S2 B), suggesting that, although HER2 + tumors might present a distinct oncogene dependency because of their hallmark mutation, their transcriptional identity might be more consistent with Basal (HR-negative) and Luminal B (HR-positive) tumors.
Some key events might also be missed (false negatives) because of the highly conservative nature of the DIGGIT analysis. Indeed, while BRAF mutations, which are frequent in SKCM, were significantly associated with differential MR activity by aQTL analysis, they were missed as upstream MR modulators by CINDyand were thus also missed by MOMA. Indeed, previous validation ( Alvarez et al., 2016 1. Alvarez, M.J. ∙ Shen, Y. ∙ Giorgi, F.M. ... Functional characterization of somatic mutations in cancer using network-based inference of protein activity Nat. Genet. 2016; 48 :838-847 Crossref Scopus (498) PubMed Google Scholar ; Califano and Alvarez, 2017 14. Califano, A. ∙ Alvarez, M.J. The recurrent architecture of tumour initiation, progression and drug sensitivity Nat. Rev. Cancer. 2017; 17 :116-130 Crossref Scopus (130) PubMed Google Scholar ) shows that ∼20% of proteins harboring functional genetic alteration might be missed by VIPER analysis. We are currently developing approaches to further improve sensitivity, for instance by including DNA binding motifs, ATAC-Seq data, or other epigenetic data modalities. Similarly, as also reported, VIPER might invert the sign of differential activity because of autoregulatory loops. This does not compromise MR identification but might identify some activated MRs as inactivated and vice-versa. Further improvement to the algorithm might be possible by changing the integration logic or by using mutational or perturbational data to better infer the activity of mutation harboring proteins, as shown in ( Broyde et al., 2020 13. Broyde, J. ∙ Simpson, D.R. ∙ Murray, D. ... Systematic Elucidation and Validation of Oncoprotein-Specific Molecular Interaction Maps Nat. Biotechnol. 2020; Epub ahead of print Crossref Scopus (16) PubMed Google Scholar ).
Although the current version of MOMA identified a large repertoire of previously unreported mutations and subtypes, the algorithm might be tuned for improved stratification, on an individual tumor cohort basis, for instance by using the average of each cohort, rather than the average of TCGA, as a control, as shown in several prior studies, (e.g., Carro et al., 2010 15. Carro, M.S. ∙ Lim, W.K. ∙ Alvarez, M.J. ... The transcriptional network for mesenchymal transformation of brain tumours Nature. 2010; 463 :318-325 Crossref Scopus (978) PubMed Google Scholar and Rajbhandari et al., 2018 58. Rajbhandari, P. ∙ Lopez, G. ∙ Capdevila, C. ... Cross-Cohort Analysis Identifies a TEAD4-MYCN Positive Feedback Loop as the Core Regulatory Element of High-Risk Neuroblastoma Cancer Discov. 2018; 8 :582-599 Crossref Scopus (96) PubMed Google Scholar ), thus further highlighting subtle subtype differences.
To make MOMA broadly available to the research community, we deposited the related software in Bioconductor ( Paull et al., 2020b 55. Paull, E.O. ∙ Brennan, C. ∙ Jones, S. ... MOMA: Multi Omic Master Regulator Analysis. R Package V1.0.2 2020 https://bioconductor.org/packages/release/bioc/html/MOMA.html Google Scholar ), allowing its application to any cohort for which matched gene expression and mutational data are available. We also developed a public-access web application that allows biologists to easily query and visualize the ∼2 million tumor-specific molecular interactions emerging from the analysis ( Paull et al., 2020a 54. Paull, E.O. ∙ Brennan, C. ∙ Jones, S. ... MOMA Web App V1.0 2020 http://MR-graph.org Google Scholar ).

Section: STAR★Methods

REAGENT or RESOURCE SOURCE IDENTIFIER Antibodies Rabbit Anti-GRHL2 Millipore Sigma Cat#HPA004820; RRID: AB_1857928 Rabbit Anti-SPDEF Proteintech Cat#11467-1-AP; RRID: AB_2877765 Rabbit-Anti AR Cell Signaling Tech. Cat#5153S; RRID: AB_10691711 Mouse Anti-g-catenin (JUP) BD Biosciences Cat#610253; RRID: AB_397648 Mouse Anti-E-Cadherin (CDH1) BD Biosciences Cat#610404; RRID: AB_397786 Chemicals, Peptides, and Recombinant Proteins Fedratinib Selleck Chemicals Cat#S2736 Pevonedistat Selleck Chemicals Cat#S7109 Lexibulin Selleck Chemicals Cat#S2195 ENMD-2076 Selleck Chemicals Cat#S1181 Triapine Selleck Chemicals Cat#S7470 Dorsomorphin Selleck Chemicals Cat#S7306 Raltiterxed Selleck Chemicals Cat#S1192 Deposited Data TCGA Sample Data Broad Institute https://gdac.broadinstitute.org/ PRADA Gene Fusion Data The Jackson Laboratory https://www.tumorfusions.org/ Achilles shRNA Essentiality Data DepMap; Broad Institute https://depmap.org/portal/achilles/ METABRIC Breast Cancer Patient Data cBioPortal; Curtis et al., 2012 23. Curtis, C. ∙ Shah, S.P. ∙ Chin, S.F. ..., METABRIC Group The genomic and transcriptomic architecture of 2,000 breast tumours reveals novel subgroups Nature. 2012; 486 :346-352 Crossref Scopus (4225) PubMed Google Scholar https://www.cbioportal.org/study/summary?id=brca_metabric Pancancer Driver Genes Bailey et al., 2018 5. Bailey, M.H. ∙ Tokheim, C. ∙ Porta-Pardo, E. ... Comprehensive characterization of cancer driver genes and mutations Cell. 2018; 173 :371-385 Full Text Full Text (PDF) Scopus (1275) PubMed Google Scholar https://doi.org/10.1016/j.cell.2018.02.060 Network of Cancer Genes (NCG) Repana et al., 2019 59. Repana, D. ∙ Nulsen, J. ∙ Dressler, L. ... The Network of Cancer Genes (NCG): a comprehensive catalogue of known and candidate cancer genes from cancer sequencing screens Genome Biol. 2019; 20 :1 Crossref Scopus (174) PubMed Google Scholar http://ncg.kcl.ac.uk/ Molecular Signatures Database (MSigDB) UC San Diego; Broad Institute https://www.gsea-msigdb.org/gsea/msigdb/index.jsp Gene Ontology Gene Ontology Consortium http://geneontology.org Enzalutamide-treated LNCaP cells Handle et al., 2019 34. Handle, F. ∙ Prekovic, S. ∙ Helsen, C. ... Drivers of AR indifferent anti-androgen resistance in prostate cancer cells Sci. Rep. 2019; 9 :13786 Crossref Scopus (43) PubMed Google Scholar GEO: GSE130534 Analysis of prostate cells and tumor biopsies Rajan et al., 2014 57. Rajan, P. ∙ Sudbery, I.M. ∙ Villasevil, M.E. ... Next-generation sequencing of advanced prostate cancer treated with androgen-deprivation therapy Eur. Urol. 2014; 66 :32-39 Full Text Full Text (PDF) Scopus (116) PubMed Google Scholar GEO: GSE48403 Analysis of prostate cells and tumor biopsies Zhang et al., 2016 87. Zhang, D. ∙ Park, D. ∙ Zhong, Y. ... Stem cell and neurogenic gene-expression profiles link prostate basal cells to aggressive prostate cancer Nat. Commun. 2016; 7 :10798 Crossref Scopus (158) PubMed Google Scholar GEO: GSE67070 Experimental Models: Cell Lines LNCap clone FGC ATCC Cat#ATCC® CRL-1740 DU 145 ATCC Cat#ATCC® HTB-81 22Rv1 ATCC Cat#ATCC® CRL-2505 PC-3 ATCC Cat#ATCC® CRL-1435 293 [HEK293] ATCC Cat#ATCC® CRL-1573 Experimental Models: Organisms/Strains Immunodeficient Athymic Nude mice - Foxn1 nu Envigo Model# Hsd:Athymic Nude-Foxn1 nu –069 Oligonucleotides: shRNA Clones See Table S5 for clones Recombinant DNA pMD2.G Laboratory of Didier Trono via Addgene Addgene plasmid #12259 psPAX2 Laboratory of Didier Trono via Addgene Addgene plasmid #12260 Software and Algorithms MOMA Web application This paper http://www.mr-graph.org/ MOMA Bioconductor Package This paper https://bioconductor.org/packages/release/bioc/html/MOMA.html R for Statistical Programming R Core Team, 2020 56. R-Core-Team R: A Language and Environment for Statistical Computing R Foundation for Statistical Computing, Vienna, Austria, 2020 Google Scholar https://www.R-project.org/ Complex Heatmap Gu et al., 2016 32. Gu, Z. ∙ Eils, R. ∙ Schlesner, M. Complex heatmaps reveal patterns and correlations in multidimensional genomic data Bioinformatics. 2016; 32 :2847-2849 Crossref Scopus (4781) PubMed Google Scholar https://doi.org/10.1093/bioinformatics/btw313 Q-Value Estimation for FDR Storey et al., 2020 68. Storey, J.D., Bass, A.J., Dabney, A., and Robinson, D. (2020). Q-value estimation for false discovery rate control. https://doi.org/10.18129/B9.bioc.qvalue . Google Scholar http://github.com/jdstorey/qvalue ggplot2: Graphics for Data Analysis Wickham et al., 2016 82. Wickham, H. ggplot2: Elegant Graphics for Data Analysis New York: Springer-Verlag, 2016 Crossref Google Scholar https://ggplot2.tidyverse.org VIPER R package Alvarez et al., 2016 1. Alvarez, M.J. ∙ Shen, Y. ∙ Giorgi, F.M. ... Functional characterization of somatic mutations in cancer using network-based inference of protein activity Nat. Genet. 2016; 48 :838-847 Crossref Scopus (498) PubMed Google Scholar https://doi.org/10.18129/B9.bioc.viper mixtools R package Benaglia et al., 2009 8. Benaglia, T. ∙ Chauveau, D. ∙ Hunter, D.R. ... mixtools: An R Package for Analyzing Mixture Models 32 :29 Google Scholar https://www.jstatsoft.org/article/view/v032i06 survival R package Therneau and Grambsch, 2000 73. Therneau, T. ∙ Grambsch, P. Modeling Survival Data: Extending the Cox Model. Springer, 2000 Crossref Google Scholar https://CRAN.R-project.org/package=survival DEBrowser Kucukural et al., 2019 43. Kucukural, A. ∙ Yukselen, O. ∙ Ozata, D.M. ... DEBrowser: interactive differential expression analysis and visualization tool for count data BMC Genomics. 2019; 20 :6 Crossref Scopus (140) PubMed Google Scholar https://debrowser.umassmed.edu/ clusterProfiler R package Yu et al., 2012 84. Yu, G. ∙ Wang, L.G. ∙ Han, Y. ... clusterProfiler: an R package for comparing biological themes among gene clusters OMICS. 2012; 16 :284-287 Crossref Scopus (18538) PubMed Google Scholar http://yulab-smu.top/clusterProfiler-book/ MutSig2CV Lawrence et al., 2013 45. Lawrence, M.S. ∙ Stojanov, P. ∙ Polak, P. ... Mutational heterogeneity in cancer and the search for new cancer-associated genes Nature. 2013; 499 :214-218 Crossref Scopus (4130) PubMed Google Scholar https://software.broadinstitute.org/cancer/cga/mutsig Mutation Assessor Reva et al., 2011 60. Reva, B. ∙ Antipin, Y. ∙ Sander, C. Predicting the functional impact of protein mutations: application to cancer genomics Nucleic Acids Res. 2011; 39 :e118 Crossref Scopus (1472) PubMed Google Scholar http://mutationassessor.org/r3/ CHASM Carter et al., 2009 16. Carter, H. ∙ Chen, S. ∙ Isik, L. ... Cancer-specific high-throughput annotation of somatic mutations: computational prediction of driver missense mutations Cancer Res. 2009; 69 :6660-6667 Crossref Scopus (375) PubMed Google Scholar https://wiki.chasmsoftware.org GISTIC 2.0 Mermel et al., 2011 50. Mermel, C.H. ∙ Schumacher, S.E. ∙ Hill, B. ... GISTIC2.0 facilitates sensitive and confident localization of the targets of focal somatic copy-number alteration in human cancers Genome Biol. 2011; 12 :R41 Crossref Scopus (2277) PubMed Google Scholar https://doi.org/10.1186/gb-2011-12-4-r41 PrePPI Zhang et al., 2012 85. Zhang, Q.C. ∙ Petrey, D. ∙ Deng, L. ... Structure-based prediction of protein-protein interactions on a genome-wide scale Nature. 2012; 490 :556-560 Crossref Scopus (564) PubMed Google Scholar https://honiglab.c2b2.columbia.edu/PrePPI/index.html HumanNet v2 Hwang et al., 2019 36. Hwang, S. ∙ Kim, C.Y. ∙ Yang, S. ... HumanNet v2: human gene networks for disease research Nucleic Acids Res. 2019; 47 :D573-D580 Crossref Scopus (145) PubMed Google Scholar https://www.inetbio.org/humannet/ Multinet Khurana et al., 2013 41. Khurana, E. ∙ Fu, Y. ∙ Chen, J. ... Interpretation of genomic variants using a unified biological network approach PLoS Comput. Biol. 2013; 9 :e1002886 Crossref Scopus (130) PubMed Google Scholar https://doi.org/10.1371/journal.pcbi.1002886 Cytoscape Shannon et al., 2003 67. Shannon, P. ∙ Markiel, A. ∙ Ozier, O. ... Cytoscape: a software environment for integrated models of biomolecular interaction networks Genome Res. 2003; 13 :2498-2504 Crossref Scopus (32549) PubMed Google Scholar https://cytoscape.org/ Open table in a new tab
Further information and requests for resources, reagents, and code should be directed to and will be fulfilled by the Lead Contact, Andrea Califano ( ac2248@columbia.edu ).
This study did not generate new unique reagents.
Source data for the analyses done in the paper is available from the TCGA Firehose Repository (gdac.broadinstitute.org, 2016-01-28 release). Full description of data types per sample (RNA sequencing, SNV and SCNA) acquired from TCGA firehose available in Table S1 . All samples with RNA sequencing data available were used in the analysis. Cohorts with fewer than 100 samples were not used. Further information about sample acquisition and relevant clinical annotations are available on the TCGA website. Fusion data were acquired from the Tumor Fusions Gene Data Portal, which is based on the TCGA data ( http://www.tumorfusions.org ; 2017-10-01 release) ( Hu et al., 2018 35. Hu, X. ∙ Wang, Q. ∙ Tang, M. ... TumorFusions: an integrative resource for cancer-associated transcript fusions Nucleic Acids Res. 2018; 46 :D1144-D1149 Crossref Scopus (165) PubMed Google Scholar ; Torres-García et al., 2014 76. Torres-García, W. ∙ Zheng, S. ∙ Sivachenko, A. ... PRADA: pipeline for RNA sequencing data analysis Bioinformatics. 2014; 30 :2224-2226 Crossref Scopus (121) PubMed Google Scholar ).
Various datasets were used for validation of different components of the analysis. Unless otherwise stated all available data were used from the respective dataset. All accession information for the respective external data is available in the Key Resources Table.
The results of the analysis can be interactively accessed on our MOMA web application ( http://www.mr-graph.org/ ). Code used to analyze the data has been compiled into a Bioconductor R package, MOMA, that can be downloaded here ( https://bioconductor.org/packages/release/bioc/html/MOMA.html ).
The immunodeficient NCr nude Spontaneous mutant model (Envigo; Product model: Mutant mice - Hsd:Athymic Nude-Foxn1 nu - 069) was used for the MRB:2 xenograft validation experiments. All experimental procedures were approved by the Ethical Committee on Animal Research at IDIBELL and have been authorized by the responsible Department of the Catalan Autonomous Government (File Number: FUE-2016-00307059; Project Number: 9025, Project coordinator: Alvaro Aytés). The barrier facility at IDIBELL is an AAALAC-certified facility. Maximum cage density was 5 mice/cage and cages were placed in ventilated racks with water ad libitum and chow replenished weekly as well as clean new bedding. All animals used in this study were 6 weeks old male athymic Nude-Foxn1nu (Envigo). Mice were monitored daily for signs of distress throughout the course of the experiment.
All cell lines were acquired from ATCC, as authenticated by them. Growth medium for cells is as follows: LNCaP cells and 22Rv1 cells were grown in RPMI-1640 medium (GIBCO) supplemented with 10% Fetal Bovine Serum (FBS; Sigma-Aldrich) and antibiotics (penicillin/streptomycin, P/S; = 100 units of penicillin and 100 μg of streptomycin per mL of medium); DU145 cells were grown in Eagle’s Minimal Essential Medium (GIBCO) supplemented with 10% FBS and P/S; PC3 cells were grown in Ham’s F-12K (Kaighn’s) Medium (GIBCO) supplemented with 10% FBS and P/S; HEK293 were grown in DMEM supplemented with 10% FBS and P/S. All cell lines were grown at 5% CO2 and 37C.
RNA-Seq raw gene counts were downloaded from the TCGA firehose web site ( http://gdac.broadinstitute.org , 2016-01-28 release), transformed to Reads Per Kilobase of transcript, per Million mapped reads (RPKM), using the average transcript length for each gene and log 2 transformed. Transcriptome-wide expression signatures were computed by two non-parametric transformations. First, each column (tumor sample) was rank transformed and scaled between 0 and 1. Then each row (gene) was rank transformed and scaled between 0 and 1. Finally, regulatory protein activity was measured by the VIPER algorithm ( Alvarez et al., 2016 1. Alvarez, M.J. ∙ Shen, Y. ∙ Giorgi, F.M. ... Functional characterization of somatic mutations in cancer using network-based inference of protein activity Nat. Genet. 2016; 48 :838-847 Crossref Scopus (498) PubMed Google Scholar ), using tissue-matched ARACNE regulons ( Giorgi et al., 2016 31. Giorgi, F.M. ∙ Alvarez, M.J. ∙ Califano, A. aracne. networks, a data package containing gene regulatory networks assembled from TCGA data by the ARACNe algorithm 2016 https://bioconductor.org/packages/release/data/experiment/vignettes/aracne.networks/inst/doc/aracne.networks.pdf Google Scholar ; Lachmann et al., 2016 44. Lachmann, A. ∙ Giorgi, F.M. ∙ Lopez, G. ... ARACNe-AP: gene network reverse engineering through adaptive partitioning inference of mutual information Bioinformatics. 2016; 32 :2233-2235 Crossref Scopus (220) PubMed Google Scholar ) (see Figure S1 B).
Systematic experimental validation has confirmed that VIPER can accurately measure differential activity for > 80% of transcriptional regulator proteins, when ≥40% of the genes in a regulon represent bona fide targets of the protein ( Alvarez et al., 2016 1. Alvarez, M.J. ∙ Shen, Y. ∙ Giorgi, F.M. ... Functional characterization of somatic mutations in cancer using network-based inference of protein activity Nat. Genet. 2016; 48 :838-847 Crossref Scopus (498) PubMed Google Scholar ). In addition, multiple studies have experimentally validated that > 70% of ARACNe-inferred targets represent bona fide, physical transcriptional targets—e.g., by Chromatin Immunoprecipitation (ChIP) and RNAi-mediated silencing, followed by gene expression profiling ( Alvarez et al., 2016 1. Alvarez, M.J. ∙ Shen, Y. ∙ Giorgi, F.M. ... Functional characterization of somatic mutations in cancer using network-based inference of protein activity Nat. Genet. 2016; 48 :838-847 Crossref Scopus (498) PubMed Google Scholar ; Basso et al., 2005 6. Basso, K. ∙ Margolin, A.A. ∙ Stolovitzky, G. ... Reverse engineering of regulatory networks in human B cells Nat. Genet. 2005; 37 :382-390 Crossref Scopus (1131) PubMed Google Scholar ; Carro et al., 2010 15. Carro, M.S. ∙ Lim, W.K. ∙ Alvarez, M.J. ... The transcriptional network for mesenchymal transformation of brain tumours Nature. 2010; 463 :318-325 Crossref Scopus (978) PubMed Google Scholar ; Lefebvre et al., 2010 46. Lefebvre, C. ∙ Rajbhandari, P. ∙ Alvarez, M.J. ... A human B-cell interactome identifies MYB and FOXM1 as master regulators of proliferation in germinal centers Mol. Syst. Biol. 2010; 6 :377 Crossref Scopus (292) PubMed Google Scholar )—thus fulfilling the VIPER requirements for accurate protein measurement. The results of the VIPER analysis are reported as a Normalized Enrichment Scores (NES) values of a protein targets in differentially expressed genes with respect to the centroid of TCGA, as assessed by aREA (see below). This has been shown to accurately characterize differential protein activity. Positive NES values (shown as a red gradient) indicate increased protein activity while negative NES values (shown as a blue gradient) indicate decreased protein activity.
Candidate genomic event data were downloaded from the TCGA firehose ( http://gdac.broadinstitute.org , 2016-01-28 release). For mutations and small indels, we downloaded Mutation Annotation Files (MAF) and selected all events annotated as non-silent alterations. For SCNAs, we downloaded SNP6 copy number profiles and selected a threshold of ± 0.5 as the value that provides an optimal tradeoff between sensitivity and specificity in capturing copy number changes, as discussed in the literature ( Jerby-Arnon et al., 2014 38. Jerby-Arnon, L. ∙ Pfetzer, N. ∙ Waldman, Y.Y. ... Predicting cancer-specific vulnerability via data-driven detection of synthetic lethality Cell. 2014; 158 :1199-1209 Full Text Full Text (PDF) Scopus (208) PubMed Google Scholar ).
To ensure that copy number changes are functionally relevant, we adopted the approach discussed in the DIGGIT manuscript ( Chen et al., 2014 18. Chen, J.C. ∙ Alvarez, M.J. ∙ Talos, F. ... Identification of causal genetic drivers of human disease through systems-level analysis of regulatory networks Cell. 2014; 159 :402-414 Full Text Full Text (PDF) Scopus (146) PubMed Google Scholar ). Specifically, only SCNA genes whose correlation between copy number and expression was statistically significant across a cohort were considered as functional candidates ( Figure S1 B). For the Genomic Saturation analysis, GISTIC2.0 results were downloaded from Firehose to better account for proximal copy number alteration events and to differentiate between focal (score of ± 2) and regional (score of ± 1) events. When multiple functional events were identified within the same amplicon, they were consolidated into a single event vector, thus preventing overcounting (Region Consolidation). However, for completeness, the MOMA Web App reports the identity of all events in an amplicon that pass the CINDy and aQTL analyses. Finally, gene-fusion calls were called by the PRADA algorithm, and downloaded from the Tumor Fusions Gene Data Portal ( www.tumorfusions.org , 2017-10-01 release) ( Hu et al., 2018 35. Hu, X. ∙ Wang, Q. ∙ Tang, M. ... TumorFusions: an integrative resource for cancer-associated transcript fusions Nucleic Acids Res. 2018; 46 :D1144-D1149 Crossref Scopus (165) PubMed Google Scholar ; Torres-García et al., 2014 76. Torres-García, W. ∙ Zheng, S. ∙ Sivachenko, A. ... PRADA: pipeline for RNA sequencing data analysis Bioinformatics. 2014; 30 :2224-2226 Crossref Scopus (121) PubMed Google Scholar ).
The analytic Rank-based Enrichment Analysis (aREA) was introduced in ( Alvarez et al., 2016 1. Alvarez, M.J. ∙ Shen, Y. ∙ Giorgi, F.M. ... Functional characterization of somatic mutations in cancer using network-based inference of protein activity Nat. Genet. 2016; 48 :838-847 Crossref Scopus (498) PubMed Google Scholar ) as an analytical methodology to assess gene set enrichment analysis statistics, producing results that are virtually identical to GSEA ( Subramanian et al., 2005 70. Subramanian, A. ∙ Tamayo, P. ∙ Mootha, V.K. ... Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles Proc. Natl. Acad. Sci. USA. 2005; 102 :15545-15550 Crossref Scopus (33620) PubMed Google Scholar ) without the need for time-consuming sample or gene shuffling.
We implemented a slightly improved version of the DIGGIT algorithm. The original DIGGIT combined (a) a MINDy analysis step ( Wang et al., 2009 80. Wang, K. ∙ Saito, M. ∙ Bisikirska, B.C. ... Genome-wide identification of post-translational modulators of transcription factor activity in human B cells Nat. Biotechnol. 2009; 27 :829-839 Crossref Scopus (203) PubMed Google Scholar ) to identify proteins representing candidate upstream modulators of a MR protein (b) an aQTL analysis step to identify genomic events in candidate upstream modulators associated with statistically significant differential MR activity, and (c) a conditional association analysis step to eliminate genomic events that were no longer significant given another genomic event. The analysis was improved as follows: (a) rather than using mutual information, aQTL statistical significance is assessed by aREA-based enrichment analysis of samples, ranked by differential activity of the specific MR, in samples harboring a specific SNV or SCNA events, (b) the MINDy algorithm was replaced by CINDy ( Giorgi et al., 2014 30. Giorgi, F.M. ∙ Lopez, G. ∙ Woo, J.H. ... Inferring protein modulation from gene expression data using conditional mutual information PLoS ONE. 2014; 9 :e109569 Crossref Scopus (19) PubMed Google Scholar ), providing a more accurate implementation of the conditional mutual information foundation of the algorithm, and (c) the conditional association analysis step was eliminated because it produced too many statistical ties when applied to pancancer cohorts; note that aQTL analysis was performed only for events occurring in ≥ 4 samples since fewer events are highly unlikely to achieve statistical significance ( Figure S1 C Step 2). The individual steps are described in the following sections.
Step 1 : Proteins were first ranked by their VIPER statistical significance, integrated across all cohort samples using the Stouffer’s method for p value integration ( Stouffer et al., 1949 69. Stouffer, S.A. ∙ Suchman, E.A. ∙ DeVinney, L.C. ... Adjustment during Army Life The American Soldier Princeton University Press, Princeton, 1949 Google Scholar ).
Step 2 For each statistically significant differentially active protein (i.e., candidate MR) the conditional mutual information 𝐶 ⁢ 𝑀 ⁢ 𝐼 = 𝐼 ⁡ [ 𝑀 ⁢ 𝑅 , { 𝑇 𝑖 } | 𝑀 ] , between the expression of the MR and of its regulon genes, given the expression of any gene harboring a somatic event, was computed. Thus, CINDy identified mutation-harboring genes encoding for proteins that affect the ability of a MR to regulate its targets ( Figure S1 B).
Step 3 : For each event type (i.e., SNV, amplified SCNA, or deleted SCNA) all statistically significant CINDy scores for a given MR were integrated using Stouffer’s method to produce three global CINDy scores 𝑆 S N V 𝐶 = − L o g 1 0 ⁢ ( 𝑝 S N V 𝐶 ) , 𝑆 A m p 𝐶 = − L o g 1 0 ⁢ ( 𝑝 A m p 𝐶 ) , and 𝑆 D e l 𝐶 = − L o g 1 0 ⁢ ( 𝑝 D e l 𝐶 ) . Fusion events were not analyzed in this fashion since ARACNe is not designed to identify targets of fusion proteins. Thus, for fusion events, only the aQTL analysis step was applied.
Step 1 : Proteins were ranked by their VIPER statistical significance, integrated across all cohort samples using Stouffer’s method. This could be further improved in the future by integrating across individual subtypes rather than entire cohorts.
Step 2 : For each statistically significant differentially active protein (i.e., candidate MR) and somatic event (SNV, SCNA, or FUS), the statistical significance of the aQTL event was assessed by computing the enrichment of all cohort samples, ranked by the MR’s differential activity, in samples harboring the event, using aREA.
Step 3 : For each event type, a global aQTL score ( 𝑆 𝑎 ⁢ 𝑄 ⁢ 𝑇 ⁢ 𝐿 ) was computed as the − 𝑙 ⁢ 𝑜 ⁢ 𝑔 1 0 ⁡ ( 𝑃 𝑎 ⁢ 𝑄 ⁢ 𝑇 ⁢ 𝐿 ) , with 𝑃 𝑎 ⁢ 𝑄 ⁢ 𝑇 ⁢ 𝐿 representing the integration of all statistically significant MR-event aQTL p-value s ( p ≤ 0.05) per MR for that event type, using Stouffer’s method. This produced three global aQTL scores 𝑆 S N V 𝑎 ⁢ 𝑄 ⁢ 𝑇 ⁢ 𝐿 , for SNVs, small indels, and fusion events, 𝑆 D e l 𝑎 ⁢ 𝑄 ⁢ 𝑇 ⁢ 𝐿 , for SCNA deletion, and 𝑆 A m p 𝑎 ⁢ 𝑄 ⁢ 𝑇 ⁢ 𝐿 for SCNA amplifications. If ≥ 100 CINDy-inferred MR modulators were identified in a given cohort (see CINDy Score), then only aQTLs for somatic events harbored by genes with a statistically significant CINDy p-value were integrated. Otherwise, the p-value s of all statistically significant aQTLs were integrated independent of CINDy results. This is because fewer than 100 statistically significant CINDy modulators indicates that the dataset is too small for a properly powered CINDy analysis.
PrePPI ( Zhang et al., 2012 85. Zhang, Q.C. ∙ Petrey, D. ∙ Deng, L. ... Structure-based prediction of protein-protein interactions on a genome-wide scale Nature. 2012; 490 :556-560 Crossref Scopus (564) PubMed Google Scholar ) is used to identify structure-based protein-protein interactions between proteins encoded by genes harboring a somatic event and each MR protein.
Step 1: Proteins were first ranked by their VIPER statistical significance, integrated across all cohort samples using Stouffer’s method.
Step 2 : High-confidence interactions in the PrePPI database 1.2.0 ( Zhang et al., 2013 86. Zhang, Q.C. ∙ Petrey, D. ∙ Garzón, J.I. ... PrePPI: a structure-informed database of protein-protein interactions Nucleic Acids Res. 2013; 41 :D828-D833 Crossref Scopus (191) PubMed Google Scholar ) (likelihood > 0.5) were assigned an empirical p-value as follows: first they are ranked based on their likelihood scores; then p-value s were computed as the fraction of interactions with equal or better rank, normalized by the total number of PrePPI interactions in the database.
Step 3 : For each event type, a global PrePPI score ( 𝑆 𝑃 ) was computed as the − 𝐿 ⁢ 𝑜 ⁢ 𝑔 1 0 ⁡ ( 𝑃 𝑃 ⁢ 𝑟 ⁢ 𝑒 ⁢ 𝑃 ⁢ 𝑃 ⁢ 𝐼 ) , with 𝑃 𝑃 ⁢ 𝑟 ⁢ 𝑒 ⁢ 𝑃 ⁢ 𝑃 ⁢ 𝐼 generated by integrating the individual p-value s of all statistically significant PrePPI interactions ( p ≤ 0.05) for that event type, using Fisher’s method ( Jerby-Arnon et al., 2014 38. Jerby-Arnon, L. ∙ Pfetzer, N. ∙ Waldman, Y.Y. ... Predicting cancer-specific vulnerability via data-driven detection of synthetic lethality Cell. 2014; 158 :1199-1209 Full Text Full Text (PDF) Scopus (208) PubMed Google Scholar ). This produced three global PrePPI scores 𝑆 S N V 𝑃 ⁢ 𝑟 ⁢ 𝑒 ⁢ 𝑃 ⁢ 𝑃 ⁢ 𝐼 , 𝑆 D e l 𝑃 ⁢ 𝑟 ⁢ 𝑒 ⁢ 𝑃 ⁢ 𝑃 ⁢ 𝐼 , and 𝑆 A m p 𝑃 ⁢ 𝑟 ⁢ 𝑒 ⁢ 𝑃 ⁢ 𝑃 ⁢ 𝐼 .
Step 1: For each candidate MR, the p-value s corresponding to same-type events (e.g., all SCNA deletions) as assessed by aQTL, PrePPI, and CINDy, were integrated using Stouffer’s method. For fusion events, CINDy and PrePPI scores cannot be computed and are thus not integrated. For the aQTL analysis, fusion events were considered equivalent to SNVs. This produced 9 integrated p-value s for each statistically significant, candidate MR protein: 𝑝 𝑆 ⁢ 𝑁 ⁢ 𝑉 𝑎 ⁢ 𝑄 ⁢ 𝑇 ⁢ 𝐿 , 𝑝 𝐴 ⁢ 𝑚 ⁢ 𝑝 𝑎 ⁢ 𝑄 ⁢ 𝑇 ⁢ 𝐿 , 𝑝 𝐷 ⁢ 𝑒 ⁢ 𝑙 𝑎 ⁢ 𝑄 ⁢ 𝑇 ⁢ 𝐿 , 𝑝 𝑆 ⁢ 𝑁 ⁢ 𝑉 𝑃 ⁢ 𝑟 ⁢ 𝑒 ⁢ 𝑃 ⁢ 𝑃 ⁢ 𝐼 , 𝑝 𝐴 ⁢ 𝑚 ⁢ 𝑝 𝑃 ⁢ 𝑟 ⁢ 𝑒 ⁢ 𝑃 ⁢ 𝑃 ⁢ 𝐼 , 𝑝 𝐷 ⁢ 𝑒 ⁢ 𝑙 𝑃 ⁢ 𝑟 ⁢ 𝑒 ⁢ 𝑃 ⁢ 𝑃 ⁢ 𝐼 , 𝑝 𝑆 ⁢ 𝑁 ⁢ 𝑉 𝐶 ⁢ 𝐼 ⁢ 𝑁 ⁢ 𝐷 ⁢ 𝑦 , 𝑝 𝐴 ⁢ 𝑚 ⁢ 𝑝 𝐶 ⁢ 𝐼 ⁢ 𝑁 ⁢ 𝐷 ⁢ 𝑦 , and 𝑝 𝐷 ⁢ 𝑒 ⁢ 𝑙 𝐶 ⁢ 𝐼 ⁢ 𝑁 ⁢ 𝐷 ⁢ 𝑦 .
Step 2: After ranking all proteins in a cohort based on their VIPER score, we used Stouffer’s method to integrate the 9 p-value s for each statistically significant protein (i.e., candidate MR) with its VIPER p-value , thus creating a global MOMA p-value ( 𝑝 𝑀 ⁡ ( 𝑀 ⁢ 𝑅 ) ) . The latter representing the probability that a protein may be a bona fide MR by chance. A global MOMA score was then computed as 𝑆 𝑀 ⁡ ( 𝑀 ⁢ 𝑅 ) = − l o g 1 0 ⁢ ( 𝑝 𝑀 ⁡ ( 𝑀 ⁢ 𝑅 ) ) squared ( Figure S1 C).
The CRS was introduced in ( Alvarez et al., 2018 2. Alvarez, M.J. ∙ Subramaniam, P.S. ∙ Tang, L.H. ... A precision oncology approach to the pharmacological targeting of mechanistic dependencies in neuroendocrine tumors Nat. Genet. 2018; 50 :979-989 Crossref Scopus (130) PubMed Google Scholar ) as a statistically sound way to assess the fit of each sample within a cluster. For each sample, a distance vector V 1 , representing its distance from all other samples in the same cluster and a vector V 2 , representing its distance from all other samples in the cohort are computed. The sample distance matrix was computed by taking the weighted VIPER scores for each sample (VIPER activity values multiplied by each MR’s MOMA Score) and calculating the pairwise Pearson correlations. The normalized enrichment score of V 2 distances, ranked from the largest to the smallest one, in V 1 distances, is then assessed using aREA. This produces a p-value that represents the tightness and separation of the cluster being considered in relation to all other samples. A cluster-wide reliability score for each cluster is assessed as the average cluster reliability (NES) of each sample in the cluster, scaled between 0 and 1. Finally, the reliability of the entire clustering solution ( global cluster reliability score ) is assessed as the average of the cluster-wide reliability score of all clusters in the solution.
Each tissue-specific VIPER activity matrix was clustered using k -medoids clustering, with k ranging from 2 to 10 clusters, using a distance matrix defined by the weighted Pearson correlation between VIPER-inferred protein activity vectors. Weights were defined as the square of the integrated MOMA scores ( 𝑆 2 𝑀 ⁡ ( 𝑀 ⁢ 𝑅 𝑖 ) ) , thus increasing the contribution of high-scoring MRs ( Figure S1 D). Cluster Reliability Scores (CRS) were calculated for each sample and for each k value and the optimal number of clusters was determined as the first local maximum for the Global Cluster Reliability Score. We used a Kolmogorov–Smirnov test between the CRS of the samples from the optimal k- cluster solution (i.e., the one with the highest global reliability score) and the CRS of the samples from every other k -cluster solution to identify solutions that were statistically indistinguishable. Among those, we selected the one producing the best survival separation, as described in Survival analysis .
Silhouette Scores were computed as described in ( Rousseeuw, 1987 64. Rousseeuw, P.J. Silhouettes - a Graphical Aid to the Interpretation and Validation of Cluster-Analysis J. Comput. Appl. Math. 1987; 20 :53-65 Crossref Scopus (12710) Google Scholar ). They were used purely for visualization purposes, since they are well-established as metrics to assess cluster reliability.
Similar to Protein Activity-based clustering, each tissue-specific gene expression matrix was clustered using k -medoids clustering with k set as the same value chosen for the tissue-specific VIPER activity clustering. Distance between samples was defined using Pearson correlation between gene expression profiles. Cluster Reliability Scores and Silhouette scores were computed as described in above.
Clinical data was downloaded from the Broad Institute GDAC website ( http://gdac.broadinstitute.org ). We used the ‘survival’ R package version 2.41-3 (CRAN: survival ) ( Therneau and Grambsch, 2000 73. Therneau, T. ∙ Grambsch, P. Modeling Survival Data: Extending the Cox Model. Springer, 2000 Crossref Google Scholar ) to fit a Cox proportional hazards model to each sample grouping defined by the initial clustering. We then defined the “best” survival clusters as the one with the lowest proportion of observed to expected death events, and the “worst” survival as the highest observed/expected ratio. We then fit a second Cox model exclusively to samples from those two clusters and calculated the significance of survival differences between “best” and “worst” clusters in that model.
Saturation curves were generated by ascertaining the number of functional somatic events upstream of the N most statistically significant candidate MR proteins, ranked by their global MOMA score. To assess an appropriate saturation threshold, we first assessed how many functional somatic events 𝑁 𝐸 = 1 , 2 5 3 were upstream of the first half (1,253) of all regulatory proteins in that subtype, thus conservatively excluding proteins with a non-statistically significant VIPER activity. The saturation threshold then was set at 85% of that number 𝑁 0 = 0 . 8 5 × 𝑁 𝐸 = 1 , 2 5 3 . We then assessed how many of the N proteins with the highest VIPER activity were needed to identify 𝑁 0 somatic events in their upstream pathways. For all subtypes—except for 3 Ovarian cancer subtypes (S 1 , S 3 and S 4 )—saturation increased so rapidly and significantly, compared to an identical number of randomly selected regulatory proteins (null hypothesis), that increases in event number for N > 100 MRs were not statistically significant. To avoid contaminating functional genomic events with passenger ones, by using non-significant MRs to assess saturation, we thus selected a more conservative saturation threshold 𝑁 1 = 0 . 8 5 × 𝑁 𝐸 = 1 0 0 . We used 𝑁 1 for all subtypes except for the three ovarian cancer subtypes for which we used 𝑁 0 .
To visually represent genomic events upstream of MR proteins in each sample, as identified by saturation analysis, we used cBioPortal OncoPrint ( Cerami et al., 2012 17. Cerami, E. ∙ Gao, J. ∙ Dogrusoz, U. ... The cBio cancer genomics portal: an open platform for exploring multidimensional cancer genomics data Cancer Discov. 2012; 2 :401-404 Crossref Scopus (11634) PubMed Google Scholar ), with ComplexHeatmap ( Gu et al., 2016 32. Gu, Z. ∙ Eils, R. ∙ Schlesner, M. Complex heatmaps reveal patterns and correlations in multidimensional genomic data Bioinformatics. 2016; 32 :2847-2849 Crossref Scopus (4781) PubMed Google Scholar ). To avoid clutter, we restricted visualization to events previously reported as oncogenes and tumor suppressors ( Bailey et al., 2018 5. Bailey, M.H. ∙ Tokheim, C. ∙ Porta-Pardo, E. ... Comprehensive characterization of cancer driver genes and mutations Cell. 2018; 173 :371-385 Full Text Full Text (PDF) Scopus (1275) PubMed Google Scholar ; Repana et al., 2019 59. Repana, D. ∙ Nulsen, J. ∙ Dressler, L. ... The Network of Cancer Genes (NCG): a comprehensive catalogue of known and candidate cancer genes from cancer sequencing screens Genome Biol. 2019; 20 :1 Crossref Scopus (174) PubMed Google Scholar ). However, all events can be downloaded from the MOMA Web App. For amplified or deleted SCNAs, we determined whether an oncogene or tumor suppressor had been identified by MOMA as functional in that region, before region consolidation (see Genomic Events ). For regions with a single oncogene/tumor-suppressor its name is used as representative of the SCNA. When two were detected, their names separated by a semicolon were used. When three or more were detected, the SCNA locus is used followed by “-multi.” Due to size constraints for figure representation, a maximum of 50 most frequent events is shown. However, complete driver event lists are available on the MOMA Web App. The option to generate OncoPrint plots with all genes is prioritized for the next version of the application.
To assess the statistical significance of somatic event enrichment, upstream of checkpoint MRs, we performed a sample-specific analysis in each cohort. For each sample we identified activated MRs and their upstream somatic events using the same methodology described in the Saturation Analysis section. Then, for each sample, we computed the ratio of all validated CHASM ( Carter et al., 2009 16. Carter, H. ∙ Chen, S. ∙ Isik, L. ... Cancer-specific high-throughput annotation of somatic mutations: computational prediction of driver missense mutations Cancer Res. 2009; 69 :6660-6667 Crossref Scopus (375) PubMed Google Scholar ) and GISTIC2.0 ( Mermel et al., 2011 50. Mermel, C.H. ∙ Schumacher, S.E. ∙ Hill, B. ... GISTIC2.0 facilitates sensitive and confident localization of the targets of focal somatic copy-number alteration in human cancers Genome Biol. 2011; 12 :R41 Crossref Scopus (2277) PubMed Google Scholar ) putative driver events versus the total number of events ( Figure S3 C). To assess the cohort-level significance, we compared the number of samples with a ratio > 1 against a one-tailed binomial null distribution (p = 0.5). This showed that every cohort but one (LAML) showed significant enrichment in putative driver genes ( Figure S3 B).
The 407 MRs identified by saturation analysis that were also statistically significant in ≥ 4 subtypes (recurrence analysis) were clustered based on their VIPER-inferred activity, using a Euclidean distance metric and partitioning around medoids (PAM) for k = 2 to 100 clusters ( Figure S1 E). To compute the Euclidean distance, each MR was associated with a 112-dimensional vector representing its VIPER-inferred activity in each subtype. A Cluster Fitness score was defined as the Average Cluster Reliability Score for all MRs in a cluster. The analysis identified k = 24 as the optimal clustering solution ( Figure S5 A). Each “core-set” cluster identified by this analysis was then expanded by the m MRs with the best average Euclidean distance to those in the core-set, for m = 0, … 100. For each m additional MRs in each MRB, the trace of the covariance matrix of the Tumor Hallmark enrichment across the 24 MRBs was calculated to assess the total variance of the solution. This variance showed optimal increase for m = 6 ( Figure S5 B). These optimization steps to ensured uniqueness, specificity, and robustness of the MRB solution.
Each MRB is represented as a 112-dimensional vector representing its statistically significant activation (1), inactivation (−1) or neutral (0). The Jaccard concordance index between two MRBs is the scalar product of their associated vectors, such that co-activation or co-inactivation of the MRB in the same subtype increases the score by 1 while non-concordant activity in a subtype does not increase the score.
Cancer Hallmarks include 50 gene-sets defined by the Broad Institute and refined/simplified by others ( Drake et al., 2016 26. Drake, J.M. ∙ Paull, E.O. ∙ Graham, N.A. ... Phosphoproteome Integration Reveals Patient-Specific Networks in Prostate Cancer Cell. 2016; 166 :1041-1054 Full Text Full Text (PDF) Scopus (169) PubMed Google Scholar ; Liberzon et al., 2015 47. Liberzon, A. ∙ Birger, C. ∙ Thorvaldsdóttir, H. ... The Molecular Signatures Database (MSigDB) hallmark gene set collection Cell Syst. 2015; 1 :417-425 Full Text Full Text (PDF) Scopus (6412) PubMed Google Scholar ). To calculate downstream enrichment, we pooled genes from the regulons of each MR in each MR block that had a highly significantly likelihood of being a physical target (p < 0.05) and that were identified in at least 2 different tissues. We then assessed enrichment using the hypergeometric distribution between MR targets and each Hallmark’s gene set. The same approach was used to compute enrichment in KEGG and Reactome gene sets. Significance was assessed by Benjamini-Hochberg False Discovery Rate (FDR) to account for multiple hypothesis testing. Only significant enrichments (FDR < 0.05) are shown. To calculate enrichment of genomic events upstream of MR blocks, we selected the top 100 most significant predicted upstream genomic events, for both SNVs and functional SCNA genes, in subtypes with significant MRB activity (p < 10 −3 ) (See Supplemental Data SD6). The hypergeometric overlap between these gene sets and the Hallmark, KEGG and Reactome gene sets was performed as described above. A fixed event number was chosen to avoid biasing the statistical analysis for MRBs with a greater number of upstream events. All enrichment analyses were done using the enricher function from the R clusterProfiler package ( Yu et al., 2012 84. Yu, G. ∙ Wang, L.G. ∙ Han, Y. ... clusterProfiler: an R package for comparing biological themes among gene clusters OMICS. 2012; 16 :284-287 Crossref Scopus (18538) PubMed Google Scholar ).
Achilles shRNA DEMETER knockout scores were downloaded from The Broad Institute for all cell lines in CCLE for all TFs and co-TFs analyzed by MOMA. To identify a natural threshold to assess essentiality, Achilles dependency scores were re-normalized by fitting a bimodal normal mixture models using the R package ‘mixtools’ ( Benaglia et al., 2009 8. Benaglia, T. ∙ Chauveau, D. ∙ Hunter, D.R. ... mixtools: An R Package for Analyzing Mixture Models 32 :29 Google Scholar ). The normal probability density with the most positive (i.e., least essential) mean was set as the null-hypothesis ( essentiality null hypothesis probability density ) to assess essentiality as a z-score. This allows setting an appropriate null hypothesis to assess essentiality on a gene by gene basis.
For each of the 112 MOMA subtypes, we matched the MR activity vector, weighted by the cohort-specific MOMA score of each MR, to the protein activity profile of each CCLE cell line, using the ‘viperSimilarity’ algorithm included in the VIPER algorithm ( Alvarez et al., 2016 1. Alvarez, M.J. ∙ Shen, Y. ∙ Giorgi, F.M. ... Functional characterization of somatic mutations in cancer using network-based inference of protein activity Nat. Genet. 2016; 48 :838-847 Crossref Scopus (498) PubMed Google Scholar ), thus identifying the cell lines that best recapitulates subtype-specific MRs as possible dependencies. We then assessed the essentiality of each MR in cell lines that were significant matches (p < 0.01; Bonferroni correction) versus those providing clear non-matches (p = 1) using a non-parametric rank-based Mann-Whitney-Wilcox test based on the null hypothesis probability density defined in the previous paragraph; significant FDRs after multiple hypothesis correction (Benjamini-Hochberg FDR < 0.05) were considered essential subtype-specific MRs. Essentiality was then stratified for each MR across the subtypes where that MR was statistically significantly active. To calculate statistical significance of the enrichment of essential genes, a null model was built by taking 10 6 random selections of MRs equivalent to the number of MRs in each tumor checkpoint and then counting the number of essential MRs across all subtypes. These permutations were then fitted to a normal distribution ( Figure S5 F).
ARACNE was run with 100 bootstrap iterations and a mutual information significance threshold of p = 10 −8 , separately for candidate TF and coTF regulators, using METABRIC gene expression profile data. For each sample, protein activity was inferred using VIPER. Survival analysis was performed by first calculating the mean VIPER activity across checkpoint proteins and binning samples into “high” and “low” quantiles, for each checkpoint. Clinical data was downloaded from the cBioPortal. We used the ‘survival’ R/CRAN package version 2.41-3 to fit a Cox proportional hazards model to each sample grouping, using the last known follow-up date, and testing for significant survival differences with that model.
For each of the candidate Master Regulator proteins in MRB:2 we computed the rankings based on the integrated p-value of each MR-event in prostate cancer, as well as the cross-pancancer rankings for the same interactions. For each MR and each somatic event, p-value s were generated as discussed in the DIGGIT methods section. A joint rank from these two lists was then created using an additive mean and the top 20 interactions were retained for each MR. These Interactions were visualized as a network graph ( Figure 6 F) with the Cytoscape software package ( Shannon et al., 2003 67. Shannon, P. ∙ Markiel, A. ∙ Ozier, O. ... Cytoscape: a software environment for integrated models of biomolecular interaction networks Genome Res. 2003; 13 :2498-2504 Crossref Scopus (32549) PubMed Google Scholar ). Network edges between MRB:2 proteins and mutation events identified in Figure 6 F were included in the sample/event plot ( Figure 6 E). Events with significant copy number associations were also included if they contained one or more samples with a mutation in that same protein. Additionally, for interactions with only copy number events (deletion, amplification) we computed the aREA association score with the average activity of MRB:2, and selected the top 10 most significant deleted and amplified genes, respectively, to include on the plots.
Silencing of SORBS3, BCAR1, MAP3K7, PTEN, Tp53 was achieved by lentiviral delivery of validated shRNAs. Two target-specific shRNAs in the pLKO.1 lentiviral vector were co-transfected in HEK293 cells together with the pMD2.G and psPAX2 envelope and packaging plasmids in 1% FBS. pMD2.G and psPAX2 were gifts from the laboratory of Didier Trono (Addgene plasmid # 12259; http://n2t.net/addgene:12259; RRID:Addgene_12259 and Addgene plasmid # 12260; http://n2t.net/addgene:12260; RRID:Addgene_12260) Supernatants were recovered at 24 and 48 h and were later concentrated using the Lenti-X concentrator reagent (Takara #631231). The 22Rv1 human prostate cancer cell line was spin-infected at multiplicities of infection (MOI) of approximately 1 in the presence of 8 μg/mL polybrene (hexadimethrine bromide), then incubated with virus for approximately 18 h in a 37°C, 5% CO2 incubator. At 48 h post-infection, cells were selected with 2 μg/mL puromycin and at 96 h post-transduction medium was changed to fresh complete medium. Efficiency of gene silencing was assessed by qPCR using primers for each of the targets and comparing target expression against cells transduced with the MISSION® Non-Target shRNA Control Transduction Particles.
To assess the effect of selected gene silencing on MRB:2 MRs, we generated a signature for count data from each experimental condition, using the control condition as a reference, and performing a t test, using 100 permutations of the samples (columns) as a null model. This signature and null model were inputted to the ‘msviper’ function in the VIPER Bioconductor package, along with the TCGA Prostate cancer regulon. A second null model was constructed by re-running this same analysis on 100 permutations of the column labels, and a t test was performed between the VIPER scores from each condition and this null, to assess the overall ability in reverting the signature for checkpoint 2 proteins.
Control and silenced cells where seeded at high concentration in 6 well plates in triplicate using a silicone insert. At day 1 the silicone insert was removed and cell migration into the gap was monitored at 24 h, 48 h and 72 h h. The percent of migrating cells was quantified, relative to non-targeting controls, by measuring the cell-free area with ImageJ software. A Mann–Whitney U test was used to calculate the significance (P value) of the difference between the control (n = 3 replicates) and knockdown cells (n = 6 replicates; 3 for shRNA shRNA#1 and 3 for shRNA#2)
5 × 10 4 cells were seeded in the BD FluoroBlok inserts (BD Biosciences) in FBS-free media. Inserts were placed in 24-well plates containing RPMI supplemented with 10% FBS as chemoattractant. Invasion was monitored using a bottom-reading fluorescence plate reader and invading cells detected using calcein AM fluorescent labeling. The fluorescence signal was quantified with ImageJ, and a Mann–Whitney U test was used to calculate the significance ( p-value ) of the difference between the control (n = 3 replicates) and gene-silenced cells (n = 6 replicates; 3 for shRNA shRNA#1 and 3 for shRNA#2).
IDIBELL′s Institutional Animal Care and Use Committee (IACUC) had approved all animal procedures. For analyses in vivo , 5 × 10 6 22Rv1 cells expressing the control or target shRNA lentivirus were mixed with Matrigel (1:1 vol/vol) and injected into the right flank of immunodeficient nude mice (Envigo, Nude-Foxn1 nu ); tumor growth was monitored with calipers until one of the experimental groups reached the maximum 1.5 cm 3 tumor volume. One-way analysis of variance (ANOVA) was used to calculate statistical significance ( p-value ) of the difference between control and silenced groups.
Gene counts for this dataset were downloaded from Gene Expression Ominibus, (GEO), GEO: GSE130534 ( Handle et al., 2019 34. Handle, F. ∙ Prekovic, S. ∙ Helsen, C. ... Drivers of AR indifferent anti-androgen resistance in prostate cancer cells Sci. Rep. 2019; 9 :13786 Crossref Scopus (43) PubMed Google Scholar ). Analysis of the counts were performed using the DEbrowser tool ( Kucukural et al., 2019 43. Kucukural, A. ∙ Yukselen, O. ∙ Ozata, D.M. ... DEBrowser: interactive differential expression analysis and visualization tool for count data BMC Genomics. 2019; 20 :6 Crossref Scopus (140) PubMed Google Scholar ).
We used a dataset of protein activity profiles of drug response, as inferred from a screening of 120 FDA-approved drugs and 217 late-stage experimental compounds (in Phase 2 and 3 trials) in the DU145 prostate cancer cell line ( Vasciaveo et al., 2020 79. Vasciaveo, A. ∙ Douglass, E. ∙ Karan, C. ... Drug Screening Analysis of 337 Compounds on DU145 Prostate Cancer Cell Line. 2020; bioRxiv 2020/234179 Google Scholar ). Profiles were generated at 24 h following perturbation with the compound’s IC20 concentration determined at 48 h by 7-point dose response curves. This concentration was selected to represent the highest sub-lethal concentration that would help elucidate the compound mechanism of action without significantly triggering additional cell response mechanisms, e.g., associated with drug stress response or cell death, that would confound the analysis.
The aREA function from the R VIPER package 1.20.0 was used to compute a Normalized Enrichment Score (NES) for each drug, based on the enrichment of differentially activated proteins, as inferred by VIPER, in MRB:14 MRs. NES values were converted to p-value s and corrected for multiple hypothesis testing, using the Bonferroni method. Finally, -Log 10 p was used as a score to prioritize drugs and statistically significant drugs, with scores greater than two, were considered as potential candidates to elicit MRB:14 activation.
Gene expression data (counts) from two studies ( Rajan et al., 2014 57. Rajan, P. ∙ Sudbery, I.M. ∙ Villasevil, M.E. ... Next-generation sequencing of advanced prostate cancer treated with androgen-deprivation therapy Eur. Urol. 2014; 66 :32-39 Full Text Full Text (PDF) Scopus (116) PubMed Google Scholar ; Zhang et al., 2016 87. Zhang, D. ∙ Park, D. ∙ Zhong, Y. ... Stem cell and neurogenic gene-expression profiles link prostate basal cells to aggressive prostate cancer Nat. Commun. 2016; 7 :10798 Crossref Scopus (158) PubMed Google Scholar ) were collected. Both studies were analyzed in the same way as follows. Counts downloaded from the GEO portal (GEO: GSE48403 , Rajan et al., 2014 57. Rajan, P. ∙ Sudbery, I.M. ∙ Villasevil, M.E. ... Next-generation sequencing of advanced prostate cancer treated with androgen-deprivation therapy Eur. Urol. 2014; 66 :32-39 Full Text Full Text (PDF) Scopus (116) PubMed Google Scholar ; and GEO: GSE67070 , Zhang et al., 2016 87. Zhang, D. ∙ Park, D. ∙ Zhong, Y. ... Stem cell and neurogenic gene-expression profiles link prostate basal cells to aggressive prostate cancer Nat. Commun. 2016; 7 :10798 Crossref Scopus (158) PubMed Google Scholar ) were normalized using the variance stabilizing transformation function available from the DESeq2 package 1.26.0 in R. The metaVIPER approach ( Ding et al., 2018 25. Ding, H. ∙ Douglass, Jr., E.F. ∙ Sonabend, A.M. ... Quantitative assessment of protein activity in orphan tissues and single cells using the metaVIPER algorithm Nat. Commun. 2018; 9 :1471 Crossref Scopus (66) PubMed Google Scholar ), available from the R VIPER package, was then used to generate two interactomes from the TCGA PRAD cohort (this manuscript) and the 2015 SU2C metastatic Castration Resistant Prostate Cancer (mCRPC) cohort ( Robinson et al., 2015 62. Robinson, D. ∙ Van Allen, E.M. ∙ Wu, Y.M. ... Integrative clinical genomics of advanced prostate cancer Cell. 2015; 161 :1215-1228 Full Text Full Text (PDF) Scopus (2441) PubMed Google Scholar ). Regulons were pruned to the top 100 targets with the highest likelihood using the pruneRegulon function of the VIPER package. Gene expression signatures for each individual sample were computed using the method ttest available from the viper function. Enrichment analysis on VIPER-inferred protein activity signatures was computed and resultant NES scores used. Clustering of labeled samples due to similar activation profiles of MRB:14 on patient samples was performed using the hierarchical clustering algorithm available from the ComplexHeatmap package.
Data for PAM50 annotation and luminal/basal subtyping from two studies on TCGA BRCA ( Ciriello et al., 2015 20. Ciriello, G. ∙ Gatza, M.L. ∙ Beck, A.H. ..., TCGA Research Network Comprehensive Molecular Portraits of Invasive Lobular Breast Cancer Cell. 2015; 163 :506-519 Full Text Full Text (PDF) Scopus (1329) PubMed Google Scholar ) and BLCA ( Robertson et al., 2017 61. Robertson, A.G. ∙ Kim, J. ∙ Al-Ahmadie, H. ... Comprehensive Molecular Characterization of Muscle-Invasive Bladder Cancer Cell. 2017; 171 :540-556 Full Text Full Text (PDF) Scopus (1532) PubMed Google Scholar ) were downloaded. Protein activity profiles for the TCGA BRCA and BLCA cohorts were computed and enrichment scores for MRB:2 and MRB:14 derived. MRB:2, which is a proliferation-associated block (described above), was used as a control. Patients were sorted based on activity NES scores to show correlation between high MRB:14 activity and luminal subtypes as determined by published PAM50 classifiers.
Small molecule compounds were purchased from Selleck Chemicals (Houston, TX). Culture inserts for migration studies were from iBidi (Gräfelfing, Germany, #80209).
Cell pellets were lysed in buffer composed as follows: 50mM Tris-HCl, pH 7.5; 250 mM NaCl; 50 mM NaF; 10 mM Na-pyrophosphate; 2.5mM EDTA; 2.5 mM EGTA; 2 mM sodium orthovanadate; 2% CHAPS; 0.5% Triton X-100; Phosphatase cocktail 3 from Sigma at 1:15 dilution; Protease cocktail (Pierce) 1:15 dilution. After SDS-PAGE separation of equal amounts (∼30 ug) of protein lysate from each sample, proteins were transferred to PVDF membranes and then probed with antibodies using standard procedures. Primary antibodies were as follows: AR (Cell Signaling Technology, Cat#5153S, RRID: AB_10691711 ); GRHL2 (Millipore Sigma, Cat#HPA004820, RRID: AB_1857928 ); SPDEF (Proteintech, Cat#11467-1-AP, RRID: AB_2877765 ); g-catenin/JUP (BD Biosciences, Cat#610253, RRID: AB_397648 ); CDH1 (BD Biosciences, Cat#610404, RRID: AB_397786 ), diluted 1:1000 each.
These assays were performed using manufactured cell culture inserts with a defined cell-free gap (iBidi) in 6-well plates. DU145 cells were plated in the inserts at 4 × 10 5 cells per ml (70 uL per channel). At 24 h after plating cells images of the gap were taken (T = 0) and medium was replaced with medium containing the drugs, or DMSO as vehicle control. All drugs were tested at their EC 50 concentration, 7.2 mM, 1.2 mM, 44 nM, and 8.77 mM for fedratinib, pevonedistat, lexibulin, and ENMD-2076, respectively. Negative control drugs were also tested at their EC 50 concentration, 1.65 mM, 3.5 mM, and 28nM for triapine, dorsomorphin, and raltiterxed, respectively. After 24 h (T = 24), additional images (n ≥ 3) were taken along the full length of the gap for each treatment. Images were analyzed using the MRI Wound Healing Tool macro ( http://dev.mri.cnrs.fr/projects/imagej-macros/wiki/Wound_Healing_Tool ) installed in ImageJ. Total gap area was calculated per image and averaged across images for a given sample and converted to % gap remaining (see Figure 7 H, I legends).
Analysis was conducted in R ( R-Core-Team, 2020 56. R-Core-Team R: A Language and Environment for Statistical Computing R Foundation for Statistical Computing, Vienna, Austria, 2020 Google Scholar ) and figures were produced using the ggplot2 (CRAN: ggplot2 ) and Complex Heatmap packages ( Gu et al., 2016 32. Gu, Z. ∙ Eils, R. ∙ Schlesner, M. Complex heatmaps reveal patterns and correlations in multidimensional genomic data Bioinformatics. 2016; 32 :2847-2849 Crossref Scopus (4781) PubMed Google Scholar ; Wickham, 2016 82. Wickham, H. ggplot2: Elegant Graphics for Data Analysis New York: Springer-Verlag, 2016 Crossref Google Scholar ). Graphical abstract was created using BioRender.com . Statistical parameters and tests are reported in the main text, Figures, Figure legends and Tables. Whenever appropriate, p values were adjusted for multiple comparisons using qvalue package in R ( Storey et al., 2020 68. Storey, J.D., Bass, A.J., Dabney, A., and Robinson, D. (2020). Q-value estimation for false discovery rate control. https://doi.org/10.18129/B9.bioc.qvalue . Google Scholar ). The section entitled ‘‘Method Details’’ describes the statistical analyses performed in conjunction with each step. Data are judged to be statistically significant when p < 0.05 in applied statistical analyses unless otherwise noted that a higher threshold was used.
Interactive MOMA web application: http://www.mr-graph.org/
MOMA R package: https://bioconductor.org/packages/release/bioc/html/MOMA.html

Section: Acknowledgments

We acknowledge the genomic and small-animal imaging shared resources of the Herbert Irving Comprehensive Cancer Center, supported in part by P30CA013696. This work was also supported by the National Cancer Institute’s (NCI) Office of Cancer Target Discovery and Development (CTDˆ2) initiative (U01CA217858) to A.C., an NCI Outstanding Investigator Award (R35CA197745) to A.C., the NCI Research Centers for Cancer Systems Biology Consortium (U54CA209997) to A.C., the Prostate Cancer Foundation grant 18CHAL07 to A.C., NIH R01 (R01CA173481 and R01CA196662) to C.A.S., and the NIH Instrumentation grants (S10OD012351 and S10 OD021764) to A.C. A.A. was supported by grants from the Spanish ISCIII-MINECO (PI19/00342; PI16/01070), EAURF/407003/XH, a DOD Award (W81XWH-18-1-0193), the CERCA Program/Generalitat de Catalunya, and FEDER/ERDF funds—a way to Build Europe. A.V. is supported by the DOD Early Investigator Research Award (W81XWH19-1-0337).
Conceptualization and Methodology, E.O.P., A.A., F.M.G., M.J.A., C.AS., and A.C.; Investigation and Formal Analysis, E.O.P, A.A., P.S., F.M.G, E.F.D., S.J.J., A.V., M.J.A., and A.C.; Resources and Software, E.O.P., B.C., S.J.J., S.T., and P.S.; Writing – Original Draft, E.O.P, P.S., and A.C.; Writing – Review and Editing, all authors.
A.C. is founder, equity holder, consultant, and director of DarwinHealth Inc., a company that has licensed some of the algorithms used in this manuscript from Columbia University. M.J.A. is Chief Scientific Officer and equity holder at DarwinHealth, Inc. Patent 10,790,040, titled “Virtual Inference of Protein Activity by Regulon Analysis” has issued on Sept. 29, 2020 related to the VIPER method. Columbia University is also an equity holder in DarwinHealth Inc.

Section: Supplemental Information (6)

Download all Spreadsheet (36.78 KB) Table S1: Sample and clustering information, related to Figures 2 and S2 Spreadsheet (44.80 KB) Table S2: Master regulator checkpoints and recurrence analyses, related to Figures 2, 3, and S3 Spreadsheet (22.50 KB) Table S3: Comparison to other datasets, related to Figures 3 and 6 Spreadsheet (3.48 MB) Table S4: MRB analyses, related to Figures 5, S6, and STAR methods Spreadsheet (19.54 KB) Table S5: Validation experiments additional information, related to Figure 7 and STAR methods Spreadsheet (48.72 MB) Table S6: MOMA cohort data, related to Figures 3 and 4
