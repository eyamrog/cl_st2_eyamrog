Title: Representational geometry of perceptual decisions in the monkey parietal cortex


Abstract: Summary

Lateral intraparietal (LIP) neurons represent formation of perceptual decisions involving eye movements. In circuit models for these decisions, neural ensembles that encode actions compete to form decisions. Consequently, representation and readout of the decision variables (DVs) are implemented similarly for decisions with identical competing actions, irrespective of input and task context differences. Further, DVs are encoded as partially potentiated action plans through balance of activity of action-selective ensembles. Here, we test those core principles. We show that in a novel face-discrimination task, LIP firing rates decrease with supporting evidence, contrary to conventional motion-discrimination tasks. These opposite response patterns arise from similar mechanisms in which decisions form along curved population-response manifolds misaligned with action representations. These manifolds rotate in state space based on context, indicating distinct optimal readouts for different tasks. We show similar manifolds in lateral and medial prefrontal cortices, suggesting similar representational geometry across decision-making circuits.

Section: Introduction

Perceptual decision-making relies on deliberative processes that evaluate and compare possible alternatives based on sensory information. A commonly suggested mechanism for such decisions is to integrate sensory information into a decision variable (DV), which is compared against a decision criterion or bound to commit to a choice ( Green and Swets, 1966 23. Green, D.M. ∙ Swets, J.A. Signal Detection Theory and Psychophysics John Wiley, 1966 Google Scholar ; Link, 1992 46. Link, S.W. The Wave Theory of Difference and Similarity Lawrence Erlbaum Assoc, 1992 Google Scholar ; Ratcliff and McKoon, 2008 64. Ratcliff, R. ∙ McKoon, G. The diffusion decision model: theory and data for two-choice decision tasks Neural Comput. 2008; 20 :873-922 Crossref Scopus (1909) PubMed Google Scholar ; Smith and Vickers, 1988 74. Smith, P.L. ∙ Vickers, D. The accumulator model of two-choice discrimination J. Math. Psychol. 1988; 32 :135-168 Crossref Scopus (185) Google Scholar ). Consistent with these behavioral models, multiple brain structures show activity compatible with representation of the DV ( Gold and Shadlen, 2007 22. Gold, J.I. ∙ Shadlen, M.N. The neural basis of decision making Annu. Rev. Neurosci. 2007; 30 :535-574 Crossref Scopus (2478) PubMed Google Scholar ; Shadlen and Kiani, 2013 71. Shadlen, M.N. ∙ Kiani, R. Decision making as a window on cognition Neuron. 2013; 80 :791-806 Full Text Full Text (PDF) Scopus (337) PubMed Google Scholar ). For example, neurons in the lateral intraparietal (LIP) area increase their average firing rate in response to sensory evidence supporting their preferred saccade target during a motion direction discrimination task ( Bennur and Gold, 2011 5. Bennur, S. ∙ Gold, J.I. Distinct representations of a perceptual decision and the associated oculomotor plan in the monkey lateral intraparietal area J. Neurosci. 2011; 31 :913-921 Crossref Scopus (125) PubMed Google Scholar ; Shadlen and Newsome, 2001 72. Shadlen, M.N. ∙ Newsome, W.T. Neural basis of a perceptual decision in the parietal cortex (area LIP) of the rhesus monkey J. Neurophysiol. 2001; 86 :1916-1936 Crossref Scopus (1267) PubMed Google Scholar ). The hypothesis that the average LIP firing rate reflects accumulated evidence has successfully accounted for various aspects of decision-making behavior such as choice and reaction time distributions ( Churchland et al., 2008 12. Churchland, A.K. ∙ Kiani, R. ∙ Shadlen, M.N. Decision-making with multiple alternatives Nat. Neurosci. 2008; 11 :693-702 Crossref Scopus (474) PubMed Google Scholar ; Purcell and Kiani, 2016 61. Purcell, B.A. ∙ Kiani, R. Neural mechanisms of post-error adjustments of decision policy in parietal cortex Neuron. 2016; 89 :658-671 Full Text Full Text (PDF) Scopus (98) PubMed Google Scholar ) as well as choice confidence ( Kiani and Shadlen, 2009 36. Kiani, R. ∙ Shadlen, M.N. Representation of confidence associated with a decision by neurons in the parietal cortex Science. 2009; 324 :759-764 Crossref Scopus (665) PubMed Google Scholar ). Similar encoding of the DV has been found in many other brain structures ( Deverett et al., 2018 16. Deverett, B. ∙ Koay, S.A. ∙ Oostland, M. ... Cerebellar involvement in an evidence-accumulation decision-making task eLife. 2018; 7 :e36781 Crossref Scopus (47) PubMed Google Scholar ; Ding and Gold, 2010 17. Ding, L. ∙ Gold, J.I. Caudate encodes multiple computations for perceptual decisions J. Neurosci. 2010; 30 :15747-15759 Crossref Scopus (207) PubMed Google Scholar , 2012 18. Ding, L. ∙ Gold, J.I. Neural correlates of perceptual decision making before, during, and after decision commitment in monkey frontal eye field Cereb. Cortex. 2012; 22 :1052-1067 Crossref Scopus (154) PubMed Google Scholar ; Donner et al., 2009 19. Donner, T.H. ∙ Siegel, M. ∙ Fries, P. ... Buildup of choice-predictive activity in human motor cortex during perceptual decision making Curr. Biol. 2009; 19 :1581-1585 Full Text Full Text (PDF) Scopus (338) PubMed Google Scholar ; Horwitz and Newsome, 1999 26. Horwitz, G.D. ∙ Newsome, W.T. Separate signals for target selection and movement specification in the superior colliculus Science. 1999; 284 :1158-1161 Crossref Scopus (277) PubMed Google Scholar ; Kiani et al., 2014a 38. Kiani, R. ∙ Cueva, C.J. ∙ Reppas, J.B. ... Dynamics of neural population responses in prefrontal cortex indicate changes of mind on single trials Curr. Biol. 2014; 24 :1542-1547 Full Text Full Text (PDF) Scopus (99) PubMed Google Scholar ; Kim and Basso, 2008 40. Kim, B. ∙ Basso, M.A. Saccade target selection in the superior colliculus: a signal detection theory approach J. Neurosci. 2008; 28 :2991-3007 Crossref Scopus (86) PubMed Google Scholar ; Kim and Shadlen, 1999 41. Kim, J.N. ∙ Shadlen, M.N. Neural correlates of a decision in the dorsolateral prefrontal cortex of the macaque Nat. Neurosci. 1999; 2 :176-185 Crossref Scopus (719) PubMed Google Scholar ; de Lafuente et al., 2015 14. de Lafuente, V. ∙ Jazayeri, M. ∙ Shadlen, M.N. Representation of accumulating evidence for a decision in two parietal areas J. Neurosci. 2015; 35 :4306-4318 Crossref Scopus (110) PubMed Google Scholar ; Peixoto et al., 2018 57. Peixoto, D. ∙ Kiani, R. ∙ Chandrasekaran, C. ... Population dynamics of choice representation in dorsal premotor and primary motor cortex bioRxiv. 2018; Crossref Scopus (0) Google Scholar ; Ratcliff et al., 2003 65. Ratcliff, R. ∙ Cherian, A. ∙ Segraves, M. A comparison of macaque behavior and superior colliculus neuronal activity to predictions from models of two-choice decisions J. Neurophysiol. 2003; 90 :1392-1407 Crossref Scopus (303) PubMed Google Scholar ) and in other perceptual tasks ( Hanks et al., 2015 24. Hanks, T.D. ∙ Kopec, C.D. ∙ Brunton, B.W. ... Distinct relationships of parietal and prefrontal cortices to evidence accumulation Nature. 2015; 520 :220-223 Crossref Scopus (294) PubMed Google Scholar ; Heekeren et al., 2004 25. Heekeren, H.R. ∙ Marrett, S. ∙ Bandettini, P.A. ... A general mechanism for perceptual decision-making in the human brain Nature. 2004; 431 :859-862 Crossref Scopus (573) PubMed Google Scholar ; Hou et al., 2019 28. Hou, H. ∙ Zheng, Q. ∙ Zhao, Y. ... Neural correlates of optimal multisensory decision making under time-varying reliabilities with an invariant linear probabilistic population code Neuron. 2019; 104 :1010-1021.e10 Full Text Full Text (PDF) Scopus (37) PubMed Google Scholar ; Kumano et al., 2016 43. Kumano, H. ∙ Suda, Y. ∙ Uka, T. Context-dependent accumulation of sensory evidence in the parietal cortex underlies flexible task switching J. Neurosci. 2016; 36 :12192-12202 Crossref Scopus (21) PubMed Google Scholar ; O’Connell et al., 2012 52. O’Connell, R.G. ∙ Dockree, P.M. ∙ Kelly, S.P. A supramodal accumulation-to-bound signal that determines perceptual decisions in humans Nat. Neurosci. 2012; 15 :1729-1735 Crossref Scopus (461) PubMed Google Scholar ; Philiastides and Sajda, 2006 59. Philiastides, M.G. ∙ Sajda, P. Temporal characterization of the neural correlates of perceptual decision making in the human brain Cereb. Cortex. 2006; 16 :509-518 Crossref Scopus (275) PubMed Google Scholar ; Purcell et al., 2010 62. Purcell, B.A. ∙ Heitz, R.P. ∙ Cohen, J.Y. ... Neurally constrained modeling of perceptual decision making Psychol. Rev. 2010; 117 :1113-1143 Crossref Scopus (267) PubMed Google Scholar ; Thura and Cisek, 2014 75. Thura, D. ∙ Cisek, P. Deliberation and commitment in the premotor and primary motor cortex during dynamic decision making Neuron. 2014; 81 :1401-1416 Full Text Full Text (PDF) Scopus (194) PubMed Google Scholar ).
These experimental findings have promoted the proposition that decisions are formed through competition of neuronal modules with specific choice preferences until one module “wins” and dictates the choice. The strongest supporting evidence for this proposition is observed in motor planning regions of the brain, where neurons represent the formation of decisions communicated through their preferred actions. Sensory information biases this competition such that the evidence supporting a choice increases the activity of corresponding neurons. Because the competition happens at the level of action selection, what distinguishes different perceptual tasks is the sensory information being integrated, not the integrator itself. These ideas shape existing theoretical frameworks for implementation of the decision-making process with biophysically realistic neural networks ( Beck et al., 2008 4. Beck, J.M. ∙ Ma, W.J. ∙ Kiani, R. ... Probabilistic population codes for Bayesian decision making Neuron. 2008; 60 :1142-1152 Full Text Full Text (PDF) Scopus (471) PubMed Google Scholar ; Deco et al., 2013 15. Deco, G. ∙ Rolls, E.T. ∙ Albantakis, L. ... Brain mechanisms for perceptual and reward-related decision-making Prog. Neurobiol. 2013; 103 :194-213 Crossref Scopus (111) PubMed Google Scholar ; Lo and Wang, 2006 47. Lo, C.C. ∙ Wang, X.J. Cortico-basal ganglia circuit mechanism for a decision threshold in reaction time tasks Nat. Neurosci. 2006; 9 :956-963 Crossref Scopus (366) PubMed Google Scholar ; Mazurek et al., 2003 48. Mazurek, M.E. ∙ Roitman, J.D. ∙ Ditterich, J. ... A role for neural integrators in perceptual decision making Cereb. Cortex. 2003; 13 :1257-1269 Crossref Scopus (478) PubMed Google Scholar ; Purcell et al., 2010 62. Purcell, B.A. ∙ Heitz, R.P. ∙ Cohen, J.Y. ... Neurally constrained modeling of perceptual decision making Psychol. Rev. 2010; 117 :1113-1143 Crossref Scopus (267) PubMed Google Scholar ; Wang, 2002 78. Wang, X.J. Probabilistic decision making by slow reverberation in cortical circuits Neuron. 2002; 36 :955-968 Full Text Full Text (PDF) Scopus (847) PubMed Google Scholar ; Wimmer et al., 2015 79. Wimmer, K. ∙ Compte, A. ∙ Roxin, A. ... Sensory integration dynamics in a hierarchical network explains choice probabilities in cortical area MT Nat. Commun. 2015; 6 :6177 Crossref Scopus (97) PubMed Google Scholar ; Wong and Wang, 2006 81. Wong, K.F. ∙ Wang, X.J. A recurrent network mechanism of time integration in perceptual decisions J. Neurosci. 2006; 26 :1314-1328 Crossref Scopus (638) PubMed Google Scholar ). Such networks have been quite successful in explaining past behavioral and physiological data.
However, several key assumptions at the core of these frameworks have yet to be tested experimentally. First, it is unclear whether the neural representation of the integration process is shared across tasks and whether potential differences necessitate different readout schemes for downstream circuits. Second, it is unclear whether the DVs are encoded as intermediate response patterns between competing actions: are the pools of neurons competing during decision formation identical to those representing the final actions? Testing these assumptions has been challenging because past studies were largely limited to a single behavioral task. A side-by-side comparison of multiple tasks is necessary for a rigorous test as it creates an opportunity to observe qualitative and quantitative differences of neural activity across tasks.
Here, we examine the geometry of population activity in LIP in seven monkeys and three tasks: a motion direction discrimination task, which has been extensively used to study perceptual decisions, and two variants of a novel face categorization task, where subjects report the species or expression of a face ( Okazawa et al., 2018 54. Okazawa, G. ∙ Sha, L. ∙ Purcell, B.A. ... Psychophysical reverse correlation reflects both sensory and decision-making processes Nat. Commun. 2018; 9 :3479 Crossref Scopus (42) PubMed Google Scholar ). We find a striking mismatch in patterns of average firing rates among the tasks. Specifically, mean firing rates during the face tasks are inversely correlated with the sensory evidence in favor of the preferred saccade target of neurons—the opposite of the pattern observed in the motion task ( Churchland et al., 2008 12. Churchland, A.K. ∙ Kiani, R. ∙ Shadlen, M.N. Decision-making with multiple alternatives Nat. Neurosci. 2008; 11 :693-702 Crossref Scopus (474) PubMed Google Scholar ; Kiani et al., 2008 37. Kiani, R. ∙ Hanks, T.D. ∙ Shadlen, M.N. Bounded integration in parietal cortex underlies decisions even when viewing duration is dictated by the environment J. Neurosci. 2008; 28 :3017-3029 Crossref Scopus (347) PubMed Google Scholar ; Shadlen and Newsome, 2001 72. Shadlen, M.N. ∙ Newsome, W.T. Neural basis of a perceptual decision in the parietal cortex (area LIP) of the rhesus monkey J. Neurophysiol. 2001; 86 :1916-1936 Crossref Scopus (1267) PubMed Google Scholar ). We show that this inconsistency arises because, at each moment, the LIP population encodes the DV on a curved manifold in the state space, and this manifold changes in a task-dependent manner. We establish that the curved manifold provides an explicit code ( Misaki et al., 2010 50. Misaki, M. ∙ Kim, Y. ∙ Bandettini, P.A. ... Comparison of multivariate classifiers and response normalizations for pattern-information fMRI Neuroimage. 2010; 53 :103-118 Crossref Scopus (359) PubMed Google Scholar ) for both the DV and stimulus difficulty but the latter does not have apparent functional contributions to the monkey’s confidence about the choice. Further, we show that task dependence of curved manifolds is shaped by task rules and is not explained solely by differences of sensory stimuli. Finally, we demonstrate that similar manifolds emerge in the lateral and medial prefrontal cortices. We propose that the task-dependent curvature of the DV manifold is a fundamental representational property that challenges key assumptions of existing circuit models for perceptual decisions.

Section: Results

We examined population response properties in LIP for two variants of a face categorization task ( Figure 1 A, face task) and a motion direction discrimination task ( Figure 1 B, motion task). In the motion task, monkeys viewed a dynamic random-dots stimulus and reported the perceived motion direction. We manipulated stimulus difficulty by varying the percentage of coherently moving dots across trials (motion coherence). Within each trial, the stochastic nature of the stimulus caused frame by frame fluctuations of motion coherence around a nominal mean for the trial. In the face task, monkeys classified the species of a set of face stimuli (monkey or human) or their expression (sad or happy) in separate blocks. The discriminated categories in each block were defined by two prototype faces. We manipulated stimulus difficulty by creating a morph continuum between the two prototypes and varying the stimulus morph level across trials. Our customized morphing algorithm allowed independent morphing of facial features. We chose eyes, nose, and mouth as informative features and morphed them, while fixing other facial features at halfway between the prototypes. The facial features fluctuated randomly around a mean morph level in each trial (SD, 20% morph; updated every 106.7 ms), similar to the within-trial variability of motion in the motion task. These fluctuations, which were interleaved with masks to remain subliminal, enabled us to estimate spatiotemporal weighting of informative features for decision-making ( Figure S1 ). In both tasks, monkeys reported their decision by making a saccadic eye movement to one of the two targets, one placed inside the response field (RF) of the recorded neurons (T in ) and the other on the opposite side of the screen, outside the RF (T out ).
Three monkeys performed the motion task and two monkeys performed the face task, while we recorded from LIP neurons. In both tasks, the monkey’s choice accuracy monotonically improved as a function of stimulus strength ( Figures 1 C and 1E) and duration ( Figures 1 D and 1F). The reduction of psychophysical thresholds with longer stimulus durations (face task, log-log regression slope, −0.19 ± 0.02, p < 0.001; motion task, −0.61 ± 0.03, p < 0.001, bootstrap test) indicated that monkeys leveraged multiple stimulus frames for their decisions. These results were quantitatively compatible with drift diffusion models (DDMs) that accumulated sensory evidence toward decision bounds in both tasks (DDM fit to psychometric function, face task, R 2 = 0.998; motion task, R 2 = 0.997). In both tasks, the model also quantitatively explained the results of psychophysical reverse correlation, including differential effects of sensory evidence on choice over time and differential weighting of informative facial features for species and expression categorizations ( Figure S1 ). Based on the similarity of decision-making behavior between the two tasks, we hypothesized that LIP neurons would exhibit similar decision-related responses in both tasks.
Contrary to our expectation, we found a qualitative difference in the population average LIP responses in the two tasks ( Figures 2 A and 2B). In the motion task ( Figure 2 B), neurons had higher firing rates when the stimulus strongly supported the T in choice and lower firing rates when it strongly supported the T out choice. Thus, the firing rates monotonically reflected the amount of evidence for the T in choice. However, LIP neurons recorded in the face task exhibited a reversed order for T in choices ( Figure 2 A); they showed enhanced activity for weaker sensory evidence. Consequently, the average firing rates no longer monotonically reflected the amount of evidence for the T in choice. This observation is puzzling as it seemingly contradicts the account of LIP responses as a neural correlate of accumulated evidence for a decision. Critically, this pattern also appears to disagree with monkeys’ behavioral performance, which monotonically improved as a function of stimulus strength in both tasks ( Figure 1 ).
To quantify the significance of this reversal in firing rates, we plotted the population average firing rates in a window spanning from 250 to 600 ms from stimulus onset as a function of stimulus strength ( Figure 2 C). For T in choices in the motion task, firing rates increased with the strength of evidence supporting the choice (α 1 = 0.22 ± 0.05 across units, p = 8.2 × 10 −5 ; Equation 1 ), whereas in the face task, firing rates decreased (α 1 = −0.19 ± 0.03, p = 3.8 × 10 −8 ). This reversal was also seen in many single units and was consistently present in different monkeys and different task variations ( Figures S2 A–S2D). In contrast to T in choices, firing rates systematically declined with the strength of evidence in favor of the T out choice during stimulus viewing in both tasks ( Figure 2 D; motion task, α 1 = −0.30 ± 0.05, p = 5.0 × 10 −9 ; face task, α 1 = −0.33 ± 0.03, p = 2.9 × 10 −20 ). The peri-stimulus time histograms (PSTHs) for the T out choice were better separated for different stimulus strengths ( Figure 2 B), consistent with past electrophysiological studies ( Shadlen and Newsome, 2001 72. Shadlen, M.N. ∙ Newsome, W.T. Neural basis of a perceptual decision in the parietal cortex (area LIP) of the rhesus monkey J. Neurophysiol. 2001; 86 :1916-1936 Crossref Scopus (1267) PubMed Google Scholar ) as well as bounded evidence accumulation models for the decision-making process.
Does the reversal suggest different underlying neural computations during face categorization? Because individual units show diverse response profiles ( Figure S2 B), we sought to better understand the neural code by exploring the patterns of population responses in the two tasks. Figures 2 E and 2F depict population activity in a three-dimensional (3D) principal component (PC) space derived from the PSTHs of recorded units (top 3 PCs, explained variance in motion task: 78%, face task: 54%; see Figure 3 A for the PCA procedure). The data points in this state space correspond to the population responses for different stimulus strengths at different times after stimulus onset. The population neural responses gradually changed along a curved line in the state space from the strongest stimulus supporting T in to the strongest stimulus supporting T out choices. The curvature was quite large and unlikely to have been caused by random fluctuation of neural responses ( Figure S4 A). Further, a bootstrap analysis confirmed that the manifold is curved along a consistent direction in each task (p < 0.001). This curvature, which arose from the diverse tuning of neurons for stimulus strength in the population ( Figure S3 B), was observed in individual monkeys and also found for groups of simultaneously recorded units within single sessions ( Figures S4 B–S4D). The curved manifold gradually expanded over time after stimulus onset, indicating better separation of population response patterns associated with different stimuli. This expansion is compatible with integration of sensory evidence over time and the representation of the DV by the neural population in both tasks. Later in the trials, immediately before the monkey's saccade, the population responses converged to one of the two states depending on the monkey's choice ( Figure S5 ). Correspondingly, the average firing rates reached a common level ( Figure S5 A), as has been reported previously ( Shadlen and Newsome, 2001 72. Shadlen, M.N. ∙ Newsome, W.T. Neural basis of a perceptual decision in the parietal cortex (area LIP) of the rhesus monkey J. Neurophysiol. 2001; 86 :1916-1936 Crossref Scopus (1267) PubMed Google Scholar ).
An important implication of the curvature of the population response manifold is that the average firing rate does not necessarily preserve the order of the stimulus strengths. Recall that the average firing rate is calculated as a linear sum of single-neuron firing rates with equal weights across the recorded population. Because projections on the PC space are also linear, changes of the population average firing rate would correspond to a linear axis in the PC space (black vectors in Figures 2 G and 2H). By projecting on this axis, one can determine the average firing rate associated with each point on the manifold. In the face task, the curved manifold was rotated with respect to the average rate axis such that the projections result in a reversed order of average firing rates for different stimulus strengths supporting the T in choice. By contrast, the position of the curved manifold in the motion task did not create such a reversal. Thus, the apparent mismatch of average firing rates between the two tasks was incidental to the position of the manifolds, which changed substantially in the state space for the two tasks. However, the population response manifolds of both tasks shared a common geometry that orderly represented the evidence supporting each choice.
These findings indicate that LIP activity during decision formation is better characterized as a state on a curved manifold than as average firing rate. As we explain in the following sections, this insight leads to important questions about the relationship between neural responses and behavior, as well as the underlying computational mechanisms.
The curved manifold indicates that LIP simultaneously encodes two key variables for the decision-making process: stimulus difficulty and integrated evidence (the DV). Stimulus difficulty, or more generally the experimentally controlled reliability of incoming evidence, is defined as unsigned stimulus strength in both tasks and encoded along the major axis of the curved manifold ( Figure 3 A). In contrast, the DV is encoded as position along the curved manifold, or alternatively as projections onto a linear axis perpendicular to the major axis of the curved manifold. The explicit encoding of stimulus difficulty contrasts with previous studies, which suggested only an implicit code for stimulus difficulty through the representation of the DV and choice ( Kiani and Shadlen, 2009 36. Kiani, R. ∙ Shadlen, M.N. Representation of confidence associated with a decision by neurons in the parietal cortex Science. 2009; 324 :759-764 Crossref Scopus (665) PubMed Google Scholar ; Pouget et al., 2016 60. Pouget, A. ∙ Drugowitsch, J. ∙ Kepecs, A. Confidence and certainty: distinct probabilistic quantities for different goals Nat. Neurosci. 2016; 19 :366-374 Crossref Scopus (287) PubMed Google Scholar ). Here, we define explicit as linearly decodable ( Misaki et al., 2010 50. Misaki, M. ∙ Kim, Y. ∙ Bandettini, P.A. ... Comparison of multivariate classifiers and response normalizations for pattern-information fMRI Neuroimage. 2010; 53 :103-118 Crossref Scopus (359) PubMed Google Scholar ) and implicit as readable albeit not linearly. Our results raise an intriguing possibility that the curved manifold may contribute to both the choice and the confidence associated with the choice, because it enables linear readouts of both the DV and stimulus difficulty by downstream areas.
To examine this prediction, we first identified the best linear axes in the state space for reading out the DV and stimulus difficulty, then we quantified the sufficiency of these axes for predicting choice and stimulus difficulty, respectively, and finally, we tested whether projections along the stimulus difficulty axis were predictive of the monkey’s confidence. In both the motion and face tasks, the DV for a fixed stimulus duration is proportional to the signed stimulus strength ( Okazawa et al., 2018 54. Okazawa, G. ∙ Sha, L. ∙ Purcell, B.A. ... Psychophysical reverse correlation reflects both sensory and decision-making processes Nat. Commun. 2018; 9 :3479 Crossref Scopus (42) PubMed Google Scholar , 2020 55. Okazawa, G. ∙ Sha, L. ∙ Kiani, R. Linear integration of sensory evidence over space and time underlies face categorization bioRxiv. 2020; Crossref Scopus (0) Google Scholar ; Palmer et al., 2005 56. Palmer, J. ∙ Huk, A.C. ∙ Shadlen, M.N. The effect of stimulus strength on the speed and accuracy of a perceptual decision J. Vis. 2005; 5 :376-404 Crossref Scopus (492) PubMed Google Scholar ). Further, in both tasks, difficulty is defined by the absolute stimulus strength. We used an orthogonal canonical correlation analysis (CCA) ( Cunningham and Ghahramani, 2015 13. Cunningham, J.P. ∙ Ghahramani, Z. Linear dimensionality reduction: Survey, insights, and generalizations J. Mach. Learn. Res. 2015; 16 :2859-2900 Google Scholar ) to find a pair of linear axes in the state space, one most correlated with the signed stimulus strength (“DV axis”) and another most correlated with the unsigned stimulus strength (“stimulus difficulty axis”). These two axes provided a two-dimensional (2D) perspective of the population neural responses, which reproduced the curved manifold in both tasks ( Figure 3 B). The weights of neurons in the two axes were unimodally distributed, with no indication that distinct sub-populations were engaged in coding the DV and difficulty. The DV and difficulty encoding axes were stable throughout the decision formation period, reflecting the stability of curved manifolds in the 3D PC space ( Figures 2 E and 2F).
Critically, the neural responses projected on the DV and difficulty axes were predictive of the choice and stimulus difficulty, respectively ( Figures 3 C and 3D). To ensure that these predictions were not artificially introduced by our analysis, we adopted a cross-validation approach, where we first derived the DV and difficulty axes from a random half of the trials and then used the other half for the predictions. Projections along the DV axis gradually diverged for T in and T out choices during stimulus viewing ( Figure 3 C; p < 0.001 in both tasks, bootstrap test of neural responses 350–450 ms after stimulus onset). Further, when the monkey made an error, the neural responses followed a trajectory opposite to that of correct trials, indicating that the DV axis affords a representation of the DV that shapes the choice, not a representation of the objective stimulus. Finally, the neural responses projected on the stimulus difficulty axis distinguished easy and difficult stimuli ( Figure 3 D; p < 0.001), but they did not predict the monkey’s choices ( Figure 3 E; T in versus T out , face task, p = 0.15; motion task, p = 0.46; 350–450 ms after stimulus onset, bootstrap test). The inability to predict the monkey’s performance suggests that the modulation of population responses along the difficulty axis does not reflect potential increase of the monkey’s attention or task engagement for difficult stimuli.
Does this stimulus difficulty encoding play a role in confidence judgments? We examined this possibility by analyzing neural responses while monkeys performed the motion task with post-decision wagering ( Kiani and Shadlen, 2009 36. Kiani, R. ∙ Shadlen, M.N. Representation of confidence associated with a decision by neurons in the parietal cortex Science. 2009; 324 :759-764 Crossref Scopus (665) PubMed Google Scholar ; Middlebrooks and Sommer, 2012 49. Middlebrooks, P.G. ∙ Sommer, M.A. Neuronal correlates of metacognition in primate frontal cortex Neuron. 2012; 75 :517-530 Full Text Full Text (PDF) Scopus (94) PubMed Google Scholar ). In this version of the task, a third target (sure target, T s ) appeared during the delay period on half of the trials ( Figure 4 A). By choosing this target after the Go cue, the monkey could opt out of direction discrimination for a small but guaranteed reward. It has been previously verified that monkeys choose T s based on their certainty, selecting it more frequently on difficult trials ( Figure 4 B) ( Kiani and Shadlen, 2009 36. Kiani, R. ∙ Shadlen, M.N. Representation of confidence associated with a decision by neurons in the parietal cortex Science. 2009; 324 :759-764 Crossref Scopus (665) PubMed Google Scholar ; Komura et al., 2013 42. Komura, Y. ∙ Nikkuni, A. ∙ Hirashima, N. ... Responses of pulvinar neurons reflect a subject’s confidence in visual categorization Nat. Neurosci. 2013; 16 :749-755 Crossref Scopus (136) PubMed Google Scholar ; Odegaard et al., 2018 53. Odegaard, B. ∙ Grimaldi, P. ∙ Cho, S.H. ... Superior colliculus neuronal ensemble activity signals optimal rather than subjective confidence Proc. Natl. Acad. Sci. USA. 2018; 115 :E1588-E1597 Crossref Scopus (50) PubMed Google Scholar ). Further, previous studies demonstrated that the neural representation of the DV is predictive of the monkey’s T s choices ( Kiani and Shadlen, 2009 36. Kiani, R. ∙ Shadlen, M.N. Representation of confidence associated with a decision by neurons in the parietal cortex Science. 2009; 324 :759-764 Crossref Scopus (665) PubMed Google Scholar ). However, if the neural mechanisms of confidence rely on explicit encoding of stimulus difficulty by the LIP population, projections along the difficulty axis in the state space would also be predictive of T s choices. In fact, it is even possible that previous reports of the relationship between the DV representation and T s choices were merely side effects of the joint encoding of the DV and stimulus difficulty in the same curved manifold, because changes of stimulus strengths across trials modify projections along both the DV and difficulty axes.
Although projections along the stimulus difficulty axis distinguished difficult and easy trials ( Figure 3 D), these projections were not predictive of the monkey’s confidence ( Figure 4 ). To illustrate this point, Figure 4 C shows the projection of neural responses in the 2D space defined by the DV and difficulty axes at an example intermediate time during decision formation (400 ms after stimulus onset). The DV axis in this figure is defined with respect to the correct choice, with positive and negative values indicating the DVs in favor of the correct and error choices, respectively. Whereas different choices were associated with distinct projections along the DV axis, projections along the stimulus difficulty axis did not distinguish low-confidence T s choices from the higher-confidence choices where the monkey chose one of the direction targets (correct and error choices).
To quantitatively test these observations, we asked whether, for a fixed stimulus strength, residual projections along the DV and difficulty axes were predictive of confidence over the course of decision formation ( Figures 4 D and 4E). The residuals were computed separately for each stimulus strength. Then, we combined the residuals of different stimulus strengths for each choice. This residual analysis addresses the stimulus difficulty confound that causes joint variations along the DV and difficulty axes, because it isolates the effect of variations along one axis while keeping projections on the other axis constant. The residual projections along the DV axis showed a clear separation for the three choices, with the residuals for T s choices in between those for correct and error choices ( Figure 4 D; correct versus T s , p < 0.001; error versus T s , p < 0.001, bootstrap test, 350–450 ms after stimulus onset). Thus, the DVs closer to zero were associated with T s choices and errors occurred because the DV supported the opposite choice ( Figures 3 C and 4 C), consistent with previous reports ( Kiani and Shadlen, 2009 36. Kiani, R. ∙ Shadlen, M.N. Representation of confidence associated with a decision by neurons in the parietal cortex Science. 2009; 324 :759-764 Crossref Scopus (665) PubMed Google Scholar ). In contrast, residual projections along the difficulty axis failed to distinguish different choices ( Figure 4 E; correct versus T s , p = 0.52; error versus T s , p = 0.17), indicating that this axis did not have noticeable bearing on the monkey’s choice and confidence. These results suggest that the functional role of the curved manifold is primarily to encode the DV.
The observed geometry of the DV encoding has important implications for circuit models of perceptual decision-making. Existing theories assume action-selective neural modules compete to implement evidence integration ( Beck et al., 2008 4. Beck, J.M. ∙ Ma, W.J. ∙ Kiani, R. ... Probabilistic population codes for Bayesian decision making Neuron. 2008; 60 :1142-1152 Full Text Full Text (PDF) Scopus (471) PubMed Google Scholar ; Deco et al., 2013 15. Deco, G. ∙ Rolls, E.T. ∙ Albantakis, L. ... Brain mechanisms for perceptual and reward-related decision-making Prog. Neurobiol. 2013; 103 :194-213 Crossref Scopus (111) PubMed Google Scholar ; Lo and Wang, 2006 47. Lo, C.C. ∙ Wang, X.J. Cortico-basal ganglia circuit mechanism for a decision threshold in reaction time tasks Nat. Neurosci. 2006; 9 :956-963 Crossref Scopus (366) PubMed Google Scholar ; Mazurek et al., 2003 48. Mazurek, M.E. ∙ Roitman, J.D. ∙ Ditterich, J. ... A role for neural integrators in perceptual decision making Cereb. Cortex. 2003; 13 :1257-1269 Crossref Scopus (478) PubMed Google Scholar ; Purcell et al., 2010 62. Purcell, B.A. ∙ Heitz, R.P. ∙ Cohen, J.Y. ... Neurally constrained modeling of perceptual decision making Psychol. Rev. 2010; 117 :1113-1143 Crossref Scopus (267) PubMed Google Scholar ; Wang, 2002 78. Wang, X.J. Probabilistic decision making by slow reverberation in cortical circuits Neuron. 2002; 36 :955-968 Full Text Full Text (PDF) Scopus (847) PubMed Google Scholar ; Wimmer et al., 2015 79. Wimmer, K. ∙ Compte, A. ∙ Roxin, A. ... Sensory integration dynamics in a hierarchical network explains choice probabilities in cortical area MT Nat. Commun. 2015; 6 :6177 Crossref Scopus (97) PubMed Google Scholar ; Wong and Wang, 2006 81. Wong, K.F. ∙ Wang, X.J. A recurrent network mechanism of time integration in perceptual decisions J. Neurosci. 2006; 26 :1314-1328 Crossref Scopus (638) PubMed Google Scholar ). In these models, different perceptual tasks are implemented by changing the input to the competing modules, not by changing the competition process itself. However, the position of the DV manifold largely differed between the face and motion tasks ( Figures 2 G and 2H), suggesting that the DV encoding is also task-dependent. Revealing the nature of this task dependency—whether it arises due to differences in sensory stimuli or task rules—and its impact on the readout of the DV is important for understanding the properties of decision-making circuits.
We therefore analyzed a subset of neurons (n = 28) recorded in two face categorization tasks (species and expression) to quantify task dependency. The face stimuli in both contexts could vary along both species and expression morph axes ( Figure 5 A). The stimuli around the center of this 2D space were presented in both categorization tasks (gray box in Figure 5 A). Thus, the monkeys applied two different categorization rules to the same visual stimuli. Their behavior indeed indicates that they successfully distinguished the two categorization rules without significant interference from the orthogonal rule ( Figure 5 B).
We found that the change in task rules alone is sufficient to change the neural manifold. In both face tasks, PSTHs showed a reverse order with stimulus strength ( Figure S2 D), and there was significant curvature in the population response manifolds ( Figure 5 C; p < 0.001). Critically, the manifolds formed by the neural activity within the species and expression categorization tasks were distinct from each other ( Figure 5 C; different coefficients of polynomial fits to the manifolds, p < 0.001, likelihood-ratio test). These manifold differences were apparent in population response patterns for the same stimuli in the two tasks, evident in the projections of population responses on the top three PCs ( Figure 5 D; p < 0.001, permutation test). Projections on the first PC were most striking, because they revealed the distinct category boundaries of the two tasks (top row of Figure 5 D; a vertical boundary in the species task and a horizontal boundary in the expression task).
The differences in the manifolds caused the linear DV axes derived from CCA to be different in the two task contexts. The two DV axes projected onto the 3D state space had a +19.0° ± 6.0° angle (signed with respect to the axis of average firing rate), which was significantly different from 0° ( Figures 5 E and 5F; p < 0.001, bootstrap test; the angle difference grew larger in higher dimensional state spaces). Consequently, when a DV decoder optimized for one categorization task was used for decoding the DV in the other task, a substantial readout bias emerged ( Figure 5 H; Δγ 0 = 10.3 ± 1.1 in Equation 9 for decoding with the same- and different-context DV axes at 400 ms, p = 2.5 × 10 −4 , likelihood-ratio test).
Although the neurons recorded in both face categorization tasks provided the best test for changes of manifolds with task context, the difference could also be inferred from the units recorded only in one categorization task (n = 104). For those units, we computed the angle between the DV axis and the average firing rate axis for each task (ω spc and ω exp in Figure 5 E). If an area encodes the DV in a task-independent manner, these angles would be identical. However, we found them to be significantly different ( Figure 5 G; Monkey A, p < 0.006; Monkey L, p < 0.006, bootstrap test).
Together, the manifolds that encode the DV changed in the state space depending on task contexts, and these changes necessitated the optimal readout axis of the DV to be also task-dependent. In simple decision-making models based on competition of action-selective modules, the balance of activity between the modules encodes the DV, and as such, the same DVs across tasks are associated with similar relative activity between the action-selective units. In contrast, the population neural code in LIP is versatile, reflecting the decision context in a manner that suggests distinct encoding of the DV and action.
Further support for distinct encoding of the DV and action plan comes from comparing the population responses during decision formation and saccade preparation ( Figures 6 A–6D). During saccade preparation, responses coalesced into one of two states corresponding to the two choices ( Figures 6 A and 6C, right, and S5 depicts average firing rates). However, the axis connecting the two action states was misaligned with the curved DV manifold ( Figures 6 B and 6D). The angle between the two axes (face task, 34.4° ± 4.0°; motion task, 11.7° ± 1.6° in 3D space) was significantly greater than those expected from the variability of neural responses (p < 0.001, bootstrap test; the expected angles based on response variability were estimated by comparing the choice axes between random halves of trials, face task: 2.9° ± 1.6°, motion task: 2.5° ± 1.3°).
The misalignment can also be demonstrated by comparing the firing rates between units preferring different choices (T 1 and T 2 , Figure 6 E). In the motion task, the differential firing rates were strongly correlated with stimulus strength (slopes of firing rate difference as a function of stimulus strength for T 1 choice: 9.46 ± 1.10), whereas in the face task, they were much less dependent on stimulus strength (slope: 1.61 ± 0.62). T in − T out differential firing rates followed a similar pattern ( Figure 6 F). In the face task, a significant portion of neurons (27.3%) showed non-positive slopes of T in − T out firing rates as a function of stimulus strength ( Figure 6 G), larger than the proportion observed in the motion task (9.3%, p = 0.0002, Fisher’s exact test). Accordingly, ideal observer accuracy for discriminating T in and T out stimuli based on single unit firing rates was much poorer in the face task ( Figure 6 H; slope of AUC as a function of stimulus strength, face task: 0.047 ± 0.007, motion task: 0.255 ± 0.019, p = 2.1 × 10 −21 ).
Congruent with these results, the weights of a large portion of individual neurons in the DV axis were negative for the face task (24.2%, compared to 10.1% in the motion task, p = 0.003, Fisher’s exact test). A negative weight indicates a qualitative mismatch between the saccade selectivity of the neuron and its contribution to the encoding of the DV. However, the negative weights were less prevalent than expected if the DV and action codes were uncorrelated (50% incongruence; p = 1.2 × 10 −9 , binomial test), suggesting partial but imperfect correspondence between the population codes for the DV and action.
Based on these findings, we suggest that there could be a non-monotonic transformation of the neural activity from the DV encoding in early phases of decision formation to encoding of a planned action at later times in the trial ( Figure 6 I). In other words, the encoding of the DV in LIP is context-dependent and not tightly bound to the actions associated with the decisions. At later times, however, the DV representation gives rise to the representation of the upcoming saccade and is ultimately supplanted by it.
Our analyses thus far focused on LIP neural activity. However, decision-related signals encoding the DV are prevalent across multiple brain structures ( Deverett et al., 2018 16. Deverett, B. ∙ Koay, S.A. ∙ Oostland, M. ... Cerebellar involvement in an evidence-accumulation decision-making task eLife. 2018; 7 :e36781 Crossref Scopus (47) PubMed Google Scholar ; Ding and Gold, 2010 17. Ding, L. ∙ Gold, J.I. Caudate encodes multiple computations for perceptual decisions J. Neurosci. 2010; 30 :15747-15759 Crossref Scopus (207) PubMed Google Scholar , 2012 18. Ding, L. ∙ Gold, J.I. Neural correlates of perceptual decision making before, during, and after decision commitment in monkey frontal eye field Cereb. Cortex. 2012; 22 :1052-1067 Crossref Scopus (154) PubMed Google Scholar ; Horwitz and Newsome, 1999 26. Horwitz, G.D. ∙ Newsome, W.T. Separate signals for target selection and movement specification in the superior colliculus Science. 1999; 284 :1158-1161 Crossref Scopus (277) PubMed Google Scholar ; Kiani et al., 2014a 38. Kiani, R. ∙ Cueva, C.J. ∙ Reppas, J.B. ... Dynamics of neural population responses in prefrontal cortex indicate changes of mind on single trials Curr. Biol. 2014; 24 :1542-1547 Full Text Full Text (PDF) Scopus (99) PubMed Google Scholar ; Kim and Shadlen, 1999 41. Kim, J.N. ∙ Shadlen, M.N. Neural correlates of a decision in the dorsolateral prefrontal cortex of the macaque Nat. Neurosci. 1999; 2 :176-185 Crossref Scopus (719) PubMed Google Scholar ; de Lafuente et al., 2015 14. de Lafuente, V. ∙ Jazayeri, M. ∙ Shadlen, M.N. Representation of accumulating evidence for a decision in two parietal areas J. Neurosci. 2015; 35 :4306-4318 Crossref Scopus (110) PubMed Google Scholar ). If the curved manifold is a representational property of decision formation, areas other than LIP are also expected to have this response geometry. Alternatively, the manifold curvature could be specific to LIP and stem from its circuit and functional properties. To test these possibilities, we examined the responses of two other cortical areas in the frontoparietal network involved in oculomotor decisions during the motion task: the supplementary eye field (SEF) and the prearcuate gyrus (PAG).
Both areas revealed similar response geometries as in LIP ( Figure 7 ). Critically, population responses, visualized using the same PCA procedure as for LIP, formed a curved manifold in both areas ( Figure 7 B; significance of curvature, p < 0.001), with a monotonic arrangement of different stimulus strengths along the manifold. In these recordings, monkeys performed a reaction time variant of the task, where they indicated their decision as soon as they were ready. In the reaction-time task, the monkey did not wait for a Go cue, and the trial terminated as soon as the monkey committed to a choice. Hence the results confirmed that the curvature of the manifold is indeed a property pertaining to decision formation, not a post-commitment representation and not a persistent representation of choice. Together, the results across the frontoparietal network indicate that the curved DV manifold is a ubiquitous property of the brain regions involved in decision formation.

Section: Discussion

We show that the average firing rates of LIP neurons do not change monotonically with the DV in the face task, in contrast to the motion task ( Figure 2 A). In state space, the neural population represents the DV along a curved manifold in both tasks ( Figures 2 E and 2F). However, the manifolds are rotated and shifted with respect to the axis of average firing rate across tasks, causing the disparate ordering of PSTHs ( Figures 2 G and 2H), and highlighting the conceptual gap between average firing rates and the DV ( Raposo et al., 2014 63. Raposo, D. ∙ Kaufman, M.T. ∙ Churchland, A.K. A category-free neural population supports evolving demands during decision-making Nat. Neurosci. 2014; 17 :1784-1792 Crossref Scopus (293) PubMed Google Scholar ; Schall, 2019 70. Schall, J.D. Accumulators, neurons, and response time Trends Neurosci. 2019; 42 :848-860 Full Text Full Text (PDF) Scopus (40) PubMed Google Scholar ). Population level analysis was key to elucidating task-dependent encoding of the DV because a dependency could be obscured in average firing rates ( Hou et al., 2019 28. Hou, H. ∙ Zheng, Q. ∙ Zhao, Y. ... Neural correlates of optimal multisensory decision making under time-varying reliabilities with an invariant linear probabilistic population code Neuron. 2019; 104 :1010-1021.e10 Full Text Full Text (PDF) Scopus (37) PubMed Google Scholar ; Kumano et al., 2016 43. Kumano, H. ∙ Suda, Y. ∙ Uka, T. Context-dependent accumulation of sensory evidence in the parietal cortex underlies flexible task switching J. Neurosci. 2016; 36 :12192-12202 Crossref Scopus (21) PubMed Google Scholar ). The task-dependent changes of the DV manifold are not simply due to changes in sensory stimuli. Rather, they occur even when the same stimuli were used with different task rules ( Figure 5 ). Critically, the rotation of DV manifolds implies that the readout of the DVs—a necessity for action planning and circuit-circuit coordination in the decision-making network—must take task context into account. In the absence of such “context-aware readouts,” there could be substantial inaccuracies manifesting as choice bias ( Figure 5 H).
The task-dependent encoding of the DV despite identical actions (saccades) across tasks also suggests partial dissociation of neural codes for the DV and actions. This conclusion is further supported by opposing selectivity of a sizeable fraction of neurons for the DV and actions, as well as misalignment of the DV and action encoding axes in population responses. Our results, however, do not indicate that decision formation takes place in circuits separate from action planning. Rather, the same LIP population that initially encodes the DV on a curved manifold gradually changes its response patterns to encode actions later in the trial ( Figures 6 and S5 ). This sequential use of the same neural population for decision-making and action planning matches prior experimental observations in frontal cortices ( Aoi et al., 2020 3. Aoi, M.C. ∙ Mante, V. ∙ Pillow, J.W. Prefrontal cortex exhibits multidimensional dynamic encoding during decision-making Nat. Neurosci. 2020; 23 :1410-1420 Crossref Scopus (55) PubMed Google Scholar ; Kaufman et al., 2015 33. Kaufman, M.T. ∙ Churchland, M.M. ∙ Ryu, S.I. ... Vacillation, indecision and hesitation in moment-by-moment decoding of monkey motor cortex eLife. 2015; 4 :e04677 Crossref Scopus (66) PubMed Google Scholar ; Peixoto et al., 2021 58. Peixoto, D. ∙ Verhein, J.R. ∙ Kiani, R. ... Decoding and perturbing decision states in real time Nature. 2021; 591 :604-609 Crossref Scopus (34) PubMed Google Scholar ), especially progressive recruitment of choice representation ( Peixoto et al., 2018 57. Peixoto, D. ∙ Kiani, R. ∙ Chandrasekaran, C. ... Population dynamics of choice representation in dorsal premotor and primary motor cortex bioRxiv. 2018; Crossref Scopus (0) Google Scholar ). The partial dissociation between the DV and action planning necessitates network models in which the same neural circuits undergo a transformation of population response patterns over time ( Figure 6 I).
Our finding that similar response geometries and encoding dynamics are present in LIP, as well as lateral and medial prefrontal cortices ( Figure 7 ), suggests ubiquitous principles that shape the neural code throughout the cortical nodes of the decision-making network. Our conclusions, therefore, transcend present debates about the causal role of LIP in perceptual decisions ( Jeurissen et al., 2019 31. Jeurissen, D. ∙ Shushruth, S. ∙ El-Shamayler, Y. ... Deficits in decision making after pharmacological and chemogenetic inactivation of area LIP (program no. 061.16) Society for Neuroscience Meeting 2019 Google Scholar ; Katz et al., 2016 32. Katz, L.N. ∙ Yates, J.L. ∙ Pillow, J.W. ... Dissociated functional significance of decision-related activity in the primate dorsal stream Nature. 2016; 535 :285-288 Crossref Scopus (178) PubMed Google Scholar ; Shushruth et al., 2018 73. Shushruth, S. ∙ Mazurek, M. ∙ Shadlen, M.N. Comparison of decision-related signals in sensory and motor preparatory responses of neurons in area LIP J. Neurosci. 2018; 38 :6350-6365 Crossref Scopus (22) PubMed Google Scholar ; Zhou and Freedman, 2019 82. Zhou, Y. ∙ Freedman, D.J. Posterior parietal cortex plays a causal role in perceptual and categorical decisions Science. 2019; 365 :180-185 Crossref Scopus (70) PubMed Google Scholar ). The presence of a similar response geometry in multiple nodes of the saccade planning network supports the possibility that decisions are formed through interactions within a distributed network encompassing multiple brain regions. Pertinently, neural responses in the superior colliculus, caudate, and frontal eye fields have been occasionally reported to vary inversely or non-monotonically with stimulus strength ( Ding and Gold, 2010 17. Ding, L. ∙ Gold, J.I. Caudate encodes multiple computations for perceptual decisions J. Neurosci. 2010; 30 :15747-15759 Crossref Scopus (207) PubMed Google Scholar , 2012 18. Ding, L. ∙ Gold, J.I. Neural correlates of perceptual decision making before, during, and after decision commitment in monkey frontal eye field Cereb. Cortex. 2012; 22 :1052-1067 Crossref Scopus (154) PubMed Google Scholar ; Horwitz and Newsome, 2001 27. Horwitz, G.D. ∙ Newsome, W.T. Target selection for saccadic eye movements: prelude activity in the superior colliculus during a direction-discrimination task J. Neurophysiol. 2001; 86 :2543-2558 Crossref Scopus (137) PubMed Google Scholar ), hinting at the potential presence of curved DV manifolds in those regions as well.
Why does the curvature exist ubiquitously in all the tasks and brain regions studied here? We suggest that curved manifolds arise automatically due to fundamental constraints on neural computations ( Figure S6 ). The first set of constraints limit the dynamic range of the firing rates (and hence projections along the encoding axes) that constitute the neural code: the non-negativity of firing rates puts a lower bound on the dynamic range, and various costs associated with spiking (e.g., metabolic costs) ( Lennie, 2003 45. Lennie, P. The cost of cortical computation Curr. Biol. 2003; 13 :493-497 Full Text Full Text (PDF) Scopus (749) PubMed Google Scholar ) curtail firing rates from above. An energetically efficient code would seek to lower the overall firing rate of neurons, bending the manifold near the non-negativity bound ( Keemink and Machens, 2019 34. Keemink, S.W. ∙ Machens, C.K. Decoding and encoding (de)mixed population responses Curr. Opin. Neurobiol. 2019; 58 :112-121 Crossref Scopus (17) PubMed Google Scholar ) ( Figure S6 C). The second set of constraints arises from the need for a precise code. Encoding a continuous decision variable within a limited dynamic range could become more precise with a curved manifold than a straight line, as the difference of nearby DV values could be encoded with larger, more distinguishable changes in population responses ( Figure S6 C). However, the exact precision gained by a curved manifold depends on the correlation structure of the population ( Bondy et al., 2018 8. Bondy, A.G. ∙ Haefner, R.M. ∙ Cumming, B.G. Feedback determines the structure of correlated variability in primary visual cortex Nat. Neurosci. 2018; 21 :598-606 Crossref Scopus (81) PubMed Google Scholar ; Moreno-Bote et al., 2014 51. Moreno-Bote, R. ∙ Beck, J. ∙ Kanitscheider, I. ... Information-limiting correlations Nat. Neurosci. 2014; 17 :1410-1417 Crossref Scopus (329) PubMed Google Scholar ) and the feasibility of decoding along the curved manifold instead of a linear readout. Fortunately, decoding along a low-order polynomial in state space, similar to those in our study, is not prohibitively challenging. Further, there is no strong reason to favor a linear readout over other simple readouts ( Ritchie et al., 2019 66. Ritchie, J.B. ∙ Kaplan, D.M. ∙ Klein, C. Decoding the brain: Neural representation and the limits of multivariate pattern analysis in cognitive neuroscience Br. J. Philos. Sci. 2019; 70 :581-607 Crossref Scopus (73) PubMed Google Scholar ). However, the complexity of the manifold cannot increase in an unbounded fashion as the resulting neural code may become susceptible to decoding errors or become too tangled to be easily readable ( Figure S6 E). We propose that for each task, the sensory and contextual inputs define the sub-region of the state space where the DV can be encoded in, and the constraints above shape a curved manifold that accommodates adequately precise encoding of the DV and an easy readout.
The curved manifold indicates that the LIP population activity explicitly encodes both stimulus difficulty (i.e., reliability of sensory evidence) and the DV ( Figure 3 A), a departure from past studies that reported only implicit encoding of stimulus difficulty by single neuron responses in LIP ( Kiani and Shadlen, 2009 36. Kiani, R. ∙ Shadlen, M.N. Representation of confidence associated with a decision by neurons in the parietal cortex Science. 2009; 324 :759-764 Crossref Scopus (665) PubMed Google Scholar ; Pouget et al., 2016 60. Pouget, A. ∙ Drugowitsch, J. ∙ Kepecs, A. Confidence and certainty: distinct probabilistic quantities for different goals Nat. Neurosci. 2016; 19 :366-374 Crossref Scopus (287) PubMed Google Scholar ). This encoding of stimulus difficulty cannot be explained away as an increased attention level or task engagement for more difficult stimuli. Two key observations corroborate our conclusion. First, stimulus difficulty is encoded from the very beginning of the representation of the decision-making process (∼200 ms after stimulus onset) ( Figure 3 D), making it unlikely to be a reactive recruitment of engagement mechanisms due to perceived stimulus difficulty. We remind that stimulus difficulty is not predictable prior to the stimulus onset and inferring the difficulty of a stimulus is time-consuming ( Khalvati et al., 2020 35. Khalvati, K. ∙ Kiani, R. ∙ Rao, R.P.N. Bayesian inference with incomplete knowledge explains perceptual confidence and its deviations from accuracy bioRxiv. 2020; Crossref Scopus (0) Google Scholar ). Second, and more critically, higher engagement should lead to better behavioral performance, but the activity along the difficulty encoding axis was uncorrelated with the monkey’s accuracy ( Figure 3 E). Moreover, trial-to-trial variations of the encoded difficulty for the same stimulus strength did not correlate with the monkey’s confidence in a post-decision wagering task ( Figure 4 ), providing a clear example that decodability does not necessarily amount to functionality ( Ritchie et al., 2019 66. Ritchie, J.B. ∙ Kaplan, D.M. ∙ Klein, C. Decoding the brain: Neural representation and the limits of multivariate pattern analysis in cognitive neuroscience Br. J. Philos. Sci. 2019; 70 :581-607 Crossref Scopus (73) PubMed Google Scholar ). This apparently non-functional encoding of stimulus difficulty lends support to the hypothesis that the manifold curvature is a geometric property of population responses for computing or monitoring changes of the DV, as explained above.
We further rule out that the curvature of the DV manifold and encoding of stimulus difficulty arise from sensory responses or spatial attention to stimuli. Parietal neurons respond to a variety of stimulus attributes in their RFs ( Bisley et al., 2004 7. Bisley, J.W. ∙ Krishna, B.S. ∙ Goldberg, M.E. A rapid and precise on-response in posterior parietal cortex J. Neurosci. 2004; 24 :1833-1838 Crossref Scopus (124) PubMed Google Scholar ; Janssen et al., 2008 30. Janssen, P. ∙ Srivastava, S. ∙ Ombelet, S. ... Coding of shape and position in macaque lateral intraparietal area J. Neurosci. 2008; 28 :6679-6690 Crossref Scopus (94) PubMed Google Scholar ; Lehky and Sereno, 2007 44. Lehky, S.R. ∙ Sereno, A.B. Comparison of shape encoding in primate dorsal and ventral visual pathways J. Neurophysiol. 2007; 97 :307-319 Crossref Scopus (127) PubMed Google Scholar ; Sarma et al., 2016 69. Sarma, A. ∙ Masse, N.Y. ∙ Wang, X.J. ... Task-specific versus generalized mnemonic representations in parietal and prefrontal cortices Nat. Neurosci. 2016; 19 :143-149 Crossref Scopus (75) PubMed Google Scholar ) and also show strong response modulations depending on the location of spatial attention ( Bisley and Goldberg, 2003 6. Bisley, J.W. ∙ Goldberg, M.E. Neuronal activity in the lateral intraparietal area and spatial attention Science. 2003; 299 :81-86 Crossref Scopus (690) PubMed Google Scholar ). However, these response properties do not explain the reversal of firing rates. First, our recording from face-selective regions in the inferior temporal (IT) cortex during the face tasks has revealed that sensory responses are monotonically modulated by the stimulus strength ( Figure S7 ), just like the monotonic tuning to random dots stimuli in the middle temporal (MT) area ( Britten et al., 1993 11. Britten, K.H. ∙ Shadlen, M.N. ∙ Newsome, W.T. ... Responses of neurons in macaque MT to stochastic motion signals Vis. Neurosci. 1993; 10 :1157-1169 Crossref Scopus (478) PubMed Google Scholar ). Therefore, the reversal was not inherited from response properties in sensory areas. Second, our sensory stimuli were presented outside the LIP RFs. Increased sensory responses or spatial attention to more difficult stimuli would not affect or rather decrease the activity of the recorded LIP neurons, leading to a response pattern opposite to the reversed order in the face task. To further ascertain that the observed LIP responses were not affected by inadvertent overlaps of the stimuli with RFs, we performed a control experiment in our face task, where we showed the stimuli in the visual hemifield opposite to the LIP RFs. The results replicated the same reversal of firing rates and curved manifolds as in the main task ( Figures S2 J–S2L). It should also be noted that past studies have reported similar LIP response patterns regardless of whether motion stimuli were presented foveally or parafoveally ( Huk and Shadlen, 2005 29. Huk, A.C. ∙ Shadlen, M.N. Neural activity in macaque parietal cortex reflects temporal integration of visual motion signals during perceptual decision making J. Neurosci. 2005; 25 :10420-10436 Crossref Scopus (408) PubMed Google Scholar ; Shushruth et al., 2018 73. Shushruth, S. ∙ Mazurek, M. ∙ Shadlen, M.N. Comparison of decision-related signals in sensory and motor preparatory responses of neurons in area LIP J. Neurosci. 2018; 38 :6350-6365 Crossref Scopus (22) PubMed Google Scholar ), indicating that differences in stimulus position across tasks do not explain our results.
A hallmark of the decision-making process is its flexibility. To implement flexible decisions, neural circuits must accommodate context-dependent interpretation of information, intricate rules, and a large variety of motor actions to interact with the outside world. The curvature and context-dependency of the DV manifolds and the partial separation of the DV and action encoding, as we report here, are some of the building blocks that the primate brain may have devised for flexible and accurate decisions based on sensory information.
The present study uses the PSTHs of neurons recorded over different sessions to infer the geometry of population responses. We therefore do not directly quantify the effect of population noise correlations, which are known to influence the optimal encoding and decoding axes in large neural populations ( Moreno-Bote et al., 2014 51. Moreno-Bote, R. ∙ Beck, J. ∙ Kanitscheider, I. ... Information-limiting correlations Nat. Neurosci. 2014; 17 :1410-1417 Crossref Scopus (329) PubMed Google Scholar ; Rumyantsev et al., 2020 68. Rumyantsev, O.I. ∙ Lecoq, J.A. ∙ Hernandez, O. ... Fundamental bounds on the fidelity of sensory cortical coding Nature. 2020; 580 :100-105 Crossref Scopus (98) PubMed Google Scholar ). Although we observe the population response geometry and its task dependency robustly across datasets and small pools of neurons recorded simultaneously in the same session (∼10 neurons) ( Figure S4 C), much larger-scale neural recordings from LIP are needed to quantify the true effect of correlations across the population.
One of our key findings is task-dependent changes of the curved DV manifolds. However, we have limited understanding of how this task-dependency is implemented. Future experimental and computational modeling studies are needed to address this gap in our knowledge. It would also be important to examine how widely similar task dependencies exist outside LIP.

Section: STAR★Methods

REAGENT or RESOURCE SOURCE IDENTIFIER Experimental models: Organisms/strains Rhesus Monkeys (macaca mulatta) Primate Products N/A Software and algorithms MATLAB 2018a Mathworks https://www.mathworks.com/products/matlab.html ; RRID: SCR_001622 Data acquisition (Central Suite) Blackrock Microsystems LLC https://www.blackrockmicro.com/ Plexon Offline Sorter Plexon https://plexon.com Deposited data Face and motion datasets and analysis code This paper https://github.com/KianiLab/Okazawa_Cell_2021 Other Data acquisition system Blackrock Microsystems LLC CerePlex Direct Eye tracker SR Research Eyelink 1000 Linear array probe Plexon V-probe (16 ch) Single electrode FHC UEWLCHSECN1E 96-ch Utah Array Blackrock Microsystems LLC https://www.blackrockmicro.com/electrode-types/utah-array/ Open table in a new tab
Further information and requests for resources should be directed to and will be fulfilled by the Lead Contact, Roozbeh Kiani ( roozbeh@nyu.edu ).
This study did not generate new unique reagents.
The datasets and analysis code supporting the current study are available at https://github.com/KianiLab/Okazawa_Cell_2021 .
We recorded responses of parietal and frontal neurons while seven adult macaque monkeys (Macaca mulatta; all males, 5–15 years old) performed a variety of perceptual decision-making tasks. Two monkeys (A and L) performed two variants of a novel face discrimination task and five monkeys (D, I, S, O, and N) performed direction discrimination tasks with random dots ( Kiani et al., 2008 37. Kiani, R. ∙ Hanks, T.D. ∙ Shadlen, M.N. Bounded integration in parietal cortex underlies decisions even when viewing duration is dictated by the environment J. Neurosci. 2008; 28 :3017-3029 Crossref Scopus (347) PubMed Google Scholar ; Roitman and Shadlen, 2002 67. Roitman, J.D. ∙ Shadlen, M.N. Response of neurons in the lateral intraparietal area during a combined visual discrimination reaction time task J. Neurosci. 2002; 22 :9475-9489 Crossref PubMed Google Scholar ). Monkeys D and I also performed the dots task with post-decision wagering ( Kiani and Shadlen, 2009 36. Kiani, R. ∙ Shadlen, M.N. Representation of confidence associated with a decision by neurons in the parietal cortex Science. 2009; 324 :759-764 Crossref Scopus (665) PubMed Google Scholar ). All experimental procedures conformed to the National Institutes of Health Guide for the Care and Use of Laboratory Animals and were approved by the institutional animal care and use committee at New York University. The data from monkeys D, I, and S were previously published ( Kiani and Shadlen, 2009 36. Kiani, R. ∙ Shadlen, M.N. Representation of confidence associated with a decision by neurons in the parietal cortex Science. 2009; 324 :759-764 Crossref Scopus (665) PubMed Google Scholar ; Kiani et al., 2008 37. Kiani, R. ∙ Hanks, T.D. ∙ Shadlen, M.N. Bounded integration in parietal cortex underlies decisions even when viewing duration is dictated by the environment J. Neurosci. 2008; 28 :3017-3029 Crossref Scopus (347) PubMed Google Scholar ).
Monkeys were seated in a semi-dark room in front of a cathode ray tube monitor (frame rate, 75 Hz) with their heads stabilized using a surgically implanted head post. Stimulus presentation was controlled with Psychophysics Toolbox ( Brainard, 1997 9. Brainard, D.H. The psychophysics toolbox Spat. Vis. 1997; 10 :433-436 Crossref Scopus (14525) PubMed Google Scholar ) and MATLAB. Eye movements were monitored using a high-speed infrared camera (Eyelink, SR-Research, Ontario) or a scleral eye coil ( Fuchs and Robinson, 1966 20. Fuchs, A.F. ∙ Robinson, D.A. A method for measuring horizontal and vertical eye movement chronically in the monkey J. Appl. Physiol. 1966; 21 :1068-1070 Crossref Scopus (667) PubMed Google Scholar ). Gaze positions were recorded at 1 kHz.
Throughout the paper, we refer to the face discrimination task as the “face task,” and to the direction discrimination task with random dots as the “motion task.”
The task required classification of faces into two categories, each defined by a prototype face. Each trial began when the monkey fixated on a small fixation point at the center of the screen (diameter, 0.3°). Shortly afterward, two red targets appeared on opposite sides of the screen, equidistant from the fixation point. After a variable delay (truncated exponential distribution, range, 250–500 ms), a face stimulus appeared 1.6°–2.5°, to one side of the fixation point (contralateral to the recording site in the main experiment or ipsilateral in a control experiment, Figures S2 J–S2L). The stimulus size randomly varied across trials by one octave to prevent the monkey from relying on local features (width range, 2.9°-5.8°, mean, 4.2°). The stimulus was presented for a variable duration (truncated exponential distribution, range, 227–1080 ms, mean, 440 ms) followed by a delay period (truncated exponential distribution, range, 300–900 ms, mean, 600 ms). After the delay, the fixation point disappeared (Go cue), and the monkey reported the face category with a saccadic eye movement to one of the targets. Correct responses were rewarded with a drop of juice. To manipulate task difficulty, we created a morph continuum between the two prototypes and presented different intermediate faces (see below). When the face was halfway between the two prototypes on the morph continuum, the reward was given randomly.
We trained monkeys to categorize the same face stimuli in two distinct ways: species and expression categorization ( Figure 5 A). In the species categorization task, the two prototype stimuli were human and monkey faces, whereas in the expression categorization task, they were faces with “happy” and “sad” expressions. Here, happy and sad are used as designations that facilitate explaining the task. We focus merely on the monkey’s ability to discriminate different expressions and do not imply that they interpret these expressions as humans do. Monkeys performed these two categorizations in blocks that switched either within or across sessions. In the first few trials of each block, we presented only the faces closest to the prototypes of the discriminated categories to cue the task context to the monkey. In both categorization tasks, monkeys easily generalized across different facial identities. We therefore created multiple stimulus sets from different human and monkey identities. Each set enabled testing both categorization tasks (see below). We switched the stimulus set after runs of sessions. In total, three stimulus sets were used during electrophysiological recording sessions.
Each stimulus set can be visualized as a two-dimensional (2D) “face space,” whose axes correspond to the morph level between species and expression category prototypes ( Figure 5 A). This 2D face space was created with three “seed” faces: photographs of happy and sad expressions of a human face and neutral expression of a monkey face. The seed faces were obtained from the MacBrain Face Stimulus Set ( Tottenham et al., 2009 76. Tottenham, N. ∙ Tanaka, J.W. ∙ Leon, A.C. ... The NimStim set of facial expressions: judgments from untrained research participants Psychiatry Res. 2009; 168 :242-249 Crossref Scopus (2616) PubMed Google Scholar ) and the PrimFace database ( https://visiome.neuroinf.jp/primface ). We manually defined 96–118 anchor points on each seed face and developed a custom algorithm to morph the three seed faces by computing a linear weighted sum of the positions of the anchor points and textures inside the tessellated triangles defined by the anchor points. Our algorithm allowed independent morphing of different stimulus regions. Further, because our morphing changed both the geometry and content of the facial regions, the resulting faces were perceptually seamless.
Natural faces are complex and high-dimensional stimuli that challenge investigation of the decision-making process. To control stimulus complexity and make studying the decision-making process tractable, we limited informative features for face categorization. We selected three features in each face (eyes, nose, and mouth) and limited morphing across faces to those regions, reducing the effective stimulus dimensionality. Regions outside the informative features were always fixed at the midpoint of the morph space between the three seed faces and did not change in the experiment.
Each informative facial feature varied in a 2D “feature space” defined by the corresponding features of the three seed faces. Morphed features were generated as weighted combinations of the three seed features. To change the features along the species axis, the weights for the happy ( 𝑊 ℎ ) , sad ( 𝑊 𝑠 ) , and monkey ( 𝑊 𝑚 ) faces varied from [0.5, 0.5, 0] to [0, 0, 1]. We label these two end points as − 1 0 0 % and + 1 0 0 % species morph levels (or species prototypes). For the expression axis, the weights for the prototypes changed from [0.75, −0.25, 0.5] to [-0.25, 0.75, 0.5]. The negative weights indicate linear extrapolation beyond the seed features. We verified that for the weights used in our stimulus sets, all morphed features and resulting faces looked naturalistic and did not show noticeable aliasing. In the 2D space, the species morph level of a feature was defined by ( 𝑊 𝑚 − 𝑊 ℎ − 𝑊 𝑠 ) × 1 0 0 % , and its expression morph level was defined by ( 𝑊 𝑠 − 𝑊 ℎ ) × 1 0 0 % . Because the three informative features were morphed independently in their 2D feature spaces, our full stimulus space was six dimensional. The 2D face space of Figure 5 A shows faces with identical morph levels of eyes, nose, and mouth — a 2D cut of the 6D space.
On each trial, we chose a nominal morph level along the relevant axis for the categorization task (species axis for species categorization or expression axis for expression categorization). This nominal value determined the morph level of the three features in the trial, as well as the response that the monkey was rewarded for. The nominal morph level ranged from –96% to +96%. The exact set of nominal morph levels was adjusted for each stimulus set to keep the monkey’s overall accuracy roughly constant across the sets.
To investigate how monkeys weighted evidence conferred by the three informative features, we allowed the features to fluctuate randomly around the nominal morph level of the trial every 106.7 ms during stimulus presentation. For all nominal morph levels between −12% and +12%, the three features fluctuated independently within their own 2D feature spaces according to a circular Gaussian distribution with a standard deviation of 20% morph level. The features therefore changed both along the relevant and irrelevant axes for the categorization task, allowing us to gauge which ones influenced the monkey’s choices. For strong nominal morph levels ( > 12%), fluctuations happened only along the relevant axis in order to prevent the monkey from confusing the task context. Sampled values that fell outside the prototype range [–100% +100%] were replaced with new samples inside the range (5.2% of samples).
We used a masking procedure to keep changes of features in a trial subliminal ( Okazawa et al., 2018 54. Okazawa, G. ∙ Sha, L. ∙ Purcell, B.A. ... Psychophysical reverse correlation reflects both sensory and decision-making processes Nat. Commun. 2018; 9 :3479 Crossref Scopus (42) PubMed Google Scholar ). The masks were created by phase randomization of faces ( Heekeren et al., 2004 25. Heekeren, H.R. ∙ Marrett, S. ∙ Bandettini, P.A. ... A general mechanism for perceptual decision-making in the human brain Nature. 2004; 431 :859-862 Crossref Scopus (573) PubMed Google Scholar ) and interleaved the stimulus fluctuations. In each 106.7 ms sample-mask cycle, a face stimulus was shown for 13.3 ms and then gradually faded out as the mask faded in. In the fading period, the mask and the stimulus were linearly combined, pixel-by-pixel, according to a half-cosine weighting function, such that in the last frame, the weight of the mask was one and the weight of the face was zero. In the next cycle, a new face stimulus with slightly altered informative features was shown, followed by fading with another mask, and so on. Before the first sample-mask cycle in the trial, we showed a mask frame to ensure all stimulus samples were preceded and followed by masks. The masking procedure was quite effective in pilot experiments with humans, preventing the detection of the feature changes. The stimulus in each trial looked like a face appearing and disappearing behind cloud-like patterns. Stimulus viewing duration in each trial consisted of 2-10 stimulus-mask cycles (truncated exponential distribution, mean, 4), which corresponded to 227–1080 ms, including the initial mask.
Two monkeys performed the task in 72 recording sessions (monkey A, 40 sessions; monkey L, 32 sessions), which amounted to 56,582 trials (monkey A, 18,080 and 9,309 trials for species and expression categorizations, respectively; monkey L, 17,077 and 12,116 trials). In the majority of these sessions (55), the face stimulus was contralateral to the recording site. In the control condition where the stimulus was ipsilateral to the recording site ( Figures S2 J–S2L), we ran 17 sessions (monkey A, 10; monkey L, 7) and collected 12,944 trials (monkey A, 7,584 trials for species categorization; monkey L, 4,041 and 1,319 trials for species and expression categorization, respectively).
The experimental settings for the motion task are described elsewhere ( Kiani and Shadlen, 2009 36. Kiani, R. ∙ Shadlen, M.N. Representation of confidence associated with a decision by neurons in the parietal cortex Science. 2009; 324 :759-764 Crossref Scopus (665) PubMed Google Scholar ; Kiani et al., 2008 37. Kiani, R. ∙ Hanks, T.D. ∙ Shadlen, M.N. Bounded integration in parietal cortex underlies decisions even when viewing duration is dictated by the environment J. Neurosci. 2008; 28 :3017-3029 Crossref Scopus (347) PubMed Google Scholar ), and summarized here. The monkey began each trial by fixating a fixation point at the center of the screen, followed by the appearance of two red targets on opposite sides of the screen equidistant from the fixation point. After a variable delay (truncated exponential distribution, range, 250–600 ms), the moving random-dots stimulus ( Britten et al., 1992 10. Britten, K.H. ∙ Shadlen, M.N. ∙ Newsome, W.T. ... The analysis of visual motion: a comparison of neuronal and psychophysical performance J. Neurosci. 1992; 12 :4745-4765 Crossref PubMed Google Scholar ) appeared within a 5°, circular aperture centered on the fixation point. The percentage of coherently moving dots determined the strength of motion (coherence). The motion strength varied randomly across trials from the following set: 0%, 1.6%, 3.2%, 6.4%, 12.8%, 25.6%, and 51.2% coherence. The net motion direction was toward one of the two targets and varied randomly across trials. Monkeys I and S performed a variable duration task, where the stimulus was presented for 80-1500 ms (truncated exponential distribution, mean, 311 ms). The Go cue occurred after the stimulus or following a delay period (truncated exponential distribution, range, 500–1000 ms, mean, 847 ms), instructing monkeys to report their perceived motion direction with a saccadic eye movement to one of the targets. Monkey D as well as monkey I performed another variable duration task, where the stimulus duration was 100-900 ms (mean, 286 ms) and always followed by a delay duration of 1200-1800 ms (mean, 1386 ms). Monkeys O and N performed a reaction time task, where they were free to respond any time after the stimulus onset (mean reaction time, monkey O, 729 ms, monkey N, 927 ms). Correct responses were rewarded with water or juice. For 0% coherence motion, the reward was given randomly.
Monkeys D and I also performed a version of the variable duration task with post-decision wagering ( Kiani and Shadlen, 2009 36. Kiani, R. ∙ Shadlen, M.N. Representation of confidence associated with a decision by neurons in the parietal cortex Science. 2009; 324 :759-764 Crossref Scopus (665) PubMed Google Scholar ). During this task, on a random half of the trials, a third target (“sure” target) appeared at a random time during the delay period (500–750 ms after motion offset) and stayed on through the rest of the delay period. After the Go cue, the monkey made a saccade either to one of the two direction targets or to the sure target, if present. Choosing the sure target always yielded a reward, but the reward size was smaller than that for choosing the correct direction target. The reward ratio was adjusted to encourage the monkey to choose the sure target on nearly half of trials.
We collected 67,349 trials in the variable duration task (monkey I, 24,603 trials; monkey S, 21,947 trials; monkey D, 20,799 trials). Among them, 30,991 trials were in the post-decision wagering task (monkey I, 10,192 trials; monkey D, 20,799 trials). We collected 23,756 trials in the reaction time task (monkey O, 6,291; monkey N, 17,465). Psychophysical thresholds were comparable across the tasks.
For recordings from the lateral intra-parietal (LIP) cortex, electrodes were placed in the ventral division of LIP (LIPv), located based on both structural magnetic resonance imaging scans and transition of white and gray matter during recordings. The recording was performed through a plastic cylinder (Crist Instruments, Damascus, MD), implanted on the skull, and a plastic grid (1 mm spacing; Crist Instruments), placed inside the chamber for precise targeting of the electrodes. We used either single tungsten microelectrodes (FHC, Bowdoin, ME) or 16-channel linear array probes (V-Probe; Plexon, Dallas, TX). Action potential waveforms were isolated online using a time-amplitude window discriminator or sorted offline (Plexon offline sorter). In our analyses, we combined both well-isolated single units and multi-units. We confirmed that similar results were obtained using single units alone ( Figure S4 D).
Units were selected for analysis if they exhibited spatially-selective persistent activity during the delay period of a memory-guided saccade task ( Gnadt and Andersen, 1988 21. Gnadt, J.W. ∙ Andersen, R.A. Memory related motor planning activity in posterior parietal cortex of macaque Exp. Brain Res. 1988; 70 :216-220 Crossref Scopus (720) PubMed Google Scholar ). While the monkey maintained fixation, a target briefly flashed on the screen and was followed by a delay period ( ∼ 1000 ms). At the end of the delay period, the fixation point turned off (Go cue), and the monkey made a saccade to the remembered target location. The target location varied randomly across trials. The response field (RF) of the neurons was identified as the target locations associated with the largest firing rates during the delay period. During the motion or face task, we placed one of the targets (T in ) in the RF and the other (T out ) outside the RF. For the post-decision wagering results included in this paper, the sure target (T s ) was placed outside the RF.
Our choice to focus on units with persistent delay activity in a memory-guided saccade task was made to remain consistent with previous studies ( Roitman and Shadlen, 2002 67. Roitman, J.D. ∙ Shadlen, M.N. Response of neurons in the lateral intraparietal area during a combined visual discrimination reaction time task J. Neurosci. 2002; 22 :9475-9489 Crossref PubMed Google Scholar ; Shadlen and Newsome, 2001 72. Shadlen, M.N. ∙ Newsome, W.T. Neural basis of a perceptual decision in the parietal cortex (area LIP) of the rhesus monkey J. Neurophysiol. 2001; 86 :1916-1936 Crossref Scopus (1267) PubMed Google Scholar ). However, the LIP neurons lacking persistent activity also showed similar curved population response manifolds during our main tasks ( Figure S2 F–S2I). Thus, similar conclusions could be made using all LIP neurons or different subgroups of neurons.
In the motion task, 129 units were recorded from the LIP of three monkeys (monkey D, 46 single units; monkey I, 50 single units; monkey S, 33 single units). In the face task, 132 units were recorded from two monkeys (monkey A, 70 (single: 41); monkey L, 62 (single: 34)) with face stimuli presented contralateral to the recording site. An additional 44 units (monkey A, 31; monkey L, 13) were also recorded during the control condition with ipsilateral stimuli ( Figures S2 J–S2L).
To examine the decision-related activity of other cortical areas, we also recorded from two prefrontal regions: prearcuate gyrus (PAG) in lateral frontal cortex and supplementary eye field (SEF) in dorsomedial prefrontal cortex. The recordings from PAG were performed from monkey N with a chronically implanted 96-channel microelectrode array (electrode length = 1 mm; spacing = 0.4 mm; Blackrock Microsystems, Salt Lake City, UT). We performed 11 recording sessions, which yielded 84 ± 10 (mean ± s.d.) simultaneously recorded units per session. The recordings from SEF were performed from monkey O with either single tungsten microelectrodes (FHC) or 16-channel linear array probes (Plexon). In 9 recording sessions, we isolated 34 SEF units. SEF was identified based on stereotactic coordinates, saccade selectivity, and evoked-saccades with low-current microstimulation ( < 5 0 ⁢ 𝜇 ⁢ 𝐴 ) .
We sorted the stimulus strengths for each task into five levels. For the motion task, we used motion coherence to define the strength levels, compatible with past studies ( Kiani and Shadlen, 2009 36. Kiani, R. ∙ Shadlen, M.N. Representation of confidence associated with a decision by neurons in the parietal cortex Science. 2009; 324 :759-764 Crossref Scopus (665) PubMed Google Scholar ; Kiani et al., 2008 37. Kiani, R. ∙ Hanks, T.D. ∙ Shadlen, M.N. Bounded integration in parietal cortex underlies decisions even when viewing duration is dictated by the environment J. Neurosci. 2008; 28 :3017-3029 Crossref Scopus (347) PubMed Google Scholar ; Shadlen and Newsome, 2001 72. Shadlen, M.N. ∙ Newsome, W.T. Neural basis of a perceptual decision in the parietal cortex (area LIP) of the rhesus monkey J. Neurophysiol. 2001; 86 :1916-1936 Crossref Scopus (1267) PubMed Google Scholar ): 0%–3.2%, 6.4%, 12.8%, 25.6%, and 51.2% coherence. For the face task, we used the average morph level across stimulus-mask cycles in each trial: 0%–5%, 5%–15%, 15%–25%, 25%–50%, 50%–100% morph. Due to the stochastic nature of the stimuli, this average morph level could differ from the nominal morph level. Specifically, in addition to changing the stimulus along the relevant axis for the categorization task, the fluctuations also shifted the stimulus along the irrelevant axis. Using the average morph level enabled us to quantify the veridical stimulus strength for both axes and explore their effects on the behavior and neural responses. Apart from this benefit, we confirmed that defining the strength levels based on the nominal morph level did not critically change any of our results. Similarly, we confirmed that defining the stimulus strength levels of the motion task based on average motion energy — a measure of veridical stimulus strength ( Adelson and Bergen, 1985 1. Adelson, E.H. ∙ Bergen, J.R. Spatiotemporal energy models for the perception of motion J. Opt. Soc. Am. A. 1985; 2 :284-299 Crossref Scopus (2684) PubMed Google Scholar ; Kiani et al., 2014b 39. Kiani, R. ∙ Corthell, L. ∙ Shadlen, M.N. Choice certainty is informed by both evidence and decision time Neuron. 2014; 84 :1329-1342 Full Text Full Text (PDF) Scopus (271) PubMed Google Scholar ) — did not change any of our conclusions. The same stimulus strength levels were used for both behavioral and neural data analyses.
Note that the stimulus strength could be in favor of one choice or another. Therefore, for analyses that depended on the exact choice made by the monkey (e.g., T in versus T out ), we expanded the definition of stimulus strength levels to add a sign to the numbers above, where positive and negative strengths indicate stimuli supporting the T in and T out choices, respectively. Throughout the paper, we use consistent colors to show different stimulus strength levels in the figures, with red symbols depicting positive strengths and blue symbols depicting negative strengths, while the saturation of symbols depicting absolute stimulus strength.
Psychometric functions ( Figures 1 C and 1E) were calculated as the probability of making correct choices — choices compatible with the sign of the stimulus strength level — as a function of stimulus strengths. Psychophysical thresholds were defined as the stimulus strength that yielded 81.6% correct choices. Thresholds were estimated by fitting a logistic function to the choice data (similar results were obtained with cumulative Weibull fits). To assess the effect of stimulus duration on behavioral performance, we divided trials into six stimulus duration quantiles, calculating the psychophysical threshold separately for each quantile ( Figures 1 D and 1F).
To test if the behavioral performance is consistent with an evidence accumulation mechanism, we fit a drift diffusion model (DDM) to the data. In the DDM, signed momentary sensory evidence accumulated over time to create the decision variable (DV). The process continued until the DV reached either an upper or a lower bound, or all the available sensory evidence was integrated. The bound that was reached first dictated the choice. But if the accumulated evidence failed to reach a bound by the end of the trial, the sign of the DV determined the choice. We fit the DDM to individual monkeys’ behavior using a maximum-likelihood procedure. Details of the method are described elsewhere ( Okazawa et al., 2018 54. Okazawa, G. ∙ Sha, L. ∙ Purcell, B.A. ... Psychophysical reverse correlation reflects both sensory and decision-making processes Nat. Commun. 2018; 9 :3479 Crossref Scopus (42) PubMed Google Scholar ). The DDM had two free parameters in the motion task: sensitivity and bound height. Sensitivity, 𝑘 , determined the linear scaling of the mean momentary evidence in the model with signed stimulus strength, 𝑠 . Therefore, the drift rate of the diffusion process at each moment, 𝜇 ⁡ ( 𝑡 ) , was equal to 𝑘 ⁢ 𝑠 ⁡ ( 𝑡 ) . Since stimulus strength was defined based on motion coherence, 𝑠 ⁡ ( 𝑡 ) was a constant in the model. The bound height, 𝐵 , determined the amount of evidence that had to be accumulated to reach the upper ( + 𝐵 ) or lower ( − 𝐵 ) bound. Because the drift rate and bound height scale with the s.d. of momentary evidence in the model, we set the variance of the momentary evidence to 1 to allow unique solutions for the model fit.
For the face task, we allowed different sensitivity parameters for the three informative features in each categorization task: 𝜇 ⁡ ( 𝑡 ) = 𝑘 𝑒 ⁢ 𝑠 𝑒 ⁡ ( 𝑡 ) + 𝑘 𝑚 ⁢ 𝑠 𝑚 ⁡ ( 𝑡 ) + 𝑘 𝑛 ⁢ 𝑠 𝑛 ⁡ ( 𝑡 ) , where 𝑠 𝑒 ⁡ ( 𝑡 ) , 𝑠 𝑚 ⁡ ( 𝑡 ) , and 𝑠 𝑛 ⁡ ( 𝑡 ) are signed morph levels of eyes, nose, and mouth along the relevant axis for categorization at time 𝑡 . We did not observe any notable influence of morph levels along the irrelevant axis on the monkey’s choices, within the tested ranges in our tasks ( Figure 5 B). We therefore excluded them from the equation for drift rate to limit the number of model parameters. In a reaction-time version of the task performed by human subjects, we established that sensitivity parameters were largely constant over time ( Okazawa et al., 2020 55. Okazawa, G. ∙ Sha, L. ∙ Kiani, R. Linear integration of sensory evidence over space and time underlies face categorization bioRxiv. 2020; Crossref Scopus (0) Google Scholar ) and that there was minimal loss of information (leak). We do not present these model variants in this paper as they do not directly pertain to our main conclusions. However, we note that we do not find substantial evidence for non-stationary sensitivity or the presence of a significant leak in the monkey data, suggesting a similarity of the decision-making process across species.
The monkeys that performed the same task had consistent behavior and neural responses. We therefore combined data across subjects in the figures. But when appropriate, we show individual monkeys’ results too (e.g., Figure S2 ). The behavioral plots in Figures 1 C–1F combine data from all monkeys performing the respective tasks. The model fits (gray lines) are the average of fits for individual monkeys. Figures 1 C and 1D combines data and fits across both monkeys and both face categorization tasks. Figure 5 B shows the behavior separately for the species and expression categorization tasks. Since the veridical stimulus strengths varied along both task-relevant and irrelevant axes, we plotted two psychometric functions, one for each axis. Both curves in the figure are from the DDM explained above. The model fits do not include any degree of freedom for stimulus strengths along the irrelevant morph axis, as explained above. The non-significant changes of model accuracy along the irrelevant morph axis are due to random stimulus fluctuations along the task-relevant axis that do not totally average out for the limited number of trials in the dataset.
Peri-stimulus time histograms (PSTHs) shown in Figures 2 A, 2B, 6 A, 6C, S2 , and S4 D were smoothed by convolution with a 100 ms boxcar filter. The PSTHs were aligned to the stimulus onset and cut off at 300 ms after stimulus offset to focus our analysis on the responses pertaining to the decision formation based on sensory inputs. The same convention was used in subsequent analyses. When plotting the PSTHs, we focus on correct trials only to be able to examine changes of firing rate with stimulus strength for the same choice except for Figure S2 E.
The firing rates shown in Figures 2 C, 2D, and S2 K were calculated by counting the number of spikes during decision formation (250-600 ms after stimulus onset) in correct trials. To combine data across units with different ranges of firing rates, we z-scored the firing rates of each unit by subtracting its mean firing rate and dividing by the standard deviation of firing rates across all trials. We then calculated the mean of z-scored firing rates of each unit for each stimulus strength and averaged them across units. To quantify the relationship between the firing rates, 𝑟 ⁡ ( 𝑠 ) , and the stimulus strength, 𝑠 , we performed linear regressions independently for T in and T out choices: 𝑟 ⁡ ( 𝑠 ) = 𝛼 0 + 𝛼 1 ⁢ | 𝑠 | (1) where | 𝑠 | is the absolute (unsigned) stimulus strength. The regression coefficients ( 𝛼 0 and 𝛼 1 ) were determined for each unit. The lines in Figures 2 C, 2D, and S2 K were generated from average 𝛼 0 and 𝛼 1 across units. The significance of slopes across the neural population was determined based on a two-sided t test on the distribution of single unit slopes.
To test if the differences in activity between two pools of neurons preferring two choices implement the DV, we computed the differential firing rates between units preferring two choices ( Figure 6 E). Since the units were recorded from one hemisphere and most of them had the same preference, we created a pseudo-population, where the preferred choice of a random half of the recorded units is inverted. We then computed the differences in the firing rates between the units with the opposite preferences for each stimulus strength. We repeated this procedure 1,000 times and averaged the PSTHs over these repetitions.
To examine if the difference of T in and T out firing rates increased with stimulus strength, we used the following linear regression: 𝛥 ⁢ 𝑟 ⁡ ( 𝑠 ) = 𝛽 0 + 𝛽 1 ⁢ | 𝑠 | (2) where 𝛥 ⁢ 𝑟 ⁡ ( 𝑠 ) is the differential firing rate between correct T in and T out choices for the unsigned stimulus strength | 𝑠 | . Figure 6 G shows the distribution of the slope coefficient ( 𝛽 1 ) across the recorded units.
We implemented a neurometric analysis ( Figure 6 H) to quantify the accuracy of an ideal observer that uses the responses of LIP neurons to discriminate the stimuli with similar strength on the two sides of the category boundary in each task ( Britten et al., 1992 10. Britten, K.H. ∙ Shadlen, M.N. ∙ Newsome, W.T. ... The analysis of visual motion: a comparison of neuronal and psychophysical performance J. Neurosci. 1992; 12 :4745-4765 Crossref PubMed Google Scholar ; Shadlen and Newsome, 2001 72. Shadlen, M.N. ∙ Newsome, W.T. Neural basis of a perceptual decision in the parietal cortex (area LIP) of the rhesus monkey J. Neurophysiol. 2001; 86 :1916-1936 Crossref Scopus (1267) PubMed Google Scholar ). The ideal observer accuracy equals the area under the Receiver Operating Characteristic (ROC) curve of the distribution of spike counts for the two competing stimuli. Figure 6 H shows the results for different stimulus strengths using a 100 ms sliding window. To remain conservative, we did not conditionalize spike count distributions on correct choices in this analysis. Because conditioning on correct choices would lead to higher areas under ROC for weaker stimuli, it would further reduce the dependence of the ideal observer’s accuracy on stimulus strength, bolstering our conclusion that the difference of the activity of pools of neurons selective for the two choices fails to fully explain the representation of the DV in the face task.
The PSTHs for the reaction-time version of the motion task ( Figure 7 A) were calculated from 100 ms before stimulus onset to the median reaction time for each stimulus strength. A 50 ms window before saccade onset was excluded from each trial so that the PSTHs were not influenced by the motor burst of the neurons. Using a more conservative exclusion window (100 ms before saccade onset) did not critically change the results. For both the PAG and SEF units, target selectivity was determined using neural responses during a presaccadic period (–300 to 0 ms from saccade onset) and the choice target that evoked higher activity was defined as the putative T in . Responses in memory- or visually-guided saccade tasks corroborated our designations.
In the following sections, we explain analyses for characterization of population response patterns. We use these population analyses as a vehicle to drive intuition and develop insights, noting that because these methods build on single cell responses, their conclusions can also be derived from careful analysis of single cells across the population.
We performed principal component analysis (PCA) to visualize the neural population response manifolds ( Figures 2 E–2H, 5 C, 6 A–6D, 7 B, S2 , S3 , S4 , and S5 ). PCA was performed across units using trial-averaged PSTHs. Each unit contributed multiple PSTHs, one for each combination of choices and stimulus strength levels. The PSTHs focused on the period of decision formation and spanned 250-600 ms after stimulus onset. We detrended the PSTHs of each unit by subtracting the average unit PSTH across all stimulus strengths and choices to focus on modulations of activity associated with task parameters. We confirmed that the detrending did not critically change the observed geometry of neural manifolds. We then concatenated the detrended PSTHs of each unit into a response vector for that unit and combined the vectors of all units into a population response matrix with 𝑇 × 𝐶 rows and 𝑁 columns, where 𝑇 is the number of time points in each PSTH (1 ms resolution), 𝐶 is the number of conditions (5 stimulus strength levels × 2 choices, T in and T out ), and 𝑁 is the number of units. Only correct T in and T out choices were used for these analyses because error responses were rare for high stimulus strengths. A tiny fraction of elements in the population response matrix were missing ( < 0 . 1 % ) due to low numbers of trials for some units. The missing data were replaced with the average response of the corresponding unit. The first three principal components (PCs) explained 78% of the total variance of the full 𝑁 dimensional neural space in the motion task and 54% of the total variance in the face task. The analysis included all units recorded either simultaneously or separately. We confirmed that similar results were obtained using simultaneously recorded units only ( Figure S4 C).
Because we have aligned the PSTHs of LIP neurons with respect to their RFs ( Figure S3 A; PSTHs were defined with respect to T in and T out , not the right-left location of targets), the PCA effectively captures the structure of population responses within a group of neurons having a shared choice preference. Therefore, the observed manifold geometry arises from the variability of neural responses within that group of neurons (see Figure S3 B for intuition). The finding, however, also extends to a neural population with diverse choice preferences. We performed PCA for a pseudo-population created by inverting the preferred choice of a random half of the recorded units. The resulting manifold geometry leads to conclusions similar to our main results ( Figures S3 C–S3F).
The neural population response for each stimulus strength level at each time can be depicted as a point in the three-dimensional (3D) PC space ( Figures 2 E–2H, 5 C, 6 A–6D, 7 B, S2 , S3 , S4 , and S5 ). The data points in the figures were calculated based on spike counts within a 100 ms window centered at the specified times in each figure. To draw a manifold that captures the population responses for different stimulus strength levels (gray lines), we fit the projection of population responses along each PC axis with a cubic smoothing spline as a function of stimulus strength ( csaps function in MATLAB). The SEM of the population response projections along each PC axis (error bars in Figures 2 G, 2H, 7 B, and S2 L) was computed using a bootstrap procedure. We re-computed the mean firing rate of each unit for each stimulus strength level and time by randomly sampling trials with replacement. Then, we projected the resulting population response patterns onto the 3D PC space. This procedure was repeated 1,000 times, and the standard deviations of the projections were calculated and used as the SEM of the data points in the plots.
To rule out the possibility that the population response manifold is actually a straight line that looks curved due to noise in the measured neural responses, we performed three tests. The first two examined the consistency of the direction of the curvature using a cross-validation procedure, and the third tested whether the observed extent of the curvature could arise solely from neural noise. For the analyses in the paper, the three tests always provided consistent results.
Stochastic variability of neural activity could indeed cause changes in the curvature of the population response manifold, but these noisy changes are in random directions in the state space and would lack consistency. In our cross-validation tests, we divided the trials of individual units into random halves and derived a manifold for each half. In the first test, we directly compared the directions of the major axes of the two manifolds, → 𝑣 1 and → 𝑣 2 . The major axis of each manifold was defined as the vector between the midpoint of the two ends of the manifold and the apex of the manifold. The angles between the two major axes were quite small, 11.9° ± 6.0° in the motion task and 9.3° ± 4.9° in the face task ( 𝑚 ⁢ 𝑒 ⁢ 𝑎 ⁢ 𝑛 ± 𝑆 ⁢ 𝐸 ⁢ 𝑀 , calculated over 1,000 iterations of random splitting of data). These angles were significantly smaller than expected from noise (90°), indicating strong consistency in the direction of manifold curvature.
In our second cross-validation procedure, we adopted a more robust approach that averaged the direction of curvature of all locations of the manifold for the second half of the data with respect to the major axis of the manifold from the first half. For the 1D manifold ( → 𝑚 ⁡ ( 𝑠 ) ) in the state space at the location corresponding to stimulus 𝑠 , its curvature is: → 𝑇 ⁡ ( 𝑠 ) = → 𝑚 ′ ⁡ ( 𝑠 ) ∣ → 𝑚 ′ ⁡ ( 𝑠 ) ∣ (3) → 𝑁 ⁡ ( 𝑠 ) = → 𝑇 ′ ⁡ ( 𝑠 ) ∣ → 𝑚 ′ ⁡ ( 𝑠 ) ∣ (4) 𝜅 ⁡ ( 𝑠 ) = ∣ → 𝑁 ⁡ ( 𝑠 ) ∣ (5) where → 𝑇 ⁡ ( 𝑠 ) is the unit tangent vector, → 𝑁 ⁡ ( 𝑠 ) is a vector normal to the curve, and the length of → 𝑁 ⁡ ( 𝑠 ) equals the curvature, 𝜅 ⁡ ( 𝑠 ) , at the location corresponding to stimulus 𝑠 . | . | is the 𝐿 ⁢ 2 norm. The direction of → 𝑁 ⁡ ( 𝑠 ) determines the direction of curvature in the state space. The dot product of → 𝑁 ⁡ ( 𝑠 ) with → 𝑣 1 determines how well their directions match each other: 𝑐 ⁢ 𝑜 ⁢ 𝑠 ⁡ ( 𝜑 ⁡ ( 𝑠 ) ) = → 𝑁 ⁡ ( 𝑠 ) ⋅ → 𝑣 1 ∣ → 𝑁 ⁡ ( 𝑠 ) ∣ ⋅ ∣ → 𝑣 1 ∣ (6) where 𝜑 ⁡ ( 𝑠 ) is the angle between → 𝑁 ⁡ ( 𝑠 ) and → 𝑣 1 at 𝑠 . 𝑐 ⁢ 𝑜 ⁢ 𝑠 ⁡ ( 𝜑 ⁡ ( 𝑠 ) ) was computed at every point on the manifold and then averaged over the full extent of the manifold. Positive values of ⟨ 𝑐 ⁢ 𝑜 ⁢ 𝑠 ⁡ ( 𝜑 ⁡ ( 𝑠 ) ) ⟩ 𝑠 indicate that the direction of the curved manifold for the second half of data is consistent with the first half. We tested if this value is significantly greater than zero using a bootstrap procedure (iterations, 1,000).
For our third test of the significance of manifold curvature, we compared the curvature of the actual neural data with that of simulated data from a linearized response manifold with similar conditional response variability to the actual data ( Figure S4 A). The simulated data were generated by straightening the underlying manifold in the actual data. We first redefined the mean firing rates of each unit for different stimulus strengths by linearly interpolating between firing rates for the strongest stimuli supporting T in and T out choices. This interpolation ensured the linearity of the simulated response manifold. For each stimulus strength, we defined the distribution of simulated responses of a unit as a mean-adjusted version of the true distribution of unit responses, such that variance and shape of stimulus-conditioned response distributions remained unchanged. We simulated individual trials by randomly sampling from these adjusted distributions for the same number of trials that each unit was recorded for. Repeating this process for all the units generated a simulated dataset with the same number of units, trials, and conditional response variability as the actual data. We created 1,000 simulated datasets and derived the manifold for each of them using the procedure explained above. Then we calculated the curvature at each point of each manifold using Equation 5 and quantified the overall magnitude of the curvature as the average curvature across the manifold. Finally, the magnitude of the manifold curvature in the data was compared with the distribution of magnitudes obtained from the simulated data.
In the PC space, the projected population average firing rate changed along a linear axis (straight line in Figures 2 G, 2H, 5 E, and S5 B), since PCA is a linear dimensionality reduction procedure. A vector that corresponds to this linear projection axis can be readily derived from the PC coefficients: → 𝔯 𝑝 ⁢ 𝑜 ⁢ 𝑝 . 𝑎 ⁢ 𝑣 ⁢ 𝑔 . = [ ∑ 𝑁 𝑛 = 1 𝑤 1 , 𝑛 ; ∑ 𝑁 𝑛 = 1 𝑤 2 , 𝑛 ; ∑ 𝑁 𝑛 = 1 𝑤 3 , 𝑛 ] (7) where 𝑤 𝑖 , 𝑛 is the coefficient of neuron 𝑛 for the 𝑖 -th PC and 𝑁 is the total number of neurons. In Figures 2 G and 2H, to illustrate the population average firing rates corresponding to locations on the manifold, we projected a perpendicular line from each point on the manifold to the axis of the average firing rate in the 3D PC space. Due to limitations of 2D illustrations, however, these perpendicular projections in the 3D space appear to have angles different from 90° in the figure.
For the reaction time tasks, PCA was performed as described above but using the detrended PSTHs from 250 ms to 550 ms after stimulus onset. The PAG results in Figure 7 were generated using the simultaneously recorded units in one session ( 𝑛 = 9 9 ) . Similar results were obtained in all recorded sessions.
The curved population response manifold suggests the presence of linear axes in the state space that encode the decision variable (DV) and stimulus difficulty ( Figure 3 A). To identify the best encoding axes, we performed an orthogonal canonical correlation analysis (CCA) ( Cunningham and Ghahramani, 2015 13. Cunningham, J.P. ∙ Ghahramani, Z. Linear dimensionality reduction: Survey, insights, and generalizations J. Mach. Learn. Res. 2015; 16 :2859-2900 Google Scholar ) ( Figure 3 B). CCA finds linear transformations that maximize the correlation of two matrices with each other. One matrix in our analysis was the neural population response, 𝐑 , consisting of the trial-averaged, detrended PSTHs of the recorded units. The population response matrix was constructed as we explained for the PCA analysis but was limited to a shorter window (350–450 ms after stimulus onset) in order to allow approximation of the DV and stimulus difficulty based on task parameters. Neural activity around 400 ms after stimulus onset well reflects the decision formation, but similar results could also be obtained at earlier or later times (e.g., 300 ms, 500 ms, or 600 ms). The second matrix in our analysis was the task parameter matrix, 𝐏 , which approximated the DV and stimulus difficulty associated with each PSTH as 𝑠 (signed stimulus strength) and − | 𝑠 | , respectively. For simplicity, we assumed a constant DV and difficulty during the short PSTH snippet included in the response matrix. The average DV across trials of a particular stimulus strength is proportional to the signed stimulus strength in our tasks, especially at early periods of the decision-making process when the decision bound is not yet reached for the majority of trials because the behavior could be successfully modeled with linear integration of stimulus strength ( Figures 1 C–1F and S1 ). The proportionality constant, however, changes with time, as the DVs for different stimulus strengths diverge from each other ( Beck et al., 2008 4. Beck, J.M. ∙ Ma, W.J. ∙ Kiani, R. ... Probabilistic population codes for Bayesian decision making Neuron. 2008; 60 :1142-1152 Full Text Full Text (PDF) Scopus (471) PubMed Google Scholar ; Kiani et al., 2014a 38. Kiani, R. ∙ Cueva, C.J. ∙ Reppas, J.B. ... Dynamics of neural population responses in prefrontal cortex indicate changes of mind on single trials Curr. Biol. 2014; 24 :1542-1547 Full Text Full Text (PDF) Scopus (99) PubMed Google Scholar ; Peixoto et al., 2018 57. Peixoto, D. ∙ Kiani, R. ∙ Chandrasekaran, C. ... Population dynamics of choice representation in dorsal premotor and primary motor cortex bioRxiv. 2018; Crossref Scopus (0) Google Scholar ). It is therefore important to limit the duration of analysis window to ensure reliable CCA results, while keeping it long enough to allow accurate estimation of mean firing rates in each condition. A 100 ms window met the analysis requirements, but our conclusions were not critically dependent on it. Further, the exact time of the analysis window had minimal impact on our results as long as it reasonably overlapped with decision formation (we tested 350–600 ms after stimulus onset). More complex methods in which we inferred the DV and task difficulty using the exact stimulus fluctuations corresponding to the analysis window and the DDM yielded similar results.
The CCA seeks projection vectors, → 𝛼 𝑖 and → 𝛽 𝑖 , that maximize the correlation of canonical variables 𝐑 ⁢ → 𝛼 𝑖 and 𝐏 ⁢ → 𝛽 𝑖 . After finding the first pair of canonical variables, the analysis finds a second pair of canonical variables uncorrelated with the first. Orthogonal CCA also ensures that the projection vectors are orthogonal ( Cunningham and Ghahramani, 2015 13. Cunningham, J.P. ∙ Ghahramani, Z. Linear dimensionality reduction: Survey, insights, and generalizations J. Mach. Learn. Res. 2015; 16 :2859-2900 Google Scholar ). Combining the projection vectors yield 2D transformation matrices 𝐀 = [ → 𝛼 1 , → 𝛼 2 ] and 𝐁 = [ → 𝛽 1 , → 𝛽 2 ] , which we used to project the neural responses to the 2D subspace defined by the linear DV and difficulty axes: → 𝑥 𝐶 ⁢ 𝐶 ⁢ 𝐴 = → 𝑟 𝑇 ⁢ 𝐀 ⁢ 𝐁 − 1 (8) where → 𝑟 is the population response vector and → 𝑥 𝐶 ⁢ 𝐶 ⁢ 𝐴 is the position in the 2D subspace. In Figures 3 , 4 , and 5 H, → 𝑟 consisted of firing rates of the neurons in 100 ms windows. For the CCA results presented in the paper, we reduced the dimensions of 𝐑 to 10 using PCA to attempt denoising the population responses prior to the CCA. However, the denoising or the number of PC dimensions used for denoising was not critical for our conclusions (we tested a wide range of dimensions from 10 to 40; 10 dimensions explained 89% and 76% of the total variance in the motion and face tasks, respectively). The 2D CCA dimensions accounted for 63% (motion) and 36% (face) of the total variance.
All figures and analyses that depended on CCA were cross-validated. The cross validation was implemented by using a random half of trials as a training set to compute the transformation matrices, and then applying them to the other half of trials (test set). In Figures 3 B–3E and 4 C–4E, the SEM of the data points were estimated using a bootstrap procedure within the test trials (iterations, 1,000). The gray curves in Figures 3 B and 4 C, which estimated the manifold spanning different stimulus strengths, were computed by fitting the projection of neural responses along each dimension using a second-order polynomial function of stimulus strength.
To plot the time course of neural responses along the two axes defined by CCA ( Figures 3 C and 3D), we further split the test trials based on the monkey’s choice (correct or error) or based on stimulus difficulty (easy or difficult, specified as stimulus strengths greater or less than 20%). When computing the choice-dependent neural responses ( Figure 3 C), all stimulus strengths were combined except for 0%, for which the correct choice was undefined. When computing the difficulty-dependent neural responses ( Figure 3 D), we used only correct trials, thus keeping the monkey’s choice identical between the easy and difficult conditions.
To examine the relationship between the neural responses and the monkey’s confidence, we analyzed a subset of neurons (70/129) recorded during the motion task with post-decision wagering (see the section on Behavioral tasks). Bailing out of the motion direction discrimination by choosing the sure-bet option indicated low confidence. We first performed CCA on a random half of trials with correct choices (training set) to find the best encoding axes for the DV and stimulus difficulty. Then, we projected neural responses of the remaining trials on these axes, independently for correct, error, and T s choices. In Figure 4 C, we adjusted the sign of the DV axis projections such that positive and negative values indicated DVs in favor of the correct and error choices, respectively. To quantitatively test the relationship between the neural responses and the monkey’s choices ( Figures 3 E, 4 D, and 4E), we computed the residual activity associated with each choice (correct, error, and T s ) by subtracting the mean projection of all test trials with the same stimulus strengths along each axis. We then averaged the residual responses across different stimulus strengths to achieve better visualization and boost analysis power. For these analyses, we used only trials with low stimulus strengths (3.2%–12.8%), where error and T s choices were present in all sessions. Because correct and error choices were undefined for 0% coherence trials, they were not included.
To examine how task contexts influenced LIP activity, we compared the neural responses during the species and expression categorization of the same face stimuli ( Figure 5 ). The analysis used a subset of units (n = 28) recorded in both tasks in the same sessions. To create the PC space common to both categorization tasks, we used stimuli present in both tasks (gray region in Figure 5 A). The stimuli were grouped into four strength levels ( [ − 1 5 % − 5 % ] , [ − 5 % 0 % ] , [ 0 % 5 % ] , [ 5 % 1 5 % ] ) for each stimulus axis (species and expression). This yielded 32 conditions (4 species levels × 4 expression levels × 2 task contexts). We computed PSTHs of correct trials in these conditions and performed PCA using the same procedure described earlier.
In Figure 5 D, we plotted the PC scores of each stimulus strength (4 × 4 levels) in a window 350-450 ms after stimulus onset. The significance of differences in PC scores between the tasks was determined using a permutation test. For each stimulus level, we shuffled the trial labels between the two tasks (preserving the number of trials) and computed PC scores of the two shuffled groups. We then evaluated the similarity of the two groups of PC scores by calculating the Pearson correlation coefficient across stimuli and PC dimensions. We repeated this procedure 1,000 times to establish the null distribution and compared it against the observed correlation coefficient to report the 𝑝 -value.
In Figure 5 C, we selected the top three PCs derived from the above analysis and projected neural responses calculated for our standard stimulus strength levels in each task as explained in earlier sections. Here, the statistical significance of the difference of the manifolds between the two tasks was evaluated using a likelihood ratio test. We fit the PC scores of each dimension using a second-order polynomial function of stimulus strength, either simultaneously, using the same coefficients for both tasks, or separately, using different coefficients for each task. The goodness of fits was quantified as the likelihood of data points given the manifolds under a Gaussian noise model. The noise covariance matrix was estimated using a bootstrap procedure (iterations, 1,000). The likelihood ratio test determined whether the likelihood of separate manifolds for the two tasks was significantly larger, taking into account the difference in the degree of freedom between the two fits.
The task dependency of neural responses influenced how the DV was encoded by the population. To examine the extent of this effect, we first determined the DV axis in each task context using the CCA procedure described earlier. Our results did not critically depend on whether we determined the DV axis by performing the 2D CCA (estimating both the DV and difficulty axes) or by performing a 1D CCA (estimating the DV axis only). We then computed the angle between the DV axes of the two face categorization tasks in the 3D PC space ( 𝜃 in Figure 5 E). We used the neural responses in a window 350-450 ms after stimulus onset, but the results were largely invariant to the exact choice of analysis window during decision formation. 𝜃 was defined with respect to the axis of average firing rate ( → 𝔯 𝑝 ⁢ 𝑜 ⁢ 𝑝 . 𝑎 ⁢ 𝑣 ⁢ 𝑔 . in Equation 7 ) such that positive values indicated a greater angle between → 𝔯 𝑝 ⁢ 𝑜 ⁢ 𝑝 . 𝑎 ⁢ 𝑣 ⁢ 𝑔 . and the DV axis in expression task, compared to that in species task. Hence, when the DV axes in the two categorization tasks differ, 𝜃 should be either significantly greater or less than zero. We used a bootstrap procedure to test the statistical significance of 𝜃 (iterations, 1,000).
We quantified the extent to which the angle between the DV axes ( 𝜃 ) affected the linear readout of the encoded DVs. We projected the neural responses recorded in one task context on the DV axis derived for the same or different tasks ( Figure 5 H; the results of the expression task are plotted). The projected responses were fit with a logistic curve as a function of stimulus strength ( 𝑠 ) : 𝑥 𝐶 ⁢ 𝐶 ⁢ 𝐴 = ( 𝛾 0 + 𝐼 ⋅ 𝛥 ⁢ 𝛾 0 ) + 𝛾 1 1 + 𝑒 ⁢ 𝑥 ⁢ 𝑝 ⁡ ( − ( 𝛾 2 + 𝛾 3 ⁢ 𝑠 ) ) (9) where 𝛾 𝑖 are regression coefficients and 𝐼 is an indicator variable (0 for using the DV axis from the same task and 1 for using the DV axis from the different task). 𝛥 ⁢ 𝛾 0 is a regression coefficient that captures the change of bias caused by not adjusting the DV axis based on task context. The significance of 𝛥 ⁢ 𝛾 0 was examined using a likelihood ratio test that compared the likelihood of models with and without 𝛥 ⁢ 𝛾 0 . The likelihoods were estimated using a bootstrap procedure (iterations, 1,000).
The analyses above used only the neurons recorded in both task contexts. Because the rest of units (n = 104) were recorded for only one task context, their DV axes could not be directly compared. However, the axis of average firing rate ( → 𝔯 𝑝 ⁢ 𝑜 ⁢ 𝑝 . 𝑎 ⁢ 𝑣 ⁢ 𝑔 . ) could be used as a common reference. We reasoned that, if a brain area encodes the DV in a context-independent manner, a population of neurons recorded from this area would have a fixed angle between the DV axis and the axis of average firing rate (i.e., 𝜔 𝑠 ⁢ 𝑝 ⁢ 𝑐 = 𝜔 𝑒 ⁢ 𝑥 ⁢ 𝑝 in Figure 5 E). We therefore tested if the angle between the DV axis and → 𝔯 𝑝 ⁢ 𝑜 ⁢ 𝑝 . 𝑎 ⁢ 𝑣 ⁢ 𝑔 . differed between the populations recorded for each face categorization task ( Figure 5 G). The SEM of the angles and statistical significance of the angle differences were calculated using a bootstrap procedure (iterations, 1,000). Repeating these tests in higher dimensional state spaces provided similar conclusions.

Section: Acknowledgments

The authors would like to thank Alex Pouget, Long Sha, Stanley Komban, Michael Waskom, Saleh Esteki, Bianca Sieveritz, Mike Shadlen, and Stefano Fusi for helpful discussions and comments on earlier versions of the manuscript. This work was supported by the Simons Collaboration on the Global Brain (542997 and 543009), McKnight Scholar Award, Pew Scholarship in the Biomedical Sciences, and National Institute of Mental Health (R01 MH109180-01). G.O. was supported by post-doctoral fellowships from the Charles H. Revson Foundation and the Japan Society for the Promotion of Science. C.E.H. was supported by National Eye Institute Training Grant in Visual Neuroscience (T32 EY007136).
G.O. and R.K. conceived the study and wrote the manuscript. G.O., C.E.H., and R.K. collected the data. G.O. performed data analysis. A.M. and C.K.M. contributed to interpreting results and developed models. R.K. supervised and guided the study. All authors reviewed and edited the manuscript.
The authors declare no competing interests.
