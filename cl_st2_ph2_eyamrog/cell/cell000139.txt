Title: Major Impacts of Widespread Structural Variation on Gene Expression and Crop Improvement in Tomato


Abstract: Summary

Structural variants (SVs) underlie important crop improvement and domestication traits. However, resolving the extent, diversity, and quantitative impact of SVs has been challenging. We used long-read nanopore sequencing to capture 238,490 SVs in 100 diverse tomato lines. This panSV genome, along with 14 new reference assemblies, revealed large-scale intermixing of diverse genotypes, as well as thousands of SVs intersecting genes and cis -regulatory regions. Hundreds of SV-gene pairs exhibit subtle and significant expression changes, which could broadly influence quantitative trait variation. By combining quantitative genetics with genome editing, we show how multiple SVs that changed gene dosage and expression levels modified fruit flavor, size, and production. In the last example, higher order epistasis among four SVs affecting three related transcription factors allowed introduction of an important harvesting trait in modern tomato. Our findings highlight the underexplored role of SVs in genotype-to-phenotype relationships and their widespread importance and utility in crop improvement.

Section: Introduction

Phenotypic variation in crop plants is shaped by genetic variation from their wild ancestors, as well as the selection and maintenance of collections of mutations that impact agricultural adaptations and human preferences ( Meyer and Purugganan, 2013; Olsen and Wendel, 2013 53. Meyer, R.S. ∙ Purugganan, M.D. Evolution of crop species: genetics of domestication and diversification Nat. Rev. Genet. 2013; 14 :840-852 Crossref Scopus (744) PubMed Google Scholar 59. Olsen, K.M. ∙ Wendel, J.F. A bountiful harvest: genomic insights into crop domestication phenotypes Annu. Rev. Plant Biol. 2013; 64 :47-70 Crossref Scopus (283) PubMed Google Scholar ). The majority of this variation is quantitative, and now more than ever, a major goal of genetics is to identify and understand how specific genes and variants contribute to quantitative trait variation. In particular, this knowledge is necessary for designing and engineering favored alleles in crop improvement, enabled by genome editing ( Chen et al., 2019; Rodríguez-Leal et al., 2017; Wallace et al., 2018 19. Chen, K. ∙ Wang, Y. ∙ Zhang, R. ... CRISPR/Cas genome editing and precision plant breeding in agriculture Annu. Rev. Plant Biol. 2019; 70 :667-697 Crossref Scopus (911) PubMed Google Scholar 67. Rodríguez-Leal, D. ∙ Lemmon, Z.H. ∙ Man, J. ... Engineering quantitative trait variation for crop improvement by genome editing Cell. 2017; 171 :470-480.e8 Full Text Full Text (PDF) Scopus (693) PubMed Google Scholar 89. Wallace, J.G. ∙ Rodgers-Melnick, E. ∙ Buckler, E.S. On the road to breeding 4.0: unraveling the good, the bad, and the boring of crop quantitative genomics Annu. Rev. Genet. 2018; 52 :421-444 Crossref Scopus (169) PubMed Google Scholar ). Although high-throughput short-read sequencing accelerated the discovery of natural genetic variants among diverse germplasm of major crops, it has also introduced an unavoidable bias: characterized variants are disproportionately skewed toward single-nucleotide polymorphisms (SNPs) and small indels ( De Coster and Van Broeckhoven, 2019 22. De Coster, W. ∙ Van Broeckhoven, C. Newest methods for detecting structural variations Trends Biotechnol. 2019; 37 :973-982 Full Text Full Text (PDF) Scopus (55) PubMed Google Scholar ). However, decades of research have shown that structural variations (SVs) (large deletions, insertions, duplications, and chromosomal rearrangements) are important in plant evolution and agriculture, affecting traits such as shoot architecture, flowering time, fruit size, and stress resistance ( Lye and Purugganan, 2019 52. Lye, Z.N. ∙ Purugganan, M.D. Copy number variation in domestication Trends Plant Sci. 2019; 24 :352-365 Full Text Full Text (PDF) Scopus (114) PubMed Google Scholar ). Compared to SNPs, SVs can cause large-scale perturbations of cis -regulatory regions and are therefore more likely to quantitatively change gene expression and phenotypes. SVs can also modify expression levels by directly altering gene copy number. However, despite their importance, identifying SVs with short-read sequencing is notoriously difficult and unreliable, leaving the vast majority of SVs poorly resolved and their molecular and phenotypic impacts largely hidden ( Ho et al., 2020; Sedlazeck et al., 2018a 31. Ho, S.S. ∙ Urban, A.E. ∙ Mills, R.E. Structural variation in the sequencing era Nat. Rev. Genet. 2020; 21 :171-189 Crossref Scopus (284) PubMed Google Scholar 73. Sedlazeck, F.J. ∙ Rescheneder, P. ∙ Smolka, M. ... Accurate detection of complex structural variations using single-molecule sequencing Nat. Methods. 2018; 15 :461-468 Crossref Scopus (818) PubMed Google Scholar ).
High-throughput Oxford Nanopore Technologies (ONT) long-read sequencing now enables a broad survey of population-scale SV landscapes. Such resources that capture the diversity of SVs, in combination with expression profiling and genome editing, immediately allow for the direct interrogation of the molecular and phenotypic consequences of SVs. Here, we present the most comprehensive panSV genome for a major crop and study its significance in evolution, domestication, quantitative genetics, and breeding. We used ONT long-read sequencing to identify SVs from a collection of 100 diverse wild and domesticated tomato accessions. Tomato, in addition to its agricultural and economic importance, has extensive genetic resources, well-described phenotypic diversity, and efficient genome editing, making it an ideal system to investigate the significance of SVs in both fundamental plant biology and agriculture. Our data provided continuous long-range information that allowed for the sequence-resolved inference of more than 200,000 SVs, the majority being transposons and related repeat sequences. Patterns of SV distribution revealed extensive admixture and population-scale introgressions. RNA sequencing showed that gene expression is widely impacted by SVs affecting both coding and cis -regulatory regions. Establishing high-quality de novo genome assemblies for 14 selected genotypes allowed us to resolve hidden genomic complexity involving SVs. To demonstrate the value of this panSV genome, we directly linked these complex alleles with multiple domestication and improvement traits affecting fruit flavor, size, and productivity. For two of these traits, modest changes in expression originated from gene copy number variation, and we used CRISPR-Cas9 genome editing to demonstrate causal quantitative relationships between gene dosage and phenotype. Our work uncovers the prevalence and importance of SVs in plant genomes and demonstrates the underexplored roles of SVs in trait variation.

Section: Results

To deeply survey the landscape of natural structural variation in tomato, we collected long-read sequencing data from a representative population-scale tomato panel ( Figure 1 A; Table S1 A). To this end, we first used available short-read sequencing data to call SVs from over 800 tomato accessions and then applied the SVCollector algorithm to optimally select 51 diverse modern and early domesticated samples that maximize SV diversity ( Sedlazeck et al., 2018b 74. Sedlazeck, F.J. ∙ Lemmon, Z. ∙ Soyk, S. ... SVCollector: Optimized sample selection for validating and long-read resequencing of structural variants bioRxiv. 2018; Crossref Scopus (0) Google Scholar ). We then separately selected an additional 49 wild species and modern accessions that are used by tomato research and breeding communities ( Table S1 A). Our final set of 100 accessions captures phylogenetic diversity spanning the closest wild relatives of domesticated tomato ( S. pimpinellifolium [SP], S. cheesmaniae [CHE], and S. galapagense [GAL]), early domesticated forms ( S. lyc. var. cerasiforme [SLC]), and “vintage” cultivars and modern varieties ( S. lycopersicum , [SLL]; Figures 1 A, S1 A, and S1B; Table S1 B).
For each of the 100 accessions, we used ONT long-read sequencing to generate a minimum of 40× genome coverage, achieving a total of 7.77 Tb of long-read data with an average read length N50 of 19.6 kbp ( Table S1 C). Reads were aligned to the recently released SL4.0 reference genome (Heinz 1706, SLL) with NGMLR, and SVs were called with Sniffles ( Figures S1 C and S1D; Hosmani et al., 2019; Sedlazeck et al., 2018a 33. Hosmani, P.S. ∙ Flores-Gonzalez, M. ∙ van de Geest, H. ... An improved de novo assembly and annotation of the tomato reference genome using single-molecule sequencing, Hi-C proximity ligation and optical maps bioRxiv. 2019; Crossref Scopus (0) Google Scholar 73. Sedlazeck, F.J. ∙ Rescheneder, P. ∙ Smolka, M. ... Accurate detection of complex structural variations using single-molecule sequencing Nat. Methods. 2018; 15 :461-468 Crossref Scopus (818) PubMed Google Scholar ). We then filtered, sequence resolved, and merged all 100 sets of SV calls, revealing 238,490 total SVs (defined in this study as >30 bp) that comprise the most comprehensive sequence-resolved panSV genome in plants (see STAR Methods ). Importantly, we confirmed that the majority of these variants would not have been revealed using solely short-read sequencing data ( Figure S1 E).
Individual accessions had between 1,928 and 45,840 SVs, with the wild SP, GAL, and CHE accessions harboring the most structural variation relative to the Heinz reference genome ( Figure 1 B). Insertions and deletions were the most common SV type, though we also found dozens to hundreds of inversions, duplications, and translocations in all samples. SVs are with respect to the reference genome and do not necessarily reflect underlying evolutionary context. Clustering of the SV presence/absence matrix revealed a structure that mirrored the larger SNP-based tomato phylogeny, with accessions clustering within their known taxonomic groups ( Figure 1 C). Interestingly, the SLL “cherry” variety Sweet100 grouped with the SLCs, and the only two processing cultivars, M82 and EA02054, form a distinct group from the SLLs, suggesting admixture. Comparative analysis of the long-read SVs showed that SP and SLC have more SV diversity compared to SLL, consistent with the loss of genetic variation during the domestication and improvement of tomato ( Figures 1 D and S1 F; Aflitos et al., 2014; Lin et al., 2014 2. Aflitos, S. ∙ Schijlen, E. ∙ de Jong, H. ..., 100 Tomato Genome Sequencing Consortium Exploring genetic variation in the tomato (Solanum section Lycopersicon) clade by whole-genome sequencing Plant J. 2014; 80 :136-148 Crossref Scopus (293) PubMed Google Scholar 50. Lin, T. ∙ Zhu, G. ∙ Zhang, J. ... Genomic analyses provide insights into the history of tomato breeding Nat. Genet. 2014; 46 :1220-1226 Crossref Scopus (668) PubMed Google Scholar ). This analysis also indicated that, even sequencing 100 accessions, many SVs remain to be discovered ( Figure 1 E). Consistently, the majority of SVs are singletons, or are otherwise rare, although tens of thousands of SVs are common (>5% detection frequency; Figure 1 F). We evaluated SV length distribution, which showed that most SVs were relatively small: 30.5%: 30–50 bp; 30.5%: 50–200 bp; and 39%: >200 bp ( Figure 1 G). We note that our method has limited ability to detect larger insertions, because, unlike deletion calling, such detection is bounded by read length (see STAR Methods ). SVs are typically composed of, or generated by, transposons and related repeats ( Audano et al., 2019; Fuentes et al., 2019 7. Audano, P.A. ∙ Sulovari, A. ∙ Graves-Lindsay, T.A. ... Characterizing the major structural variant alleles of the human genome Cell. 2019; 176 :663-675.e19 Full Text Full Text (PDF) Scopus (278) PubMed Google Scholar 28. Fuentes, R.R. ∙ Chebotarov, D. ∙ Duitama, J. ... Structural variants in 3000 rice genomes Genome Res. 2019; 29 :870-880 Crossref Scopus (88) PubMed Google Scholar ), and annotation of our panSV genome showed 84% of deletions and 76% of insertions larger than 100 bp match at least one repeat. Retrotransposon sequences, especially from Gypsy and Copia elements, are the most prevalent among the annotated SVs ( Figure 1 H).
To supplement the panSV genome with additional genomic resources, we selected 14 diverse accessions for genome assembly and annotation ( Table S2 D). Combining long- and short-read sequencing data, de novo assemblies using the MaSuRCA hybrid assembler yielded an average contig N50 of 1.9 Mbp ( Figures S2 A and S2B; Table S2 A; see STAR Methods ; Zimin et al., 2017 102. Zimin, A.V. ∙ Puiu, D. ∙ Luo, M.C. ... Hybrid assembly of the large and highly repetitive genome of Aegilops tauschii , a progenitor of bread wheat, with the MaSuRCA mega-reads algorithm Genome Res. 2017; 27 :787-792 Crossref Scopus (246) PubMed Google Scholar ). Reference-guided scaffolding with RaGOO produced chromosome-scale pseudomolecules that contained, on average, a single copy of 96% of complete benchmarking universal single-copy orthologs (BUSCO) genes ( Figures S2 C–S2P; Table S2 B; Alonge et al., 2019; Simão et al., 2015 4. Alonge, M. ∙ Soyk, S. ∙ Ramakrishnan, S. ... RaGOO: fast and accurate reference-guided scaffolding of draft genomes Genome Biol. 2019; 20 :224 Crossref Scopus (357) PubMed Google Scholar 75. Simão, F.A. ∙ Waterhouse, R.M. ∙ Ioannidis, P. ... BUSCO: assessing genome assembly and annotation completeness with single-copy orthologs Bioinformatics. 2015; 31 :3210-3212 Crossref Scopus (7065) PubMed Google Scholar ). Repeats were annotated using REPET, and genes annotations were “lifted over” from reference annotations using geneLift (see STAR Methods ; Flutre et al., 2011 25. Flutre, T. ∙ Duprat, E. ∙ Feuillet, C. ... Considering transposable element diversification in de novo annotation approaches PLoS ONE. 2011; 6 :e16526 Crossref Scopus (320) PubMed Google Scholar ). We used these new reference genomes (referred to as “MAS2.0”) to validate SVs in the same 14 accessions, of which 90% were also found in the assemblies (see STAR Methods ). Owing to the diversity of these assemblies, which represent multiple SP, SLC, and SLL accessions, we anchored 22% of recently discovered “pan-genome” genes that are missing from the ITAG reference annotation ( Figures S2 Q and S2R; Table S2 C; Gao et al., 2019 29. Gao, L. ∙ Gonda, I. ∙ Sun, H. ... The tomato pan-genome uncovers new genes and a rare allele regulating fruit flavor Nat. Genet. 2019; 51 :1044-1051 Crossref Scopus (381) PubMed Google Scholar ). These MAS2.0 genomes were critical to link complex SV loci with functional consequences shown below.
The chromosomal distribution of SVs from our panSV genome revealed several hypervariable genomic regions relative to the Heinz reference shared among subsets of SLL accessions (designated SV “hotspots”; Figure 2 A). Because SP accessions have more structural variants than those of SLL, SV hotspots in SLL could reflect admixture and introgression between wild and domesticated accessions, which was previously partially explored using SNPs ( Aflitos et al., 2014, 2015; Sato et al., 2012 2. Aflitos, S. ∙ Schijlen, E. ∙ de Jong, H. ..., 100 Tomato Genome Sequencing Consortium Exploring genetic variation in the tomato (Solanum section Lycopersicon) clade by whole-genome sequencing Plant J. 2014; 80 :136-148 Crossref Scopus (293) PubMed Google Scholar 3. Aflitos, S.A. ∙ Sanchez-Perez, G. ∙ de Ridder, D. ... Introgression browser: high-throughput whole-genome SNP visualization Plant J. 2015; 82 :174-182 Crossref Scopus (17) PubMed Google Scholar 69. Sato, S. ∙ Tabata, S. ∙ Hirakawa, H. ..., Tomato Genome Consortium The tomato genome sequence provides insights into fleshy fruit evolution Nature. 2012; 485 :635-641 Crossref Scopus (2418) PubMed Google Scholar ). Introgression is a common practice in tomato breeding, through which disease resistance genes and other desirable traits from wild donors are introduced into SLL breeding germplasm ( Aflitos et al., 2014 2. Aflitos, S. ∙ Schijlen, E. ∙ de Jong, H. ..., 100 Tomato Genome Sequencing Consortium Exploring genetic variation in the tomato (Solanum section Lycopersicon) clade by whole-genome sequencing Plant J. 2014; 80 :136-148 Crossref Scopus (293) PubMed Google Scholar ). We found that SV hotspots in SLL correlated with genomic regions that show high similarity with SP and/or SLC based on the Jaccard similarity of SV content between accessions ( Figures S3 A–S3L; Tables S3 A–S3L). For example, multiple SV hotspots exist on chromosome 4, including a 2-Mbp region common to all SLL accessions that corresponds to a known unique introgression in the Heinz reference genome ( Figure 2 A; Sato et al., 2012 69. Sato, S. ∙ Tabata, S. ∙ Hirakawa, H. ..., Tomato Genome Consortium The tomato genome sequence provides insights into fleshy fruit evolution Nature. 2012; 485 :635-641 Crossref Scopus (2418) PubMed Google Scholar ). Most SP accessions show a decrease in SV frequency in this region, indicating these accessions are closely related to the introgression donor. We also found a large introgression block shared by five SLLs that occupies two-thirds of the chromosome ( Figure 2 B). Notably, two of these accessions are M82 and EA02054, which also carry large introgression blocks that span nearly all of chromosomes 5 and 11 ( Figures 2 A, S3 E, and S3K), explaining their distinct grouping in SLL and their relatively large number of SVs compared to Heinz 1706, which is also a processing type ( Figures 1 B and 1C).
Expecting that our panSV genome would illuminate how breeding and introgression have shaped SV content, we examined 11 SLLs included in our 100 genomes from the University of Florida (UFL) tomato breeding program, which has a well-documented history of disease resistance gene introgression ( Scott, 1999a 70. Scott, J.W. University of Florida tomato breeding accomplishments and future directions Annu. Proc. Soil Crop Sci. Soc. Florida. 1999; 58 :8-11 Google Scholar ). The devastating fungal disease Fusarium wilt first emerged in the 1930s, and the resistance genes I and I2 (from SP donors) and I3 (from S. pennellii ) against three races of this disease were successively introduced into UFL breeding material between the 1930s and 1980s ( Figure 2 C; Bohn and Tucker, 1939; Scott and Jones, 1989; Strobel et al., 1969 12. Bohn, G.W. ∙ Tucker, C.M. Immunity to fusarium wilt in the tomato Science. 1939; 89 :603-604 Crossref Scopus (56) PubMed Google Scholar 72. Scott, J.W. ∙ Jones, J.P. Monogenic resistance in tomato to Fusarium oxysporum f. sp. lycopersici race 3 Euphytica. 1989; 40 :49-53 Google Scholar 80. Strobel, J.W. ∙ Hayslip, N.C. ∙ Burgis, D.S. ... Walter, a determinate tomato resistant to races 1 and 2 of the Fusarium wilt pathogen Circ. Fla. Agric. Exp. Stn. 1969; Google Scholar ). Furthermore, the Sm resistance gene against Grey leaf spot was introduced in the 1950s ( Walter and Kelbert, 1953 90. Walter, J.M. ∙ Kelbert, D.G.A. Manalucie: A Tomato with Distinctive New Features University of Florida, Agricultural Experiment Stations, 1953 Google Scholar ). Molecular mapping and gene cloning have shown that I and Sm are located on the opposite arms from I2 on chromosome 11. The variants from our panSV genome demonstrated overlapping introgressions from multiple donors, including those contributing resistance to other diseases ( Foolad and Panthee, 2012 26. Foolad, M.R. ∙ Panthee, D.R. Marker-assisted selection in tomato breeding Crit. Rev. Plant Sci. 2012; 31 :93-123 Crossref Scopus (140) Google Scholar ), accounting for the large introgression block in the UFL accessions ( Figure 2 D). Interestingly, the modern breeding line Fla.8111B carries the I , I2 , and Sm resistance genes but lacks a large portion of this introgression, suggesting this region was later purged during selection.
The I3 introgression on chromosome 7 was introduced in the 1980s ( Figure 2 C). The modern breeding lines Fla.7481 and Fla.7907B that carry I3 resistance show a 5-Mbp SV hotspot with low similarity to SP and SLC at the I3 locus, consistent with the donor being the distant green-fruited wild species S. pennellii ( Figure 2 E). Interestingly, UFL lines lacking I3 resistance have a 2-Mbp introgression from SP or SLC that first appeared in the 1960s and overlaps the I3 introgression. The I3 introgression is negatively implicated with several horticultural characteristics, including reduced fruit size and increased sensitivity to bacterial spot ( Hutton et al., 2014; Li et al., 2018; Scott, 1999b 34. Hutton, S.F. ∙ Scott, J.W. ∙ Vallad, G.E. Association of the Fusarium wilt race 3 resistance gene, I-3 , on chromosome 7 with increased susceptibility to bacterial spot race T4 in tomato J. Am. Soc. Hortic. Sci. 2014; 139 :282-289 Crossref Google Scholar 49. Li, J. ∙ Chitwood, J. ∙ Menda, N. ... Linkage between the I-3 gene for resistance to Fusarium wilt race 3 and increased sensitivity to bacterial spot in tomato Theor. Appl. Genet. 2018; 131 :145-155 Crossref Scopus (19) PubMed Google Scholar 71. Scott, J.W. Tomato plants heterozygous for fusarium wilt race 3 resistance develop larger fruit than homozygous resistant plants Proc. Annu. Meet. Fla. State Hort. Soc. 1999; 112 :305-307 Google Scholar ). The earlier introduced SP introgression may have provided tolerance to bacterial spot or benefitted other traits, as is likely for many other putative SP or SLC introgressions revealed by our panSV genome ( Figures S3 A–S3L; Tables S3 A–S3L). The large number of SVs from wild species introduced in breeding could have broad functional consequences.
SVs may influence the expression of nearby genes by altering the sequence or copy number of a gene or by changing the composition or position of cis -regulatory sequences ( Chiang et al., 2017; Yang et al., 2019 20. Chiang, C. ∙ Scott, A.J. ∙ Davis, J.R. ..., GTEx Consortium The impact of structural variation on human gene expression Nat. Genet. 2017; 49 :692-699 Crossref Scopus (249) PubMed Google Scholar 96. Yang, N. ∙ Liu, J. ∙ Gao, Q. ... Genome assembly of a tropical maize inbred line provides insights into structural variation and crop improvement Nat. Genet. 2019; 51 :1052-1059 Crossref Scopus (177) PubMed Google Scholar ). We explored this relationship with the comprehensive catalog of SVs across our tomato panSV genome. Candidate SVs that could potentially impact gene expression were abundant in our collection. Nearly 50% (112,114) of SVs overlap genes and/or flanking regulatory sequences (±5 kbp of coding sequence), and among 34,075 annotated genes, 95% have at least one SV within 5 kbp of coding sequences across the 100 genomes, with the majority found in cis-regulatory regions ( Figures 3 A and 3B). To explore the impact of SVs on gene expression, we performed 3′ RNA sequencing (RNA-seq) on three tissues (cotyledons, roots, and apical meristems) for 23 accessions that capture 44,358 gene-associated SVs. We evaluated a total of 21,156 SV-gene pairs and found hundreds of significant expression changes ( Figure 3 C; Tables S4 A and S4B; see STAR Methods ). Nearly half of the SVs affecting coding sequences (deletions of coding sequence [CDS] start, deletions of exons, and duplications) are significantly associated with differences in expression, with many substantially reducing or eliminating expression ( Table S4 ). In regulatory regions, 1,534 SV-gene pairs (7.3%) showed significant differential expression across all tissues, and overall, these differences were subtler compared to SVs in coding regions (mean log 2 fold change 1.36 and 2.47, respectively; Figure S4 A).
Knowing that a substantial fraction of population-scale expression variation is explained by cis -eQTL ( Battle et al., 2017; Kawakatsu et al., 2016 8. Battle, A. ∙ Brown, C.D. ∙ Engelhardt, B.E. ..., GTEx Consortium, Laboratory, Data Analysis &Coordinating Center (LDACC)—Analysis Working Group, Statistical Methods groups—Analysis Working Group, Enhancing GTEx (eGTEx) groups, NIH Common Fund, NIH/NCI, NIH/NHGRI, NIH/NIMH, NIH/NIDA, Biospecimen Collection Source Site—NDRI, Biospecimen Collection Source Site—RPCI, Biospecimen Core Resource—VARI, Brain Bank Repository—University of Miami Brain Endowment Bank, Leidos Biomedical—Project Management, ELSI Study, Genome Browser Data Integration &Visualization—EBI, Genome Browser Data Integration &Visualization—UCSC Genomics Institute, University of California Santa Cruz, Lead analysts, Laboratory, Data Analysis &Coordinating Center (LDACC), NIH program management, Biospecimen collection, Pathology, eQTL manuscript working group Genetic effects on gene expression across human tissues Nature. 2017; 550 :204-213 Crossref Scopus (2349) PubMed Google Scholar 37. Kawakatsu, T. ∙ Huang, S.-S.C. ∙ Jupe, F. ..., 1001 Genomes Consortium Epigenomic diversity in a global collection of Arabidopsis thaliana accessions Cell. 2016; 166 :492-505 Full Text Full Text (PDF) Scopus (438) PubMed Google Scholar ), we next formulated a classification task that uses changes in gene expression to predict the presence of a nearby SV (see STAR Methods ; Figure S4 B). This classifier complements standard fold-change measurements among known SV-gene pairs, and its performance can quantify the extent to which global expression changes are associated with SVs. Notably, this test is robust to population structure because global changes in expression or confounding variants can only serve to weaken any one-to-one relationship between gene expression variation and the existence of a nearby variant.
Broadly, differential expression significantly predicts genes with associated SVs ( Figures 3 D, 3E, and S4 C–S4E; Tables S4 C–S4L). As expected, this classifier performs best on the coding sequence SVs (e.g., deletions of exons, apex tissue expression, area under the receiver operating characteristics [AUROC] > 0.78, and false discovery rate [FDR] < 0.05), as reflected by the sharp initial rise in receiver operating characteristic (ROC) curves ( Figure 3 D). The strength of this signature indicates that indirect effects (e.g., trans regulation) do not dominate the observed relationship and also demonstrates the high accuracy of our variant calls. Importantly, we also observe subtle but significant effects of regulatory SVs on gene expression (e.g., deletions overlapping 3′ flanking sequence, apex tissue expression, AUROC > 0.53, and FDR < 0.05). The AUROC captures the individual cis -regulatory effect size, which is small on a per variant basis. However, in aggregate, these variants have a large impact on expression variation ( Figure 3 E), suggesting they globally shape expression profiles. Overall, our results show that SVs can impact gene expression in both substantial and subtle ways and that many such variants in our panSV genome may be functionally relevant ( Figures 3 F and S4 F).
Our panSV genome, new MAS2.0 assemblies, and expression dataset could help to reveal genes and variants underlying quantitative trait variation that has been masked by hidden genomic complexity. Many fruit aroma volatile QTLs that contribute to flavor have been identified through genome-wide association study (GWAS), but only a few have been functionally characterized ( Tieman et al., 2017; Zhu et al., 2018 82. Tieman, D. ∙ Zhu, G. ∙ Resende, Jr., M.F.R. ... A chemical genetic roadmap to improved tomato flavor Science. 2017; 355 :391-394 Crossref Scopus (515) PubMed Google Scholar 100. Zhu, G. ∙ Wang, S. ∙ Huang, Z. ... Rewiring of the fruit metabolome in tomato breeding Cell. 2018; 172 :249-261.e12 Full Text Full Text (PDF) Scopus (581) PubMed Google Scholar ). One such QTL involves the metabolically linked volatiles guaiacol and methyl salicyate, whose “smoky” or “medicinal” flavors negatively influence consumer appeal. A previous GWAS identified a candidate gene E8 ( Solyc09 g089580 ), encoding a putative negative regulator of ethylene biosynthesis involved in fruit ripening ( Tieman et al., 2017 82. Tieman, D. ∙ Zhu, G. ∙ Resende, Jr., M.F.R. ... A chemical genetic roadmap to improved tomato flavor Science. 2017; 355 :391-394 Crossref Scopus (515) PubMed Google Scholar ). Although transcriptional knockdown of E8 resulted in accumulation of guaiacol and methyl salicylate, other volatiles were also modified. Furthermore, no causal mutations were identified, likely due to two large gaps flanking E8 in the reference genome at the time (SL3.0).
A separate study found that mutations in the NON-SMOKY GLYCOSYLTRANSFERASE1 ( NSGT1 ) and NSGT2 paralogous genes, which are physically close on chromosome 9, cause an accumulation of guaiacol ( Figure 4 A; Tikunov et al., 2013 83. Tikunov, Y.M. ∙ Molthoff, J. ∙ de Vos, R.C.H. ... Non-smoky glycosyltransferase1 prevents the release of smoky aroma from tomato fruit Plant Cell. 2013; 25 :3067-3078 Crossref Scopus (83) PubMed Google Scholar ). Whereas NSGT2 shows little expression and is believed to be non-functional, upregulation of NSGT1 during ripening converts guaiacol to non-cleavable triglycosides, preventing guaiacol volatilization ( Tikunov et al., 2013 83. Tikunov, Y.M. ∙ Molthoff, J. ∙ de Vos, R.C.H. ... Non-smoky glycosyltransferase1 prevents the release of smoky aroma from tomato fruit Plant Cell. 2013; 25 :3067-3078 Crossref Scopus (83) PubMed Google Scholar ). To investigate whether NSGT genes could be linked to the smoky QTL, we inspected the previous reference genome SL3.0 and found a partial sequence of NSGT1 near the gap at the chromosome 9 GWAS locus and another NSGT1 fragment at a second GWAS peak on an unanchored contig ( Figure 4 B; Tieman et al., 2017 82. Tieman, D. ∙ Zhu, G. ∙ Resende, Jr., M.F.R. ... A chemical genetic roadmap to improved tomato flavor Science. 2017; 355 :391-394 Crossref Scopus (515) PubMed Google Scholar ). Consistently, a recent short-read k-mer-based analysis also linked the two smoky GWAS peaks and suggested hidden structural complexity ( Voichek and Weigel, 2020 88. Voichek, Y. ∙ Weigel, D. Identifying genetic variants underlying phenotypic variation in plants without complete genomes Nat. Genet. 2020; 52 :534-540 Crossref Scopus (76) PubMed Google Scholar ). However, all these studies failed to resolve this locus. Importantly, our new MAS2.0 assemblies not only filled the gaps flanking E8 with these two NSGT paralogs but also further revealed coding sequence variants and SVs that are resolved into five haplotypes ( Figures 4 B and 4C; see STAR Methods ).
Haplotype I is likely ancestral with the NSGT1 and NSGT2 genes flanking E8 . Although an NSGT2 coding sequence mutation is found in all other haplotypes, haplotypes II and III have intact NSGT1 , with the latter carrying two copies of NSGT1 ( Figure 4 C). Finally, copy number and functional variation are extended in haplotypes IV and V; haplotype IV has a 7-kbp duplication, including mutant nsgt2 that disrupted NSGT1 , rendering it non-functional, and haplotype V has a large 23-kbp deletion that removes both NSGT1 and E8 , leaving only a single mutated copy of nsgt2 ( Figure 4 D).
These haplotypes, along with the previous characterization of NSGT1 ( Tikunov et al., 2013 83. Tikunov, Y.M. ∙ Molthoff, J. ∙ de Vos, R.C.H. ... Non-smoky glycosyltransferase1 prevents the release of smoky aroma from tomato fruit Plant Cell. 2013; 25 :3067-3078 Crossref Scopus (83) PubMed Google Scholar ), suggest that multiple mutant alleles of nsgt1 are responsible for natural variation in guaiacol (and methyl salicylate) accumulation and the smoky flavor. Using gene expression and metabolite data from fruits of more than 300 accessions ( Tieman et al., 2017; Zhu et al., 2018 82. Tieman, D. ∙ Zhu, G. ∙ Resende, Jr., M.F.R. ... A chemical genetic roadmap to improved tomato flavor Science. 2017; 355 :391-394 Crossref Scopus (515) PubMed Google Scholar 100. Zhu, G. ∙ Wang, S. ∙ Huang, Z. ... Rewiring of the fruit metabolome in tomato breeding Cell. 2018; 172 :249-261.e12 Full Text Full Text (PDF) Scopus (581) PubMed Google Scholar ), we tested associations between functional (I, II, and III), coding sequence non-functional (IV), and deletion non-functional (V) NSGT1 haplotypes and guaiacol accumulation (see STAR Methods ). Accessions carrying the mutant haplotypes IV and V, which emerged early in domestication in the SLCs ( Table S5 A), exhibited lower combined NSGT1/2 expression levels compared to accessions with functional haplotypes, with no NSGT1/2 expression detected in the five accessions carrying the haplotype V deletion ( Figure 4 E; see STAR Methods ). Consistently, both mutant haplotypes accumulated more guaiacol, though the effect from the rare haplotype V showed weak statistical significance ( Figure 4 F). We validated these findings using a new GWAS panel of 155 accessions comprised primarily of SP and SLC genotypes ( Razifard et al., 2020 66. Razifard, H. ∙ Ramos, A. ∙ Della Valle, A.L. ... Genomic evidence for complex domestication history of the cultivated tomato in Latin America Mol. Biol. Evol. 2020; 37 :1118-1132 Crossref Scopus (102) PubMed Google Scholar ). Again, both nsgt1 coding and deletion mutation haplotypes accumulate significantly more guaiacol than functional haplotypes ( Figure 4 G). Finally, we generated an F2 population between two SLCs segregating for haplotype V and functional NSGT1 , which confirmed the deletion, lacking both NSGT1 and E8 , is associated with accumulation of both guaiacol and methyl salicylate ( Figure 4 H). Together, our results anchored two NSGT genes to the smoky GWAS QTL and show that multiple nsgt1 mutations largely explain natural variations of the smoky flavor. This example demonstrates how our high-quality long-read genome assemblies can resolve complex haplotypes and reveal causative variants for poorly understood QTLs.
A substantial increase in fruit weight was a major feature of tomato domestication ( van der Knaap et al., 2014 84. van der Knaap, E. ∙ Chakrabarti, M. ∙ Chu, Y.H. ... What lies beyond the eye: the molecular mechanisms regulating tomato fruit weight and shape Front. Plant Sci. 2014; 5 :227 Crossref Scopus (176) PubMed Google Scholar ). The genes underlying five major fruit weight QTL have been identified, with the responsible mutations being either SVs or SNPs ( Chakrabarti et al., 2013; Frary et al., 2000; Mu et al., 2017; Muños et al., 2011; Xu et al., 2015 17. Chakrabarti, M. ∙ Zhang, N. ∙ Sauvage, C. ... A cytochrome P450 regulates a domestication trait in cultivated tomato Proc. Natl. Acad. Sci. USA. 2013; 110 :17125-17130 Crossref Scopus (215) PubMed Google Scholar 27. Frary, A. ∙ Nesbitt, T.C. ∙ Grandillo, S. ... fw2.2: a quantitative trait locus key to the evolution of tomato fruit size Science. 2000; 289 :85-88 Crossref Scopus (1113) PubMed Google Scholar 55. Mu, Q. ∙ Huang, Z. ∙ Chakrabarti, M. ... Fruit weight is controlled by cell size regulator encoding a novel protein that is expressed in maturing tomato fruits PLoS Genet. 2017; 13 :e1006930 Crossref Scopus (120) PubMed Google Scholar 56. Muños, S. ∙ Ranc, N. ∙ Botton, E. ... Increase in tomato locule number is controlled by two single-nucleotide polymorphisms located near WUSCHEL Plant Physiol. 2011; 156 :2244-2254 Crossref Scopus (242) PubMed Google Scholar 95. Xu, C. ∙ Liberatore, K.L. ∙ MacAlister, C.A. ... A cascade of arabinosyltransferases controls shoot meristem size in tomato Nat. Genet. 2015; 47 :784-792 Crossref Scopus (318) PubMed Google Scholar ). Among these is fw3.2 , which is strongly associated with a SNP in the promoter of the cytochrome P450 gene SlKLUH , a known regulator of organ size in multiple species ( Anastasiou et al., 2007; Chakrabarti et al., 2013; Miyoshi et al., 2004 5. Anastasiou, E. ∙ Kenz, S. ∙ Gerstung, M. ... Control of plant organ size by KLUH/CYP78A5-dependent intercellular signaling Dev. Cell. 2007; 13 :843-856 Full Text Full Text (PDF) Scopus (293) PubMed Google Scholar 17. Chakrabarti, M. ∙ Zhang, N. ∙ Sauvage, C. ... A cytochrome P450 regulates a domestication trait in cultivated tomato Proc. Natl. Acad. Sci. USA. 2013; 110 :17125-17130 Crossref Scopus (215) PubMed Google Scholar 54. Miyoshi, K. ∙ Ahn, B.-O. ∙ Kawakatsu, T. ... PLASTOCHRON1, a timekeeper of leaf initiation in rice, encodes cytochrome P450 Proc. Natl. Acad. Sci. USA. 2004; 101 :875-880 Crossref Scopus (156) PubMed Google Scholar ). The promoter SNP was proposed to account for higher (2- to 3-fold) SlKLUH expression ( Figure 5 A), and transcriptional knockdown of this gene results in smaller fruits, though a causative role for the SNP was unclear.
Our panSV genome revealed an ∼50-kbp tandem duplication at the fw3.2 locus containing three genes, including two identical copies of SlKLUH (designated fw3.2 dup ; Figure 5 B). Although SNPs in promoters can affect expression by modifying cis -regulatory elements, we explored whether fw3.2 dup is the causative variant, with the hypothesis that an increase in gene copy number explains the higher expression. In support of this, our expression analyses showed that all three intact genes within the duplication are expressed approximately 2-fold higher in accessions carrying fw3.2 dup ( Figures 5 C and S5 A). To disentangle the effects of these variants on fruit weight, we generated F2 populations segregating for fw3.2 dup but fixed for the promoter SNP and other known fruit weight QTLs. Higher fruit weight co-segregated with the duplication allele ( Figures 5 D and S5 B). In contrast, there was no association between the promoter SNP and fruit weight in F2 populations segregating only for the SNP ( Figures S5 C and S5D).
Our results suggested that the duplication carrying SlKLUH could explain fw3.2 due to an increase in gene copy number and therefore dosage. We tested this by CRISPR-Cas9 targeting SlKLUH in the processing cultivar M82 (carrying fw3.2 dup and therefore four functional copies of SlKLUH ) with multiple guide RNAs (gRNAs). PCR genotyping and sequencing of independent T0 plants showed large deletions and small indels in the target sites. The majority of these plants, including three confirmed to lack wild-type (WT) alleles, were much smaller than control plants and had tiny inflorescences and flowers that were infertile ( Figures 5 E and S5 E).
Fortuitously, one fertile plant ( slkluh CR T0-1) showed a weaker phenotype from having both WT and mutant alleles, allowing us to directly test how changes in SlKLUH dosage affect fruit weight. To work in an isogenic background with uniform cherry type fruits that allows for a robust assessment of fruit size, we crossed the slkluh CR T0-1 with the SP accession LA1589. As LA1589 has only two copies of SpKLUH ( Figure 5 F), the M82 × LA1589 F1 isogenic hybrids have three gene copies of KLUH (2 copies SlKLUH and 1 copy SpKLUH ). These control F1 hybrids (group A) were compared with F1 progeny resulting from the cross between slkluh CR T0-1 and LA1589 (see STAR Methods ). Several F1 hybrid plants that inherited the Cas9 transgene produced small organs and were infertile (group C), which we confirmed was due to inheritance of mutated and further trans targeting of all KLUH copies ( Figures S5 F and S5G). Among F1 plants lacking the Cas9 transgene, a subset inherited two mutated alleles of SlKLUH and a single functional allele of SpKLUH (group B; Figures 5 F, 5G, and S5 H). Notably, these group B plants produced 15% smaller flowers and 30% smaller fruits compared to group A plants (1 versus 3 functional alleles of KLUH ; Figures 5 H and 5I). Thus, our panSV genome and functional genetic dissection using CRISPR-Cas9 genome editing show that the duplication including KLUH , and the corresponding increase in gene dosage and expression, underlies fw3.2 .
We revealed thousands of genes with expression variation that could be caused by SVs. These variants might have little or no phenotypic consequences; however, many may be “cryptic,” having little or no effect on their own but causing phenotypic changes in the context of other variants ( Paaby and Rockman, 2014; Sackton and Hartl, 2016 60. Paaby, A.B. ∙ Rockman, M.V. Cryptic genetic variation: evolution’s hidden substrate Nat. Rev. Genet. 2014; 15 :247-258 Crossref Scopus (339) PubMed Google Scholar 68. Sackton, T.B. ∙ Hartl, D.L. Genotypic context and epistasis in individuals and populations Cell. 2016; 166 :279-287 Full Text Full Text (PDF) Scopus (92) PubMed Google Scholar ). The “jointless” fruit pedicel is an important tomato harvesting trait that originated by different mutations from wild and domesticated accessions ( Soyk et al., 2017 78. Soyk, S. ∙ Lemmon, Z.H. ∙ Oved, M. ... Bypassing negative epistasis on yield in tomato imposed by a domestication gene Cell. 2017; 169 :1142-1155.e12 Full Text Full Text (PDF) Scopus (245) PubMed Google Scholar ). The jointless trait allows complete separation of fruits from other floral parts and is caused by a transposon insertion that eliminates functional transcripts of the MADS-box transcription factor gene JOINTLESS2 ( J2 ). A cryptic insertion in the related ENHANCER OF J2 ( EJ2 ) gene reduces functional transcripts and causes excessive inflorescence branching with reduced fruit production following introduction of the jointless trait ( Figure 6 A). Breeders overcame this negative interaction and restored normal inflorescences by exploiting two natural “suppressor of branching” ( sb ) QTLs that we designated sb1 and sb3 ( Soyk et al., 2019 79. Soyk, S. ∙ Lemmon, Z.H. ∙ Sedlazeck, F.J. ... Duplication of a domestication locus neutralized a cryptic variant that caused a breeding barrier in tomato Nat. Plants. 2019; 5 :471-479 Crossref Scopus (60) PubMed Google Scholar ). We recently showed that sb3 is an 83-kbp duplication that includes ej2 w , which causes a dose-dependent increase of weak allele expression that compensates for the reduced functional transcripts ( Figure 6 A).
The cryptic sb1 locus is a partial suppressor of branching, and our previous QTL mapping positioned sb1 to a 6-Mbp interval on chromosome 1 ( Figures 6 B and 6C). We searched for candidate genes and focused on two neighboring MADS-box paralogs, TM3 ( Solyc01 g093965 ) and SISTER OF TM3 ( STM3 ) ( Solyc01 g092950 ; Figure S6 A). Notably, STM3 showed approximately 2-fold higher expression in the branched parental line (M82 j2 TE ej2 W ) compared to the suppressed parent (Fla.8924 j2 TE ej2 W ; Figure S6 B). There were no obvious coding or regulatory mutations in this gene; however, the Heinz 4.0 reference genome has gaps in that area. Our MAS2.0 assemblies filled the gaps and revealed copy number variation for STM3 , with an extra copy of the gene in the branched parent due to a near perfect 22-kbp tandem duplication ( Figures 6 D and S6 C). Consistently, genotypes with four copies of STM3 showed 2-fold higher expression compared to two copy genotypes ( Figure 6 E).
To test whether lower dosage and expression from a single STM3 gene is responsible for the sb1 QTL, we used CRISPR-Cas9 to generate mutant alleles disrupting the complex STM3-TM3 locus. A CRISPR construct with two gRNAs gave small indel mutations in all copies of the identical TM3/STM3 exon 2 ( sb1 CR-1 ), although a second construct with four gRNAs deleted the entire locus ( sb1 CR-del ; Figures 6 F and S6 D). Both sb1 CR-1 and sb1 CR-del plants were slightly late flowering, but their inflorescences were normal ( Figure S6 E). We then introduced each allele into the highly branched M82 j2 TE ej2 w double mutants and identified j2 TE ej2 w sb1 CR-1 and j2 TE ej2 w sb1 CR-del triple mutants from segregating F2 populations. Importantly, all of these plants (0 functional copies of STM3 ) showed practically complete suppression of branching compared to j2 TE ej2 w double mutants (4 functional copies of STM3 ; Figures 6 F, 6G, and S6 F). Moreover, j2 TE ej2 w plants that were heterozygous for the CRISPR alleles (2 functional copies of STM3 ) showed partial suppression of inflorescence branching, mimicking the effect of sb1 (e.g., Fla.8924; 2 functional copies of STM3 ; Figures 6 F, 6G, and S6 F). Thus, a single-copy STM3 , and the corresponding lower gene expression, explains sb1 .
Short-read-based genotyping of more than 500 accessions spanning tomato taxonomic groups showed that the duplication of STM3 arose early in domestication, but the ancestral single gene has remained common in tomato germplasm ( Figures 6 H and S6 G; Table S5 B). In fact, the majority of vintage and modern fresh-market accessions have single-copy STM3 , indicating that a lower dosage and expression level provided partial suppression of branching upon the introduction of j2 TE into lines carrying ej2 w . The duplication of ej2 w , and the resulting increased expression of this weak allele, arose later and was likely selected to achieve complete suppression of branching. In support, all jointless fresh-market accessions carry both sb1 (single-copy STM3 ) and sb3 (duplicated ej2 w ; Figure 6 I). In contrast, breeding for jointless in processing tomato accessions was achieved by selecting against ej2 w ( Figure 6 I). Consistent with this, sb1 and SB1 (duplicated STM3 ) are present at equal frequencies in processing tomato accessions, maintaining cryptic variation in the context of inflorescence development ( Figures 6 I and 6J). Our analysis reveals STM3 as a new regulator of tomato inflorescence development, and the dissection of sb1 shows that the path of jointless breeding depended on four SVs affecting the expression levels of three MADS-box genes and further illustrates how functional consequences of structural variation can remain hidden.

Section: Discussion

Advancements in genome-sequencing technologies continue to revolutionize biology by providing an increasingly comprehensive view of the genetic changes underlying phenotypic diversity. The recent development of high-throughput Oxford Nanopore long-read sequencing has provided the opportunity to rapidly reveal the breadth and depth of previously hidden SVs in complex genomes and across populations ( Beyter et al., 2019 11. Beyter, D. ∙ Ingimundardottir, H. ∙ Eggertsson, H.P. ... Long read sequencing of 1,817 Icelanders provides insight into the role of structural variants in human disease bioRxiv. 2019; Crossref Scopus (0) Google Scholar ). Taking advantage of the expansive genetic diversity of wild and domesticated tomatoes, we sequenced a collection of 100 accessions and resolved hundreds of thousands of SVs. These SVs were shaped predominately by transposons ( Domínguez et al., 2020 24. Domínguez, Marisol ∙ Dugas, Elise ∙ Benchouaia, Médine ... The impact of transposable elements on tomato diversity bioRxiv. 2020; Crossref Scopus (0) Google Scholar ), are abundant across all chromosomes, frequently reside within or in close proximity to genes, are often associated with expression, and likely contribute to phenotypic variation. Integrating our panSV genome, de novo assemblies, and expression data with genome-editing enabled us to resolve and functionally link SVs to three major domestication and breeding traits. The smoky and sb1 loci in particular demonstrate how these resources were essential to resolve complex haplotypes underlying QTLs where previous assemblies were thwarted by repeats, especially highly similar long and local duplications. Moreover, our analyses of the smoky and fw3.2 loci show that presumed causative variation may be incomplete or incorrect. More broadly, most QTLs discovered by GWAS in model and crop plants reside in regions with multiple candidate genes and variants. In addition to improving GWAS statistical power, long-read-based discovery of abundant, sometimes complex SVs may immediately pinpoint high-confidence candidate genes and variants for functional analyses. Similar progress in understanding functional impacts of SVs will likely emerge from generating population-scale panSV genomes in other species ( Danilevicz et al., 2020; Song et al., 2020; Sun et al., 2018; Yang et al., 2019; Zhou et al., 2019 21. Danilevicz, M.F. ∙ Tay Fernandez, C.G. ∙ Marsh, J.I. ... Plant pangenomics: approaches, applications and advancements Curr. Opin. Plant Biol. 2020; 54 :18-25 Crossref Scopus (75) PubMed Google Scholar 77. Song, J.-M. ∙ Guan, Z. ∙ Hu, J. ... Eight high-quality genomes reveal pan-genome architecture and ecotype differentiation of Brassica napus Nat. Plants. 2020; 6 :34-45 Crossref Scopus (398) PubMed Google Scholar 81. Sun, S. ∙ Zhou, Y. ∙ Chen, J. ... Extensive intraspecific gene order and gene structural variations between Mo17 and other maize genomes Nat. Genet. 2018; 50 :1289-1295 Crossref Scopus (262) PubMed Google Scholar 96. Yang, N. ∙ Liu, J. ∙ Gao, Q. ... Genome assembly of a tropical maize inbred line provides insights into structural variation and crop improvement Nat. Genet. 2019; 51 :1052-1059 Crossref Scopus (177) PubMed Google Scholar 99. Zhou, Y. ∙ Minio, A. ∙ Massonnet, M. ... The population genetics of structural variants in grapevine domestication Nat. Plants. 2019; 5 :965-979 Crossref Scopus (163) PubMed Google Scholar ).
Our panSV genome revealed that fw3.2 and sb1 were both associated with previously hidden duplications. In both plants and animals, duplications that alter copy number and expression of dosage-sensitive genes were found to modify phenotypic diversity, including traits important in domestication and breeding ( Lye and Purugganan, 2019 52. Lye, Z.N. ∙ Purugganan, M.D. Copy number variation in domestication Trends Plant Sci. 2019; 24 :352-365 Full Text Full Text (PDF) Scopus (114) PubMed Google Scholar ). Large, tandem, recent duplications are one of the most challenging SVs to resolve, and even when a strong candidate gene is present, as with SlKLUH in the fw3.2 duplication, directly testing how modified gene dosage and expression impacts quantitative variation is challenging. Enabled by CRISPR-Cas9 genome editing, we generated plants with different gene copy numbers, and therefore dosages, for SlKLUH and STM3 in the fw3.2 and SB1 duplications, respectively. Establishing a dosage series of isogenic genotypes not only confirmed the causality of the duplications and the specific genes but also directly demonstrated their quantitative impact. In particular, heterozygotes of sb1 CR alleles (2 copies of STM3 on 1 chromosome) suppressed inflorescence branching of j2 TE ej2 W plants to a similar degree as the natural dosage effect from single-copy STM3 (1 copy of STM3 on each chromosome). Similarly, reducing functional KLUH copy number from three to one recapitulated the natural quantitative effect on fruit size of having four or two copies. Manipulating gene copy number by genome editing now provides a way to systematically interrogate and explore dosage to phenotype relationships ( Veitia et al., 2013 86. Veitia, R.A. ∙ Bottani, S. ∙ Birchler, J.A. Gene dosage effects: nonlinearities, genetic interactions, and dosage compensation Trends Genet. 2013; 29 :385-393 Full Text Full Text (PDF) Scopus (95) PubMed Google Scholar ), which will be important for guiding the design and engineering of specific dosages for crop improvement.
Our panSV genome showed that the majority of gene-associated SVs are in cis -regulatory regions, and many are associated with subtle changes in expression. Expanding long-read sequencing and expression analyses to a wider population will reveal even more such SVs. This raises the question to what extent cis -regulatory SVs affect phenotypes. For genes that are dosage sensitive, such as those encoding components of molecular complexes or involved in signaling networks, a subtle change in expression could alter phenotype ( Veitia et al., 2013 86. Veitia, R.A. ∙ Bottani, S. ∙ Birchler, J.A. Gene dosage effects: nonlinearities, genetic interactions, and dosage compensation Trends Genet. 2013; 29 :385-393 Full Text Full Text (PDF) Scopus (95) PubMed Google Scholar ). However, the magnitude of phenotypic effect may depend on a threshold change in expression and could be weak, making detection challenging in population genetics studies where other mutations and alleles influence trait variation. Genome editing could be used to study the effects of gene-associated SVs by recreating specific mutations or mimicking the expression effects of natural cis -regulatory SVs in isogenic backgrounds. Our previous work characterizing collections of CRISPR-Cas9-engineered promoter alleles in multiple developmental genes showed that deletion and inversion SVs can affect expression and phenotypic outputs in various, often unpredictable ways ( Rodríguez-Leal et al., 2017 67. Rodríguez-Leal, D. ∙ Lemmon, Z.H. ∙ Man, J. ... Engineering quantitative trait variation for crop improvement by genome editing Cell. 2017; 171 :470-480.e8 Full Text Full Text (PDF) Scopus (693) PubMed Google Scholar ). As SVs could be cryptic, a more powerful and informative approach would therefore be to sensitize the locus or genome, by combining natural cis -regulatory SVs with engineered SVs in the same promoter or with engineered mutations in related, potentially redundant genes. Resolving the functional impacts of SVs, particularly those whose effects are subtle or cryptic, will advance our understanding of genotype-to-phenotype relationships and facilitate the exploitation of natural and engineered SVs in crop improvement.

Section: STAR★Methods

REAGENT or RESOURCE SOURCE IDENTIFIER Biological Samples DNA and leaf tissue from tomato core collection and breeding lines. See Table S1 B N/A Chemicals, Peptides, and Recombinant Proteins CTAB Sigma Aldrich Cat#H6269-500G Agarose VWR Cat#97062-250 BsaI NEB Cat#R0535L BpiI Thermo Fisher Cat#ER1012 T4 DNA Ligase NEB Cat#M0202L Acetone Fisher Scientific Cat#A928-4 Taq DNA Polymerase with Standard Taq Buffer NEB Cat#M0273L KOD Xtreme Hot Start DNA Polymerase Millipore Cat#71975 iQ SYBR Green Supermix Bio-Rad Cat# 17-8882 Critical Commercial Assays TruSeq DNA PCR-Free HT Library Preparation Kit Illumina Cat#FC-121-3003 TruSeq Nano DNA LT Library Preparation Kit Illumina Cat#FC-121-4001 Kapa Library quantification kit Kapa Biosystems Cat#07960140001 RNase Free DNase Set QIAGEN Cat#79254 QIAprep Spin Miniprep Kit QIAGEN Cat#27106 QIAquick PCR Purification Kit QIAGEN Cat#28106 StrataClone Blunt PCR Cloning Kit Stratagene Cat#240207 SuperScript III First-Strand Synthesis System Invitrogen Cat# 18080051 RNeasy Plant Mini Kit QIAGEN Cat#74904 Deposited Data Nanopore long-read sequencing data and illumina resequencing This study PRJNA557253 3′ RNA-sequencing This study PRJNA557253 Experimental Models: Organisms/Strains Tomato wild species, landraces, and cultivars See Table S1 B N/A Tomato elite breeding lines See Table S1 B N/A Oligonucleotides Primer sequences for genotyping, see Table S6 This study N/A Primer sequences for RT-PCR, see Table S6 This study N/A Guide RNA (gRNA) sequences, see Table S6 This study N/A Primer sequences for sequencing, see Table S6 This study N/A Recombinant DNA MoClo Toolkit ( Weber et al., 2011 91. Weber, E. ∙ Engler, C. ∙ Gruetzner, R. ... A modular cloning system for standardized assembly of multigene constructs PLoS ONE. 2011; 6 :e16765 Crossref Scopus (753) PubMed Google Scholar ) Addgene #1000000044 pICH86966::AtU6p::sgRNA_PDS ( Belhaj et al., 2013 9. Belhaj, K. ∙ Chaparro-Garcia, A. ∙ Kamoun, S. ... Plant genome editing made easy: targeted mutagenesis in model and crop plants using the CRISPR/Cas system Plant Methods. 2013; 9 :39 Crossref Scopus (462) PubMed Google Scholar ) Addgene #46966 pICH47732::NOSp::NPTII ( Belhaj et al., 2013 9. Belhaj, K. ∙ Chaparro-Garcia, A. ∙ Kamoun, S. ... Plant genome editing made easy: targeted mutagenesis in model and crop plants using the CRISPR/Cas system Plant Methods. 2013; 9 :39 Crossref Scopus (462) PubMed Google Scholar ) Addgene #51144 pICH47742::35S::Cas9 ( Belhaj et al., 2013 9. Belhaj, K. ∙ Chaparro-Garcia, A. ∙ Kamoun, S. ... Plant genome editing made easy: targeted mutagenesis in model and crop plants using the CRISPR/Cas system Plant Methods. 2013; 9 :39 Crossref Scopus (462) PubMed Google Scholar ) Addgene #49771 Software and Algorithms Trimmomatic ( Bolger et al., 2014b 14. Bolger, A.M. ∙ Lohse, M. ∙ Usadel, B. Trimmomatic: a flexible trimmer for Illumina sequence data Bioinformatics. 2014; 30 :2114-2120 Crossref Scopus (36372) PubMed Google Scholar ) http://www.usadellab.org/cms/?page=trimmomatic Samtools ( Li et al., 2009 48. Li, H. ∙ Handsaker, B. ∙ Wysoker, A. ..., 1000 Genome Project Data Processing Subgroup The Sequence Alignment/Map format and SAMtools Bioinformatics. 2009; 25 :2078-2079 Crossref Scopus (37567) PubMed Google Scholar ) http://www.htslib.org/ HTSeq-count ( Anders et al., 2015 6. Anders, S. ∙ Pyl, P.T. ∙ Huber, W. HTSeq--a Python framework to work with high-throughput sequencing data Bioinformatics. 2015; 31 :166-169 Crossref Scopus (13081) PubMed Google Scholar ) https://www-huber.embl.de/users/anders/HTSeq/doc/overview.html R ( R Development Core Team, 2017 64. R Development Core Team R: A language and environment for statistical computing R Foundation for Statistical Computing, 2017 http://www.R-project.org/ Google Scholar ) https://www.r-project.org/ DESeq2 ( Love et al., 2014 51. Love, M.I. ∙ Huber, W. ∙ Anders, S. Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2 Genome Biol. 2014; 15 :550 Crossref Scopus (45393) PubMed Google Scholar ) https://bioconductor.org/packages/release/bioc/html/DESeq2.html STAR ( Dobin et al., 2013 23. Dobin, A. ∙ Davis, C.A. ∙ Schlesinger, F. ... STAR: ultrafast universal RNA-seq aligner Bioinformatics. 2013; 29 :15-21 Crossref Scopus (25613) PubMed Google Scholar ) https://github.com/alexdobin/STAR kallisto ( Bray et al., 2016 15. Bray, N.L. ∙ Pimentel, H. ∙ Melsted, P. ... Near-optimal probabilistic RNA-seq quantification Nat. Biotechnol. 2016; 34 :525-527 Crossref Scopus (4977) PubMed Google Scholar ) https://pachterlab.github.io/kallisto/ bwa ( Li and Durbin, 2009 47. Li, H. ∙ Durbin, R. Fast and accurate short read alignment with Burrows-Wheeler transform Bioinformatics. 2009; 25 :1754-1760 Crossref Scopus (31657) PubMed Google Scholar ) http://bio-bwa.sourceforge.net/ Picard NA https://broadinstitute.github.io/picard/ Delly ( Rausch et al., 2012 65. Rausch, T. ∙ Zichner, T. ∙ Schlattl, A. ... DELLY: structural variant discovery by integrated paired-end and split-read analysis Bioinformatics. 2012; 28 :i333-i339 Crossref Scopus (1364) PubMed Google Scholar ) https://github.com/dellytools/delly Lumpy ( Layer et al., 2014 42. Layer, R.M. ∙ Chiang, C. ∙ Quinlan, A.R. ... LUMPY: a probabilistic framework for structural variant discovery Genome Biol. 2014; 15 :R84 Crossref Scopus (899) PubMed Google Scholar ) https://github.com/arq5x/lumpy-sv Manta ( Chen et al., 2016 18. Chen, X. ∙ Schulz-Trieglaff, O. ∙ Shaw, R. ... Manta: rapid detection of structural variants and indels for germline and cancer sequencing applications Bioinformatics. 2016; 32 :1220-1222 Crossref Scopus (1044) PubMed Google Scholar ) https://github.com/Illumina/manta SURVIVOR ( Jeffares et al., 2017 35. Jeffares, D.C. ∙ Jolly, C. ∙ Hoti, M. ... Transient structural variations have strong effects on quantitative traits and reproductive isolation in fission yeast Nat. Commun. 2017; 8 :14061 Crossref Scopus (328) PubMed Google Scholar ) https://github.com/fritzsedlazeck/SURVIVOR SVCollector ( Sedlazeck et al., 2018b 74. Sedlazeck, F.J. ∙ Lemmon, Z. ∙ Soyk, S. ... SVCollector: Optimized sample selection for validating and long-read resequencing of structural variants bioRxiv. 2018; Crossref Scopus (0) Google Scholar ) https://github.com/fritzsedlazeck/SVCollector NGMLR ( Sedlazeck et al., 2018a 73. Sedlazeck, F.J. ∙ Rescheneder, P. ∙ Smolka, M. ... Accurate detection of complex structural variations using single-molecule sequencing Nat. Methods. 2018; 15 :461-468 Crossref Scopus (818) PubMed Google Scholar ) https://github.com/philres/ngmlr Sniffles ( Sedlazeck et al., 2018a 73. Sedlazeck, F.J. ∙ Rescheneder, P. ∙ Smolka, M. ... Accurate detection of complex structural variations using single-molecule sequencing Nat. Methods. 2018; 15 :461-468 Crossref Scopus (818) PubMed Google Scholar ) https://github.com/fritzsedlazeck/Sniffles bedtools ( Quinlan and Hall, 2010 63. Quinlan, A.R. ∙ Hall, I.M. BEDTools: a flexible suite of utilities for comparing genomic features Bioinformatics. 2010; 26 :841-842 Crossref Scopus (14500) PubMed Google Scholar ) https://github.com/arq5x/bedtools2 SciPy ( Virtanen et al., 2020 87. Virtanen, P. ∙ Gommers, R. ∙ Oliphant, T.E. ..., SciPy 1.0 Contributors SciPy 1.0: fundamental algorithms for scientific computing in Python Nat. Methods. 2020; 17 :261-272 Crossref Scopus (16613) PubMed Google Scholar ) https://github.com/scipy/scipy Iris NA https://github.com/mkirsche/Iris Racon ( Vaser et al., 2017 85. Vaser, R. ∙ Sović, I. ∙ Nagarajan, N. ... Fast and accurate de novo genome assembly from long uncorrected reads Genome Res. 2017; 27 :737-746 Crossref Scopus (1444) PubMed Google Scholar ) https://github.com/lbcb-sci/racon Jasmine NA https://github.com/mkirsche/Jasmine MaSuRCA ( Zimin et al., 2017 102. Zimin, A.V. ∙ Puiu, D. ∙ Luo, M.C. ... Hybrid assembly of the large and highly repetitive genome of Aegilops tauschii , a progenitor of bread wheat, with the MaSuRCA mega-reads algorithm Genome Res. 2017; 27 :787-792 Crossref Scopus (246) PubMed Google Scholar ) https://github.com/alekseyzimin/masurca POLCA ( Zimin and Salzberg, 2019 101. Zimin, A.V. ∙ Salzberg, S.L. The genome polishing tool POLCA makes fast and accurate corrections in genome assemblies bioRxiv. 2019; Crossref Scopus (0) Google Scholar ) https://github.com/alekseyzimin/masurca seqtk NA https://github.com/lh3/seqtk Minimap2 ( Li, 2018 46. Li, H. Minimap2: pairwise alignment for nucleotide sequences Bioinformatics. 2018; 34 :3094-3100 Crossref Scopus (5152) PubMed Google Scholar ) https://github.com/lh3/minimap2 RaGOO ( Alonge et al., 2019 4. Alonge, M. ∙ Soyk, S. ∙ Ramakrishnan, S. ... RaGOO: fast and accurate reference-guided scaffolding of draft genomes Genome Biol. 2019; 20 :224 Crossref Scopus (357) PubMed Google Scholar ) https://github.com/malonge/RaGOO MUMmer ( Kurtz et al., 2004 41. Kurtz, S. ∙ Phillippy, A. ∙ Delcher, A.L. ... Versatile and open software for comparing large genomes Genome Biol. 2004; 5 :R12 Crossref PubMed Google Scholar ) http://mummer.sourceforge.net/ geneLift NA https://github.com/srividya22/geneLift GMAP ( Wu et al., 2016 94. Wu, T.D. ∙ Reeder, J. ∙ Lawrence, M. ... GMAP and GSNAP for genomic sequence alignment: Enhancements to speed, accuracy, and functionality Mathé, E. ∙ Davis, S. (Editors) Statistical Genomics. Methods in Molecular Biology Humana Press, 2016; 283-334 Crossref Scopus (269) Google Scholar ) http://research-pub.gene.com/gmap/ REPET ( Flutre et al., 2011 25. Flutre, T. ∙ Duprat, E. ∙ Feuillet, C. ... Considering transposable element diversification in de novo annotation approaches PLoS ONE. 2011; 6 :e16526 Crossref Scopus (320) PubMed Google Scholar ) https://urgi.versailles.inra.fr/Tools/REPET PASTEC ( Hoede et al., 2014 32. Hoede, C. ∙ Arnoux, S. ∙ Moisset, M. ... PASTEC: an automatic transposable element classification tool PLoS ONE. 2014; 9 :e91929 Crossref Scopus (196) PubMed Google Scholar ) https://urgi.versailles.inra.fr/Tools/PASTEClassifier Canu ( Koren et al., 2017 39. Koren, S. ∙ Walenz, B.P. ∙ Berlin, K. ... Canu: scalable and accurate long-read assembly via adaptive k -mer weighting and repeat separation Genome Res. 2017; 27 :722-736 Crossref Scopus (4222) PubMed Google Scholar ) https://github.com/marbl/canu Flye ( Kolmogorov et al., 2019 38. Kolmogorov, M. ∙ Yuan, J. ∙ Lin, Y. ... Assembly of long, error-prone reads using repeat graphs Nat. Biotechnol. 2019; 37 :540-546 Crossref Scopus (2014) PubMed Google Scholar ) https://github.com/fenderglass/Flye DupCheck NA https://github.com/malonge/DupCheck CallIntrogressions NA https://github.com/malonge/CallIntrogressions Circa NA http://omgenomics.com/circa/ vcfanno ( Pedersen et al., 2016 62. Pedersen, B.S. ∙ Layer, R.M. ∙ Quinlan, A.R. Vcfanno: fast, flexible annotation of genetic variants Genome Biol. 2016; 17 :118 Crossref Scopus (106) PubMed Google Scholar ) https://github.com/brentp/vcfanno Open table in a new tab
Further information and requests for resources and reagents should be directed to and will be fulfilled by the Lead Contact, Zachary B. Lippman ( lippman@cshl.edu ).
This study did not generate new unique reagents. Plasmids and transgenic plants generated in this study are available from the Lead Contact with a completed Materials Transfer Agreement.
All sequencing data generated in this study have been deposited at the Sequence Read Archive ( https://ncbi.nlm.nih.gov/sra ) under BioProject PRJNA557253. Github repositories for software presented in this work are listed as follows: https://github.com/malonge/DupCheck , https://github.com/mkirsche/Jasmine , https://github.com/srividya22/geneLift , https://github.com/malonge/CallIntrogressions . All genome assemblies/annotations and SV VCF files are available at the Solanaceae Genomics Network ( https://solgenomics.net/projects/tomato100 ).
A hundred tomato accessions were collected from TGRC (Tomato Genetics Resource Center), USDA (United State Department of Agriculture), University of Florida, EU-SOL (The European Union-Solanaceae project), INRA (The National Institute for Agricultural Research), IVF-CAAS (The Institute of Vegetables and Flowers, Chinese Academy of Agricultural Science) and our own stocks. The landrace collection ( S. lycopersicum var. cerasiforme ) was from the seed stocks of E. van der Knaap. Seeds of S. pimpinellifolium (LA1589), S. lycopersicum cv. M82 (LA3475), and j2 TE ej2 w mutant are from Lippman lab. All accessions used in this study are listed in Table S1 B.
Seeds were either germinated on moistened filter paper at 28 ° C in the dark or directly sown in soil in 96-cell plastic flats. Plants were grown under long-day conditions (16-h light/8-h dark) in a greenhouse under natural light supplemented with artificial light from high-pressure sodium bulbs (∼250 μmol m -2 s -1 ). Daytime and nighttime temperatures were 26–28 ° C and 18–20 ° C, respectively, with a relative humidity of 40%–60%.
Quantification of fruit guaiacol and methylsalicylate contents in this study were conducted from plants grown in North Florida Research and Education Center-Suwannee Valley near Live Oak, Florida. Analyses of fruit weight in F2 segregation populations were conducted on plants grown at the University of Georgia (Athens, GA). Analyses of floral organ size, fruit weight of F1 hybrid plants and inflorescence branching in F4 generation were conducted on plants grown in the fields at Cold Spring Harbor Laboratory (CSHL), Cold Spring Harbor, NY. Seeds were germinated in 96-cell flats and grown for 32 d in the greenhouse before being transplanted to the field. Plants were grown under drip irrigation and standard fertilizer regimes. Analyses of inflorescence branching in two sb CR j2 TE ej2 W F2 populations were conducted on plants grown in the greenhouses at CSHL and Weizmann Institute of Science, Israel.
Publicly available short-read data came from a total of four sources ( Aflitos et al., 2014; Lin et al., 2014; Tieman et al., 2017; Zhu et al., 2018 2. Aflitos, S. ∙ Schijlen, E. ∙ de Jong, H. ..., 100 Tomato Genome Sequencing Consortium Exploring genetic variation in the tomato (Solanum section Lycopersicon) clade by whole-genome sequencing Plant J. 2014; 80 :136-148 Crossref Scopus (293) PubMed Google Scholar 50. Lin, T. ∙ Zhu, G. ∙ Zhang, J. ... Genomic analyses provide insights into the history of tomato breeding Nat. Genet. 2014; 46 :1220-1226 Crossref Scopus (668) PubMed Google Scholar 82. Tieman, D. ∙ Zhu, G. ∙ Resende, Jr., M.F.R. ... A chemical genetic roadmap to improved tomato flavor Science. 2017; 355 :391-394 Crossref Scopus (515) PubMed Google Scholar 100. Zhu, G. ∙ Wang, S. ∙ Huang, Z. ... Rewiring of the fruit metabolome in tomato breeding Cell. 2018; 172 :249-261.e12 Full Text Full Text (PDF) Scopus (581) PubMed Google Scholar ). Phylogenetic trees derived from some of these data have been adapted from their original publication and are shown in Figures 1 A, S1 A, and S1B ( Razifard et al., 2020; Soyk et al., 2019 66. Razifard, H. ∙ Ramos, A. ∙ Della Valle, A.L. ... Genomic evidence for complex domestication history of the cultivated tomato in Latin America Mol. Biol. Evol. 2020; 37 :1118-1132 Crossref Scopus (102) PubMed Google Scholar 79. Soyk, S. ∙ Lemmon, Z.H. ∙ Sedlazeck, F.J. ... Duplication of a domestication locus neutralized a cryptic variant that caused a breeding barrier in tomato Nat. Plants. 2019; 5 :471-479 Crossref Scopus (60) PubMed Google Scholar ). Phylogenetic classifications (branch coloring) were manually curated according to these previous phylogenetic studies and based on knowledge of tomato types and breeding classes. First, the raw reads were trimmed with Trimmomatic (v0.32, LEADING:30 TRAILING:30 MINLEN:75 TOPHRED33) ( Bolger et al., 2014b 14. Bolger, A.M. ∙ Lohse, M. ∙ Usadel, B. Trimmomatic: a flexible trimmer for Illumina sequence data Bioinformatics. 2014; 30 :2114-2120 Crossref Scopus (36372) PubMed Google Scholar ). Reads we aligned to the SL4.0 reference genome with bwa mem (v0.7.10-r789, -M) ( Hosmani et al., 2019; Li and Durbin, 2009 33. Hosmani, P.S. ∙ Flores-Gonzalez, M. ∙ van de Geest, H. ... An improved de novo assembly and annotation of the tomato reference genome using single-molecule sequencing, Hi-C proximity ligation and optical maps bioRxiv. 2019; Crossref Scopus (0) Google Scholar 47. Li, H. ∙ Durbin, R. Fast and accurate short read alignment with Burrows-Wheeler transform Bioinformatics. 2009; 25 :1754-1760 Crossref Scopus (31657) PubMed Google Scholar ) Alignments were then compressed, sorted and indexed with samtools view, sort, and index respectively (v0.1.19-44428cd) ( Li et al., 2009 48. Li, H. ∙ Handsaker, B. ∙ Wysoker, A. ..., 1000 Genome Project Data Processing Subgroup The Sequence Alignment/Map format and SAMtools Bioinformatics. 2009; 25 :2078-2079 Crossref Scopus (37567) PubMed Google Scholar ). Next, PCR duplicates were marked with Picard (v1.126) ( https://broadinstitute.github.io/picard/ ). We removed any samples that had less than 5X alignment coverage or any samples that had a duplication rate > = 20%. If a given accession had more than one associated BAM file, they were merged with samtools.
An ensemble approach was used to call SVs from these short-read alignments. We and others have found that a consensus among multiple short-read SV callers can achieve higher precision without substantially decreasing sensitivity ( Zarate et al., 2018 98. Zarate, S. ∙ Carroll, A. ∙ Krashenina, O. ... Parliament2: fast structural variant calling using optimized combinations of callers bioRxiv. 2018; Crossref Scopus (0) Google Scholar ). We used 3 independent tools to call SVs: Delly (v0.7.3, -q 20), Lumpy (v0.2.13, -mw 4 -tt 0.0) and Manta (v1.0.3, -j 15 -m local -g 30) ( Chen et al., 2016; Layer et al., 2014; Rausch et al., 2012 18. Chen, X. ∙ Schulz-Trieglaff, O. ∙ Shaw, R. ... Manta: rapid detection of structural variants and indels for germline and cancer sequencing applications Bioinformatics. 2016; 32 :1220-1222 Crossref Scopus (1044) PubMed Google Scholar 42. Layer, R.M. ∙ Chiang, C. ∙ Quinlan, A.R. ... LUMPY: a probabilistic framework for structural variant discovery Genome Biol. 2014; 15 :R84 Crossref Scopus (899) PubMed Google Scholar 65. Rausch, T. ∙ Zichner, T. ∙ Schlattl, A. ... DELLY: structural variant discovery by integrated paired-end and split-read analysis Bioinformatics. 2012; 28 :i333-i339 Crossref Scopus (1364) PubMed Google Scholar ). For each accession, SV call sets from Delly, Lumpy and Manta were then merged with SURVIVOR (v1.0.7, minimum distance of 1kbp, types must match, and a minimum length of 10bp) ( Jeffares et al., 2017 35. Jeffares, D.C. ∙ Jolly, C. ∙ Hoti, M. ... Transient structural variations have strong effects on quantitative traits and reproductive isolation in fission yeast Nat. Commun. 2017; 8 :14061 Crossref Scopus (328) PubMed Google Scholar ). Only SVs called by at least 2 of the 3 tools were retained. In total, we produced short-read SV calls for 847 accessions.
We then used SVCollector to select our first set of accessions for long-read sequencing ( Sedlazeck et al., 2018b 74. Sedlazeck, F.J. ∙ Lemmon, Z. ∙ Soyk, S. ... SVCollector: Optimized sample selection for validating and long-read resequencing of structural variants bioRxiv. 2018; Crossref Scopus (0) Google Scholar ). For SVCollector, we further filtered short-read SV calls to only include SVs that intersect genes (+/− 5 kbp of flanking sequence). These filtered SVs were then used as input into SVCollector (greedy), and the top-ranked SLL (29) and SLC (22) accessions for which we had available seeds were selected ( Table S1 A). Aside from these 51 accessions selected with SVCollector, we selected an additional 49 accessions for long-read sequencing. These included SLL, SP, GAL and CHE accessions which were not included in the short-read SV analysis. A list of all accessions and their associated SVCollector ranks (where applicable) is available in Table S1 A.
For extraction of high molecular weight DNA, young leaves were collected from 21-day-old light-grown seedlings. Prior to tissue collection, seedlings were etiolated in complete darkness for 48 h. Flash-frozen plant tissue was ground using a mortar and pestle and extracted in four volumes of ice-cold extraction buffer 1 (0.4 M sucrose, 10 mM Tris-HCl pH 8, 10 mM MgCl2, and 5 mM 2-mercaptoethanol). Extracts were briefly vortexed, incubated on ice for 15 min, and filtered twice through a single layer of Miracloth (Millipore Sigma). Filtrates were centrifuged at 4000 rpm for 20 min at 4 ° C, and pellets were gently resuspended in 1 ml of extraction buffer 2 (0.25 M sucrose, 10 mM Tris-HCl pH 8, 10 mM MgCl2, 1% Triton X-100, and 5 mM 2-mercaptoetanol). Crude nuclear pellets were collected by centrifugation at 12,000 g for 10 min at 4 ° C and washed by resuspension in 1 ml of extraction buffer 2 followed by centrifugation at 12,000 g for 10 min at 4 ° C. Nuclear pellets were re-suspended in 500 μl of extraction buffer 3 (1.7 M sucrose, 10 mM Tris-HCl pH 8, 0.15% Triton X-100, 2 mM MgCl2, and 5 mM 2-mercaptoethanol), layered over 500 μl extraction buffer 3, and centrifuged for 30 min at 16,000 g at 4 ° C. The nuclei were resuspended in 2.5 ml of nuclei lysis buffer (0.2 M Tris pH 7.5, 2 M NaCl, 50 mM EDTA, and 55 mM CTAB) and 1 ml of 5% Sarkosyl solution and incubated at 60 ° C for 30 min. To extract DNA, nuclear extracts were gently mixed with 8.5 ml of chloroform/isoamyl alcohol solution (24:1) and slowly rotated for 15 min. After centrifugation at 4000 rpm for 20 min, ∼3 ml of aqueous phase was transferred to new tubes and mixed with 300 μl of 3 M NaOAC and 6.6 ml of ice-cold ethanol. Precipitated DNA strands were transferred to new 1.5 ml tubes and washed twice with ice-cold 80% ethanol. Dried DNA strands were dissolved in 100 μl of elution buffer (10 mM Tris-HCl, pH 8.5) overnight at 4 ° C. Quality, quantity, and molecular size of DNA samples were assessed using Nanodrop (Thermofisher), Qbit (Thermofisher), and pulsed-field gel electrophoresis (CHEF Mapper XA System, Biorad) according to the manufacturer’s instructions.
Aside from the publicly available data used for short-read-based SV calling, we produced additional short-read data in-house for use in genome assembly for all but 2 (M82 and Fla.8924) MAS2.0 accessions. Short-read sequencing was performed according to Soyk et al. (2019) 79. Soyk, S. ∙ Lemmon, Z.H. ∙ Sedlazeck, F.J. ... Duplication of a domestication locus neutralized a cryptic variant that caused a breeding barrier in tomato Nat. Plants. 2019; 5 :471-479 Crossref Scopus (60) PubMed Google Scholar . In brief, libraries were prepared with the Illumina TruSeq DNA PCR-free prep kit from 2 μg genomic DNA sheared to 550 bp insert size. DNA libraries were sequenced on an Illumina NextSeq500 platform at the Cold Spring Harbor Laboratory Genome Center.
Libraries for Oxford Nanopore genome sequencing were constructed using high-quality HMW DNA. DNA was sheared to ∼20 kb using Covaris g-tubes or ∼75 kb using Megarupter (Diagenode) and purified with a 1 × AMPure XP bead cleanup. Next, DNA size selection was performed using the Short Read Eliminator kit (Circulomics). Library preparation was performed with 1.5 μg of size-selected HMW DNA, using the Ligation Sequencing Kit SQK-LSK109 (Oxford Nanopore Technologies) following manufacturer’s guidelines. Libraries were loaded on MinION or PromethION flow cells and sequenced according to standard protocols. Runs were basecalled with either Albacore v2.3 or with Guppy v2.1 through 3.2. Basecalling was performed using the PromethION r9.4.1 model, with recommended settings for the SQK-LSK109 kit and the FLO-PRO001 or FLO-PRO002 flowcells. At least 40G of data with mean read quality above or equal to Q7 were produced for each sample. Statistics describing the long-reads for all 100 accessions can be found in Table S1 C.
A diagram describing the SV calling pipeline is depicted in Figure S1 C. For each of our 100 accessions selected for long-read sequencing, we aligned a maximum of 60X coverage to the SL4.0 reference genome. The SL4.0 reference genome is a recently published preprint that improves to the previous (SL3.0) tomato reference genome ( Hosmani et al., 2019 33. Hosmani, P.S. ∙ Flores-Gonzalez, M. ∙ van de Geest, H. ... An improved de novo assembly and annotation of the tomato reference genome using single-molecule sequencing, Hi-C proximity ligation and optical maps bioRxiv. 2019; Crossref Scopus (0) Google Scholar ). This PacBio long-reads assembled genome is the most complete and accurate representation of the Heinz 1706 reference genome to date. ITAG4.0, the reference gene models used in this study, are the accompanying reference gene annotation set. To call SVs relative to this reference, we aligned reads with NGMLR (v0.2.7, -x ont–bam-fix) and called SVs with Sniffles (v1.0.11)(–cluster–min_homo_af 0.7 -n 1000) ( Sedlazeck et al., 2018a 73. Sedlazeck, F.J. ∙ Rescheneder, P. ∙ Smolka, M. ... Accurate detection of complex structural variations using single-molecule sequencing Nat. Methods. 2018; 15 :461-468 Crossref Scopus (818) PubMed Google Scholar ). As is convention, SV labels (insertions, deletions, duplications, inversions and translocations) are defined with respect to this single reference genome and do not necessarily define the underlying mutations causing the genetic variation. We further note that long insertions are somewhat underrepresented since Sniffles’ power to call insertions is bounded by read-length. For read sets exceeding 60X coverage, the longest set of reads achieving 60X was used. We then filtered SVs to remove potentially spurious calls. First, we identified regions of the reference genome prone to producing false SV calls and removed any SVs intersecting these regions (a total of 2,961,888 bp of the SL4.0 reference genome). To define these regions, we simulated ONT reads using SURVIVOR from the SL4.0 reference genome and called SVs with Sniffles. We performed this simulation a total of 9 times and merged the 9 VCF files with SURVIVOR (minimum distance of 1kbp, types must match, and a minimum length of 50bp). We then masked any region of the reference implicated in any SV from this simulation, including 2.5 kbp of flanking sequence. Next, we removed any SVs mapping to the ambiguous reference “chromosome 0” (SL4.0ch00). We also removed SVs larger than 100 kbp or SVs with a “0/0” genotype.
Using this same process described above, we also aligned Heinz 1706 PacBio reads to the SL4.0 reference genome to assess the propensity of the reference genome to produce false positives ( Hosmani et al., 2019 33. Hosmani, P.S. ∙ Flores-Gonzalez, M. ∙ van de Geest, H. ... An improved de novo assembly and annotation of the tomato reference genome using single-molecule sequencing, Hi-C proximity ligation and optical maps bioRxiv. 2019; Crossref Scopus (0) Google Scholar ). We called only 75 from these alignments, suggesting that spurious false positives due to reference bias in our panSV-genome are rare.
For some accessions, duplications were filtered by observing short-read coverage across putative duplications. To do this, we wrote a custom tool similar to CNVnator’s genotyping functionality ( Abyzov et al., 2011 1. Abyzov, A. ∙ Urban, A.E. ∙ Snyder, M. ... CNVnator: an approach to discover, genotype, and characterize typical and atypical CNVs from family and population genome sequencing Genome Res. 2011; 21 :974-984 Crossref Scopus (1117) PubMed Google Scholar ). First, for each accession, we calculated short-read coverage in non-overlapping 200bp windows of the reference genome using bedtools ( Quinlan and Hall, 2010 63. Quinlan, A.R. ∙ Hall, I.M. BEDTools: a flexible suite of utilities for comparing genomic features Bioinformatics. 2010; 26 :841-842 Crossref Scopus (14500) PubMed Google Scholar ). The same reads and alignments as described in “ Short-Read Structural Variant Calling and Sample Selection ” were used here. Coverage was then corrected for GC bias using a custom version of the algorithm outlined in Yoon et al. (2009) 97. Yoon, S. ∙ Xuan, Z. ∙ Makarov, V. ... Sensitive and accurate detection of copy number variants using read depth of coverage Genome Res. 2009; 19 :1586-1592 Crossref Scopus (465) PubMed Google Scholar . The global mean coverage was calculated by first removing outliers (using the 1.5 x IQR rule) then fitting a Gaussian distribution to the coverages using SciPy (stats.norm.fit) ( Virtanen et al., 2020 87. Virtanen, P. ∙ Gommers, R. ∙ Oliphant, T.E. ..., SciPy 1.0 Contributors SciPy 1.0: fundamental algorithms for scientific computing in Python Nat. Methods. 2020; 17 :261-272 Crossref Scopus (16613) PubMed Google Scholar ). Finally, in order to verify a duplication, we required that the coverage roughly spanning the duplication boundaries must be greater than 1.75X the global mean coverage. Only duplications at least 1 kbp in size were considered. In order to calculate the coverage of the duplicated region, adjacent 200 bp windows were merged together via averaging to obtain 1 window close to the true duplication size. The coverage for this window, aligned to the original duplication coordinates (rounded to the nearest 200bp interval) was then compared to the global mean coverage. The above duplication filtering was only performed on samples for which we had short-read data available. The source code for duplication filtering can be found on GitHub ( https://github.com/malonge/DupCheck ).
By default, Sniffles provides supporting reads for each insertion call but reports the insertion sequence from a single noisy read. To associate each insertion with an accurate sequence, we used Iris (v1.0.1)( https://github.com/mkirsche/Iris ). Iris extracts the reads supporting the insertion sequencing using samtools, computes their consensus using Racon ( Vaser et al., 2017 85. Vaser, R. ∙ Sović, I. ∙ Nagarajan, N. ... Fast and accurate de novo genome assembly from long uncorrected reads Genome Res. 2017; 27 :737-746 Crossref Scopus (1444) PubMed Google Scholar ), and then replaces the original insertion sequence with the polished consensus. Finally, we used Jasmine to merge SVs across all accessions (v1.0.1, min_support = 1 max_dist = 500 k_jaccard = 8 min_seq_id = 0.25 spec_len = 30)(see “ Merging SVs with Jasmine ” below). We used the default distance metric for merging, which is Euclidean distance. Briefly, 2-dimensional coordinates for each SV are given by (SV start position, SV length). SVs may be candidates for merging if their Euclidean distance between these 2D points is ≤ 500. The primary SV set was merged across all 100 accessions, though we also produced group-specific merged call sets for SLL, SLC, and SP using the same parameters.
We developed a new SV merging tool called Jasmine, which is available open-source on GitHub ( https://github.com/mkirsche/Jasmine ). Jasmine constructs a graph G in which nodes represent SVs from individual samples. Edges connect pairs of SVs that may be merged based on criteria such as the distance between their breakpoints, and in the case of insertions, their sequence similarity. Next, the variants are partitioned based on reference sequence, SV type, and strand. In order to compute the best possible set of SV merges for a given group, Jasmine computes a forest on the graph which has a few key properties: 1) The edges in the forest are a subset of the edges in G , 2) No tree in the forest contains multiple nodes representing SVs from the same sample, 3) There are no unused edges in G which can be added to the forest while maintaining the previous properties, and 4) The sum of the breakpoint distances of edges in the forest is minimized. To do this, Jasmine uses a variant of Kruskal’s algorithm for computing minimum spanning trees. By considering the edges in non-decreasing order of edge weight, Jasmine greedily adds edges to the forest if they will not violate any of the required properties. To avoid storing this potentially very large network in memory, the network is computed dynamically by finding low-weight edges for each node with a KD-tree. Initially, a small constant number of edges incident to each node is stored, and as these are processed in increasing order of edge weight, new edges to process are added to the set by finding the next nearest neighbors for each node. As a result of this optimization, Jasmine is efficient in terms of both memory and runtime and can merge the entire set of over 1.7 million tomato SV calls in less than ten minutes on a single thread of a laptop.
We tested the efficacy of Jasmine on a simulated dataset. In this experiment, we use our merged tomato panSV-genome as our “ground truth.” This provides us with a realistic distribution of allele frequencies, SV types, and SV genomic positions. From this merged SV set, we then derived 100 individual SV sets, essentially reversing the merging process. When assigning variants to their original individual set, we added noise to the SV genomic position. The noise was modeled with a uniform distribution centered at 50 bp for both the start positions and lengths. In addition, the sequences of insertions were changed to model 10% sequencing error. Then, we reran Jasmine (using the same parameters as those used for our panSV-genome) on these noisy individual call sets and compared the results to the original merging. 98.98% of the 19.4 million variant pairs which were merged initially were also merged in the simulated results, while only 0.93% of the merged pairs from the simulation were unmerged in the original dataset. We also found that of the 238k variant calls which originally consisted of merged variants from multiple samples, 97.78% of them contained exactly the same sets of variants after the simulation. The added noise to the variant boundaries caused some previously merged variants to exceed the distance threshold. Also, some originally close variants in the same sample traded places during the merging process. This analysis shows that the method is highly robust to variation in the positions and lengths of structural variants across samples.
We established de novo genome assemblies and associated gene and repeat annotations for a subset of the 100 accessions sequenced for SV analysis. This included the PAS014479 (SP), BGV006775 (SP), BGV006865(SLC), BGV007989 (SLC), BGV007931 (SLC), PI303721 (SLL), PI169588 (SLL), EA00990 (SLL), LYC1410 (SLL), Floradade (SLL), EA00371 (SLL), M82 (SLL), Fla.8924 (SLL), and Brandywine (SLL) accessions. Collectively, we refer to these assemblies and annotations as “MAS2.0,” and they are freely available to download at the Sol Genomics Network ( https://solgenomics.net/projects/tomato100 ).
A diagram describing the assembly pipeline is depicted in Figure S2 A . A hybrid assembly was performed for each accession using the MaSuRCA assembler (v3.3.3 or v3.3.4) ( Zimin et al., 2017 102. Zimin, A.V. ∙ Puiu, D. ∙ Luo, M.C. ... Hybrid assembly of the large and highly repetitive genome of Aegilops tauschii , a progenitor of bread wheat, with the MaSuRCA mega-reads algorithm Genome Res. 2017; 27 :787-792 Crossref Scopus (246) PubMed Google Scholar ). Sequencing data used for assembly are described in “ Short-read DNA sequencing ” and “ Long-read DNA sequencing ” and Table S2 D. M82 and Fla.8924 were not sequenced in-house for this study, but rather come from a previous publication ( Alonge et al., 2019 4. Alonge, M. ∙ Soyk, S. ∙ Ramakrishnan, S. ... RaGOO: fast and accurate reference-guided scaffolding of draft genomes Genome Biol. 2019; 20 :224 Crossref Scopus (357) PubMed Google Scholar ). As is recommended by the MaSuRCA documentation, no preprocessing was done on any of the sequencing data. For the ONT reads, we used the longest 35X coverage of reads with an average Phred quality score of at least 7. Library insert sizes for all Illumina data was set to 500 ± 50. All assemblies employed the Flye unitigger during the final stage of MaSuRCA, except M82, which used default unitigging settings. All other MaSuRCA parameters were set to default values. The MaSuRCA draft assembly stats are found in Table S2 A.
Each set of initial draft contigs underwent two rounds of short-read polishing with POLCA (MaSuRCA v3.3.4)( Zimin and Salzberg, 2019 101. Zimin, A.V. ∙ Salzberg, S.L. The genome polishing tool POLCA makes fast and accurate corrections in genome assemblies bioRxiv. 2019; Crossref Scopus (0) Google Scholar ). As input for each of the two rounds of polishing, we used seqtk to randomly sample ⅔ of the Illumina data used during assembly ( https://github.com/lh3/seqtk ). After polishing, we screened each set of contigs for bacterial contamination by aligning them to the tomato SL4.0 reference and a bacterial reference genome. Every RefSeq bacterial genome, downloaded on October 1st, 2019, comprised our bacterial reference. Contigs were mapped to both references with Minimap2 (-k19 -w19) ( Li, 2018 46. Li, H. Minimap2: pairwise alignment for nucleotide sequences Bioinformatics. 2018; 34 :3094-3100 Crossref Scopus (5152) PubMed Google Scholar ). Any contig covered more by bacterial alignments than by tomato alignments were deemed contaminated and removed from the assembly. Only the BGV006865 and PI303721 accessions contained contaminated contigs. Finally, polished and screened contigs were scaffolded according to the SL4.0 reference genome using RaGOO (v1.1) (-T corr) ( Alonge et al., 2019 4. Alonge, M. ∙ Soyk, S. ∙ Ramakrishnan, S. ... RaGOO: fast and accurate reference-guided scaffolding of draft genomes Genome Biol. 2019; 20 :224 Crossref Scopus (357) PubMed Google Scholar ). The MaSuRCA mega-reads associated with the initial assemblies were used for misassembly correction. “Chromosome 0” of the SL4.0 was not considered during RaGOO scaffolding (-e). We generated dotplots for each assembly by aligning the final pseudomolecules to the SL4.0 reference genome using nucmer (-l 100 -c 500) and finally plotting with mummerplot (–fat–layout) ( Figures S2 C–S2P) ( Kurtz et al., 2004 41. Kurtz, S. ∙ Phillippy, A. ∙ Delcher, A.L. ... Versatile and open software for comparing large genomes Genome Biol. 2004; 5 :R12 Crossref PubMed Google Scholar ). Finally, we used BUSCO to assess genome completeness (v3.0.2, -l solanaceae_odb10 -m genome -c 10 -sp tomato)( Table S2 B) ( Simão et al., 2015 75. Simão, F.A. ∙ Waterhouse, R.M. ∙ Ioannidis, P. ... BUSCO: assessing genome assembly and annotation completeness with single-copy orthologs Bioinformatics. 2015; 31 :3210-3212 Crossref Scopus (7065) PubMed Google Scholar ).
To observe SV concordance between our panSV-genome and the MAS2.0 assemblies, we called SVs from the assemblies using two techniques. First, we aligned the MAS2.0 assemblies to the SL4.0 reference genome using Nucmer (v3.1, -maxmatch -l 100 -c 500) and called SVs with Assemblytics (unique_length_required = 500 min_size = 15, max_size = 100500) ( Nattestad and Schatz, 2016 58. Nattestad, M. ∙ Schatz, M.C. Assemblytics: a web analytics tool for the detection of variants from an assembly Bioinformatics. 2016; 32 :3021-3023 Crossref Scopus (194) PubMed Google Scholar ). Additionally, we simulated 60X coverage of perfect 25 kbp reads from the MAS2.0 assemblies and called SVs with NGMLR (v0.2.7, -x ont –bam-fix) and Sniffles (v1.0.11, -s 2 -l 15 –cluster –min_homo_af 0.7 -n 1000) with respect to the SL4.0 reference genome. Combining the Assemblytics and Sniffles MAS2.0 SV sets, we observed the pairwise SV concordance with the corresponding 14 accessions in our panSV-genome. The % SV overlap for each of the 14 accessions is as follows: BGV006775: 95.5571, BGV006865: 94.5002, BGV007931: 95.8251, BGV007989: 91.8735, Brandywine: 91.1921, EA00371: 87.8088, EA00990: 86.9073, Fla.8924: 89.4226, Floradade: 84.7832, LYC1410: 93.3863, M82: 90.3600, PAS014479: 92.8686, PI169588: 88.5430, PI303721: 70.9839.
We note that we do not expect perfect overlap between the read-mapping and assembly-based SV calls, since both have unique fallibilities and biases. For example, larger variants found with one approach may be broken into multiple smaller variants found by the other approach. Or, the exact position of variants may shift within genomic repetitive elements. Also, SVs in regions of the genome that fail to assemble may still be detected by aligning reads to a reference genome. Furthermore, expected variability in nanopore sequencing, along with other factors, likely contributes to the between accession variation that we observe. Broadly, an average overlap of 90% is a positive indication of SV accuracy and data quality.
We used a “lift-over” approach to annotating the MAS2.0 assemblies with gene models. Along with the tomato reference ITAG4.0 gene models, our reference gene model set included previously published “pan-genome” genes which may be missing from ITAG4.0 but present in our assemblies ( Gao et al., 2019 29. Gao, L. ∙ Gonda, I. ∙ Sun, H. ... The tomato pan-genome uncovers new genes and a rare allele regulating fruit flavor Nat. Genet. 2019; 51 :1044-1051 Crossref Scopus (381) PubMed Google Scholar ). Gene models were lifted-over onto each of the 14 MAS2.0 assemblies with geneLift (v1.1, -c 90 -i 95) ( https://github.com/srividya22/geneLift ). Briefly, geneLift maps reference cDNA sequences to target assemblies using GMAP and Minimap2 and retains alignments with at least 90% coverage and 95% identity ( Wu et al., 2016 94. Wu, T.D. ∙ Reeder, J. ∙ Lawrence, M. ... GMAP and GSNAP for genomic sequence alignment: Enhancements to speed, accuracy, and functionality Mathé, E. ∙ Davis, S. (Editors) Statistical Genomics. Methods in Molecular Biology Humana Press, 2016; 283-334 Crossref Scopus (269) Google Scholar ). The remaining non-overlapping GMAP alignments constitute the initial gene models, which are then supplemented by Minimap2 alignments to unannotated regions providing additional non-redundant gene models. Gene IDs reported by geneLift match the reference gene IDs and any gene duplications reported have an added suffix “-c” followed by the respective copy number of the gene to make them unique. Annotated “pan-genome” genes can be distinguished by a “TomatoPan” gene ID prefix. The geneLift statistics for each assembly can be found in Table S2 C.
We used REPET to annotate MAS2.0 assemblies and panSV-genome insertion/deletion sequences with repeats ( Flutre et al., 2011 25. Flutre, T. ∙ Duprat, E. ∙ Feuillet, C. ... Considering transposable element diversification in de novo annotation approaches PLoS ONE. 2011; 6 :e16526 Crossref Scopus (320) PubMed Google Scholar ). From each MAS2.0 genome assembly, we built a sub-genome by selecting the longest contigs up to a cumulative size ranging 360-380 Mbp. This allowed us to sample a large portion of the genome while keeping the downstream computation tractable ( Jouffroy et al., 2016 36. Jouffroy, O. ∙ Saha, S. ∙ Mueller, L. ... Comprehensive repeatome annotation reveals strong potential impact of repetitive elements on tomato ripening BMC Genomics. 2016; 17 :624 Crossref Scopus (26) PubMed Google Scholar ). Each sub-genome was used to generate libraries of consensus sequences that are representative of repeats present therein using the TEdenovo pipeline from the REPET package v2.4 (parameters were set to consider repeats with at least 5 copies). The libraries produced were filtered to keep only those sequences that are found at least once as a full-length copy in the respective sub-genomes. Each resulting library of consensus sequences was then used as query for annotation of respective whole genomes using the TEannot pipeline from the REPET package v2.4. The library of consensus sequences was classified using PASTEC followed by semi-manual curation ( Hoede et al., 2014 32. Hoede, C. ∙ Arnoux, S. ∙ Moisset, M. ... PASTEC: an automatic transposable element classification tool PLoS ONE. 2014; 9 :e91929 Crossref Scopus (196) PubMed Google Scholar ).
For the annotation of insertions and deletions, the filtered consensus libraries obtained from ten of the 14 MAS2.0 assemblies (the first 10 to be completed) were pooled and appended to those from SL4.0 which were generated previously using the protocol described above. This combined library was then used as query for whole genome annotation by TEannot using default settings.
None of our 14 MAS2.0 assemblies contained the NSGT deletion allele described in “ New Reference Genomes Resolve Multiple Haplotypes for the “Smoky” Volatile Locus .” Therefore, we performed a local assembly of the NSGT locus in PI129033, a sample known to carry this deletion allele. Using the same long-read alignments as described in “ Long-read Structural Variant Calling, Filtering, and Merging ,” we extracted PI129033 reads that aligned to the NSGT locus (SL4.0ch09:65168601-65653800) using samtools view. These reads were then error corrected with Canu (corOutCoverage = 999, genomeSize = 475k) and assembled with Flye (–nano-corr,–genome-size 475k) ( Kolmogorov et al., 2019; Koren et al., 2017 38. Kolmogorov, M. ∙ Yuan, J. ∙ Lin, Y. ... Assembly of long, error-prone reads using repeat graphs Nat. Biotechnol. 2019; 37 :540-546 Crossref Scopus (2014) PubMed Google Scholar 39. Koren, S. ∙ Walenz, B.P. ∙ Berlin, K. ... Canu: scalable and accurate long-read assembly via adaptive k -mer weighting and repeat separation Genome Res. 2017; 27 :722-736 Crossref Scopus (4222) PubMed Google Scholar ). Flye produced a single contig 534,847 bp in length representing the NSGT locus in PI129033. We next sought to polish this contig with short reads to produce an accurate representation of the locus. To do this, we first placed the contig into the SL4.0 reference genome in order to provide a suitable reference genome for short-read mapping. This avoids the potential poor quality of mapping when aligning WGS reads to a small segment of the genome. To create this pseudo-reference genome, we first started with the SL4.0 genome and replaced the NSGT locus (SL4.0ch09:65168601-65653800) with our local assembly. We also added 100bp gaps to the flanks of the inserted contig so that we could identify and retrieve it after polishing. We aligned short reads to this pseudo-reference using bwa and performed two rounds of short-read polishing with Racon (-u). Finally, we removed the local assembly from the pseudo-reference using samtools faidx and aligned it with Minimap2 (-ax asm5) to the SL4.0 reference genome to precisely define the deletion coordinates.
For each accession, we counted the number of SVs in non-overlapping 1Mpb windows of the reference genome. Bins with a relatively large number of SVs are informally referred to as “SV hotspots.” An example distribution of SV frequency in 1 Mbp bins for M82 is shown in Figure S3 M. SV frequency, shown in heatmap and circos form, is depicted in Figures 2 A and S3 A–S3L ( http://omgenomics.com/circa/ ). Our observation of “hotspots” usually results from visual interpretation of these plots. SV hotspot heatmap rows are ordered within each phylogenetic group (GAL, CHE, SP, SLC, SLL) by the R “heatmap.2” default row ordering. These ordered groups were then concatenated to produce the final heatmap.
Since we hypothesized that introgression from wild donors could account for many of the observed SLL hotspots, we developed a technique to compare accessions to look for genomic regions of SV similarity. The custom Python code used for this task can be found in a GitHub repository ( https://github.com/malonge/CallIntrogressions ). The script “get_distances.py” compares SLL accessions to one or many accessions from any other “comparison” group (SP, SLC, GAL, or CHE). The algorithm considers successive 1Mpb windows of the reference genome. For each SLL accession, its set of SVs in a given window is compared to the set of SVs in all accessions in the comparison group in the same window. To compare two sets of SVs, we calculate the Jaccard similarity, requiring at least 5 SVs in both SV sets. The script then outputs, for each 1 Mpb window and for each SLL accession, the maximum Jaccard Similarity with any other comparison accession. If all comparisons for a given window had fewer than 5 SVs in either SV set, an “NA” value is reported.
We calculated similarity for all 45 SLL accessions at the same time by comparing each accession to each non-SLL accession. Comparisons against GAL and CHE did not yield any candidate introgressions from these groups, so we did not display those results. Comparisons against SP and SLC, which both show many regions of putative admixture/introgression from donors of these groups, are shown in Figures S3 A–S3L. Tables S3 A–S3L report the comparison accessions which yielded the maximum Jaccard similarity for each window depicted in Figures S3 A–S3L. In Figures 2 D and 2E, we also show an instance where we compare SLL accessions against a single SP comparison accession (LA1589).
Throughout the manuscript, we describe various relationships between SVs and other genomic features such as genes. Generally, we annotated our panSV-genome with genomic features using vcfanno ( Pedersen et al., 2016 62. Pedersen, B.S. ∙ Layer, R.M. ∙ Quinlan, A.R. Vcfanno: fast, flexible annotation of genetic variants Genome Biol. 2016; 17 :118 Crossref Scopus (106) PubMed Google Scholar ). We define an “annotation” as the association of a particular SV with particular feature IDs (such as a gene ID) based on some relationship. vcfanno annotates SVs by finding their intersection (overlap) with genomic feature intervals. Accordingly, some of the annotations reported in the manuscript can be directly interpreted from vcfanno, such as “Insertions in exons,” or “Deletions overlapping 5 kbp upstream,” since these can be directly interpreted from feature intersection. Other annotations, such as SV containment of genes, required some combination of intersection calculations. For example, to detect genes contained by SVs, we first checked if the gene start and end positions intersected a given SV. If that SV intersected both the start and end of a gene, it contains that gene.
We ultimately produced many SV/feature annotation classes which are explained in more detail here. In any applicable annotation, “upstream” or “downstream” refers to the 5′ or 3′ flanking regions of genes, respectively. In supplemental material, these “upstream” and “downstream” regions may also be referred to as “5′ UTR” and “3′ UTR” respectively. “Insertions in exons,” “Insertions in introns,” “Insertions in 5 kbp downstream,” “Insertions in 5 kbp upstream,” “Deletions overlapping 5 kbp upstream,” and “Deletions overlapping 5 kbp downstream” are self-explanatory. “Duplications” are duplications that contain entire genes. “Deletions of exons” are deletions that delete at least one entire CDS exon of a gene, but do not delete the entire gene. Finally, “Deletions of CDS start” are deletions that contain 50 bp upstream and downstream of a CDS start site.
Data analysis was performed in R using custom scripts. In each tissue (apex, cotyledon and root), gene expression was averaged over the biological replicates in each accession (23 accessions with 3 replicates each in apex and root, and 22 accessions with 4 replicates each in cotyledon), and the genes with average expression count of at least 1 across the accessions were retained for further analysis. We averaged read counts across replicates to effectively treat the replicate expression as estimating a fixed effect. These gene expression averages within each accession/tissue were ranked and standardized so that the values were constrained between 0 and 1. While most of our analyses operate on these rank data, in order to provide estimates of fold change, we used the average expression profiles across replicates directly. These values were normalized by division of total read count of each accession and then fold changes were calculated across these normalized values between accessions with and without the SV.
We first defined a list of SV-gene pairs based on SV annotations (see SV Genomic Feature Annotation ). We filtered this list to only include SV-gene pairs which had the SV present in at least 5 and absent in at least 5 of the accessions for which we had RNA-seq data. For each of the SV-gene pairs, the accessions were split into two groups: with and without the SV. The extent of differential expression of the associated gene was calculated using a two-sided Mann-Whitney U test across the accession split. The Mann Whitney U test is a rank-based test that is very robust to underlying distributions in the expression values. The p values among a specific annotation and tissue type were adjusted by applying Benjamini-Hochberg procedure ( Benjamini and Hochberg, 1995 10. Benjamini, Y. ∙ Hochberg, Y. Controlling the false discovery rate: a practical and powerful approach to multiple testing J. R. Stat. Soc. B. 1995; 57 :289-300 Crossref Google Scholar ). The adjusted p values for each annotation and tissue type were aggregated using two methods: Fisher’s method and a harmonic mean estimate ( Sitgreaves, 1960; Wilson, 2019 76. Sitgreaves, R. Intraclass correlation and the analysis of variance J. Am. Stat. Assoc. 1960; 55 :384 Crossref Google Scholar 93. Wilson, D.J. The harmonic mean p-value for combining dependent tests Proc. Natl. Acad. Sci. USA. 2019; 116 :1195-1200 Crossref Scopus (171) PubMed Google Scholar ), and are listed in Table S4 A.
At least half of the SV-associated genes in each SV type were common to all three tissues, exhibiting different levels of differential expression across the same accession split. In order to determine an average differential expression across the tissues, we used Fisher’s method to aggregate p values across the three tissues for each SV-associated gene, and subsequently applied Benjamini-Hochberg method to limit the number of false positives ( Table S4 B).
For this analysis, we formulated a prediction task: Using the SV annotations as a “ground truth” labeled feature set (the gene associated with the SV is positively labeled and all other genes are negatively labeled), we measured how well we could predict the presence of an associated SV (positive label) given differential expression. A diagram depicting the workflow of this analysis is shown in Figure S4 B. We used AUROC (Area under the ROC) scores as a measure of the performance of this task, which is calculated as follows: For each SV of a given annotation type, the p values corresponding to the differential expression across the accession split (with or without the SV) was calculated for all genes in a given tissue via a two-sided Mann-Whitney U test, and the list of p values was ranked (highest rank corresponds to the most significant p value). For each SV, AUROC scores were analytically calculated by determining the positively labeled gene’s position in the ranked list of all gene p values (high AUROC score corresponds to a near-perfect identification of the SV-associated gene). In other words, genes are predicted to be associated with a variant if they exhibit excess differential expression when comparing accessions with versus without the SV. Conceptually, this can also be described as our classifier choosing a series of cutoff positions in this list, generating a ROC curve (and associated AUROC) by calculating the true and false positive rate associated with each cutoff ( Figure S4 B). Since all genes are affected by the underlying phylogenetic structure in the data, successful prediction of the true SV-associated gene in the list of all genes only occurs when predictions are robust to confounding population structure.
We have thus far described our prediction task when considering a single SV-gene pair. To assess the broad impact of SVs on expression, we combined all SV-gene pairs in a given annotation and tissue type. This is conceptually the same as for single SV-gene pairs, except the gene labels are combined into an aggregated labeled set where there is one positive gene label for each SV-gene pair ( Figure S4 B). The resulting ROC curve and associated AUROC effectively measures the average performance of the classifier over all SV-gene pairs. A high AUROC would indicate SVs globally have a significant impact on associated gene expression.
Our aggregated classifier’s performance can be measured by computing an overall p value as follows. For a given variant and tissue type, the ranks of p values of all SV-associated genes are removed from the list of sequential ranks of all expressed genes in a given tissue (for example, the ranks of 17 genes associated with duplications in apex tissue are removed from the sequence of ranks 1:20029 of the 20029 expressed apex genes). A One-tailed Mann-Whitney U test was performed to evaluate if the median of the ranks of SV-gene pair p values was lower than the median of ranks of p values of all other expressed genes. The resulting p value is depicted by the size of the circle in Figure 3 E. It is important to note that the overall p values (circle size) are influenced by the number of SV-associated genes used in classification in each case, as well as the fold change in expression. For instance, duplications in apex have a larger p value ( 𝑝 < 4 . 0 6 ⁢ x ⁢ 1 0 − 4 , with 17 variants used in classification) than insertions in 5 kbp downstream ( 𝑝 < 1 . 7 2 ⁢ x ⁢ 1 0 − 1 6 , with 1129 variants used in classification). Lists of AUROC scores of all SV-associated genes for each tissue and variant type are provided in Tables S4 C–S4L.
To quantify floral organ size, lengths of sepals and anther cones of closed yellow flower buds just before opening were measured. Inflorescence complexity was measured by counting the number of branching events per inflorescence. Flowering time was quantified by counting the number of leaves before the first inflorescence.
Thirteen of the fourteen MAS2.0 genome assemblies filled the gaps at the chromosome 9 “guaiacol” GWAS locus. To annotate this region, the full-length protein sequence of NSGT1 was used for BLAST search against the Heinz SL4.0 reference genome and the 14 MAS2.0 assemblies. We used the protein sequence as the query for BLAST to achieve more sensitive and more contiguous alignments while still allowing for the discrimination of NSGT alleles. Based on the BLAST results and sequence differences, four coding sequence variants including NSGT1 , NST2 , nsgt1 and nsgt2 are annotated in these genomes ( Tikunov et al., 2013 83. Tikunov, Y.M. ∙ Molthoff, J. ∙ de Vos, R.C.H. ... Non-smoky glycosyltransferase1 prevents the release of smoky aroma from tomato fruit Plant Cell. 2013; 25 :3067-3078 Crossref Scopus (83) PubMed Google Scholar ). We observed several accessions missing sequencing coverage at this locus, suggesting a deletion. We selected one such accession (PI129033) for a local assembly of the deletion haplotype (see “ PI129033 NSGT Local Assembly ”). The local assembly revealed the large deletion haplotype V.
From short-read alignments to the SL4.0 reference genome, we extracted reads overlapping with NGST locus (SL4.0ch09:65390765-65417476) using samtools view. In addition, we included previously unmapped reads. These mapped and unmapped read sets were converted back to a fastq files using samtools bam2fq. Subsequently, the reads were mapped to the unique portion of nsgt1 (117bp, GTTAGGTTTTAGGGTTTCAATTATGCTTGGAAATTTGGAagaagccatttgaaaggcttgaataaggtttaggtaccATCTTTAACAACTACCTCCAAAATTATAAACCTTTTTCTT), nsgt2 (86bp, CCAATACTTGAATGgttcaaaattagactttgtactttcaagaaaaccttgtGGAACCATTTCTTCAATTGTTTTGTTCACCCCTT), NSGT1 (100bp, ATATAATAGCTTCAACAACTTTTTAACCCCTTcatcaatagctttcaattttatcttctcactcaattgCATTGCCTTCAAATGAATTTGTTTCCTAGGC) and NSGT2 (123bp, CAAAGGCTTTCTCATCGCGTGGTTTTATTGGTTTCATATCTAATTTCTTGatctcatagtcatgaagaaaaggAAAAGATGTAAGGCTTGAACTCCCATAAAGAAATTGGTGGTAAAGGTAGG) simultaneously using bwa mem (-M). After mapping, reads with edit distance (NM tag) smaller than 15 and a minimum mapping quality of 20 were extracted. We used samtools depth to compute the coverage of the filtered reads across only the core of the unique regions (lower case sequences above) for nsgt1 , nsgt2 , NSGT1 and NSGT2 . If more than 4 core bp had 0 coverage, we discarded the total mapped read counts for the sequence. If there was read count support for any of the nsgt1 , nsgt2 , NSGT1 or NSGT2 haplotypes, we report as them as “presence.” Since the “unique” sequence of NSGT1 is also present in nsgt1 , if both nsgt1 and NSGT1 were genotyped as “presence,” we only labeled nsgt1 as “presence.” This is based on the observation that no sequencing resolved haplotypes have both nsgt1 and NSGT1 together. This genotyping was consistent with the observed haplotypes in our MAS2.0 assemblies.
From the short-read alignments to SL4.0, we counted the reads with a mapping quality of at least 20 in the middle region of the haplotype V deletion: SL4.0ch09:65401889-65404136. Accessions with less than 5 mapped reads were genotyped as “deletion.” The pipeline was benchmarked against PCR genotyped samples including 138 accessions with no deletion and 17 accession with deletions. Results from our pipeline were 100% consistent with PCR genotyping results.
From the short-read alignments to SL4.0, we extracted the reads mapped to a broad region that contained the sb1 duplication locus: SL4.0ch01:77727550-77765153. For each sample, we also extracted the unmapped reads. Mapped and unmapped read sets were converted to fastq files using samtools. Subsequently, we aligned the extracted reads to a portion of the sb1 locus (SL4.0ch01:77737550-77745153), which avoided high copy number TEs and represented a unique sequence of this locus. This was done with bwa mem (-M). We counted the number of reads mapped to this locus using samtools idxstats. The raw counts were normalized based on the total number of reads mapped for each sample. We manually checked the read alignments to SL4.0 and verified 22 single-copy accessions and eight duplication accessions. Accessions with normalized coverage lower than mean (verified single-copy accessions) – 1 standard deviation were genotyped as “single-copy” and accessions with normalized coverage greater than mean (verified duplication accessions) + 1 standard deviation were genotyped as “duplication.”
For 3′ RNA-sequencing (3′ RNA-seq), seeds were treated with 50% bleach for 20 minutes to homogenize germination and were germinated in Petri dishes with moistened filter paper in the dark at 28 ° C. Whole root tissues were collected 3 days after germination with a mixture of several seedlings as one biological replicate and three such replicates for each of a total of 23 accessions. For cotyledon tissues, seedlings after germination at similar stages were transplanted to soil in 96-cell flats and grown in the greenhouse. Cotyledons of seedlings were collected when two true leaves start to visibly emerge (10∼11 days after sowing). Four biological replicates each with several seedlings combined for each of a total of 22 accessions were collected. For apex tissue, seedlings after germination at similar stages were transplanted to soil in 96-cell flats and grown in the greenhouse. For apex tissue collection, seeds were germinated, and seedlings were transplanted as above. Vegetative apical meristem together with the two youngest/smallest leaf primordia were collected 4 days after transplanting ( Park et al., 2012 61. Park, S.J. ∙ Jiang, K. ∙ Schatz, M.C. ... Rate of meristem maturation determines inflorescence architecture in tomato Proc. Natl. Acad. Sci. USA. 2012; 109 :639-644 Crossref Scopus (141) PubMed Google Scholar ). Eight to twelve apices were combined as one biological replicate and three replicates were collected for each of a total of 23 accessions. Total RNA was extracted using the RNeasy Plant Mini Kit (QIAGEN) and treated with the RNase Free DNase Set (QIAGEN) according to the manufacturer’s instructions. Total RNA samples were sent to the Genomic Diversity Facility at Cornell University for high-throughput 3′ RNA (single-end, read length = 75bp) as described ( Kremling et al., 2018 40. Kremling, K.A.G. ∙ Chen, S.Y. ∙ Su, M.H. ... Dysregulation of expression correlates with rare-allele burden and fitness loss in maize Nature. 2018; 555 :520-523 Crossref Scopus (138) PubMed Google Scholar ).
For quantitative RT-PCR, seeds were germinated on moistened filter paper at 28°C in dark. After germination, seedlings at similar stages were transferred to soil in 96-cell plastic flats and grown in the greenhouse. Shoot apices were collected at the transition and floral meristem stage of meristem maturation ( Park et al., 2012 61. Park, S.J. ∙ Jiang, K. ∙ Schatz, M.C. ... Rate of meristem maturation determines inflorescence architecture in tomato Proc. Natl. Acad. Sci. USA. 2012; 109 :639-644 Crossref Scopus (141) PubMed Google Scholar ), and immediately flash-frozen in liquid nitrogen. Total RNA was extracted as described above. 100 ng to 1 μg of total RNA was used for cDNA synthesis using the SuperScript III First-Strand Synthesis System (Invitrogen). qPCR was performed with gene-specific primers using the iQ SYBR Green SuperMix (Bio-Rad) reaction system on the CFX96 Real-Time system (Bio-Rad). Primer sequences are available in Table S6 .
Published RNA-seq data of tomato fruit pericarp tissue from 405 accessions were downloaded from SRA PRJNA396272. Reads were trimmed by quality using Trimmomatic (ILLUMINACLIP:TruSeq3-PE-2.fa:2:40:15:1:FALSE LEADING:30 TRAILING:30 MINLEN:100) and aligned to the cDNA annotation of reference genome sequence of tomato (SL4.0) using kallisto quant ( Bray et al., 2016 15. Bray, N.L. ∙ Pimentel, H. ∙ Melsted, P. ... Near-optimal probabilistic RNA-seq quantification Nat. Biotechnol. 2016; 34 :525-527 Crossref Scopus (4977) PubMed Google Scholar ). The output of kallisto generates normalized transcripts per million reads (TPM) which was used for quantifying NSGT1/2 expression. Because only one copy of NSGT1/2 is annotated in the SL4.0 and sequences of NSGT1 and NSGT2 are highly similar, we used the TPM of the annotated copy of NSGT (Solyc09 g089585) to represent the expression level of both NSGT1 and NSGT2 . TMPs are in Table S5 C.
Published fruit guaiacol contents were obtained from Tieman et al. (2017) 82. Tieman, D. ∙ Zhu, G. ∙ Resende, Jr., M.F.R. ... A chemical genetic roadmap to improved tomato flavor Science. 2017; 355 :391-394 Crossref Scopus (515) PubMed Google Scholar . To minimize environmental effects, only data from one field season (2015) were used ( Table S5 D).
Fruit guaiacol and methylsalicylate contents in our new GWAS panel were quantified as previously described ( Tieman et al., 2017 82. Tieman, D. ∙ Zhu, G. ∙ Resende, Jr., M.F.R. ... A chemical genetic roadmap to improved tomato flavor Science. 2017; 355 :391-394 Crossref Scopus (515) PubMed Google Scholar ). Briefly, at least six fruits (two fruits for each replicate) of red ripe stage were collected from each variety. Volatile compound identification was determined by gas chromatography-mass spectrometry and co-elution with known standards (Sigma-Aldrich, St. Louis MO). Metabolite contents are in Tables S5 E and S5F.
3′ RNA-seq reads were trimmed by quality using Trimmomatic (v0.36, ILLUMINACLIP:TruSeq3-SE.fa:2:30:10 LEADING:30 TRAILING:30 MINLEN:30 HEADCROP:12) and mapped to SL4.0 reference genome using STAR with default parameters ( Dobin et al., 2013 23. Dobin, A. ∙ Davis, C.A. ∙ Schlesinger, F. ... STAR: ultrafast universal RNA-seq aligner Bioinformatics. 2013; 29 :15-21 Crossref Scopus (25613) PubMed Google Scholar ). Bam files generated by STAR were sorted by read name and gene expression was quantified as uniquely mapped reads to annotated gene features in the ITAG4.0 reference annotation using HTSeq-count (–format = bam–order = name–stranded = no–type = exon–idattr = Parent) ( Anders et al., 2015 6. Anders, S. ∙ Pyl, P.T. ∙ Huber, W. HTSeq--a Python framework to work with high-throughput sequencing data Bioinformatics. 2015; 31 :166-169 Crossref Scopus (13081) PubMed Google Scholar ). Gene counts were processed in R for visualization. First, we filtered expressed genes by only keeping genes with sum of counts across all samples greater than the sum of replicates. Then the count table was imported into R package “DESeq2” ( Love et al., 2014 51. Love, M.I. ∙ Huber, W. ∙ Anders, S. Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2 Genome Biol. 2014; 15 :550 Crossref Scopus (45393) PubMed Google Scholar ) and normalized counts were used for making boxplots.
The fw3.2 duplication and the derived allele of the promoter SNP are highly, but not completely associated. From our collection of accessions, we carefully selected four pairs of accessions carrying either single or double copies of fw3.2 but fixed at the promoter SNP (M9) of KLUH and all other known fruit weight QTL genes ( Figure S5 D). Four bi-parental F 2 populations were developed from each pair of accessions, so that the duplication of fw3.2 would segregate. We genotyped the F 2 plants by fw3.2 duplication markers and markers flanking the entire duplicated region. Similarly, six bi-parental F 2 populations that segregated for the promoter SNP but fixed as the single-copy of fw3.2 and other known fruit weight QTL genes were developed. We genotyped F 2 plants using M9 markers. In each population, ten homozygous F 2 plants carrying each of the contrasting genotype were grown in the field. At harvest, we selected 15 to 20 large fruits after mature green stage and recorded their average weight to represent the potential of largest fruit from a single plant. Poor fruit setting was observed in population 19S313 so only about 10 representative fruits were used for each plant. In extreme cases, the fruit weight of three plants were represented by less than 5 fruits. Fruit weight data are in Table S5 G.
CRISPR-Cas9 mutagenesis and generation of transgenic tomato was performed following our standard protocol ( Brooks et al., 2014 16. Brooks, C. ∙ Nekrasov, V. ∙ Lippman, Z.B. ... Efficient gene editing in tomato in the first generation using the clustered regularly interspaced short palindromic repeats/CRISPR-associated9 system Plant Physiol. 2014; 166 :1292-1297 Crossref Scopus (567) PubMed Google Scholar ). Briefly, guide RNAs (gRNAs) were designed using the CRISPRdirect tool ( https://crispr.dbcls.jp/ ) ( Naito et al., 2015 57. Naito, Y. ∙ Hino, K. ∙ Bono, H. ... CRISPRdirect: software for designing CRISPR/Cas guide RNA with reduced off-target sites Bioinformatics. 2015; 31 :1120-1123 Crossref Scopus (814) PubMed Google Scholar ). Binary vectors for gRNAs and Cas9 were assembled using the Golden Gate cloning system as described ( Rodríguez-Leal et al., 2017; Soyk et al., 2017; Werner et al., 2012 67. Rodríguez-Leal, D. ∙ Lemmon, Z.H. ∙ Man, J. ... Engineering quantitative trait variation for crop improvement by genome editing Cell. 2017; 171 :470-480.e8 Full Text Full Text (PDF) Scopus (693) PubMed Google Scholar 78. Soyk, S. ∙ Lemmon, Z.H. ∙ Oved, M. ... Bypassing negative epistasis on yield in tomato imposed by a domestication gene Cell. 2017; 169 :1142-1155.e12 Full Text Full Text (PDF) Scopus (245) PubMed Google Scholar 92. Werner, S. ∙ Engler, C. ∙ Weber, E. ... Fast track assembly of multigene constructs using Golden Gate cloning and the MoClo system Bioeng. Bugs. 2012; 3 :38-43 PubMed Google Scholar ). Final binary vectors were transformed into the tomato cultivar M82 by Agrobacterium tumefaciens -mediated transformation through tissue culture ( Gupta and Van Eck, 2016 30. Gupta, S. ∙ Van Eck, J. Modification of plant regeneration medium decreases the time for recovery of Solanum lycopersicum cultivar M82 stable transgenic lines Plant Cell Tissue Organ Cult. 2016; 127 :417-423 Crossref Scopus (23) Google Scholar ). Transplanting of first generation transgenic (T0) plants and genotyping of CRISPR-generated mutations were performed as Soyk et al. (2017) 78. Soyk, S. ∙ Lemmon, Z.H. ∙ Oved, M. ... Bypassing negative epistasis on yield in tomato imposed by a domestication gene Cell. 2017; 169 :1142-1155.e12 Full Text Full Text (PDF) Scopus (245) PubMed Google Scholar . Briefly, CRISPR-targeted region was PCR amplified and wild-type (WT) size products were sequenced for T0 plants and those with mutations were selfed or crossed to WT M82 plants for further characterization of mutant alleles. All gRNA sequences are listed in Table S6 .
To test the dosage-dependent effect of KLUH in an isogenic background with uniform “cherry” fruit type, the fertile T0 plant with CRISPR-Cas9 targeting SlKLUH ( slkluh CR T0-1) was crossed with the SP accession LA1589. About half of F1 plants carried the Cas9 transgene (1:1 segregation of transgene). Analyses were focused on F1 plants that did not inherit the Cas9 transgene, because they are a fixed, uniform genotype. In contrast, plants with the Cas9 transgene would be genetically intractable for dosage analyses, because of the random chimerism that occurs within individual plants carrying the Cas9 transgene. From eight individual F1 plants without the Cas9 transgene (genotypic group B), KLUH gene PCR products were cloned and eight individual clones were sequenced. All eight plants were confirmed to have only mutant slkluh alleles and a WT SpKLUH allele ( Figure S5 F). Sepal length, flower length and fruit weight were quantified from these plants. Most of the F1 plants with the Cas9 transgene showed slightly smaller floral organs, and several of these plants had extremely small floral organs and no fruit set. From four individual F1 plants with the Cas9 transgene that showed tiny floral organs (genotypic group C), sepal length and flower size were quantified. To determine whether this effect was due to trans-targeting of SpKLUH , two plants with extremely small floral organs were randomly selected and sequenced for multiple PCR-cloned KLUH alleles. Consistently, sequencing of the two plants showed only mutant alleles for SlKLUH and SpKLUH (mutant alleles and their combinations are shown in Figures S5 F and S5G), consistent with the CRISPR-Cas9 trans-targeting the SpKLUH gene copy. WT M82 was crossed with LA1589 and the F1 plants were used as controls. Quantification data of sepal, flower length and fruit weight are in Tables S5 H and S5I.
Sequences of homologous proteins of STM3 and TM3 were obtained from tomato and Arabidopsis genome and aligned using the ClustalW2.1 program in Geneious 11.1.5. Phylogenetic tree was constructed using “Geneious Tree Builder” with Jukes-Cantor genetic distance model and Neighbor-Joining method with 1,000 bootstrap replicates. STM3 and TM3 fell in the same clade with Arabidopsis flowering time regulator SOC1 ( Lee and Lee, 2010 43. Lee, J. ∙ Lee, I. Regulation and function of SOC1, a flowering pathway integrator J. Exp. Bot. 2010; 61 :2247-2254 Crossref Scopus (477) PubMed Google Scholar ).
Mapping of genomic position of sb1 was reported in Soyk et al. (2019) 79. Soyk, S. ∙ Lemmon, Z.H. ∙ Sedlazeck, F.J. ... Duplication of a domestication locus neutralized a cryptic variant that caused a breeding barrier in tomato Nat. Plants. 2019; 5 :471-479 Crossref Scopus (60) PubMed Google Scholar . Briefly, F2 segregation population was generated from crosses between a branched M82 j2 TE ej2 W double mutant with an unbranched j2 TE ej2 W double mutant (Fla.8924). A group of excessively branched inflorescences (6–36 branches) and a group of clearly suppressed plants (1–4 branches) were selected. An equal amount of tissue from each plant (∼0.2 g) was pooled for DNA extraction for the two groups using standard protocols. Libraries were prepared with the Illumina TruSeq DNA PCR-free prep kit from 2 μg genomic DNA sheared to 550 bp insert size and sequenced on an Illumina NextSeq platform at the CSHL Genome Center. After aligning reads to reference genome (SL3.0), SNPs were called with samtools/bcftools ( Li, 2011; Li et al., 2009 45. Li, H. A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data Bioinformatics. 2011; 27 :2987-2993 Crossref Scopus (3874) PubMed Google Scholar 48. Li, H. ∙ Handsaker, B. ∙ Wysoker, A. ..., 1000 Genome Project Data Processing Subgroup The Sequence Alignment/Map format and SAMtools Bioinformatics. 2009; 25 :2078-2079 Crossref Scopus (37567) PubMed Google Scholar ) using read alignments for the two genomic DNA sequencing pools in addition to the M82 ( Bolger et al., 2014a 13. Bolger, A. ∙ Scossa, F. ∙ Bolger, M.E. ... The genome of the stress-tolerant wild tomato species Solanum pennellii Nat. Genet. 2014; 46 :1034-1038 Crossref Scopus (316) PubMed Google Scholar ) and Fla.8924 ( Lee et al., 2018 44. Lee, T.G. ∙ Shekasteband, R. ∙ Menda, N. ... Molecular markers to select for the j-2 –mediated jointless pedicel in tomato HortScience. 2018; 53 :153-158 Crossref Scopus (11) Google Scholar ) parents. Called SNPs were then filtered for bi-allelic high-quality SNPs at least 100 bp from a called indel using bcftools ( Li, 2011 45. Li, H. A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data Bioinformatics. 2011; 27 :2987-2993 Crossref Scopus (3874) PubMed Google Scholar ). Read depth for each allele at segregating bi-allelic SNPs in 100-kb sliding windows (by 10 kb) was summed for the various sequencing pools and allele frequencies were calculated. Finally, the difference in allele frequency (SNP index) between the branched and unbranched pools was calculated and plotted across the 12 tomato chromosomes. One of the two regions that exceeded a genome-wide 95% cut-off in SNP index was located on chromosomes 1 and was named sb1 . The candidate interval based on SL3.0 is SL3.0ch01:80006250-86570024.
To show the genome coverages at the sb1 locus in M82, M82 j2 TE ej2 W , Fla.8924 and S. pimpinellifolium , we calculated the coverage from Illumina data using bedtools multicov only counting properly paired reads in 10-kb windows across chromosome 1. Depths in the four genotypes were normalized by dividing by the average depth using R.
Homozygous sb1 CR-1 and sb1 CR-del plants were each crossed with M82 j2 TE ej2 W , respectively, to construct two F2 populations segregating at those three loci. In the F2 generation, plants were first genotyped for j2 TE and ej2 W mutations at seedling stage in flats. All double mutants were transplanted and further genotyped for CRISPR alleles and quantified for inflorescence complexity/branching. Genotyping primer sequences are in Table S6 . Phenotype related to sb1 are in Tables S5 J–S5L.
“n” is defined in all relevant figure legends. All statistical tests were performed in R. Significance is only ever defined for the SV differential expression analysis ( Figure 3 C) ( Tables S4 A and S4B) and it is defined as a p value less than 0.05. Two-sided Mann-Whitney U tests were used for analysis in Figures 3 C–3F. The Mann-Whitney U test provides a robust estimate to compute the significance of the expression change that does not depend on any assumption of underlying distributions. The p values for these tests underwent FDR correction with the Benjamini-Hochberg procedure. Adjusted p values were aggregated using Fisher’s method and a harmonic mean estimate. Detailed methods for these analyses can be found in “The Impact of SVs on Gene Expression.” For expression analysis in Figures 4 E, 5 C, 6 E, and S5 A, numbers of accessions for each genotype are presented in the figures and differences between groups were compared using two-tailed, two-sample t tests. Fruit guaiacol and methylsalicylate contents were compared between genotypes using two-tailed, two-sample t tests. For quantitative analysis in sepal length, flower length, fruit weight and inflorescence complexity n = number of flowers and inflorescences quantified was used for two-tailed, two-sample t tests. The number of plants (n = ) used for each genotype is also labeled in the figures. For above analysis, all data points were plotted as single dots in the boxplots. For expression analysis with qRT-PCR, three biological replicates of pooled meristems were used for each genotype and two technical replicates were performed for each biological replicate. Mean values of normalized expression were compared using two-tailed, two samples t tests. For flowering time quantification, number of plants of each genotype is labeled in the figure. Means ± s.d. were shown and mean values between groups were compared by two-sample t tests.

Section: Acknowledgments

We thank members of the Schatz and Lippman labs at JHU and CSHL for helpful discussions. We thank Aleksey Zimin at JHU for helpful discussions about genome assembly. We thank T. Mulligan, A. Krainer, S. Qiao, and K. Schlecht from CSHL for assistance with plant care. We thank S. Muller, R. Wappel, S. Mavruk-Eskipehlivan, and E. Ghiban from the CSHL Genome Center for sequencing support. We thank Sanwen Huang at the Chinese Academy of Agricultural Sciences and Dani Zamir at the Hebrew University for sharing sequencing data and germplasm. We thank Prashant Hosmani, Susan Strickler, Naama Menda, and Lukas Mueller at the Boyce Thompson Institute for Plant Research for providing early access to the SL4.0 reference genome and hosting data on the Solanaceae Genomics Network. We thank Surya Saha and Lukas Mueller for early access to Heinz 1706 PacBio data. This work was supported by the Howard Hughes Medical Institute and grant support from the US National Institutes of Health for their support of the CSHL Cancer Center Next Generation Shared Resource (5P30CA045508-31) and (R01LM012736 and R01MH113005) to J.G. and (UM1 HG008898) to F.J.S., the USDA National Institute of Food and Agriculture (AFRI no. 2018-67013-27896; SCRI no. 2015-51181-24312) to S.H. and (AFRI no. 2016-67013-24452) to S.H. and Z.B.L., the BARD (BARD US-Israel Agricultural Research and Development Fund) (IS-5120-18C) to Y.E. and Z.B.L., the ISF (Israel Science Foundation) (1913/19) to Y.E., and the National Science Foundation Plant Genome Research Program (IOS 1855585) to D.M.T. and H.K.; (IOS 1564366) to A.L.C., D.M.T., and E.v.d.K.; (IOS-1350041) to M.C.S.; and (IOS-1732253) to J.V.E., E.v.d.K., M.C.S., and Z.B.L.
M.C.S. and Z.B.L. conceived the project. M.A., X.W., S.S., L.P., L.Z., J.V.E., J.G., Y.E., F.J.S., E.v.d.K., M.C.S., and Z.B.L. designed and planned experiments. M.A., X.W., M.B., S.S., L.P., L.Z., D.C., Y.L., T.H.H., G.S.-S., Z.A., H.R., A.L.C., D.M.T., J.K., G.R., J.V.E., J.G., Y.E., F.J.S., E.v.d.K., M.C.S., and Z.B.L. performed experiments and collected data. M.A., X.W., M.B., S.S., L.P., L.Z., H.S., S.R., F.M., Y.L., T.H.H., G.S.-S., Z.A., D.M.T., H.K., T.R.R.-B., Z.H.L., S.H., J.G., Y.E., F.J.S., E.v.d.K., M.C.S., and Z.B.L. analyzed data. M. Kirsche and S.A. wrote software for SV merging. M. Kramer, S.G., and W.R.M. performed long-read sequencing. M.A., X.W., M.C.S., and Z.B.L. wrote the manuscript with input from M.B., L.P., L.Z., Y.E., and E.v.d.K. All authors read, edited, and approved the manuscript.
W.R.M. is a founder and shareholder of Orion Genomics, a plant genetics company. Z.B.L. is a consultant for and a member of the Scientific Strategy Board of Inari Agriculture. Orion Genomics and Inari Agriculture had no role in the planning, execution, or analysis of the experiments described here.

Section: Supplemental Information (6)

Download all Spreadsheet (31.25 KB) Table S1 Tomato Accession Information and Long-Read Sequencing Statistics, Related to Figures 1 and S1 Spreadsheet (18.18 KB) Table S2 Statistics for MAS2.0 Genome Assemblies and Gene Annotation, Related to Figure S2 Spreadsheet (261.77 KB) Table S3 Accessions with Highest Similarity for Each Window for Introgression Heatmap Analysis, Related to Figures 2 and S3 Spreadsheet (1.62 MB) Table S4 Lists of SV-Associated Genes and Statistics of Differential Expression, Related to Figures 3 and S4 Spreadsheet (104.13 KB) Table S5 Raw Data of Genotyping and Phenotyping Experiments, Related to STAR Methods PDF (24.76 KB) Table S6 A List of Primers and gRNA Sequences Used in This Study, Related to STAR Methods
