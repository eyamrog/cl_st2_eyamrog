Title: A Deep Learning Approach to Antibiotic Discovery


Abstract: Summary

Due to the rapid emergence of antibiotic-resistant bacteria, there is a growing need to discover new antibiotics. To address this challenge, we trained a deep neural network capable of predicting molecules with antibacterial activity. We performed predictions on multiple chemical libraries and discovered a molecule from the Drug Repurposing Hub—halicin—that is structurally divergent from conventional antibiotics and displays bactericidal activity against a wide phylogenetic spectrum of pathogens including Mycobacterium tuberculosis and carbapenem-resistant Enterobacteriaceae. Halicin also effectively treated Clostridioides difficile and pan-resistant Acinetobacter baumannii infections in murine models. Additionally, from a discrete set of 23 empirically tested predictions from >107 million molecules curated from the ZINC15 database, our model identified eight antibacterial compounds that are structurally distant from known antibiotics. This work highlights the utility of deep learning approaches to expand our antibiotic arsenal through the discovery of structurally distinct antibacterial molecules.

Section: Introduction

Since the discovery of penicillin, antibiotics have become the cornerstone of modern medicine. However, the continued efficacy of these essential drugs is uncertain due to the global dissemination of antibiotic-resistance determinants. Moreover, the decreasing development of new antibiotics in the private sector that has resulted from a lack of economic incentives is exacerbating this already dire problem ( Brown and Wright, 2016; PEW Trusts, 2019 4. Brown, E.D. ∙ Wright, G.D. Antibacterial drug discovery in the resistance era Nature. 2016; 529 :336-343 Crossref Scopus (1608) PubMed Google Scholar 44. P.E.W. Trusts Five-year analysis shows continued deficiencies in antibiotic development https://www.pewtrusts.org/en/research-and-analysis/data-visualizations/2019/five-year-analysis-shows-continued-deficiencies-in-antibiotic-development Date: 2019 Google Scholar ). Indeed, without immediate action to discover and develop new antibiotics, it is projected that deaths attributable to resistant infections will reach 10 million per year by 2050 ( O’Neill, 2014 40. O’Neill, J. Antimicrobial Resistance: Tackling a Crisis for the Health and Wealth of Nations Review on Antimicrobial Resistance, 2014, 2014 Google Scholar ).
Historically, antibiotics were discovered largely through screening soil-dwelling microbes for secondary metabolites that prevented the growth of pathogenic bacteria ( Clardy et al., 2006; Wright, 2017 7. Clardy, J. ∙ Fischbach, M.A. ∙ Walsh, C.T. New antibiotics from bacterial natural products Nat. Biotechnol. 2006; 24 :1541-1550 Crossref Scopus (497) PubMed Google Scholar 62. Wright, G.D. Opportunities for natural products in 21 st century antibiotic discovery Nat. Prod. Rep. 2017; 34 :694-701 Crossref PubMed Google Scholar ). This approach resulted in the majority of clinically used classes of antibiotics, including β-lactams, aminoglycosides, polymyxins, and glycopeptides, among others. Semi-synthetic derivatives of these scaffolds have maintained a viable clinical arsenal of antibiotics by increasing potency, decreasing toxicity, and sidestepping resistance determinants. Entirely synthetic antibiotics of the pyrimidine, quinolone, oxazolidinone, and sulfa classes have also found prolonged clinical utility, and continue to be optimized for the same properties.
Unfortunately, the discovery of new antibiotics is becoming increasingly difficult. Natural product discovery is now plagued by the dereplication problem, wherein the same molecules are being repeatedly discovered ( Cox et al., 2017 11. Cox, G. ∙ Sieron, A. ∙ King, A.M. ... A common platform for antibiotic dereplication and adjuvant discovery Cell Chem. Biol. 2017; 24 :98-109 Full Text Full Text (PDF) Scopus (87) PubMed Google Scholar ). Moreover, given the rapid expansion of chemical spaces that are accessible by the derivatization of complex scaffolds ( Ortholand and Ganesan, 2004 41. Ortholand, J.Y. ∙ Ganesan, A. Natural products and combinatorial chemistry: back to the future Curr. Opin. Chem. Biol. 2004; 8 :271-280 Crossref Scopus (308) PubMed Google Scholar ), engineering next-generation versions of existing antibiotics results in substantially more failures than leads. Therefore, many antibiotic discovery programs have turned to screening large synthetic chemical libraries ( Tommasi et al., 2015 59. Tommasi, R. ∙ Brown, D.G. ∙ Walkup, G.K. ... ESKAPEing the labyrinth of antibacterial discovery Nat. Rev. Drug Discov. 2015; 14 :529-542 Crossref Scopus (447) PubMed Google Scholar ). However, these libraries, which can contain hundreds of thousands to a few million molecules, are often prohibitively costly to curate, limited in chemical diversity, and fail to reflect the chemistry that is inherent to antibiotic molecules ( Brown et al., 2014 5. Brown, D.G. ∙ May-Dracka, T.L. ∙ Gagnon, M.M. ... Trends and exceptions of physical properties on antibacterial activity for Gram-positive and Gram-negative pathogens J. Med. Chem. 2014; 57 :10144-10161 Crossref Scopus (183) PubMed Google Scholar ). Since the implementation of high-throughput screening in the 1980s, no new clinical antibiotics have been discovered using this method.
Novel approaches to antibiotic discovery are needed to increase the rate at which new antibiotics are identified and simultaneously decrease the associated cost of early lead discovery. Given recent advancements in machine learning ( Camacho et al., 2018 6. Camacho, D.M. ∙ Collins, K.M. ∙ Powers, R.K. ... Next-generation machine learning for biological networks Cell. 2018; 173 :1581-1592 Full Text Full Text (PDF) Scopus (605) PubMed Google Scholar ), the field is now ripe for the application of algorithmic solutions for molecular property prediction to identify novel structural classes of antibiotics. Indeed, adopting methodologies that allow early drug discovery to be performed largely in silico enables the exploration of vast chemical spaces that is beyond the reach of current experimental approaches.
The idea of analytical exploration in drug design is not new. Decades of prior work in chemoinformatics have developed models for molecular property prediction ( Mayr et al., 2018; Wu et al., 2017 38. Mayr, A. ∙ Klambauer, G. ∙ Unterthiner, T. ... Large-scale comparison of machine learning methods for drug target prediction on ChEMBL Chem. Sci. (Camb.). 2018; 9 :5441-5451 Crossref PubMed Google Scholar 64. Wu, Z. ∙ Ramsundar, B. ∙ Feinberg, E.N. ... MoleculeNet: a benchmark for molecular machine learning Chem. Sci. (Camb.). 2017; 9 :513-530 Crossref PubMed Google Scholar ). However, the accuracy of these models has been insufficient to substantially change the traditional drug discovery pipeline. With recent algorithmic advancements in modeling neural network-based molecular representations, we are beginning to have the opportunity to influence the paradigm of drug discovery. An important development relates to how molecules are represented; traditionally, molecules were represented by their fingerprint vectors, which reflected the presence or absence of functional groups in the molecule, or by descriptors that include computable molecular properties and require expert knowledge to construct ( Mauri et al., 2006; Moriwaki et al., 2018; Rogers and Hahn, 2010 37. Mauri, A. ∙ Consonni, V. ∙ Pavan, M. ... Dragon software: an easy approach to molecular descriptor calculations MATCH Commun. Math. Comput. Chem. 2006; 56 :237-248 Google Scholar 39. Moriwaki, H. ∙ Tian, Y.S. ∙ Kawashita, N. ... Mordred: a molecular descriptor calculator J. Cheminform. 2018; 10 :4 Crossref Scopus (671) PubMed Google Scholar 46. Rogers, D. ∙ Hahn, M. Extended-connectivity fingerprints J. Chem. Inf. Model. 2010; 50 :742-754 Crossref Scopus (4367) PubMed Google Scholar ). Even though the mapping from these representations to properties was learned automatically, the fingerprints and descriptors themselves were designed manually. The innovation of neural network approaches lies in their ability to learn this representation automatically, mapping molecules into continuous vectors that are subsequently used to predict their properties. These designs result in molecular representations that are highly attuned to the desired property, yielding gains in property prediction accuracy over manually crafted representations ( Yang et al., 2019b 67. Yang, K. ∙ Swanson, K. ∙ Jin, W. ... Analyzing learned molecular representations for property prediction J. Chem. Inf. Model. 2019; 59 :3370-3388 Crossref Scopus (884) PubMed Google Scholar ).
While neural network models narrowed the performance gap between analytical and experimental approaches, a difference still exists. Here, we demonstrate how the combination of in silico predictions and empirical investigations can lead to the discovery of new antibiotics ( Figure 1 ). Our approach consists of three stages. First, we trained a deep neural network model to predict growth inhibition of Escherichia coli using a collection of 2,335 molecules. Second, we applied the resulting model to several discrete chemical libraries, comprising >107 million molecules, to identify potential lead compounds with activity against E. coli . After ranking the compounds according to the model’s predicted score, we lastly selected a list of candidates based on a pre-specified prediction score threshold, chemical structure, and availability.
Through this approach, from the Drug Repurposing Hub, we identified the c-Jun N-terminal kinase inhibitor SU3327 ( De et al., 2009; Jang et al., 2015 14. De, S.K. ∙ Stebbins, J.L. ∙ Chen, L.H. ... Design, synthesis, and structure-activity relationship of substrate competitive, selective, and in vivo active triazole and thiadiazole inhibitors of the c-Jun N-terminal kinase J. Med. Chem. 2009; 52 :1943-1952 Crossref Scopus (82) PubMed Google Scholar 24. Jang, S. ∙ Yu, L.R. ∙ Abdelmegeed, M.A. ... Critical role of c-jun N-terminal protein kinase in promoting mitochondrial dysfunction and acute liver injury Redox Biol. 2015; 6 :552-564 Crossref Scopus (45) PubMed Google Scholar ) (renamed halicin herein), which is structurally divergent from conventional antibiotics, as a potent inhibitor of E. coli growth. Further investigations revealed that halicin displays growth inhibitory properties against a wide phylogenetic spectrum of pathogens through selective dissipation of the bacterial transmembrane ΔpH potential. Importantly, halicin shows efficacy against Clostridioides difficile and pan-resistant Acinetobacter baumannii infections in murine models. Of note, the World Health Organization has designated A. baumannii as one of the highest priority pathogens against which new antibiotics are urgently required ( Lee et al., 2017; Perez et al., 2007 31. Lee, C.R. ∙ Lee, J.H. ∙ Park, M. ... Biology of Acinetobacter baumannii : pathogenesis, antibiotic resistance mechanisms, and prospective treatment options Front. Cell. Infect. Microbiol. 2017; 7 :55 Crossref Scopus (592) PubMed Google Scholar 43. Perez, F. ∙ Hujer, A.M. ∙ Hujer, K.M. ... Global challenge of multidrug-resistant Acinetobacter baumannii Antimicrob. Agents Chemother. 2007; 51 :3471-3484 Crossref Scopus (1020) PubMed Google Scholar ). In addition to halicin, from a distinct set of 23 empirically tested predictions from >107 million molecules found in the ZINC15 database, we readily discovered eight additional antibacterial compounds that are structurally distant from known antibiotics. Remarkably, two of these molecules displayed potent broad-spectrum activity and could overcome an array of antibiotic-resistance determinants in E. coli . This work highlights the significant impact that machine learning can have on early antibiotic discovery efforts by simultaneously increasing the accuracy rate of lead compound identification and decreasing the cost of screening efforts.

Section: Results

Initially, we desired to obtain a training dataset de novo that was inexpensive, chemically diverse, and did not require sophisticated laboratory resources. This would allow for the development of a robust model with which new antibiotics could be predicted, without the practical hurdles that can be associated with large-scale antibiotic screening efforts. We screened for growth inhibition against E. coli BW25113 ( Zampieri et al., 2017 69. Zampieri, M. ∙ Zimmermann, M. ∙ Claassen, M. ... Nontargeted metabolomics reveals the multilevel response to antibiotic perturbations Cell Rep. 2017; 19 :1214-1228 Full Text Full Text (PDF) Scopus (116) PubMed Google Scholar ) using a widely available US Food and Drug Administration (FDA)-approved drug library consisting of 1,760 molecules of diverse structure and function. To further increase chemical diversity, we included an additional 800 natural products isolated from plant, animal, and microbial sources, resulting in a primary training set of 2,560 molecules ( Figures 2 A and S1 A; Table S1 A)—2,335 unique compounds when deduplicated ( Figure S1 B; Table S1 B). Using 80% growth inhibition as a hit cut-off, this primary screen resulted in the identification of 120 molecules with growth inhibitory activity against E. coli .
Next, all 2,335 compounds from the primary training dataset were binarized as hit or non-hit. After binarization, we used these data to train a binary classification model that predicts the probability of whether a new compound will inhibit the growth of E. coli based on its structure. For this purpose, we utilized a directed-message passing deep neural network model ( Yang et al., 2019b 67. Yang, K. ∙ Swanson, K. ∙ Jin, W. ... Analyzing learned molecular representations for property prediction J. Chem. Inf. Model. 2019; 59 :3370-3388 Crossref Scopus (884) PubMed Google Scholar ), which translates the graph representation of a molecule into a continuous vector via a directed bond-based message passing approach. This builds a molecular representation by iteratively aggregating the features of individual atoms and bonds. The model operates by passing “messages” along bonds that encode information about neighboring atoms and bonds. By applying this message passing operation multiple times, the model constructs higher-level bond messages that contain information about larger chemical substructures. The highest-level bond messages are then combined into a single continuous vector representing the entire molecule. Given the limited amount of data available for training the model, it was important to ensure that the model could generalize without overfitting. Therefore, we augmented the learned representation with molecular features computed by RDKit ( Landrum, 2006 30. Landrum, G. RDKit: Open-source cheminformatics https://rdkit.org/docs/index.html Date: 2006 Google Scholar ) ( Table S2 A), yielding a hybrid molecular representation. We further increased the algorithm’s robustness by utilizing an ensemble of classifiers and estimating hyperparameters with Bayesian optimization. The resulting model achieved a receiver operating characteristic curve-area under the curve (ROC-AUC) of 0.896 on the test data ( Figure 2 B).
After model development and optimization using our training dataset of 2,335 molecules, we subsequently applied an ensemble of models trained on twenty folds to identify potential antibacterial molecules from the Drug Repurposing Hub ( Corsello et al., 2017 10. Corsello, S.M. ∙ Bittker, J.A. ∙ Liu, Z. ... The Drug Repurposing Hub: a next-generation drug library and information resource Nat. Med. 2017; 23 :405-408 Crossref Scopus (580) PubMed Google Scholar ). This library consists of 6,111 molecules at various stages of investigation for human diseases. Here, prediction scores for each compound were determined, molecules were ranked based on their probability of displaying growth inhibition against E. coli , and compounds with molecular graphs common between the training dataset and the Drug Repurposing Hub were removed ( Figure 2 C; Table S2 B). Notably, we compared the molecule prediction ranks from our model ( Table S2 B) to numerous others, including a learned model without RDKit feature augmentation ( Table S2 C), a model trained exclusively on RDKit features ( Table S2 D), a feed-forward deep neural network model using Morgan fingerprints as the molecular representation ( Table S2 E), a random forest classifier using Morgan fingerprints ( Table S2 F), and a support-vector machine model using Morgan fingerprints ( Table S2 G).
Next, we curated the 99 molecules unique to the Drug Repurposing Hub that were most strongly predicted to display antibacterial properties by our model and empirically tested these for growth inhibition. We observed that 51 of the 99 predicted molecules displayed growth inhibition against E. coli , based on a cut-off of OD 600 <0.2 ( Figure 2 D). Importantly, higher prediction scores correlated with a greater probability of growth inhibition ( Figure 2 E). Furthermore, empirically testing the lowest predicted 63 molecules that were unique to the Drug Repurposing Hub revealed that only two of these compounds displayed growth inhibitory activity ( Figure 2 F).
After identifying the 51 molecules that displayed growth inhibition against E. coli , we prioritized these based on clinical phase of investigation, structural similarity to molecules in the primary training dataset, and predicted toxicity using a deep neural network model trained on the ClinTox database ( Gayvert et al., 2016; Wu et al., 2017 21. Gayvert, K.M. ∙ Madhukar, N.S. ∙ Elemento, O. A data-driven approach to predicting successes and failures of clinical trials Cell Chem. Biol. 2016; 23 :1294-1301 Full Text Full Text (PDF) Scopus (152) PubMed Google Scholar 64. Wu, Z. ∙ Ramsundar, B. ∙ Feinberg, E.N. ... MoleculeNet: a benchmark for molecular machine learning Chem. Sci. (Camb.). 2017; 9 :513-530 Crossref PubMed Google Scholar ) ( Table S2 B). Specifically, we prioritized predicted compounds in preclinical or Phase 1/2/3 studies, those with low structural similarity to training set molecules, and those with low predicted toxicity. The compound that satisfied all of these criteria was the c-Jun N-terminal kinase inhibitor SU3327 ( De et al., 2009; Jang et al., 2015 14. De, S.K. ∙ Stebbins, J.L. ∙ Chen, L.H. ... Design, synthesis, and structure-activity relationship of substrate competitive, selective, and in vivo active triazole and thiadiazole inhibitors of the c-Jun N-terminal kinase J. Med. Chem. 2009; 52 :1943-1952 Crossref Scopus (82) PubMed Google Scholar 24. Jang, S. ∙ Yu, L.R. ∙ Abdelmegeed, M.A. ... Critical role of c-jun N-terminal protein kinase in promoting mitochondrial dysfunction and acute liver injury Redox Biol. 2015; 6 :552-564 Crossref Scopus (45) PubMed Google Scholar ) (renamed halicin), a preclinical nitrothiazole under investigation as a treatment for diabetes. Excitingly, halicin, which is structurally most similar to a family of nitro-containing antiparasitic compounds (Tanimoto similarity ∼0.37; Figures 2 G and 2H; Table S2 H) ( Rogers and Hahn, 2010 46. Rogers, D. ∙ Hahn, M. Extended-connectivity fingerprints J. Chem. Inf. Model. 2010; 50 :742-754 Crossref Scopus (4367) PubMed Google Scholar ) and the antibiotic metronidazole (Tanimoto similarity ∼0.21), displayed excellent growth inhibitory activity against E. coli , achieving a minimum inhibitory concentration (MIC) of 2 μg/mL ( Figure 2 I).
Importantly, we observed that the prediction rank of halicin in our model (position 89) was greater than that in four of the other five models tested (positions ranging from 273 to 2579; Tables S2 D–S2G). Indeed, only the learned model without RDKit augmentation positioned halicin in a higher prediction rank (position 61; Table S2 C). These data highlight the importance of using a directed-message passing deep neural network approach in the discovery of halicin.
Given that halicin displayed potent growth inhibitory activity against E. coli , we next performed time- and concentration-dependent killing assays to determine whether this compound inhibited growth through a bactericidal or bacteriostatic mechanism. In rich growth conditions against an initial cell density of ∼10 6 colony-forming unit (CFU)/mL, we observed bacterial cell killing in the presence of halicin ( Figure 3 A). The apparent potency of halicin decreased as initial cell density increased ( Figures S2 A and S2B), likely as a result of dilution of the molecule over a greater number of cells. Next, we considered whether halicin might induce bacterial cell death against E. coli in a metabolically repressed, antibiotic-tolerant state ( Balaban et al., 2019; Stokes et al., 2019a, 2019b 3. Balaban, N.Q. ∙ Helaine, S. ∙ Lewis, K. ... Definitions and guidelines for research on antibiotic persistence Nat. Rev. Microbiol. 2019; 17 :441-448 Crossref Scopus (693) PubMed Google Scholar 54. Stokes, J.M. ∙ Gutierrez, A. ∙ Lopatkin, A.J. ... A multiplexable assay for screening antibiotic lethality against drug-tolerant bacteria Nat. Methods. 2019; 16 :303-306 Crossref Scopus (31) PubMed Google Scholar 55. Stokes, J.M. ∙ Lopatkin, A.J. ∙ Lobritz, M.A. ... Bacterial Metabolism and Antibiotic Efficacy Cell Metab. 2019; 30 :251-259 Full Text Full Text (PDF) Scopus (326) PubMed Google Scholar ). Indeed, given that metronidazole is bactericidal against non-replicating cells ( Tally et al., 1978 58. Tally, F.P. ∙ Goldin, B.R. ∙ Sullivan, N. ... Antimicrobial activity of metronidazole in anaerobic bacteria Antimicrob. Agents Chemother. 1978; 13 :460-465 Crossref Scopus (61) PubMed Google Scholar ), we reasoned that halicin may similarly display this activity. Remarkably, by incubating E. coli in nutrient-free buffer supplemented with halicin, we observed that this molecule retained bactericidal activity ( Figures 3 B, S2 C, and S2D). This is in stark contrast to the conventionally bactericidal antibiotic ampicillin, which was unable to eradicate E. coli existing in metabolically repressed states ( Figures S2 E–S2G), despite its efficacy against metabolically active cells ( Figures S2 H–S2J). Moreover, halicin was able to eradicate E. coli persister cells that remained after treatment with ampicillin ( Figure 3 C), consistent with its bactericidal activity against cells in nutrient-free buffer conditions.
The efficacy of halicin against antibiotic-tolerant cells represents a significant improvement over the majority of conventional antibiotics ( Lobritz et al., 2015; Stokes et al., 2019b 33. Lobritz, M.A. ∙ Belenky, P. ∙ Porter, C.B. ... Antibiotic efficacy is linked to bacterial cellular respiration Proc. Natl. Acad. Sci. USA. 2015; 112 :8173-8180 Crossref Scopus (496) PubMed Google Scholar 55. Stokes, J.M. ∙ Lopatkin, A.J. ∙ Lobritz, M.A. ... Bacterial Metabolism and Antibiotic Efficacy Cell Metab. 2019; 30 :251-259 Full Text Full Text (PDF) Scopus (326) PubMed Google Scholar ). This observation suggested that the molecule could function through an uncommon mechanism of action, and therefore overcome many common resistance determinants. We initially tested halicin against a selection of E. coli strains harboring plasmid-borne antibiotic-resistance genes conferring resistance to polymyxins (MCR-1), chloramphenicol (CAT), β-lactams (OXA-1), aminoglycosides [ant(2″)-Ia], and fluoroquinolones [aac(6′)-Ib-cr]. Here, we observed no change in halicin MIC in the presence of any resistance gene relative to the antibiotic-susceptible parent strains ( Figures 3 D and S2 K). Similarly, the MIC of halicin did not change in E. coli displaying resistance to the nitrofuran antibiotic nitrofurantoin via deletion of nfsA and nfsB ( Sandegren et al., 2008 47. Sandegren, L. ∙ Lindqvist, A. ∙ Kahlmeter, G. ... Nitrofurantoin resistance mechanism and fitness cost in Escherichia coli J. Antimicrob. Chemother. 2008; 62 :495-503 Crossref Scopus (142) PubMed Google Scholar ) ( Figures S2 L and S2M).
To more comprehensively assess the ability of halicin to overcome antibiotic-resistance genes, as well as understand phylogenetic spectrum of bioactivity, we assayed for halicin-dependent growth inhibition against Mycobacterium tuberculosis , as well as 36 multidrug-resistant clinical isolates each of carbapenem- resistant Enterobacteriaceae (CRE), A. baumannii , and Pseudomonas aeruginosa . These pathogens are regarded by the World Health Organization as the bacteria that most urgently require new treatments. The molecule we have named halicin was reported to have growth inhibitory activity against M. tuberculosis in a high-throughput screening setting (unpublished data; PubChem AID 1259343). Excitingly, we observed that halicin was rapidly bactericidal against M. tuberculosis ( Figures 3 E and 3F) and had strong growth inhibitory activity against CRE and A. baumannii clinical isolates ( Figure 3 G; Table S3 ). While it remains to be experimentally elucidated, the lack of efficacy against P. aeruginosa may be explained by insufficient permeability to the cell membrane ( Angus et al., 1982; Yoshimura and Nikaido, 1982 2. Angus, B.L. ∙ Carey, A.M. ∙ Caron, D.A. ... Outer membrane permeability in Pseudomonas aeruginosa : comparison of a wild-type with an antibiotic-supersusceptible mutant Antimicrob. Agents Chemother. 1982; 21 :299-309 Crossref Scopus (172) PubMed Google Scholar 68. Yoshimura, F. ∙ Nikaido, H. Permeability of Pseudomonas aeruginosa outer membrane to hydrophilic solutes J. Bacteriol. 1982; 152 :636-642 Crossref PubMed Google Scholar ).
The observations that halicin retained bactericidal activity against antibiotic-tolerant E. coli and M. tuberculosis , as well as growth inhibitory properties against multidrug-resistant Gram-negative clinical isolates, suggested that this compound was antibacterial through an unconventional mechanism. Because our model was agnostic to the mechanism of action underlying growth inhibition, we initially attempted to elucidate mechanism through the evolution of halicin-resistant mutants. However, we were unable to isolate spontaneous suppressor mutants after 30 days of serial passaging in liquid media ( Figure 4 A) or after 7 days of continuous halicin exposure on solid media ( Figure S3 A). As such, we applied RNA sequencing to understand the physiologic response of E. coli to halicin. Here, early-log phase cells were treated with a range of concentrations of compound, and whole-transcriptome sequencing was performed. We observed a rapid downregulation of genes involved in cell motility across all concentrations, as well as the upregulation of genes required for iron homeostasis at sub-lethal concentrations ( Figures 4 B, S3 B, and S3C; Tables S4 A–S4C). Interestingly, previous work has shown that dissipation of the cytoplasmic transmembrane potential results in decreased bacterial locomotion and flagellar biosynthesis ( Manson et al., 1977; Paul et al., 2008; Shioi et al., 1982 36. Manson, M.D. ∙ Tedesco, P. ∙ Berg, H.C. ... A protonmotive force drives bacterial flagella Proc. Natl. Acad. Sci. USA. 1977; 74 :3060-3064 Crossref Scopus (330) PubMed Google Scholar 42. Paul, K. ∙ Erhardt, M. ∙ Hirano, T. ... Energy source of flagellar type III secretion Nature. 2008; 451 :489-492 Crossref Scopus (252) PubMed Google Scholar 48. Shioi, J.I. ∙ Galloway, R.J. ∙ Niwano, M. ... Requirement of ATP in bacterial chemotaxis J. Biol. Chem. 1982; 257 :7969-7975 Abstract Full Text (PDF) PubMed Google Scholar ). Moreover, given that cells must maintain an electrochemical transmembrane gradient for viability ( Hurdle et al., 2011; Coates and Hu, 2008 8. Coates, A.R. ∙ Hu, Y. Targeting non-multiplying organisms as a way to develop novel antimicrobials Trends Pharmacol. Sci. 2008; 29 :143-150 Full Text Full Text (PDF) Scopus (72) PubMed Google Scholar 23. Hurdle, J.G. ∙ O’Neill, A.J. ∙ Chopra, I. ... Targeting bacterial membrane function: an underexploited mechanism for treating persistent infections Nat. Rev. Microbiol. 2011; 9 :62-75 Crossref Scopus (640) PubMed Google Scholar ), dissipation of the proton motive force would result in the death of tolerant cells.
To test the hypothesis that halicin dissipated the proton motive force, we first assayed for changes in halicin MIC against E. coli as a function of media pH. In E. coli ( Figure 4 C), as well as Staphylococcus aureus ( Figure S3 D), we observed that halicin potency decreased as pH increased, providing evidence that this compound may be dissipating the ΔpH component of the proton motive force ( Farha et al., 2013 18. Farha, M.A. ∙ Verschoor, C.P. ∙ Bowdish, D. ... Collapsing the proton motive force to identify synergistic combinations against Staphylococcus aureus Chem. Biol. 2013; 20 :1168-1178 Full Text Full Text (PDF) Scopus (163) PubMed Google Scholar ). Consistent with this observation, the addition of sodium bicarbonate to the growth medium ( Farha et al., 2018 19. Farha, M.A. ∙ French, S. ∙ Stokes, J.M. ... Bicarbonate alters bacterial susceptibility to antibiotics by targeting the proton motive force ACS Infect. Dis. 2018; 4 :382-390 Crossref Scopus (83) PubMed Google Scholar ) antagonized the action of halicin against E. coli ( Figure S3 E).
To further ascertain that halicin dissipates the transmembrane ΔpH potential in bacteria, we applied the potentiometric fluorophore 3,3′-dipropylthiadicarbocyanine iodide [DiSC 3 (5)] ( Wu et al., 1999 63. Wu, M. ∙ Maier, E. ∙ Benz, R. ... Mechanism of interaction of different classes of cationic antimicrobial peptides with planar bilayers and with the cytoplasmic membrane of Escherichia coli Biochemistry. 1999; 38 :7235-7242 Crossref Scopus (674) PubMed Google Scholar ). DiSC 3 (5) accumulates in the cytoplasmic membrane in response to the Δψ component of the proton motive force, and self-quenches its own fluorescence. When Δψ is disrupted, or the membrane is permeabilized, the probe is released into the extracellular milieu resulting in increased fluorescence. Conversely, when ΔpH is disrupted, cells compensate by increasing Δψ, resulting in enhanced DiSC 3 (5) uptake into the cytoplasmic membrane and therefore decreased fluorescence. Here, early-log E. coli cells were washed in buffer and introduced to DiSC 3 (5) to allow fluorescence equilibration. Cells were then introduced to polymyxin B ( Figure 4 D), which disrupts the cytoplasmic membrane, causing release of DiSC 3 (5) from the membrane and a corresponding increase in fluorescence. Next, we introduced cells to varying concentrations of halicin, and observed an immediate decrease in DiSC 3 (5) fluorescence in a dose-dependent manner ( Figure 4 D), suggesting that halicin selectively dissipated the ΔpH component of the proton motive force. Similar DiSC 3 (5) fluorescence changes were observed in S. aureus treated with halicin ( Figures S3 F and S3G). Moreover, halicin displayed antibiotic antagonism and synergy profiles consistent with ΔpH dissipation. Of note, halicin antagonized the activity of tetracycline in E. coli , and synergized with kanamycin ( Figure 4 E), consistent with previous work showing that the uptake of tetracyclines is dependent upon ΔpH ( Yamaguchi et al., 1991 65. Yamaguchi, A. ∙ Ohmori, H. ∙ Kaneko-Ohdera, M. ... Delta pH-dependent accumulation of tetracycline in Escherichia coli Antimicrob. Agents Chemother. 1991; 35 :53-56 Crossref Scopus (73) PubMed Google Scholar ), whereas aminoglycoside uptake is driven largely by Δψ ( Taber et al., 1987 57. Taber, H.W. ∙ Mueller, J.P. ∙ Miller, P.F. ... Bacterial uptake of aminoglycoside antibiotics Microbiol. Rev. 1987; 51 :439-457 Crossref PubMed Google Scholar ).
Interestingly, our observations that halicin induced the expression of iron acquisition genes at sub-lethal concentrations ( Tables S4 A–S4C) suggested that this compound complexes with iron in solution, thereby dissipating transmembrane ΔpH potential similarly to other antibacterial ionophores, such as daptomycin ( Farha et al., 2013 18. Farha, M.A. ∙ Verschoor, C.P. ∙ Bowdish, D. ... Collapsing the proton motive force to identify synergistic combinations against Staphylococcus aureus Chem. Biol. 2013; 20 :1168-1178 Full Text Full Text (PDF) Scopus (163) PubMed Google Scholar ). We note here that daptomycin resistance via deletion of dsp1 in S. aureus did not confer cross-resistance to halicin ( Figure S3 H). We observed enhanced potency of halicin against E. coli with increasing concentrations of environmental Fe 3+ ( Figure 4 E). This is consistent with a mechanism of action wherein halicin may bind iron prior to membrane association and ΔpH dissipation.
Given that halicin displays broad-spectrum bactericidal activity and is not highly susceptible to plasmid-borne antibiotic-resistance elements or de novo resistance mutations at high frequency, we next asked whether this compound might have utility as an antibiotic in vivo . We therefore tested the efficacy of halicin in a murine wound model of A. baumannii infection. On the dorsal surface of neutropenic BALB/c mice, we established a 2 cm 2 wound and infected with ∼2.5 × 10 5 CFU of A. baumannii strain 288 acquired from the Centers for Disease Control and Prevention (CDC). This strain is not susceptible to clinical antibiotics generally used for treatment of A. baumannii , and therefore represents a pan-resistant isolate. Importantly, halicin displayed potent growth inhibition against this strain in vitro (MIC = 1 μg/mL; Figure 5 A) and was able to sterilize A. baumannii 288 cells residing in metabolically repressed conditions ( Figures 5 B, S4 A, and S4B). After 1 h of infection establishment, mice were treated with Glaxal Base Moisturizing Cream supplemented with vehicle (0.5% DMSO) or halicin (0.5% w/v). Mice were then treated after 4 h, 8 h, 12 h, 20 h, and 24 h of infection, and sacrificed at 25 h post-infection. We observed that wound-carrying capacity had reached ∼10 8 CFU/g in the vehicle control group, whereas 5 of the 6 mice treated with halicin contained <10 3 CFU/g (below the limit of detection) and one contained ∼10 5 CFU/g ( Figure 5 C).
After showing that halicin displayed efficacy against A. baumannii in a murine wound model, we next sought to investigate whether this molecule may have utility against a phylogenetically divergent pathogen that is increasingly becoming burdensome to healthcare systems—namely, C. difficile . This spore-forming anaerobe causes pseudomembranous colitis, often as a result of dysbiosis following systemic antibiotic administration. Metronidazole or vancomycin are first-line treatments, with failure resulting from antibiotic resistance and/or the presence of metabolically dormant cells ( Surawicz et al., 2013 56. Surawicz, C.M. ∙ Brandt, L.J. ∙ Binion, D.G. ... Guidelines for diagnosis, treatment, and prevention of Clostridium difficile infections Am. J. Gastroenterol. 2013; 108 :478-498, quiz 499 Crossref Scopus (1392) PubMed Google Scholar ). In cases of recurrent infection, fecal bacteriotherapy is required to re-establish the normal colonic microbiota to outcompete C. difficile ( Gough et al., 2011 22. Gough, E. ∙ Shaikh, H. ∙ Manges, A.R. Systematic review of intestinal microbiota transplantation (fecal bacteriotherapy) for recurrent Clostridium difficile infection Clin. Infect. Dis. 2011; 53 :994-1002 Crossref Scopus (813) PubMed Google Scholar ), which can be more invasive than antibiotic therapy.
We first assayed for the ability of this molecule to inhibit the growth of C. difficile strain 630 in vitro and observed an MIC of 0.5 μg/mL ( Figure 5 D). To establish the murine infection, C57BL/6 mice were administered intraperitoneal injections of ampicillin (200 mg/kg) every 24 h for 72 h. Mice were then given 24 h to recover and subsequently administered 5 × 10 3 spores of C. difficile 630 via oral gavage. Beginning 24 h after C. difficile gavage, mice were gavaged with antibiotics (50 mg/kg metronidazole or 15 mg/kg halicin) or vehicle (10% polyethylene glycol [PEG] 300) every 24 h for 5 days, and fecal samples were collected to quantify C. difficile load ( Figure 5 E). Excitingly, we observed that halicin resulted in C. difficile clearance at a greater rate than vehicle or the antibiotic metronidazole ( Figure 5 F), which is not only a first-line treatment for C. difficile infection, but also the antibiotic most similar to halicin based on Tanimoto score ( Figure 2 H; Table S2 H). Indeed, halicin resulted in sterilization of 3 out of 4 mice after 72 h of treatment, and 4 out of 4 mice after 96 h of treatment.
After applying our deep neural network model to identify antibiotic candidates from the Drug Repurposing Hub, we subsequently explored two additional chemical libraries—the WuXi anti-tuberculosis library housed at the Broad Institute that contains 9,997 molecules, and the ZINC15 database, a virtual collection of ∼1.5 billion molecules designed for in silico screening ( Sterling and Irwin, 2015 50. Sterling, T. ∙ Irwin, J.J. ZINC 15–ligand discovery for everyone J. Chem. Inf. Model. 2015; 55 :2324-2337 Crossref Scopus (2198) PubMed Google Scholar ). The WuXi anti-tuberculosis library served to test our model in chemical spaces that were highly divergent from the training dataset, prior to conducting large-scale predictions in the vast ZINC15 database. We applied our empirical data gathered from the Drug Repurposing Hub molecules to re-train the original model and then applied this new model to the WuXi anti-tuberculosis library. Interestingly, we observed an upper limit prediction score of just ∼0.37 for the WuXi anti-tuberculosis library ( Figure S5 A), which was substantially lower than the highest prediction scores observed for the Drug Repurposing Hub (upper limit ∼0.97; Figure 2 C). Next, we curated and empirically assayed the 200 WuXi anti-tuberculosis library compounds with the highest prediction scores and the 100 with the lowest. As expected, none of the 300 molecules that were assayed for growth inhibition against E. coli displayed antibacterial activity ( Figures S5 B and S5C; Table S5 ).
After again re-training our model with the empirical data gathered from these 300 WuXi anti-tuberculosis library molecules, we performed predictions on a subset of the ZINC15 database. Here, rather than screening the entire ∼1.5 billion-molecule database, we focused specifically on those tranches that contained molecules with physicochemical properties that are observed in antibiotic-like compounds ( Figure 6 A). This more focused approach resulted in the in silico curation of 107,349,233 molecules; for perspective, this is two orders of magnitude larger than empirical screening permits ( Brown et al., 2014 5. Brown, D.G. ∙ May-Dracka, T.L. ∙ Gagnon, M.M. ... Trends and exceptions of physical properties on antibacterial activity for Gram-positive and Gram-negative pathogens J. Med. Chem. 2014; 57 :10144-10161 Crossref Scopus (183) PubMed Google Scholar ), and our in silico screen of the library could be performed in 4 days.
After running predictions on the selected tranches of the ZINC15 database, compounds were binned based on prediction score. This resulted in 6,820 molecules with scores >0.7, 3,260 molecules with scores >0.8, and 1,070 molecules with scores >0.9 ( Figure 6 B; Table S6 A). We compared the top 6,820 ZINC15 prediction ranks from our model ( Table S6 A) to numerous others, including a learned model without RDKit feature augmentation ( Table S6 B); a model trained exclusively on RDKit features ( Table S6 C); a feed-forward deep neural network model using Morgan fingerprints as the molecular representation ( Table S6 D); a random forest classifier using Morgan fingerprints ( Table S6 E); and a support-vector machine model using Morgan fingerprints ( Table S6 F). Next, all molecules were rank ordered based on prediction score using our model and assessed for Tanimoto similarity to all known antibiotics. Because we were interested in identifying antibacterial molecules that were structurally dissimilar from current antibiotics, we prioritized compounds for curation with prediction scores >0.8 and Tanimoto similarities to any known antibiotic <0.4. We were able to curate 23 compounds that met these criteria for empirical testing ( Figure 6 C; Table S7 A).
Next, we assayed these compounds for growth inhibition against E. coli , S. aureus , Klebsiella pneumoniae , A. baumannii , and P. aeruginosa . Indeed, even though our model was trained on growth inhibition against E. coli , because the majority of antibiotics display activity against numerous bacterial species, we reasoned that it could be possible that some of these predictions had bioactivity against diverse pathogens. Excitingly, we observed that 8 of the 23 molecules displayed detectable growth inhibitory activity against at least one of the tested species ( Figures 6 C, 6D, and S5 D–S5K; Tables S7 A and S7B).
Of note, we observed two compounds that displayed potent broad-spectrum activity, ZINC000100032716 and ZINC000225434673 ( Figure 6 D), and overcame an array of common resistance determinants ( Figures 6 E and 6F). Interestingly, ZINC000100032716 has structural features found in both quinolones and sulfa drugs, yet remains highly divergent from known antibiotics (enrofloxacin nearest neighbor with Tanimoto similarity ∼0.39) and was only weakly impacted by plasmid-borne fluoroquinolone resistance via aac(6′)-Ib-cr ( Figure 6 E) or chromosomal resistance via mutation of gyrA ( Figures S5 L and S5M). Moreover, both ZINC000100032716 and ZINC000225434673 displayed bactericidal activity against E. coli in rich medium ( Figures 6 G and 6H), with the latter resulting in complete sterilization after just 4 h of treatment. Given its novel structure (nitromide nearest neighbor with Tanimoto similarity ∼0.16) and low predicted toxicity in humans ( Table S7 A), we posit that ZINC000225434673 warrants further investigation.
Last, upon determining the antibacterial properties of these 23 predicted molecules, we ventured to understand their chemical relationships to the training data. We therefore analyzed the structural relationships between these compounds, ZINC15 molecules with prediction scores >0.9, our primary training set, the Drug Repurposing Hub, and the WuXi anti-tuberculosis library ( Figure 6 I). Intriguingly, our analysis revealed that the WuXi anti-tuberculosis library contained molecules that largely occupied a distinct chemical space relative to compounds with antibacterial activity, consistent with our results showing that even the highest predicted of these were unable to inhibit the growth of E. coli . Moreover, this analysis emphasized the fact that the predicted compounds resided in varied chemical spaces, suggesting that our model was largely unbiased in enriching for specific chemical moieties—at least below our Tanimoto nearest neighbor threshold of 0.4.

Section: Discussion

The prevalence of antibiotic resistance is rapidly increasing on a global scale. Concurrently, the steadily declining productivity in clinically implementing new antibiotics due to the high risk of early discovery and low return on investment is exacerbating this problem ( Brown and Wright, 2016 4. Brown, E.D. ∙ Wright, G.D. Antibacterial drug discovery in the resistance era Nature. 2016; 529 :336-343 Crossref Scopus (1608) PubMed Google Scholar ). Therefore, the development of new approaches that can substantially decrease the cost and increase the rate of antibiotic discovery is essential to reinfuse the pipeline with a steady stream of candidates that show promise as next-generation therapeutics. The adoption of machine learning approaches is ideally suited to address these hurdles. Indeed, modern neural molecular representations have the potential to: (1) decrease the cost of lead molecule identification because screening is limited to gathering appropriate training data, (2) increase the true positive rate of identifying structurally novel compounds with the desired bioactivity, and (3) decrease the time and labor required to find these ideal compounds from months or years to weeks.
In this study, we applied neural molecular representations to predict antibacterial compounds in silico from a collection of >107 million compounds. We first trained a deep neural network model with empirical data analyzing E. coli growth inhibition by molecules from a widely available FDA-approved drug library supplemented with a modest natural product library, totaling 2,335 molecules. Next, we applied the resulting model to predict antibacterial compounds from the Drug Repurposing Hub. Excitingly, among the most highly predicted molecules, our model performed well (51.5% accuracy) and ultimately resulted in identifying halicin as a broad-spectrum bactericidal antibiotic with exceptional in vivo efficacy. The low structural similarity of halicin to its nearest neighbor antibiotic, metronidazole (Tanimoto similarity ∼0.21), showed that our approach was capable of generalization, thus permitting access to new antibiotic chemistry.
We subsequently expanded our prediction space to include the WuXi anti-tuberculosis library, as well as a subset of the ZINC15 database comprising 107,349,233 molecules, in order to identify additional candidate antibacterial molecules. We did not observe growth inhibition from any molecules empirically tested from the WuXi library, in agreement with the correspondingly low model prediction scores (upper limit ∼0.37). However, from among the 23 molecules from the ZINC15 database that we curated for empirical testing, we observed that eight of these validated as true positives in at least one of the tested pathogens. Importantly, these compounds were curated based on high prediction scores and low Tanimoto similarities to known antibiotics, providing further support that our model was able to generalize to new chemistries. Remarkably, two of these eight molecules, ZINC000100032716 and ZINC000225434673, displayed broad-spectrum activity and maintained activity against E. coli harboring an array of resistance determinants.
It is important to emphasize that machine learning is imperfect. Therefore, the success of deep neural network model-guided antibiotic discovery rests heavily on the coupling of these approaches to appropriate experimental designs. The first consideration should be the assay design for training: what is the biological outcome that is desired after cells are exposed to compounds? In the proof-of-concept described herein, we selected growth inhibition as the biological property on which we would gather training data, since this generally results in a reasonable proportion of active compounds relative to the size of the screening library, and quite easily generates reproducible data. However, the number of bacterial phenotypes that could theoretically result in efficacious antibiotics is expansive ( Farha and Brown, 2015; Kohanski et al., 2010 17. Farha, M.A. ∙ Brown, E.D. Unconventional screening approaches for antibiotic discovery Ann. N Y Acad. Sci. 2015; 1354 :54-66 Crossref Scopus (46) PubMed Google Scholar 29. Kohanski, M.A. ∙ Dwyer, D.J. ∙ Collins, J.J. How antibiotics kill bacteria: from targets to networks Nat. Rev. Microbiol. 2010; 8 :423-435 Crossref Scopus (1567) PubMed Google Scholar ), and so long as it is possible to gather a sufficient quantity of reproducible hit compounds from a primary screen, deep neural network approaches would be well-suited to predict additional molecules with the desired biological property. Indeed, where our screen was largely mechanism of action agnostic, future applications could incorporate phenotypic screening conditions that enrich for molecules against specific biological targets ( Stokes and Brown, 2015; Stokes et al., 2016, 2017; Yang et al., 2019a 51. Stokes, J.M. ∙ Brown, E.D. Chemical modulators of ribosome biogenesis as biological probes Nat. Chem. Biol. 2015; 11 :924-932 Crossref Scopus (13) PubMed Google Scholar 52. Stokes, J.M. ∙ French, S. ∙ Ovchinnikova, O.G. ... Cold stress makes Escherichia coli susceptible to glycopeptide antibiotics by altering outer membrane integrity Cell Chem. Biol. 2016; 23 :267-277 Full Text Full Text (PDF) Scopus (58) PubMed Google Scholar 53. Stokes, J.M. ∙ MacNair, C.R. ∙ Ilyas, B. ... Pentamidine sensitizes Gram-negative pathogens to antibiotics and overcomes acquired colistin resistance Nat. Microbiol. 2017; 2 :17028 Crossref Scopus (245) PubMed Google Scholar 66. Yang, J.H. ∙ Wright, S.N. ∙ Hamblin, M. ... A white-box machine learning approach for revealing antibiotic mechanisms of action Cell. 2019; 177 :1649-1661 Full Text Full Text (PDF) Scopus (209) PubMed Google Scholar ).
The second consideration is the composition of the training data itself: on what chemistry should the model be trained? It is important to use training data that have sufficient chemical diversity in both active and inactive compounds, as well as appropriate pharmacology/absorption, distribution, metabolism, and excretion [ADME]/toxicity properties for in vivo application. If all active molecules are structurally similar, the model will be unable to generalize to new scaffolds. Moreover, model accuracy deteriorates as the training set and prediction set diverge. As such, there exists a tension of sorts between prediction accuracy and chemical generalization, and it is advantageous to have the broadest structural variation possible in the training phase to maximize the probability of successful generalization in new chemical spaces. In our case, the desire to train on a supplemented FDA-approved drug library was to offer the capability of performing a small screen and simultaneously capturing substantial chemical diversity with desired pharmacology/ADME/toxicity properties. While mining pre-existing screening datasets could have been implemented, we reasoned that at this early stage in the application of machine learning for antibiotic discovery, a carefully controlled training set would allow for more tractable predictions that avoided potentially unfavorable molecules. Nevertheless, given the increasing volume of screening data that exists ( Wang et al., 2017 60. Wang, Y. ∙ Bryant, S.H. ∙ Cheng, T. ... PubChem BioAssay: 2017 update Nucleic Acids Res. 2017; 45 :D955-D963 Crossref Scopus (409) PubMed Google Scholar ), carefully leveraging these resources could result in millions of molecular graph-biological property relationships, provided that the data are of adequate quality and methodological uniformity so that erroneous predictions could be minimized.
The third consideration is in prediction prioritization: what is the most appropriate approach to selecting tens of molecules for follow-up investigation from thousands of strongly predicted compounds? Because we aimed to identify new antibacterial candidates, our prioritization scheme involved the selection of molecules that were (1) given a high prediction score, (2) structurally unique relative to clinical antibiotics based on Tanimoto nearest neighbor analyses, and in some cases, (3) unlikely to display toxicity. Indeed, this approach allowed us to identify halicin, as well as numerous attractive compounds from the ZINC15 database. It should be noted here, however, that investigators can encounter limitations in acquiring predicted compounds in quantities sufficient to perform experiments. This can be due to the inability to synthesize predicted molecules, prohibitive costs of synthesizing those that can, and/or compound instability in aqueous solution. However, emerging models in retrosynthesis and physicochemical property prediction may overcome these limitations in the near future ( Coley et al., 2018; Gao et al., 2018 9. Coley, C.W. ∙ Jin, W. ∙ Rogers, L. ... A graph-convolutional neural network model for the prediction of chemical reactivity Chem. Sci. (Camb.). 2018; 10 :370-377 Crossref PubMed Google Scholar 20. Gao, H. ∙ Struble, T.J. ∙ Coley, C.W. ... Using machine learning to predict suitable conditions for organic reactions ACS Cent. Sci. 2018; 4 :1465-1476 Crossref Scopus (265) PubMed Google Scholar ).
Where our deep neural network model was trained using a targeted dataset, future endeavors could aim to assemble chemical libraries designed for model training on a task-by-task basis, which may contain on the order of perhaps ∼10 5 compounds of diverse structure. In the context of antibacterial discovery, these training libraries should contain molecules with physicochemical properties consistent with antibacterial drugs ( Tommasi et al., 2015 59. Tommasi, R. ∙ Brown, D.G. ∙ Walkup, G.K. ... ESKAPEing the labyrinth of antibacterial discovery Nat. Rev. Drug Discov. 2015; 14 :529-542 Crossref Scopus (447) PubMed Google Scholar ), yet sufficiently diverse such that the model can generalize to unconventional chemistry. Furthermore, with repeated training cycles across phylogenetically diverse species, it may be possible to predict molecules with antibacterial activity against a specified spectrum of pathogens. This has the promise to result in narrow-spectrum agents that can be administered systemically without damaging the host microbiota. Moreover, by training on multidrug-resistant pathogens, it may be possible to identify scaffolds that overcome pre-existing resistance determinants. Overall, our results suggest that the time is ripe for the application of modern machine learning approaches for antibiotic discovery—such efforts could increase the rate at which new molecular entities are discovered, decrease the resources required to identify these molecules, and decrease associated costs. Deep learning approaches could therefore enable us to expand our antibiotic arsenal and help outpace the dissemination of resistance.

Section: STAR★Methods

REAGENT or RESOURCE SOURCE IDENTIFIER Bacterial and Virus Strains Escherichia coli BW25113 CGSC 7636 Staphylococcus aureus USA 300 ATCC TCH1516 Klebsiella pneumoniae ATCC 700721 ATCC 700721 Acinetobacter baumannii ATCC 17978 ATCC 17978 Pseudomonas aeruginosa PA01 ATCC 47085 Clostridioides difficile 630 ATCC BAA-1382 Mycobacterium tuberculosis H37Rv ATCC 25618 Antibiotic-resistant isolates from CDC CDC AR Isolate Bank See Table S3 for unique identifiers Chemicals, Peptides, and Recombinant Proteins SU3327 (halicin) TCI chemicals A2940 ZINC000013517522 Vitas-M STL439768 ZINC000006719085 Vitas-M STK708267 ZINC000101675810 Vitas-M STK940888 ZINC000101676256 Vitas-M STK929481 ZINC000018090096 Specs AP-216/15652011 ZINC000169457956 Specs AP-216/15652003 ZINC000004481415 IBScreen STOCK1S-22001 ZINC000019771150 ChemBridge 5773027 ZINC000001387673 ChemBridge 5253687 ZINC000005510605 TimTec ST50999405 ZINC000022865640 TimTec ST50990898 ZINC000015134557 TimTec ST4019615 ZINC000098210492 KeyOrganics AS-8081 ZINC000100506795 TimTec ST50222762 ZINC000238901709 TimTec ST100643 ZINC000004623615 TimTec ST4104620 ZINC000100032716 TimTec ST45053787 ZINC000584578353 PI Chemicals PI-31452 ZINC000006661600 Ambeed A107950 ZINC000225434673 Ambinter Amb22349288 ZINC000006599408 Ambinter Amb17836664 ZINC000038586996 Ambinter Amb19958926 ZINC000001735150 NCI Plated 2007 200689 Deposited Data RNA sequencing datasets This study BioProject ID: PRJNA598708 Experimental Models: Organisms/Strains Mouse: BALB/c Charles River 028 Mouse: C57BL/6 Charles River C57BL/6NCrl Oligonucleotides TAGCCGGGCAGATGCCCGGCAAGAGAGAA TTACACTTCGGTTAAGGTGATATTCCGGG GATCCGTCGACC This study AB5044 ACCTTGTAATCTGCTGGCACGCAAAAT TACTTTCACATGGAGTCTTTATGT GTAGGCTGGAGCTGCTTCG This study AB5045 tgcaaaataatatgcaccacgacggcggtcagaaaaataa This study AB5046 gaagcgttacttcgcgatctgatcaacgattcgtggaatc This study AB5047 Software and Algorithms Chemprop Yang et al., 2019b 67. Yang, K. ∙ Swanson, K. ∙ Jin, W. ... Analyzing learned molecular representations for property prediction J. Chem. Inf. Model. 2019; 59 :3370-3388 Crossref Scopus (884) PubMed Google Scholar https://github.com/swansonk14/chemprop RDKit Landrum, 2006 30. Landrum, G. RDKit: Open-source cheminformatics https://rdkit.org/docs/index.html Date: 2006 Google Scholar https://github.com/rdkit BWA Li and Durbin, 2009 32. Li, H. ∙ Durbin, R. Fast and accurate short read alignment with Burrows-Wheeler transform Bioinformatics. 2009; 25 :1754-1760 Crossref Scopus (32781) PubMed Google Scholar https://github.com/lh3/bwa DESeq2 Love et al., 2014 35. Love, M.I. ∙ Huber, W. ∙ Anders, S. Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2 Genome Biol. 2014; 15 :550 Crossref Scopus (48497) PubMed Google Scholar https://bioconductor.org/packages/release/bioc/html/DESeq2.html edgeR Robinson et al., 2010 45. Robinson, M.D. ∙ McCarthy, D.J. ∙ Smyth, G.K. edgeR: a Bioconductor package for differential expression analysis of digital gene expression data Bioinformatics. 2010; 26 :139-140 Crossref Scopus (26732) PubMed Google Scholar https://bioconductor.org/packages/release/bioc/html/edgeR.html GenomeView Abeel et al., 2012 1. Abeel, T. ∙ Van Parys, T. ∙ Saeys, Y. ... GenomeView: a next-generation genome browser Nucleic Acids Res. 2012; 40 :e12 Crossref Scopus (113) PubMed Google Scholar https://genomeview.org EcoCyc Pathway Tools Keseler et al., 2013 28. Keseler, I.M. ∙ Mackie, A. ∙ Peralta-Gil, M. ... EcoCyc: fusing model organism databases with systems biology Nucleic Acids Res. 2013; 41 :D605-D612 Crossref Scopus (437) PubMed Google Scholar https://ecocyc.org Open table in a new tab
Further information and requests for resources and reagents should be directed to James J. Collins ( jimjc@mit.edu ). All unique/stable reagents generated in this study are available from the Lead Contact with a completed Materials Transfer Agreement.
A directed-message passing neural network (Chemprop), like other message passing neural networks, learns to predict molecular properties directly from the graph structure of the molecule, where atoms are represented as nodes and bonds are represented as edges. For every molecule, we reconstructed the molecular graph corresponding to each compound’s SMILES string and determined the set of atoms and bonds using the open-source package RDKit ( Landrum, 2006 30. Landrum, G. RDKit: Open-source cheminformatics https://rdkit.org/docs/index.html Date: 2006 Google Scholar ). Next, we initialized a feature vector, as described in Yang et al. (2019b) 67. Yang, K. ∙ Swanson, K. ∙ Jin, W. ... Analyzing learned molecular representations for property prediction J. Chem. Inf. Model. 2019; 59 :3370-3388 Crossref Scopus (884) PubMed Google Scholar , for each atom and bond based on computable features: 1. Atom features : atomic number, number of bonds for each atom, formal charge, chirality, number of bonded hydrogens, hybridization, aromaticity, atomic mass. 2. Bond features : bond type (single/double/triple/aromatic), conjugation, ring membership, stereochemistry.
The model applies a series of message passing steps where it aggregates information from neighboring atoms and bonds to build an understanding of local chemistry. In Chemprop, on each step of message passing, each bond’s featurization is updated by summing the featurization of neighboring bonds, concatenating the current bond’s featurization with the sum, and then applying a single neural network layer with non-linear activation. After a fixed number of message-passing steps, the learned featurizations across the molecule are summed to produce a single featurization for the whole molecule. Finally, this featurization is fed through a feed-forward neural network that outputs a prediction of the property of interest. Since the property of interest in our application was the binary classification of whether a molecule inhibits the growth of E. coli , the model is trained to output a number between 0 and 1, which represents its prediction about whether the input molecule is growth inhibitory.
In addition to the basic D-MPNN architecture described above, we employed three model optimizations ( Yang et al., 2019b 67. Yang, K. ∙ Swanson, K. ∙ Jin, W. ... Analyzing learned molecular representations for property prediction J. Chem. Inf. Model. 2019; 59 :3370-3388 Crossref Scopus (884) PubMed Google Scholar ):
While the message passing paradigm is excellent for extracting features that depend on local chemistry, it can struggle to extract global molecular features. This is especially true for large molecules, where the longest path through the molecule may be longer than the number of message-passing iterations performed, meaning information from one side of the molecule does not inform the features on the other side of the molecule. For this reason, we chose to concatenate the molecular representation that is learned via message passing with 200 additional molecule-level features computed with RDKit.
The performance of machine learning models is known to depend critically on the choice of hyperparameters, such as the size of the neural network layers, which control how and what the model is able to learn. We used the Bayesian hyperparameter optimization scheme, with 20 iterations of optimization to improve the hyperparameters of our model (see table below). Baysian hyperparameter optimization learns to select optimal hyperparameters based on performance using prior hyperparameter settings, allowing for rapid identification of the best set of hyperparameters for any model. Hyperparameter Range Value Number of message-passing steps [2, 6] 5 Neural network hidden size [300, 2400] 1600 Number of feed-forward layers [1, 3] 1 Dropout probability [0, 0.4] 0.35 Open table in a new tab
Another standard machine learning technique used to improve performance is ensembling, where several copies of the same model architecture with different random initial weights are trained and their predictions are averaged. We used an ensemble of 20 models, with each model trained on a different random split of the data ( Dietterich, 2000 15. Dietterich, T.G. Ensemble Methods in Machine Learning: Multiple Classifier Systems Springer, 2000 Crossref Scopus (5270) Google Scholar ).
Our initial training dataset consisted of 2,335 molecules, with 120 compounds (5.14%) showing growth inhibitory activity against E. coli , as defined by endpoint OD 600 < 0.2. We performed predictions on the Drug Repurposing Hub, consisting of 6,111 unique molecules; the WuXi anti-tuberculosis library, consisting of 9,997 unique molecules; and tranches of the ZINC15 database. The ZINC15 tranches that we used for molecular predictions were selected based on their likelihood to contain antibiotic-like molecules; these tranches included: ‘AA’, ‘AB’, ‘BA’, ‘BB’, ‘CA’, ‘CB’, ‘CD’, ‘DA’, ‘DB’, ‘EA’, ‘EB’, ‘FA’, ‘FB’, ‘GA’, ‘GB’, ‘HA’, ‘HB’, ‘IA’, ‘IB’, ‘JA’, ‘JB’, ‘JC’, ‘JD’, ‘KA’, ‘KB’, ‘KC’, ‘KD’, ‘KE’, ‘KF’, ‘KG’, ‘KH’, ‘KI’, ‘KJ’, and ‘KK’, constituting a dataset of 107,349,233 unique molecules.
Our experimental procedure consisted of four phases: (1a) a training phase to evaluate the optimized but non-ensembled model and (1b) training the ensemble of optimized models; (2) a prediction phase; (3) a retraining phase; and (4) a final prediction phase. We began by evaluating our model on the training set of 2,335 molecules using all optimizations except for ensembling, in order to determine the best performance of a single model. Here, we randomly split the dataset into 80% training data, 10% validation data, and 10% test data. We trained our model on the training data for 30 epochs, where an epoch is defined as a single pass through all of the training data, and we evaluated it on the validation data at the end of each epoch. After training was complete, we used the model parameters that performed best on the validation data and tested the model with those parameters on the test data. We repeated this procedure with 20 different random splits of the data and averaged the results. After we were satisfied with model performance, we conducted predictions on new datasets. Since we wanted to maximize the amount of training data and were no longer interested in measuring performance on the test set, we trained new models on the training data from each of 20 random splits, each with 90% training data, 10% validation data, and no test data.
The ensemble consisting of 20 models is the model that was applied first to the Drug Repurposing Hub, and then the WuXi anti-tuberculosis library. After empirically testing the highest and lowest predicted molecules from these libraries for growth inhibition against E. coli , we included all these data into our original training sets to create a new training set. The updated training set contained 2,911 unique molecules, with 232 (7.97%) showing growth inhibitory activity. We next used our retrained model to make predictions on the aforementioned subset of the ZINC15 database. We selected all molecules with a prediction score > 0.7, which resulted in 6,820 compounds. All molecules selected for curation were subsequently cross-referenced with SciFinder to ensure that these were not clinical antibiotics.
We lastly compared the prediction outputs of our augmented D-MPNN with a D-MPNN without RDKit features; a feedforward DNN model with the same depth as our D-MPNN model with hyperparameter optimization using RDKit features only; the same DNN instead using Morgan fingerprints (radius 2) as the molecular representation; and RF and SVM models using the same Morgan fingerprint representations. We used the scikit-learn implementation of a random forest classifier with all of the default parameters except for the number of trees, where we used 500 instead of 10. When making predictions, we output the growth inhibition probability for each molecule according to the random forest, which is the proportion of trees in the model that predict a 1 for that molecule. Similarly, we used the scikit-learn implementation of a support vector machine with all of the default parameters. When making predictions, we output the signed distance between the Morgan fingerprint of the molecule and the separating hyperplane that is learned by the SVM. This number represents how much the model predicts a molecule is antibacterial, with large positive distances meaning most likely antibacterial and large negative distances meaning most likely not. Although the signed distance is not a probability, it can still be used to rank the molecules according to how likely they are to be antibacterial.
To predict the toxicity of molecules for possible in vivo applications, we trained a Chemprop model on the ClinTox dataset. This dataset consisted of 1,478 molecules, each with two binary properties: (a) clinical trial toxicity and (b) FDA-approval status. Of these 1,478 molecules, 94 (6.36%) had clinical toxicity and 1,366 (92.42%) were FDA approved. Using the same methodology as described in phase (1) of our experimental procedure, the Chemprop model was trained on both properties simultaneously and learned a single molecular representation that was used by the feed-forward neural network layers to predict toxicity. We utilized the same RDKit features as in our other models, except for that the ClinTox model was an ensemble of five models and used the following optimal hyperparameters: message-passing steps = 6; neural network hidden size = 2200; number of feed-forward layers = 3; and dropout probability = 0.15. This ensemble of models was subsequently used to make toxicity predictions on our candidate molecules.
We utilized Tanimoto similarity to quantify the chemical relationship between molecules predicted in our study. The Tanimoto similarity of two molecules is a measure of the proportion of shared chemical substructures in the molecules. To compute Tanimoto similarity, we first determined Morgan fingerprints (computed using RDKit) for each molecule using a radius of 2 and 2048-bit fingerprint vectors. Tanimoto similarity was then computed as the number of chemical substructures contained in both molecules divided by the total number of unique chemical substructures in either molecule. The Tanimoto similarity is thus a number between 0 and 1, with 0 indicating least similar (no substructures are shared) and 1 indicating most similar (all substructures are shared). Morgan fingerprints with radius R and B bits are generated by looking at each atom and determining all of the substructures centered at that atom that include atoms up to R bonds away from the central atom. The presence or absence of these substructures is encoded as 1 and 0 in a vector of length B , which represents the fingerprint. For t-SNE analyses, plots were created using scikit-learn’s implementation of t-Distributed Stochastic Neighbor Embedding. Here, we first used RDKit to compute Morgan fingerprints for each molecule using a radius of 2 and 2048-bit fingerprint vectors. We then used t-SNE with the Jaccard distance metric to reduce the data points from 2048 dimensions to the two dimensions that are plotted. Note that Jaccard distance is another name for Tanimoto distance, and Tanimoto distance is defined as: Tanimoto distance = 1 - Tanimoto similarity. Thus, the distance between points in the t-SNE plots is an indication of the Tanimoto similarity of the corresponding molecules, with greater distance between molecules indicating lower Tanimoto similarity. We used scikit-learn’s default values for all t-SNE parameters besides the distance metric.
E. coli BW25113 was grown overnight in 3 mL Luria-Bertani (LB) medium and diluted 1/10,000 into fresh LB. 99 μl of cells was added to each well of a 96-well flat-bottom plate (Corning) using a multichannel pipette. Next, 1 μl of a 5 mM stock of each molecule from an FDA-approved drug library supplemented with a natural product library (2,560 molecules total; MicroSource Discovery Systems) was added, in duplicate, using an Agilent Bravo liquid handler. The final screening concentration was 50 μM. Plates were then incubated in sealed plastic bags at 37°C without shaking for 16 hr, and subsequently read at 600 nm using a SpectraMax M3 plate reader (Molecular Devices) to quantify cell growth. Plate data were normalized based on the interquartile mean of each plate.
Cells were grown overnight in 3 mL LB medium and diluted 1/10,000 into fresh LB. In 96-well flat-bottom plates (Corning), cells were then introduced to compound at a final concentration of 50 μM, or to compound at two-fold serial dilutions, in final volumes of 100 μl. Plates were then incubated at 37°C without shaking until untreated control cultures reached stationary phase, at which time plates were read at 600 nm using a SpectraMax M3 plate reader. We note here that the incubation time required to reach stationary phase differed between species but was generally between 12 hr and 18 hr. For ZINC15 compound validation, the strains were E. coli BW25113, S. aureus USA 300, K. pneumoniae ATCC 700721, A. baumannii ATCC 17978, and P. aeruginosa PA01. C. difficile 630 growth inhibition was performed as described above, except cells were grown in BHI + 0.1% taurocholate for 18 hr in an anaerobic chamber (Coy Laboratory Products). M. tuberculosis H37Rv was grown at 37°C in Middlebrook 7H9 broth supplemented with 10% OADC (oleic acid-albumin-dextrose complex, vol/vol), 0.2% glycerol, and 0.05% Tween-80, or on Middlebrook 7H10 plates supplemented with 10% OADC and 0.5% glycerol. Cells were grown to mid-log phase, then added to 96-well plates at OD 600 = 0.0025, in a total of 50 μl of 7H9 medium. In addition, each well contained 45 μl of 7H9 medium and varying compound concentrations diluted in a total of 5 μl of medium. Plates were incubated at 37°C in a humidified container for 14 days. OD 600 was measured using a SpectraMax M5 plate reader.
Cells were grown overnight in 3 mL LB medium and diluted 1/10,000 into fresh LB. In 96-well flat-bottom plates (Corning), cells were grown to the required density, at which time antibiotic was added at the indicated concentration and cultures were incubated for the required duration. Cells were then pelleted in plates by centrifugation at 4000 x g for 15 min at 4°C and washed in ice cold PBS. After washing, cells were 10-fold serially diluted in PBS and plated on LB to quantify cell viability. In experiments where cells were incubated with antibiotic in nutrient-deplete conditions, cells were grown to the required density in LB media, washed in PBS, and subsequently resuspended in PBS prior to the addition of antibiotic. After cultures were incubated for the required duration, cells were pelleted in plates by centrifugation at 4000 x g for 15 min at 4°C and washed in ice cold PBS. After washing, cells were 10-fold serially diluted in PBS and plated on LB to quantify cell viability. M. tuberculosis H37Rv was grown to mid-log phase, then 30,000 cells were added to a 24 well plate in 1 mL of 7H9 medium. A sample from each well was taken as time = 0, prior to halicin addition, then halicin was added to each well at the 16 μg/ml (1x MIC). At the indicated time points, samples were taken from each well and plated on 7H10. Control wells contained the relevant DMSO concentration without halicin. Plates were incubated at 37°C and counted twice after 4 and 6 weeks.
For serial passage evolution, E. coli BW25113 was grown overnight in 3 mL LB medium and diluted 1/10,000 into fresh LB. Cells were grown in 96-well flat-bottom plates (Corning), in the presence of varying concentrations of halicin (or ciprofloxacin) at two-fold serial dilutions, in final volumes of 100 μl. Plates were incubated at 37°C without shaking for 24 hr, at which time they were read at 600 nm using a SpectraMax M3 plate reader. After 24 hr, cells that grew in the presence of the highest concentration of halicin (or ciprofloxacin) were diluted into fresh LB at the equivalent of 1/10,000 of a dense culture, and once again introduced to varying concentrations of halicin (or ciprofloxacin) at two-fold serial dilutions. This procedure was performed every 24 hr over the course of 30 days. For spontaneous suppressor generation, ∼10 9 CFU of E. coli BW25113 grown in LB media was spread onto LB agar in 10 cm Petri dishes, either without antibiotics or supplemented with ciprofloxacin (Millipore Sigma) or halicin (TCI Chemicals) at the indicated concentrations. Plates were subsequently incubated at 37°C for seven days, at which time colonies from each plate were re-streaked onto LB and LB supplemented with antibiotics at the same concentration on which the colonies were originally grown. These plates were grown at 37°C overnight to monitor re-growth. For strain engineering, E. coli BW25113 ΔnfsA ::kan ΔnfsB ::cat was derived from BW25113 ΔnfsA ::kan via introduction of a cat gene to disrupt the nfsB ORF using the Lambda Red method ( Datsenko and Wanner, 2000 13. Datsenko, K.A. ∙ Wanner, B.L. One-step inactivation of chromosomal genes in Escherichia coli K-12 using PCR products Proc. Natl. Acad. Sci. USA. 2000; 97 :6640-6645 Crossref Scopus (12009) PubMed Google Scholar ). Briefly, 2 mL 2x YT media with BW25113 ΔnfsA ::kan carrying the temperature-sensitive plasmid pKD46 at 30°C was induced with 20 mM arabinose. Upon reaching mid-log phase (OD 600 ∼0.5), cells were pelleted at 6000 x g for 2 min, then washed three times with 1 mL 15% glycerol. The final pellet was resuspended in 200 μl of 15% glycerol, and 50 μl was mixed with 300 ng of disruption fragment (generated using primers AB5044 and AB5045 on pKD32 to amplify the FRT-flanked cat cassette). Cells were electroporated at 1800 kV, then allowed to recover overnight in 5 mL 2x YT at 30°C. Cells were then pelleted at 6000 x g for 2 min, resuspended in 200 μl deionized water and plated on 2x YT agar plates with 15 μg/ml kanamycin (Millipore Sigma) and 20 μg/ml chloramphenicol (Millipore Sigma). Plates were incubated at 37°C for 24-48 hr. Single colonies were PCR checked (primers AB5046, AB5047) for loss of the nfsB gene (1069 bp) and appearance of the cat gene insertion (1472 bp). Finally, positive colonies were assayed for loss of pKD46 at 37°C by replica plating on 15 μg/ml kanamycin and 20 μg/ml chloramphenicol with or without 50 μg/ml carbenicillin (Millipore Sigma). AB5044 TAGCCGGGCAGATGCCCGGCAAGAGAGAATTACACTTCGGTTAAGGTGATATTCCGGGGATCCGTCGACC AB5045 ACCTTGTAATCTGCTGGCACGCAAAATTACTTTCACATGGAGTCTTTATGTGTAGGCTGGAGCTGCTTCG AB5046 tgcaaaataatatgcaccacgacggcggtcagaaaaataa AB5047 gaagcgttacttcgcgatctgatcaacgattcgtggaatc
Cells were grown overnight in 3 mL LB medium and diluted 1/10,000 into 50 mL fresh LB. When cultures reached ∼10 7 CFU/ml, halicin was added at 0.25x MIC (0.5 μg/ml), 1x MIC (2 μg/ml), or 4x MIC (8 μg/ml) and cells were incubated for the noted durations. After incubation, cells were harvested via centrifugation at 15,000 x g for 3 min at 4°C, and RNA was purified using the Zymo Direct-zol 96-well RNA purification kit (R2056). Briefly, ∼10 7 -10 8 CFU pellets were lysed in 500 μl hot Trizol reagent (Life Technologies). 200 μl chloroform (Millipore Sigma) was added, and samples were centrifuged at 15,000 x g for 3 min at 4°C. 200 μl of the aqueous phase was added to 200 μl anhydrous ethanol (Millipore Sigma), and RNA was purified using a Zymo-spin plate as per the manufacturer’s instructions. After purification, Illumina cDNA libraries were generated using a modified version of the RNAtag-seq protocol ( Shishkin et al., 2015 49. Shishkin, A.A. ∙ Giannoukos, G. ∙ Kucukural, A. ... Simultaneous generation of many RNA-seq libraries in a single reaction Nat. Methods. 2015; 12 :323-325 Crossref Scopus (194) PubMed Google Scholar ). Briefly, 500 ng – 1 μg of total RNA was fragmented, depleted of genomic DNA, dephosphorylated, and ligated to DNA adapters carrying 5′-AN 8 -3′ barcodes of known sequence with a 5′ phosphate and a 3′ blocking group. Barcoded RNAs were pooled and depleted of rRNA using the RiboZero rRNA depletion kit (Epicenter). Pools of barcoded RNAs were converted to Illumina cDNA libraries in two main steps: (1) reverse transcription of the RNA using a primer designed to the constant region of the barcoded adaptor with addition of an adaptor to the 3′ end of the cDNA by template switching using SMARTScribe (Clontech), as previously described ( Zhu et al., 2001 70. Zhu, Y.Y. ∙ Machleder, E.M. ∙ Chenchik, A. ... Reverse transcriptase template switching: a SMART approach for full-length cDNA library construction Biotechniques. 2001; 30 :892-897 Crossref Scopus (611) PubMed Google Scholar ); and (2) PCR amplification using primers whose 5′ ends target the constant regions of the 3′ or 5′ adaptors and whose 3′ ends contain the full Illumina P5 or P7 sequences. cDNA libraries were sequenced on the Illumina NextSeq 500 platform to generate paired end reads. Following sequencing, reads from each sample in a pool were demultiplexed based on their associated barcode sequence. Up to one mismatch in the barcode was allowed, provided it did not make assignment of the read to a different barcode possible. Barcode sequences were removed from the first read, as were terminal G’s from the second read that may have been added by SMARTScribe during template switching. Next, reads were aligned to the E. coli MG1655 genome (NC_000913.3) using BWA ( Li and Durbin, 2009 32. Li, H. ∙ Durbin, R. Fast and accurate short read alignment with Burrows-Wheeler transform Bioinformatics. 2009; 25 :1754-1760 Crossref Scopus (32781) PubMed Google Scholar ) and read counts were assigned to genes and other genomic features. Differential expression analysis was conducted with DESeq2 ( Love et al., 2014 35. Love, M.I. ∙ Huber, W. ∙ Anders, S. Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2 Genome Biol. 2014; 15 :550 Crossref Scopus (48497) PubMed Google Scholar ) and/or edgeR ( Robinson et al., 2010 45. Robinson, M.D. ∙ McCarthy, D.J. ∙ Smyth, G.K. edgeR: a Bioconductor package for differential expression analysis of digital gene expression data Bioinformatics. 2010; 26 :139-140 Crossref Scopus (26732) PubMed Google Scholar ). To verify coverage, visualization of raw sequencing data and coverage plots in the context of genome sequences and gene annotations was conducted using GenomeView ( Abeel et al., 2012 1. Abeel, T. ∙ Van Parys, T. ∙ Saeys, Y. ... GenomeView: a next-generation genome browser Nucleic Acids Res. 2012; 40 :e12 Crossref Scopus (113) PubMed Google Scholar ). To determine biological response of cells as a function of halicin exposure, we performed hierarchical clustering of the gene expression profiles using the clustergram function in MATLAB 2016a. We selected the Euclidean distance as the metric to define the pairwise distance between observations, which measures a straight-line distance between two points. The use of Euclidian distance has been considered as the most appropriate to cluster log-ratio data ( D’haeseleer, 2005 12. D’haeseleer, P. How does gene expression clustering work? Nat. Biotechnol. 2005; 23 :1499-1501 Crossref Scopus (397) PubMed Google Scholar ). With a metric defined, we next selected the average linkage as the clustering method. The average linkage uses the algorithm called unweighted pair group method with arithmetic mean (UPGMA), which is the most popular and preferred algorithm for hierarchical data clustering ( Jaskowiak et al., 2014; Loewenstein et al., 2008 25. Jaskowiak, P.A. ∙ Campello, R.J. ∙ Costa, I.G. On the selection of appropriate distances for gene expression data clustering BMC Bioinformatics. 2014; 15 :S2 Crossref Scopus (109) PubMed Google Scholar 34. Loewenstein, Y. ∙ Portugaly, E. ∙ Fromer, M. ... Efficient algorithms for accurate hierarchical clustering of huge datasets: tackling the entire protein space Bioinformatics. 2008; 24 :i41-i49 Crossref Scopus (104) PubMed Google Scholar ). UPGMA uses the mean similarity across all cluster data points to combine the nearest two clusters into a higher-level cluster. UPGMA assumes there is a constant rate of change among species (genes) analyzed. We tested all alternative clustering metrics available (i.e., Spearman, Hamming, cosine, etc.) in the pdist function within the clustergram function in MATLAB and concluded that the Euclidean metric together with the average linkage allow the clearest and probably most meaningful definition of clusters for our dataset. Transcript cluster enrichment was performed using EcoCyc Pathway Tools ( Karp, 2001; Karp et al., 2016; Keseler et al., 2013 26. Karp, P.D. Pathway databases: a case study in computational symbolic theories Science. 2001; 293 :2040-2044 Crossref Scopus (176) PubMed Google Scholar 27. Karp, P.D. ∙ Latendresse, M. ∙ Paley, S.M. ... Pathway Tools version 19.0 update: software for pathway/genome informatics and systems biology Brief. Bioinform. 2016; 17 :877-890 Crossref Scopus (181) PubMed Google Scholar 28. Keseler, I.M. ∙ Mackie, A. ∙ Peralta-Gil, M. ... EcoCyc: fusing model organism databases with systems biology Nucleic Acids Res. 2013; 41 :D605-D612 Crossref Scopus (437) PubMed Google Scholar ). P value s were calculated using Fisher’s exact test.
S. aureus USA300 and E. coli MC1061 were streaked onto LB agar and grown overnight at 37°C. Single colonies were picked and used to inoculate 50 mL LB in 250 mL baffled flasks, which were incubated for 3.5 hr in a 37°C incubator shaking at 250 rpm. Cultures were pelleted at 4000 x g for 15 min and washed three times in buffer. For E. coli , the buffer was 5 mM HEPES with 20 mM glucose (pH 7.2). For S. aureus , the buffer was 50 mM HEPES with 300 mM KCl and 0.1% glucose (pH 7.2). Both cell densities were normalized to OD 600 ∼0.1, loaded with 1 μM DiSC 3 (5) dye (3,3′-dipropylthiadicarbocyanine iodide), and left to rest for 10 min in the dark for probe fluorescence to stabilize. Fluorescence was measured in a cuvette-based fluorometer with stirring (Photon Technology International) at 620 nm excitation and 670 nm emission wavelengths. A time-course acquisition was performed, with compounds injected after 60 s of equilibration to measure increases or decreases in fluorescence. For E. coli , polymyxin B was used as a control to monitor Δ ψ dissipation. For S. aureus , valinomycin was used as a Δ ψ control and nigiricin was used as a Δ pH control. Upon addition of antibiotic, fluorescence was read continuously for 3 min and at an endpoint of 4 hr.
Experiments were conducted according to guidelines set by the Canadian Council on Animal Care, using protocols approved by the Animal Review Ethics Board at McMaster University under Animal Use Protocol #17-03-10. Before infection, mice were relocated at random from a housing cage to treatment or control cages. No animals were excluded from analyses, and blinding was considered unnecessary. Six- to eight-week old BALB/c mice were pretreated with 150 mg/kg (day −4) and 100 mg/kg (day −1) of cyclophosphamide to render mice neutropenic. Mice were then anesthetized using isofluorane and administered the analgesic buprenorphine (0.1 mg/kg) intraperitoneally. A 2 cm 2 abrasion on the dorsal surface of the mouse was inflicted through tape-stripping to the basal layer of epidermis using approximately 25-30 pieces of autoclave tape. Mice were infected with ∼2.5x10 5 CFU A. baumannii CDC 288 directly pipetted on the wounded skin. The infection was established for 1 hr prior to treatment with Glaxal Base supplemented with vehicle (0.5% DMSO) or halicin (0.5% w/v). Groups of mice were treated 1 hr, 4 hr, 8 hr, 12 hr, 20 hr, and 24 hr post-infection. Mice were euthanized at the experimental endpoint of 25 hr and the wounded tissue collected, homogenized, and plated onto LB to quantify bacterial load.
Experiments were conducted according to protocol IS00000852-3, approved by Harvard Medical School Institutional Animal Care and Use Committee and the Committee on Microbiological Safety. C. difficile 630 spores were prepared from a single batch and stored long term at 4°C, as previously reported ( Edwards and McBride, 2016 16. Edwards, A.N. ∙ McBride, S.M. Isolating and purifying Clostridium difficile spores Methods Mol. Biol. 2016; 1476 :117-128 Crossref Scopus (52) PubMed Google Scholar ). To disrupt colonization resistance and enable infection with C. difficile , four colonies (n = 20) of six- to eight-week-old C57BL/6 mice were administered 200 mg/kg ampicillin every 24 hr for 72 hr via intraperitoneal injection. Antibiotic-treated mice were given 24 hr to recover prior to infection with C. difficile . A total of 5x10 3 spores of C. difficile strain 630 was delivered via oral gavage and mice were randomly assigned to three treatment groups: 50mg/kg metronidazole (n = 7), 15 mg/kg halicin (n = 7) and 10% PEG 300 vehicle (n = 6). We note here that three mice from the halicin treatment group failed to display C. difficile colonization. Beginning at 24 hr after C. difficile challenge, mice were gavaged with antibiotics or vehicle control every 24 hr for five days. To monitor C. difficile colonization, fecal samples were collected, weighed and diluted under anaerobic conditions with anaerobic PBS. CFUs were quantified using TCCFA plates supplemented with 50 μg/ml erythromycin at 37°C under anaerobic conditions, as previously described ( Winston et al., 2016 61. Winston, J.A. ∙ Thanissery, R. ∙ Montgomery, S.A. ... Cefoperazone-treated mouse model of clinically-relevant Clostridium difficile strain R20291 J. Vis. Exp. 2016; 54850 Google Scholar ).
Chemprop code is available at: https://github.com/swansonk14/chemprop .
RNA sequencing data is available at the NCBI Sequence Read Archive under accession PRJNA598708.
A web-based version of the antibiotic prediction model described herein is available at: http://chemprop.csail.mit.edu/ .

Section: Acknowledgments

We thank Caleb Bashor from Rice University for valuable discussions, Gerry Wright from McMaster University for antibiotic-resistant strains of E. coli , and Michael Gilmore from Harvard Medical School for S. aureus RN4220 and Δ dsp1 . This work was supported by the Abdul Latif Jameel Clinic for Machine Learning in Health; the Defence Threat Reduction Agency (HDTRA1-15-1-0051 to J.J.C.); the Broad Institute of MIT and Harvard (to J.J.C.); the DARPA Make-It program under contract Army Research Office (W911NF-16-2-0023 to T.S.J. and R.B.); the Defence Threat Reduction Agency (HR00111920025 to T.S.J. and R.B.); the Canadian Institutes of Health Research (FRN 143215 to E.D.B.); the Canadian Foundation for Innovation (to E.D.B.); the Canada Research Chairs Program (Tier 1 to E.D.B.); the Banting Fellowships Program (393360 to J.M.S.); the Canadian Institutes of Health Research (scholarship to C.R.M.); the Human Frontier Science Program (LT000975/2016-L to Z.B.-A.); the Broad Institute Tuberculosis Donor Group and the Pershing Square Foundation (to Z.B.-A. and V.M.T.); the Swiss National Science Foundation (P2ELP2_181884 to A.C.-P.); the Broad Institute of MIT and Harvard (to A.H.B.); NIH Early Investigator Award (DP5-OD-024590 to A.H.B.); the National Science Foundation Graduate Research Fellowship Program (1122374 to I.W.A.); and by a generous gift from Anita and Josh Bekenstein.
Conceptualization, J.M.S., T.S.J., R.B., and J.J.C.; Model Development and Training, J.M.S., K.Y., K.S., W.J., and I.W.A.; Mechanistic Investigations, J.M.S., S.F., Z.B.-A., V.M.T., A.C.-P., and A.H.B.; Mouse Models, A.C.-R., N.M.D., C.R.M., and L.A.C.; Data Representation, J.M.S. and E.J.C.; Manuscript – Writing & Editing, J.M.S., K.Y., K.S., I.W.A., R.B., and J.J.C.; Funding Acquisition, J.M.S., A.H.B., E.D.B., T.S.J., R.B., and J.J.C.; Supervision, G.M.C., E.D.B., T.S.J., R.B., and J.J.C.
J.J.C. is scientific co-founder and SAB chair of EnBiotix, an antibiotic drug discovery company.

Section: Supplemental Information (7)

Download all Spreadsheet (296.82 KB) Table S1. Model Training Using a Library of 2,560 Molecules, Related to Figure 2 (A) Primary screening data of the 2,560-molecule training library. (B) Rank-ordered de-duplicated primary screening dataset. Spreadsheet (1.34 MB) Table S2. Drug Repurposing Hub Predictions, Related to Figure 2 (A) List of RDKit molecular features used to augment the D-MPNN. (B) Prediction scores of molecules from the Drug Repurposing Hub that were not found in the training dataset. (C) Prediction scores of molecules from the Drug Repurposing Hub that were not found in the training dataset (learned features only). (D) Prediction scores of molecules from the Drug Repurposing Hub that were not found in the training dataset (RDKit features only). (E) Prediction scores of molecules from the Drug Repurposing Hub that were not found in the training dataset (feed forward DNN using Morgan fingerprints). (F) Prediction scores of molecules from the Drug Repurposing Hub that were not found in the training dataset (random forest classifier using Morgan fingerprints). (G) Prediction scores of molecules from the Drug Repurposing Hub that were not found in the training dataset (SVM model using Morgan fingerprints). (H) Tanimoto similarity of training dataset molecules to halicin. Spreadsheet (12.73 KB) Table S3. Antibiotic-Resistant CDC Strains Used for Halicin Efficacy Assays, Related to Figure 3 Spreadsheet (1.29 MB) Table S4. Whole Transcriptome Sequencing of E. coli Treated with Halicin, Related to Figure 4 (A) 0.25x MIC. (B) 1x MIC. (C) 4x MIC. Spreadsheet (25.64 KB) Table S5. Prediction Scores and Optical Density Values of the Top 200 (Yellow) and Bottom 100 (Blue) WuXi Molecules against E. coli, Related to Figure 6 Spreadsheet (2.25 MB) Table S6. ZINC15 Database Predictions, Related to Figure 6 (A) ZINC15 molecules with prediction score > 0.7. (B) Prediction scores of the top 6,820 molecules from the ZINC15 database (learned features only). (C) Prediction scores of the top 6,820 molecules from the ZINC15 database (RDKit features only). (D) Prediction scores of the top 6,820 molecules from the ZINC15 database (feed forward DNN using Morgan fingerprints). (E) Prediction scores of the top 6,820 molecules from the ZINC15 database (random forest classifier using Morgan fingerprints). (F) Prediction scores of the top 6,820 molecules from the ZINC15 database (SVM model using Morgan fingerprints). Spreadsheet (26.10 KB) Table S7. Empirical Validation of ZINC15 Predictions, Related to Figure 6 (A) ZINC15 predictions used for empirical validation. (B) Ranks of the 8 correctly predicted ZINC15 molecules across different models.
