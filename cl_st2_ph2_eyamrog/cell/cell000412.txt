Title: A neural circuit state change underlying skilled movements


Abstract: Summary

In motor neuroscience, state changes are hypothesized to time-lock neural assemblies coordinating complex movements, but evidence for this remains slender. We tested whether a discrete change from more autonomous to coherent spiking underlies skilled movement by imaging cerebellar Purkinje neuron complex spikes in mice making targeted forelimb-reaches. As mice learned the task, millimeter-scale spatiotemporally coherent spiking emerged ipsilateral to the reaching forelimb, and consistent neural synchronization became predictive of kinematic stereotypy. Before reach onset, spiking switched from more disordered to internally time-locked concerted spiking and silence. Optogenetic manipulations of cerebellar feedback to the inferior olive bi-directionally modulated neural synchronization and reaching direction. A simple model explained the reorganization of spiking during reaching as reflecting a discrete bifurcation in olivary network dynamics. These findings argue that to prepare learned movements, olivo-cerebellar circuits enter a self-regulated, synchronized state promoting motor coordination. State changes facilitating behavioral transitions may generalize across neural systems.

Section: Introduction

Inspired by phase transitions of physical matter, theoretical neuroscientists have intensively studied neural network models with transitions between different dynamical states. Akin to liquid or solid matter, collective neural activity patterns in these models often defy straightforward predictions based on the attributes of the constituents. The transitions are usually between a state of ordered or coherent network activity and one of more disordered activity ( Chialvo, 2010 14. Chialvo, D.R. Emergent complex neural dynamics Nat. Phys. 2010; 6 :744-750 Crossref Scopus (748) Google Scholar ; Hopfield, 1982 37. Hopfield, J.J. Neural networks and physical systems with emergent collective computational abilities Proc. Natl. Acad. Sci. USA. 1982; 79 :2554-2558 Crossref Scopus (13045) PubMed Google Scholar ; Rajan et al., 2010 67. Rajan, K. ∙ Abbott, L.F. ∙ Sompolinsky, H. Stimulus-dependent suppression of chaos in recurrent neural networks Phys. Rev. E Stat. Nonlin. Soft Matter Phys. 2010; 82 :011903 Crossref Scopus (183) PubMed Google Scholar ; Schneidman et al., 2006 70. Schneidman, E. ∙ Berry, 2nd, M.J. ∙ Segev, R. ... Weak pairwise correlations imply strongly correlated network states in a neural population Nature. 2006; 440 :1007-1012 Crossref Scopus (1194) PubMed Google Scholar ). These states can allow individual cells to have different levels of spiking autonomy and distinct timing and coding properties and can yield different behavioral outputs ( Abbott and Rohrkemper, 2007 1. Abbott, L.F. ∙ Rohrkemper, R. A simple growth model constructs critical avalanche networks Cisek, T.D. Paul ∙ John, F.K. (Editors) Progress in Brain Research Elsevier, 2007; 13-19 Google Scholar ; Kelso, 2012 41. Kelso, J.A.S. Multistability and metastability: understanding dynamic coordination in the brain Philos. Trans. R. Soc. Lond. B Biol. Sci. 2012; 367 :906-918 Crossref Scopus (378) PubMed Google Scholar ; Poil et al., 2012 66. Poil, S.-S. ∙ Hardstone, R. ∙ Mansvelder, H.D. ... Critical-state dynamics of avalanches and oscillations jointly emerge from balanced excitation/inhibition in neuronal networks J. Neurosci. 2012; 32 :9817-9823 Crossref Scopus (246) PubMed Google Scholar ). Thus, it is crucial to identify state transitions and how they may re-shape cellular activity and animal behavior.
In the motor system, the active regulation and internal synchronization of neural assemblies may help coordinate the muscles for specific actions ( Churchland et al., 2010 15. Churchland, M.M. ∙ Yu, B.M. ∙ Cunningham, J.P. ... Stimulus onset quenches neural variability: a widespread cortical phenomenon Nat. Neurosci. 2010; 13 :369-378 Crossref Scopus (702) PubMed Google Scholar ; Feige et al., 2000 25. Feige, B. ∙ Aertsen, A. ∙ Kristeva-Feige, R. Dynamic synchronization between multiple cortical motor areas and muscle activity in phasic voluntary movements J. Neurophysiol. 2000; 84 :2622-2629 Crossref Scopus (119) PubMed Google Scholar ; Riehle et al., 1997 68. Riehle, A. ∙ Grün, S. ∙ Diesmann, M. ... Spike synchronization and rate modulation differentially involved in motor cortical function Science. 1997; 278 :1950-1953 Crossref Scopus (742) PubMed Google Scholar ; Welsh et al., 1995 81. Welsh, J.P. ∙ Lang, E.J. ∙ Suglhara, I. ... Dynamic organization of motor control within the olivocerebellar system Nature. 1995; 374 :453-457 Crossref Scopus (526) PubMed Google Scholar ). This view suggests there should be circuitry that adjusts its internal dynamical cohesion to serve motor control. Notably, the olivocerebellum has features that might facilitate such state changes. Inferior olivary neurons have subthreshold voltage oscillations and electrical synapses that synchronize these rhythms ( De Zeeuw et al., 1998 20. De Zeeuw, C.I. ∙ Simpson, J.I. ∙ Hoogenraad, C.C. ... Microcircuitry and function of the inferior olive Trends Neurosci. 1998; 21 :391-400 Full Text Full Text (PDF) Scopus (351) PubMed Google Scholar ; Llinás and Yarom, 1986 51. Llinás, R. ∙ Yarom, Y. Oscillatory properties of guinea-pig inferior olivary neurones and their pharmacological modulation: an in vitro study J. Physiol. 1986; 376 :163-182 Crossref Scopus (466) PubMed Google Scholar ). The resulting synchronized spikes drive synchronized complex (Na + and Ca 2+ ) spikes in cerebellar Purkinje cells, each of which receives potent input from one olivary climbing fiber that, when activated, reliably evokes a complex spike ( Ozden et al., 2009 61. Ozden, I. ∙ Sullivan, M.R. ∙ Lee, H.M. ... Reliable coding emerges from coactivation of climbing fibers in microbands of cerebellar Purkinje neurons J. Neurosci. 2009; 29 :10463-10473 Crossref Scopus (94) PubMed Google Scholar ; Schultz et al., 2009 71. Schultz, S.R. ∙ Kitamura, K. ∙ Post-Uiterweer, A. ... Spatial pattern coding of sensory information by climbing fiber-evoked calcium signals in networks of neighboring cerebellar Purkinje cells J. Neurosci. 2009; 29 :8005-8015 Crossref Scopus (99) PubMed Google Scholar ). Inhibitory feedback from cerebellum may regulate olivary cells’ electrical coupling and spiking synchrony ( Best and Regehr, 2009 8. Best, A.R. ∙ Regehr, W.G. Inhibitory regulation of electrically coupled neurons in the inferior olive is mediated by asynchronous release of GABA Neuron. 2009; 62 :555-565 Full Text Full Text (PDF) Scopus (106) PubMed Google Scholar ; Van Der Giessen et al., 2008 78. Van Der Giessen, R.S. ∙ Koekkoek, S.K. ∙ van Dorp, S. ... Role of olivary electrical coupling in cerebellar motor learning Neuron. 2008; 58 :599-612 Full Text Full Text (PDF) Scopus (176) PubMed Google Scholar ).
Synchronous complex spiking by Purkinje cells accompanies rhythmic motor behaviors ( Hoogland et al., 2015 36. Hoogland, T.M. ∙ De Gruijl, J.R. ∙ Witter, L. ... Role of synchronous activation of cerebellar Purkinje cell ensembles in multi-joint movement control Curr. Biol. 2015; 25 :1157-1165 Full Text Full Text (PDF) Scopus (79) PubMed Google Scholar ; Welsh et al., 1995 81. Welsh, J.P. ∙ Lang, E.J. ∙ Suglhara, I. ... Dynamic organization of motor control within the olivocerebellar system Nature. 1995; 374 :453-457 Crossref Scopus (526) PubMed Google Scholar ), but whether this represents a transition into a coherent dynamical state to coordinate skilled movements is unknown. The mere presence of synchronous activity does not imply a discrete switch into a coherent state. By analogy, a car’s wheels and engine parts both move faster when the car accelerates, but this on its own does not imply the existence of a gearbox that can abruptly alter the basic temporal relationships in how the mechanical parts interact. Likewise, rhythmic spiking by Purkinje cells during rhythmic licking or locomotion might simply reflect movement-locked rhythmic inputs, not a state transition.
We studied reaching movements and looked for hallmark features of coherent dynamics and a state transition. First, if, as proposed, coherent activity supports motor coordination, one expects this coherence to increase as animals gain motor proficiency. Second, if synchronized firing truly acts as a metronome to coordinate movement, a coherent state should be internally time-locked at a finer time-scale than movement-locked changes in spike rates. Third, in a coherent state there should be cell assemblies that encode motor kinematics via their internally synchronized dynamics, not just as independent, individual cells. Fourth, one expects a circuit with coherent dynamics should have internal mechanisms to regulate synchronization.
To study these facets of neural activity, we trained mice to make targeted reaches as they grasped a robotic arm. Meanwhile, we imaged Purkinje cells’ complex spiking activity in parts of the cerebellar vermis involved in forelimb control ( Apps and Hawkes, 2009 3. Apps, R. ∙ Hawkes, R. Cerebellar cortical organization: a one-map hypothesis Nat. Rev. Neurosci. 2009; 10 :670-681 Crossref Scopus (376) PubMed Google Scholar ). As mice improved at the task, reliable neural synchronization arose across millimeter-sized areas of the vermis and was predictive of kinematic stereotypy. Starting before task execution, there was a transition into a coherent, internally time-locked state that involved a burst of synchronized complex spikes. The burst’s timing varied systematically across the cerebellar surface and was often followed by a coordinated silence among the visible Purkinje cells. When we perturbed reaching mid-trajectory, synchronized Purkinje cells signaled the disruption collectively, not as independent cells. Bi-directional manipulations of cerebellar feedback to the inferior olive led to bi-directional changes in synchronized complex spiking at reach onset, showing that the olivocerebellum regulates its dynamics in a way that is gated to movement initiation.
These results argue that at onset of skilled movements the olivocerebellum switches from a baseline condition, in which Purkinje cells fire complex spikes more autonomously, to a coherent state with spatiotemporally organized activity that promotes high-quality motions. A simple model shows that this re-configuration of spiking, including enhanced synchronized spiking and concerted neural silence, likely results from a discrete bifurcation in the olivary network’s collective dynamics. This concise explanation suggests that motor circuits shift between distinct operating modes and that behavioral state changes can be triggered by more than just variations in spike rates. Instead, neural circuits can control behavioral transitions via discrete transitions in the patterning of neural activity in time and space. Such discrete transitions are analogous to those between states of physical matter, and circuits beyond the olivocerebellum may use them as a way of switching between behaviors.

Section: Results

To study skilled actions, we built a robot to record (200 Hz sampling; 3–6 μm accuracy) and manipulate (1 kHz closed-loop bandwidth) movements of the robot’s handle ( STAR Methods ). We trained mice to direct the handle with their right forepaw from a starting position near the body to a forward target zone ( Figures 1 A and S1 A). At first, the robot constrained reaching to a linear path. After mice trained for ∼3 days, the robot allowed arbitrary motions in the forward horizontal plane ( Figures 1 B and 1C), and mice received a reward 1 s after well-targeted reaches. Early in learning, reaching was often off-target, but with training (5–11 days) targeting errors and kinematic variability declined ( Figures 1 B–1E and S1 B–S1G). By their last session, mice made 283 ± 28 reaches per session (mean ± SEM; 18 mice) and reaching took 202 ± 62 ms (mean ± SD).
To survey Purkinje cell dynamics, we used a two-photon mesoscope with 16 laser beams ( Rumyantsev et al., 2020 69. Rumyantsev, O.I. ∙ Lecoq, J.A. ∙ Hernandez, O. ... Fundamental bounds on the fidelity of sensory cortical coding Nature. 2020; 580 :100-105 Crossref Scopus (98) PubMed Google Scholar ) to image a 4-mm 2 area of the vermis (lobules V and VI). While this area is likely heterogeneous, much of it receives afferents from and is activated by ipsilateral forelimb movements ( Diedrichsen et al., 2005 22. Diedrichsen, J. ∙ Hashambhoy, Y. ∙ Rane, T. ... Neural correlates of reach errors J. Neurosci. 2005; 25 :9919-9931 Crossref Scopus (489) PubMed Google Scholar ; Jörntell et al., 2000 40. Jörntell, H. ∙ Ekerot, C. ∙ Garwicz, M. ... Functional organization of climbing fibre projection to the cerebellar anterior lobe of the rat J. Physiol. 2000; 522 :297-309 Crossref Scopus (55) PubMed Google Scholar ; Pasalar et al., 2006 62. Pasalar, S. ∙ Roitman, A.V. ∙ Durfee, W.K. ... Force field effects on cerebellar Purkinje cell discharge with implications for internal models Nat. Neurosci. 2006; 9 :1404-1411 Crossref Scopus (153) PubMed Google Scholar ; Wagner et al., 2019 80. Wagner, M.J. ∙ Kim, T.H. ∙ Kadmon, J. ... Shared Cortex-Cerebellum Dynamics in the Execution and Learning of a Motor Task Cell. 2019; 177 :669-682.e24 Full Text Full Text (PDF) Scopus (115) PubMed Google Scholar ). Ca 2+ imaging in Purkinje cell dendrites reliably reports complex spikes ( Mukamel et al., 2009 56. Mukamel, E.A. ∙ Nimmerjahn, A. ∙ Schnitzer, M.J. Automated analysis of cellular signals from large-scale calcium imaging data Neuron. 2009; 63 :747-760 Full Text Full Text (PDF) Scopus (473) PubMed Google Scholar ; Ozden et al., 2009 61. Ozden, I. ∙ Sullivan, M.R. ∙ Lee, H.M. ... Reliable coding emerges from coactivation of climbing fibers in microbands of cerebellar Purkinje neurons J. Neurosci. 2009; 29 :10463-10473 Crossref Scopus (94) PubMed Google Scholar ; Schultz et al., 2009 71. Schultz, S.R. ∙ Kitamura, K. ∙ Post-Uiterweer, A. ... Spatial pattern coding of sensory information by climbing fiber-evoked calcium signals in networks of neighboring cerebellar Purkinje cells J. Neurosci. 2009; 29 :8005-8015 Crossref Scopus (99) PubMed Google Scholar ), and we thereby tracked complex spiking for 8 days as mice learned the reaching task (332 ± 19 cells per session; mean ± SEM, 24 sessions; 3 mice; Figures 2 A–2L).
Early in learning, complex spiking was weakly time-locked to reaching, and there was little temporal consistency between different cells ( Figure 2 F). As learning progressed, cells in the right vermis gained more stereotypical and time-locked responses to the reaching motion ( Figures 2 C–2E), consistent with their preferential control of ipsilateral body parts ( Apps and Hawkes, 2009 3. Apps, R. ∙ Hawkes, R. Cerebellar cortical organization: a one-map hypothesis Nat. Rev. Neurosci. 2009; 10 :670-681 Crossref Scopus (376) PubMed Google Scholar ; Gao et al., 2012 28. Gao, Z. ∙ van Beugen, B.J. ∙ De Zeeuw, C.I. Distributed synergistic plasticity and cerebellar learning Nat. Rev. Neurosci. 2012; 13 :619-635 Crossref Scopus (382) PubMed Google Scholar ). Purkinje cells in the right vermis also grew more homogeneous in the timing of their responses, starting before motion onset ( Figures 2 D, 2F, and 2G). Left vermis Purkinje cells were far less synchronized ( Figures 2 C–2E).
With motor learning, Purkinje cells’ dynamics grew more correlated with those of other Purkinje cells up to ∼1 mm away, especially during reaching ( Figures 2 J and S2 A–S2D). The spatiotemporal coherence of complex spiking activity rose with learning, such that the mean time lag between closely timed complex spikes rose with the distance between cells, as if a wavefront of increased spiking probability propagated ∼1 mm or more across cerebellar cortex ( Figures S2 E–S2J). Propagation was usually aligned within ∼10° of the anterior-posterior axis (mean ± SEM speed: 10 ± 0.2 μm/ms), more commonly from anterior to posterior ( Figure S2 H).
To analyze synchronization on single reaching trials, we examined the fraction of visible Purkinje cells that was active at each time point. Early in learning, cells were weakly synchronized, and the timing of peak synchronization varied greatly trial-to-trial; later in learning, synchronization became stronger, more stereotyped ( Figures 2 H–2K) and spatially organized ( Figures S2 I and S2J). Mean levels of peak synchronization rose with learning and correlated with improved reaching performance ( Figures 2 K and 2L). Thus, Purkinje cells’ task-locked and synchronized activity developed with experience and was not just a generic reflection of movement but instead reflected trained proficiency.
If synchronization reflects internal timing signals for motor coordination, it should be related to kinematic output. To test this idea, we studied how synchronization relates to reaching kinematics in expert mice. For these and all subsequent studies, we sought recordings of finer time-resolution and used a conventional two-photon microscope for Ca 2+ -imaging in zone AX of lobule V in the right vermis (110 μm × 270 μm fields-of-view; 46 ± 4 Purkinje cells (mean ± SEM) per session; 695 cells total in 15 mice; Figure 3 A). In rodents, this area is a main recipient of forelimb-related input and is homologous to the forelimb-related X vermal and C1/C3 paravermal zones in other species ( Apps and Hawkes, 2009 3. Apps, R. ∙ Hawkes, R. Cerebellar cortical organization: a one-map hypothesis Nat. Rev. Neurosci. 2009; 10 :670-681 Crossref Scopus (376) PubMed Google Scholar ; Buisseret-Delmas et al., 1993 11. Buisseret-Delmas, C. ∙ Yatim, N. ∙ Buisseret, P. ... The X zone and CX subzone of the cerebellum in the rat Neurosci. Res. 1993; 16 :195-207 Crossref Scopus (38) PubMed Google Scholar ; Garwicz et al., 1998 29. Garwicz, M. ∙ Jörntell, H. ∙ Ekerot, C.-F. Cutaneous receptive fields and topography of mossy fibres and climbing fibres projecting to cat cerebellar C3 zone J. Physiol. 1998; 512 :277-293 Crossref Scopus (91) PubMed Google Scholar ; Jörntell et al., 2000 40. Jörntell, H. ∙ Ekerot, C. ∙ Garwicz, M. ... Functional organization of climbing fibre projection to the cerebellar anterior lobe of the rat J. Physiol. 2000; 522 :297-309 Crossref Scopus (55) PubMed Google Scholar ). To study the timing accuracy of these data, we made joint optical and electrical recordings of individual cells. There was >90% concordance across the two sets of complex spikes (5 dual recordings; Figures 3 B and S3 ). Using sub-image-frame timing data, optical recordings yielded spikes within ±6–11 ms (SD) of those recorded electrically ( Figure 3 C). Given this accuracy, all further analyses used 25-ms time bins to evaluate synchrony at time-scales finer than those of forelimb motion.
For each mouse, we ranked trials by how similar the reaching motion was to the mean trajectory, averaged over all trials ( Figures 3 D–3F and S4 ). Trials with the most stereotyped kinematics had much greater homogeneity in the pattern and timing of neural synchronization than the lowest-ranked trials ( Figures 3 G, S4 D, and S4I). Across trials, greater kinematic stereotypy was predictive of increased concerted spiking at the neural ensemble’s most likely response time ( Figures 3 H, 3I, S4 E, and S4J–S4L). Thus, the temporal patterning of synchronization covaried with single-trial kinematics, in line with the result that neural synchronization and reaching stereotypy rose in parallel across learning ( Figures 1 and 2 ).
On many trials, widespread synchronized spiking arose at reach onset ( Figures 4 A–4I), in line with reports of complex spike synchronization prior to locomotion ( Hoogland et al., 2015 36. Hoogland, T.M. ∙ De Gruijl, J.R. ∙ Witter, L. ... Role of synchronous activation of cerebellar Purkinje cell ensembles in multi-joint movement control Curr. Biol. 2015; 25 :1157-1165 Full Text Full Text (PDF) Scopus (79) PubMed Google Scholar ). Different cells had similar trial-averaged spiking patterns, but there were notable trial-to-trial variations in synchronized spiking that were shared across cells ( Figures 4 B and 4D–4F). Thus, cell-to-cell variations in trial-averaged activity were less than trial-to-trial variations in the timing of peak synchronized spiking, indicative of coherent spiking that arose at slightly different times on different trials but had a sharp temporal profile whenever it arose ( Figure 4 G).
To characterize the mean time-dependence of synchronized spiking, we identified times at which ≥20% of all visible Purkinje cells spiked in the same 25-ms time bin. This revealed, on average, a substantial rise in synchronization starting just prior to movement ( Figure 4 I). Individual cells partook in ∼20%–40% of these synchronized events (28% ± 12%; mean ± SD; 695 cells), preferentially so with other nearby cells ( Figures S5 A and S5B). However, a cell’s participation in synchronized spiking depended little on its mean spike rates during rest or reaching ( Figures S5 C–S5E).
During reaching trials there also arose periods of neural silence (∼200–300 ms in duration) across the full field of view ( Figures 4 B, 4F, 4H, and S5 F). We termed this “concerted silence”; like synchronized spiking, it arose sharply in time, without a preceding gradual change in spike rates ( Figure 4 H). Concerted silence was substantially more likely to arise within ±0.8 s of reach onset than in inter-trial intervals ( Figure S5 G; p = 6 × 10 −5 ; signed-rank test; 15 mice). Within this 1.6-s interval, silence was only modestly more likely to occur ∼200 ms after reach onset than beforehand ( Figure 4 I), suggesting it was associated with task execution but not necessarily with a specific facet of reaching motion.
To determine whether concerted spiking and silence reflected intrinsic synchronization, or whether cells had similar but independently modulated spike rates, we randomly shuffled cells’ activity traces across trials. This is an established way to distinguish task-driven from internally time-locked synchrony; trial-shuffling preserves the former but not the latter form of synchrony and allows one to account for the expected rise in coincident spikes that simply comes from elevated spiking ( Cafaro and Rieke, 2010 12. Cafaro, J. ∙ Rieke, F. Noise correlations improve response fidelity and stimulus encoding Nature. 2010; 468 :964-967 Crossref Scopus (98) PubMed Google Scholar ). In our stereotyped motor task, shuffling preserves spike timing with respect to the behavior but not single-trial correlations between cells at fine time-scales. To control for variations in motor output, we restricted shuffle analyses to reaches >6 mm in extent and <3 mm from the target.
The shuffled data showed only very weak, time-invariant synchronization ( Figures 4 I and S5 H–S5J), and the maximal synchronized spiking event and longest concerted silence ( Figures 4 J and 4K), as computed on individual trials, were both far lower than in real data. We also found the rates at which Purkinje cells fired 0–5 or more complex spikes concurrently in real versus shuffled data ( Figure S5 K). The real data had reduced activation of 1–2 cells at a time but more concerted silence and co-activation of ≥4 cells (increased silence and spiking by ≥4 cells, p < 0.001; permutation test). Thus, nearly all coherent dynamics in the real data were intrinsic and unaccounted for by task-related spiking increases.
To check whether body movements besides reaching might have influenced these results, we analyzed behavioral videos taken during Ca 2+ imaging and found scant differences in neural synchrony between trials with varying levels of body motion ( Figures S5 L–S5S). Trial-shuffling analyses restricted to trials with very similar body motions verified that a vast majority of synchronization was internally time-locked and did not arise from movement-locked changes in spiking ( Figure S5 S).
Is neural synchronization specific to reaching periods? To study this question, for a subset of expert mice, we identified periods between reaching trials with no visible body motion. We then matched resting and reaching epochs with comparable spike rates and compared the rates at which different numbers of Purkinje cells spiked together. Versus matched periods of rest, reaching suppressed small-scale activation involving 1, 2, or 3 co-active cells ( Figure 4 L; 8 mice, 302 cells, 1,693 reaches). Reaching epochs also exhibited more concerted silence (p < 10 −7 ; chi-squared test) and more frequent co-activation of ≥4 cells (p < 6·10 −4 for all firing rates >0.8 Hz).
Given the increased concerted silence during reaching, was it a better indicator of reaching than typical metrics such as mean spike rates? We evaluated ensemble mean spike rates and the total amount of concerted silence and found the latter to be a superior marker of reaching ( Figure 4 M, p = 0.016; signed-rank test; 8 mice). Given this and the increased synchronized spiking with reaching, we expected levels of concerted silence and synchronized spiking to be correlated trial by trial. Unexpectedly, this was not so ( Figure 4 N), ruling out a simple interpretation of concerted silence as a refractory period after synchronous spiking.
To explore mechanisms for concerted silence, we jointly imaged Purkinje cell dendrites and somatic Ca 2+ activity in molecular layer interneurons, which inhibit Purkinje cells. On some reaching trials, activation of all visible interneurons accompanied concerted silence in Purkinje cells ( Figures 5 A and 5B). These trials also had lower complex spike rates, without affecting the magnitudes of Purkinje cells’ Ca 2+ spikes ( Figures 5 C and 5D). Greater interneuron activity was significantly correlated with faster movement speeds and longer episodes of concerted silence ( Figures 5 E–5H). Thus, interneuron activation and Purkinje cell concerted silence likely reflect a common aspect of network synchronization, with the inhibitory inputs likely extending Purkinje cells’ silent epochs ( Discussion ).
To examine how internally synchronized neural dynamics might impact kinematic encoding, we tested whether cell ensembles convey signals that are not fully decipherable from single cell recordings. We studied a classic movement variable, unexpected self-motion ( Brooks et al., 2015 10. Brooks, J.X. ∙ Carriot, J. ∙ Cullen, K.E. Learning to expect the unexpected: rapid updating in primate cerebellum during voluntary self-motion Nat. Neurosci. 2015; 18 :1310-1317 Crossref Scopus (141) PubMed Google Scholar ; Brooks and Cullen, 2013 9. Brooks, J.X. ∙ Cullen, K.E. The primate cerebellum selectively encodes unexpected self-motion Curr. Biol. 2013; 23 :947-955 Full Text Full Text (PDF) Scopus (109) PubMed Google Scholar ), by using the robot to confine arm reaches to linear paths and perturb them mid-trajectory.
On most trials, the robot enforced a forward trajectory, but on a random subset of trials, midway through the reach the robot deflected the mouse’s paw left or right ( Figures 5 I and 5J). Forward motion was indistinguishable on these 3 trial-types (peak speed: 109 ± 3 mm/s, 105 ± 3 mm/s and 108 ± 2 mm/s, respectively, in 113 rightward, 115 leftward and 772 unperturbed trials by 3 mice; Figure 5 K). Strikingly, most Purkinje cells in the right vermis responded preferentially to leftward perturbations, after which both spike rates and synchronized spiking rose to significantly higher levels than after rightward perturbations or on unperturbed trials ( Figures 5 L–5N). Thus, like studies of eye movements ( Herzfeld et al., 2015 34. Herzfeld, D.J. ∙ Kojima, Y. ∙ Soetedjo, R. ... Encoding of action by the Purkinje cells of the cerebellum Nature. 2015; 526 :439-442 Crossref Scopus (202) PubMed Google Scholar ), our data show that complex spiking responses to unexpected perturbations can be lateralized. Apart from the brief period of elevated spiking after leftward perturbations, concerted silence was the same in all conditions ( Figure 5 O).
Given the high level of motion stereotypy enforced by the robot, we performed a trial-shuffling analysis. In real data, leftward perturbations evoked time-locked spikes from up to half the cells, whereas in shuffled data the perturbation-locked spiking responses led to synchronized spiking by only ∼10%–20% of cells ( Figure 5 P). Thus, Purkinje cells’ large-scale responses to an unexpected perturbation were synchronized internally, not just by the perturbation.
Given the evidence the olivocerebellum switches into a coherent state during skilled reaching, we examined how the network might regulate this transition. We focused on the inhibitory shunting feedback from the deep cerebellar nuclei to the olive. This pathway may modulate the synchrony of olivary spikes, and thereby of Purkinje cell complex spikes ( Lefler et al., 2014 50. Lefler, Y. ∙ Yarom, Y. ∙ Uusisaari, M.Y. Cerebellar inhibitory input to the inferior olive decreases electrical coupling and blocks subthreshold oscillations Neuron. 2014; 81 :1389-1400 Full Text Full Text (PDF) Scopus (96) PubMed Google Scholar ), but what role this feedback has during voluntary motion has been unknown.
To photo-inhibit or -excite this pathway during reaching, we expressed an opsin in olive-projecting cells of the cerebellar nuclei ( Figures 6 A, S6 A, and S6B). On a random subset (20%–30%) of trials, we illuminated the cerebellar fastigial nucleus from before reaching until after its completion. Inhibition of the nucleo-olivary pathway boosted mean complex spike rates and peak levels of complex spike synchronization, in a way that was accentuated at reach onset, while decreasing the frequency of concerted silence; photo-excitation of this pathway had the opposite effects ( Figures 6 B–6F). Photo-inhibition also led spiking to become more concentrated in time ( Figure 6 E).
To test whether perturbing nucleo-olivary signaling would impact reaching, we unilaterally illuminated the left or right fastigial nucleus. Unilateral nucleo-olivary inhibition biased forelimb motion in the ipsilateral direction, i.e., in the direction of the illuminated nucleus; unilateral excitation led to the opposite, contralateral targeting bias ( Figures 6 G–6I). Neither bilateral excitation nor inhibition altered reaching ( Figure S6 C), suggesting that reach targeting may be more sensitive to the balance of activity across the two feedback pathways than to its absolute levels. Unilateral excitation of the right (but not the left) fastigial nucleus, ipsilateral to the reaching forelimb and the Ca 2+ imaging site, reduced complex spike synchronization ( Figure S6 D). Thus, the nucleo-olivary pathway regulates complex spiking and its coherence, and the bilateral balance of these effects influences reach targeting.
The discrete changes to system properties that occur at state transitions are often well described by concise mathematical models that capture the essence of a phenomenon. Well-known successes include bifurcations in predator-prey relationships, and phase transitions and critical phenomena of physical matter ( Strogatz, 2015 74. Strogatz, S.H. Nonlinear Dynamics and Chaos CRC Press, 2015 Google Scholar ).
Given these past successes, the rhythmicity of olivary cells and their propensity to synchronize ( De Zeeuw et al., 1998 20. De Zeeuw, C.I. ∙ Simpson, J.I. ∙ Hoogenraad, C.C. ... Microcircuitry and function of the inferior olive Trends Neurosci. 1998; 21 :391-400 Full Text Full Text (PDF) Scopus (351) PubMed Google Scholar ; Llinás and Yarom, 1986 51. Llinás, R. ∙ Yarom, Y. Oscillatory properties of guinea-pig inferior olivary neurones and their pharmacological modulation: an in vitro study J. Physiol. 1986; 376 :163-182 Crossref Scopus (466) PubMed Google Scholar ), we explored whether a simple olivary network model of Kuramoto oscillator cells might capture our core results about complex spikes and their temporal re-organization during reaching. Kuramoto models have a set of phase oscillators, each with its own natural frequency, that are coupled together ( Kuramoto, 1984 46. Kuramoto, Y. Chemical Oscillations, Waves, and Turbulence Springer, 1984 Crossref Google Scholar ). These models describe synchronization-desynchronization transitions in a range of systems, and some versions exhibit bifurcations in their dynamics and wavelike phenomena ( Acebrón et al., 2005 2. Acebrón, J.A. ∙ Bonilla, L.L. ∙ Pérez Vicente, C.J. ... The Kuramoto model: A simple paradigm for synchronization phenomena Rev. Mod. Phys. 2005; 77 :137-185 Crossref Scopus (2487) Google Scholar )
In our treatment, the Kuramoto oscillators represent olivary cells, each with an intrinsic sub-threshold oscillation around 10 Hz (±2 Hz) ( STAR Methods ). Spiking occurs when excitatory inputs or noise drive the voltage above a threshold value. The level of phase synchronization is controlled by the coupling amplitude, κ ( Figure 7 A); in real olivary networks, inputs from the cerebellar nuclei modulate this coupling strength. We first modeled our data from conventional two-photon microscopy, in which the imaged Purkinje cells likely received inputs from highly coupled olivary cells ( Bazzigaluppi et al., 2012a 5. Bazzigaluppi, P. ∙ De Gruijl, J.R. ∙ van der Giessen, R.S. ... Olivary subthreshold oscillations and burst activity revisited Front. Neural Circuits. 2012; 6 :91 Crossref Scopus (50) PubMed Google Scholar ).
In the model, when κ is low, olivary cells oscillate incoherently. As κ rises, the cells converge to a common frequency and phase ( Figure 7 B). A mean-field theory treatment shows the network has 2 operating modes: when κ exceeds a critical value, there is a bifurcation inducing a switch from asynchronized to synchronized activity ( Figure 7 C). This state transition is one physicists term “second-order,” since the mean oscillatory coherence is a continuous function of κ, but its derivative is discontinuous, as seen by the steep rise in coherence as κ exceeds its critical value. Networks with a finite set of olivary cells had a transition approximating this bifurcation ( Figure 7 C).
To identify how a rise in κ at reach onset might alter complex spiking, we compared our model’s operating modes by transiently raising κ from below to above its critical value ( Figure 7 D). This increased synchronized spiking and concerted silence while leaving spike rates unchanged ( Figures 7 D–7G). We next examined a shared excitatory input, intended to model a transient rise in motor-related input to the olive at reach onset. A rise in excitatory drive as κ stayed below its critical value raised spike rates, but not oscillatory coherence or synchronized spiking, and it suppressed concerted silence ( Figures 7 D–7G). Concomitant rises in excitation and in κ to above its critical value led to re-organized spiking—more large-scale synchronized spiking, more concerted silence, and less small-scale synchronized spiking—and higher spike rates ( Figures 7 D–7G).
These results capture key aspects of how complex spikes are temporally re-organized during reaching and suggest the transition at reach onset reflects a bifurcation in olivary dynamics caused by joint rises in electrical coupling and excitatory input ( Figure 7 H). This highlights that cerebellar feedback to the olive can regulate whether the circuit operates above or below a bifurcation point. Motor-related inputs from outside the olivocerebellum could trigger the operating mode switch.
A model in which all cells are coupled may be a good approximation for studies of a local olivary compartment ( De Gruijl et al., 2014 18. De Gruijl, J.R. ∙ Hoogland, T.M. ∙ De Zeeuw, C.I. Behavioral correlates of complex spike synchrony in cerebellar microzones J. Neurosci. 2014; 34 :8937-8947 Crossref Scopus (51) PubMed Google Scholar ), but electrical coupling declines over larger spatial scales ( Vrieler et al., 2019 79. Vrieler, N. ∙ Loyola, S. ∙ Yarden-Rabinowitz, Y. ... Variability and directionality of inferior olive neuron dendrites revealed by detailed 3D characterization of an extensive morphological library Brain Struct. Funct. 2019; 224 :1677-1695 Crossref Scopus (16) PubMed Google Scholar ), which is likely important for modeling the spatially varying spiking seen with our mesoscope ( Figures S2 E–S2I). Thus, we studied a model in which olivary cells lay on a grid, and κ varied with cells’ separations ( Figures S7 A and S7B). To examine the impact of coupling changes, we transiently increased all κ values in the simulation by a multiplicative scale factor, and we varied this factor from low to high values. At higher values, the spatial coherence of spiking increased, and, strikingly, there were spatial gradients in the timing of complex spikes ( Figures S7 C and S7D), resembling those in the vermis during reaching ( Figures S2 E–S2J). Overall, the Kuramoto model captures observed changes in the spatiotemporal organization of spiking, supporting the idea that the olivary network undergoes a discrete switch in its collective dynamics during task execution.

Section: Discussion

In neuroscience, the term “state change” is used to describe phase transitions in model networks between states of distinct collective properties and macroscopic attributes, e.g., ordered versus disordered activity ( Chialvo, 2010 14. Chialvo, D.R. Emergent complex neural dynamics Nat. Phys. 2010; 6 :744-750 Crossref Scopus (748) Google Scholar ; Hopfield, 1982 37. Hopfield, J.J. Neural networks and physical systems with emergent collective computational abilities Proc. Natl. Acad. Sci. USA. 1982; 79 :2554-2558 Crossref Scopus (13045) PubMed Google Scholar ; Schneidman et al., 2006 70. Schneidman, E. ∙ Berry, 2nd, M.J. ∙ Segev, R. ... Weak pairwise correlations imply strongly correlated network states in a neural population Nature. 2006; 440 :1007-1012 Crossref Scopus (1194) PubMed Google Scholar ). Neuroscientists often conceptualize different behavioral states as resulting from distinct neural activity rates, but the concept of a discrete transition or bifurcation in the dynamics leads to an alternative view in which different behavioral states stem from differences in the organization of activity, viz . the patterning of spikes in time or space. Past experiments sought features of a state transition in motor cortex ( Churchland et al., 2012 16. Churchland, M.M. ∙ Cunningham, J.P. ∙ Kaufman, M.T. ... Neural population dynamics during reaching Nature. 2012; 487 :51-56 Crossref Scopus (881) PubMed Google Scholar ; Petermann et al., 2009 64. Petermann, T. ∙ Thiagarajan, T.C. ∙ Lebedev, M.A. ... Spontaneous cortical activity in awake monkeys composed of neuronal avalanches Proc. Natl. Acad. Sci. USA. 2009; 106 :15921-15926 Crossref Scopus (401) PubMed Google Scholar ), and theorists have modeled circuits at critical points between states ( Abbott and Rohrkemper, 2007 1. Abbott, L.F. ∙ Rohrkemper, R. A simple growth model constructs critical avalanche networks Cisek, T.D. Paul ∙ John, F.K. (Editors) Progress in Brain Research Elsevier, 2007; 13-19 Google Scholar ; Moretti and Muñoz, 2013 55. Moretti, P. ∙ Muñoz, M.A. Griffiths phases and the stretching of criticality in brain networks Nat. Commun. 2013; 4 :2521 Crossref Scopus (242) PubMed Google Scholar ; Poil et al., 2012 66. Poil, S.-S. ∙ Hardstone, R. ∙ Mansvelder, H.D. ... Critical-state dynamics of avalanches and oscillations jointly emerge from balanced excitation/inhibition in neuronal networks J. Neurosci. 2012; 32 :9817-9823 Crossref Scopus (246) PubMed Google Scholar ).
We examined whether the olivocerebellum enters a state of coherent dynamics during skilled movement, which has been proposed as a way to temporally organize motor outputs ( Jacobson et al., 2008 39. Jacobson, G.A. ∙ Rokni, D. ∙ Yarom, Y. A model of the olivo-cerebellar system as a temporal pattern generator Trends Neurosci. 2008; 31 :617-625 Full Text Full Text (PDF) Scopus (106) PubMed Google Scholar ). Prior observations of synchronized complex spikes during rhythmic movements were compatible with a state transition ( Hoogland et al., 2015; Welsh et al., 1995 36. Hoogland, T.M. ∙ De Gruijl, J.R. ∙ Witter, L. ... Role of synchronous activation of cerebellar Purkinje cell ensembles in multi-joint movement control Curr. Biol. 2015; 25 :1157-1165 Full Text Full Text (PDF) Scopus (79) PubMed Google Scholar 81. Welsh, J.P. ∙ Lang, E.J. ∙ Suglhara, I. ... Dynamic organization of motor control within the olivocerebellar system Nature. 1995; 374 :453-457 Crossref Scopus (526) PubMed Google Scholar ), but it had not been determined whether coincident spiking reflects movement-locked inputs or intrinsic synchrony locked at finer time-scales. We found an emergence with learning of coherent spiking across millimeter spans of tissue, covariation between coherent activity and kinematic stereotypy, a temporal re-configuration of ensemble spiking during task execution, internal time-locking of neural activity at finer time-scales than movement- or perturbation-locked activity changes, ensemble encoding of kinematic perturbations, and regulation of synchrony and reach targeting by the cerebellar nucleo-olivary pathway. These results support the existence of a discrete state transition at the onset of skilled reaching and show that coherent dynamics are not innate in this context, nor generic to untrained reaching, but instead relate to the acquisition of targeted reaching proficiency. A Kuramoto model explains many of our results as arising from a bifurcation in olivary network dynamics, providing a mathematical basis for the state transition and its categorization as second order.
Past studies proposed that complex spike synchrony is modulated via shunting inhibitory inputs from the cerebellar nuclei to olivary glomeruli, structures thought to mediate synchronous spiking ( Best and Regehr, 2009 8. Best, A.R. ∙ Regehr, W.G. Inhibitory regulation of electrically coupled neurons in the inferior olive is mediated by asynchronous release of GABA Neuron. 2009; 62 :555-565 Full Text Full Text (PDF) Scopus (106) PubMed Google Scholar ; De Zeeuw et al., 1997 19. De Zeeuw, C.I. ∙ Koekkoek, S.K.E. ∙ Wylie, D.R.W. ... Association between dendritic lamellar bodies and complex spike synchrony in the olivocerebellar system J. Neurophysiol. 1997; 77 :1747-1758 Crossref Scopus (63) PubMed Google Scholar ; Devor and Yarom, 2000 21. Devor, A. ∙ Yarom, Y. GABAergic modulation of olivary oscillations Prog. Brain Res. 2000; 124 :213-220 Crossref PubMed Google Scholar ; Lefler et al., 2014 50. Lefler, Y. ∙ Yarom, Y. ∙ Uusisaari, M.Y. Cerebellar inhibitory input to the inferior olive decreases electrical coupling and blocks subthreshold oscillations Neuron. 2014; 81 :1389-1400 Full Text Full Text (PDF) Scopus (96) PubMed Google Scholar ). When we optogenetically modulated nucleo-olivary feedback, even though the illumination lasted across the trial, peak synchronized spiking was gated to reach onset, presumably due to motor commands reaching the inferior olive. This effect also arose in our Kuramoto model, in which concurrent rises in excitatory drive and coupling levels led to a greater re-organization of spiking into synchronized events than a coupling rise alone; concerted silence also rose when the model entered the coherent state, even during a rise in spike rates ( Figures 7 E–7G). These results suggest that by regulating olivary coupling the olivocerebellum can switch its dynamics into distinct regimes ( Figure 7 H).
With realistic numbers of olivary cells in a microcompartment, the state switch in the model is highly discrete ( Figure 7 C), not a progression across a continuum of states. While a model of fully connected olivary cells can describe many features of complex spiking in local patches of cerebellum, at larger scales over which olivary electrical coupling is non-uniform, coupling modulation may switch the spatiotemporal dynamics of complex spiking between coordinated and less coordinated configurations ( Figure S7 ), potentially explaining the millimeter-scale coherence seen during reaching ( Figure S2 ). The wavelike propagation of spiking we saw in vivo and in simulations is broadly consistent with prior olivary models showing wavelike activity under various conditions ( Latorre et al., 2013 49. Latorre, R. ∙ Aguirre, C. ∙ Rabinovich, M.I. ... Transient dynamics and rhythm coordination of inferior olive spatio-temporal patterns Front. Neural Circuits. 2013; 7 :138 Crossref Scopus (23) PubMed Google Scholar ; Negrello et al., 2019 57. Negrello, M. ∙ Warnaar, P. ∙ Romano, V. ... Quasiperiodic rhythms of the inferior olive PLoS Comput. Biol. 2019; 15 :e1006475 Crossref Scopus (20) PubMed Google Scholar ; Torben-Nielsen et al., 2012 77. Torben-Nielsen, B. ∙ Segev, I. ∙ Yarom, Y. The generation of phase differences and frequency changes in a network model of inferior olive subthreshold oscillations PLoS Comput. Biol. 2012; 8 :e1002580 Crossref Scopus (34) PubMed Google Scholar ).
Millimeter-scale complex spike synchrony surely reflects synchronization of olivary cells, not signals from individual climbing fibers. Each climbing fiber has ∼7 collaterals ( Fujita and Sugihara, 2013 27. Fujita, H. ∙ Sugihara, I. Branching patterns of olivocerebellar axons in relation to the compartmental organization of the cerebellum Front. Neural Circuits. 2013; 7 :3 3 Crossref Scopus (26) PubMed Google Scholar ) that branch rostro-caudally; our conventional two-photon images spanned ∼1–2 dendrites, suggesting few shared climbing fiber inputs were within view. In our mesoscope data, coincident spikes engaged ∼50–100 Purkinje cells, far more than the targets of one climbing fiber.
The concerted absence of complex spiking that often arose during reaching lasted for durations that covaried with the activation of cerebellar interneurons ( Figures 5 E and 5F). A prolonged silence might result directly from interneurons’ inhibitory action, or by inhibition of Purkinje cell simple spiking and thus disinhibition of the nucleo-olivary projection, which both inhibits olivary cell bodies and shunts olivary gap junctions ( Bazzigaluppi et al., 2012b 6. Bazzigaluppi, P. ∙ Ruigrok, T. ∙ Saisan, P. ... Properties of the nucleo-olivary pathway: an in vivo whole-cell patch clamp study PLoS ONE. 2012; 7 :e46360 Crossref Scopus (47) PubMed Google Scholar ; Marshall and Lang, 2009 52. Marshall, S.P. ∙ Lang, E.J. Local changes in the excitability of the cerebellar cortex produce spatially restricted changes in complex spike synchrony J. Neurosci. 2009; 29 :14352-14362 Crossref Scopus (49) PubMed Google Scholar ). We favor the latter possibility, as interneuron activation did not alter the magnitude of Purkinje cells’ Ca 2+ spikes ( Figure 5 D). Further, photo-excitation of the nucleo-olivary pathway promoted concerted silence, showing this mechanism’s sufficiency and capacity to outweigh a decline in concerted silence that might result from a concurrent rise in shunting inhibition of olivary glomeruli ( Figure 6 D).
Olivary synchronization may coordinate olivocerebellar activity by establishing an internal “clock” to choreograph motor output ( Jacobson et al., 2008 39. Jacobson, G.A. ∙ Rokni, D. ∙ Yarom, Y. A model of the olivo-cerebellar system as a temporal pattern generator Trends Neurosci. 2008; 31 :617-625 Full Text Full Text (PDF) Scopus (106) PubMed Google Scholar ). Here, complex spikes had more systematic timing variations across the vermis in expert than naive mice ( Figure S2 J), and, in past work, mice with impaired olivary gap junctions had motor learning deficits and abnormal complex spike timing ( Van Der Giessen et al., 2008 78. Van Der Giessen, R.S. ∙ Koekkoek, S.K. ∙ van Dorp, S. ... Role of olivary electrical coupling in cerebellar motor learning Neuron. 2008; 58 :599-612 Full Text Full Text (PDF) Scopus (176) PubMed Google Scholar ). In traditional views of cerebellar learning, complex spikes signal movement or prediction errors that drive plasticity and abate as learning is achieved ( Herzfeld et al., 2018 35. Herzfeld, D.J. ∙ Kojima, Y. ∙ Soetedjo, R. ... Encoding of error and learning to correct that error by the Purkinje cells of the cerebellum Nat. Neurosci. 2018; 21 :736-743 Crossref Scopus (120) PubMed Google Scholar ; Medina and Lisberger, 2008 54. Medina, J.F. ∙ Lisberger, S.G. Links from complex spikes to local plasticity and motor learning in the cerebellum of awake-behaving monkeys Nat. Neurosci. 2008; 11 :1185-1192 Crossref Scopus (210) PubMed Google Scholar ; Yang and Lisberger, 2014 82. Yang, Y. ∙ Lisberger, S.G. Purkinje-cell plasticity and cerebellar motor learning are graded by complex-spike duration Nature. 2014; 510 :529-532 Crossref Scopus (147) PubMed Google Scholar ). Here, learning led to more stereotyped complex spiking activity that was synchronized across greater numbers of cells, in line with findings in expert animals that complex spikes can remain synchronized and time-locked to aspects of behavior and reward expectation ( Heffley and Hull, 2019 32. Heffley, W. ∙ Hull, C. Classical conditioning drives learned reward prediction signals in climbing fibers across the lateral cerebellum eLife. 2019; 8 :e46764 Crossref Scopus (75) PubMed Google Scholar ; Heffley et al., 2018 33. Heffley, W. ∙ Song, E.Y. ∙ Xu, Z. ... Coordinated cerebellar climbing fiber activity signals learned sensorimotor predictions Nat. Neurosci. 2018; 21 :1431-1441 Crossref Scopus (98) PubMed Google Scholar ; Kostadinov et al., 2019 45. Kostadinov, D. ∙ Beau, M. ∙ Blanco-Pozo, M. ... Predictive and reactive reward signals conveyed by climbing fiber inputs to cerebellar Purkinje cells Nat. Neurosci. 2019; 22 :950-962 Crossref Scopus (126) PubMed Google Scholar ; Larry et al., 2019 48. Larry, N. ∙ Yarkoni, M. ∙ Lixenberg, A. ... Cerebellar climbing fibers encode expected reward size eLife. 2019; 8 :e46870 Crossref Scopus (53) PubMed Google Scholar ).
In addition to Purkinje cells, climbing fibers also contact cerebellar nuclei cells, which combine these signals with Purkinje cells’ inhibitory inputs. However, large-scale synchronized complex spikes seem far more likely than ongoing asynchronous activity to silence cerebellar nuclei cells, given the convergence of many Purkinje cell inputs onto individual cerebellar nuclei cells. Synchronized complex spikes may also coordinate subsequent simple spikes from large sets of Purkinje cells, as well as the dynamics of molecular layer interneurons ( Badura et al., 2013 4. Badura, A. ∙ Schonewille, M. ∙ Voges, K. ... Climbing fiber input shapes reciprocity of Purkinje cell firing Neuron. 2013; 78 :700-713 Full Text Full Text (PDF) Scopus (103) PubMed Google Scholar ), enhancing the modulation of downstream motor areas and effectors. At least in some Purkinje cells, ∼30 ms pauses in simple spiking follow each complex spike ( Yang and Lisberger, 2014 82. Yang, Y. ∙ Lisberger, S.G. Purkinje-cell plasticity and cerebellar motor learning are graded by complex-spike duration Nature. 2014; 510 :529-532 Crossref Scopus (147) PubMed Google Scholar ), so synchronized complex spikes might pause and reset simple spiking with precise temporal cohesion over an assembly of Purkinje cells. This may coordinate the timing of spikes leaving the cerebellum, while enabling a flexible patterning of these spikes that depends on the configuration of complex spike synchrony ( Person and Raman, 2011 63. Person, A.L. ∙ Raman, I.M. Purkinje neuron synchrony elicits time-locked spiking in the cerebellar nuclei Nature. 2011; 481 :502-505 Crossref Scopus (256) PubMed Google Scholar ).
By identifying coherent neural activity that arises with motor skill acquisition and execution, our study highlights the importance of collective phenomena in the brain and the limits of reductionist approaches focused on single-cell properties for understanding how neural circuits drive behavior. While our Kuramoto model succinctly captures the olivocerebellar state transition, a more complete framework will be needed to understand how cell ensembles in multiple brain areas cooperate to generate a disordered-to-ordered state transition. Our data and model show that a single-cell perspective is unlikely to account for these phenomena and that it will likely be crucial to study the circuits holistically.
This study’s chief limitations are that we only imaged Purkinje cells and that Ca 2+ imaging reveals these cells’ complex spikes but not their simple spikes, which are just as important for olivocerebellar dynamics. Voltage imaging might allow simple spike recordings ( Gong et al., 2015 30. Gong, Y. ∙ Huang, C. ∙ Li, J.Z. ... High-speed recording of neural spikes in awake mice and flies with a fluorescent voltage sensor Science. 2015; 350 :1361-1366 Crossref Scopus (327) PubMed Google Scholar ), but generalizing our results will require concurrent recordings of multiple cell types, across the olivocerebellum and in other motor areas, including motor cortex, thalamus, the basal ganglia, red nucleus, and brainstem circuits like the reticular formation ( Esposito et al., 2014 24. Esposito, M.S. ∙ Capelli, P. ∙ Arber, S. Brainstem nucleus MdV mediates skilled forelimb motor tasks Nature. 2014; 508 :351-356 Crossref Scopus (186) PubMed Google Scholar ), to reveal how dynamic states engage the entire motor system. Notably, during reaching, coherent oscillations in motor cortex may bind motor circuits across the brain via interactions with cerebellum and thalamus ( Churchland et al., 2012 16. Churchland, M.M. ∙ Cunningham, J.P. ∙ Kaufman, M.T. ... Neural population dynamics during reaching Nature. 2012; 487 :51-56 Crossref Scopus (881) PubMed Google Scholar ; Gross et al., 2002 31. Gross, J. ∙ Timmermann, L. ∙ Kujala, J. ... The neural basis of intermittent motor control in humans Proc. Natl. Acad. Sci. USA. 2002; 99 :2299-2302 Crossref Scopus (316) PubMed Google Scholar ). Future work should identify the inputs to the olivocerebellum that trigger and pattern concerted spiking.
While our optogenetic manipulations were anatomically precise, they involved large-scale, non-physiological patterning, so it remains untested whether physiological patterns of nucleo-olivary feedback can synchronize or de-synchronize specific olivary subdomains that might recruit and coordinate distinct cerebellar regions for different motor behaviors. Further, unlike in our model, in which κ sets the olivary coupling strength independently of excitation levels, nucleo-olivary inputs both inhibit olivary cell bodies and shunt gap junctions. Thus, one cannot conclude that the effects of our nucleo-olivary manipulations on complex spike synchrony were solely due to the coupling change, and exactly how reach targeting was altered remains unclear.
Finally, we designed our study to assay ensemble spiking dynamics, not single-cell coding properties. Complex spikes can signal intricate admixtures of kinematic variables ( Fu et al., 1997 26. Fu, Q.G. ∙ Mason, C.R. ∙ Flament, D. ... Movement kinematics encoded in complex spike discharge of primate cerebellar Purkinje cells Neuroreport. 1997; 8 :523-529 Crossref Scopus (33) PubMed Google Scholar ; Kitazawa et al., 1998 44. Kitazawa, S. ∙ Kimura, T. ∙ Yin, P.-B. Cerebellar complex spikes encode both destinations and errors in arm movements Nature. 1998; 392 :494-497 Crossref Scopus (296) PubMed Google Scholar ; Ojakangas and Ebner, 1992 60. Ojakangas, C.L. ∙ Ebner, T.J. Purkinje cell complex and simple spike changes during a voluntary arm movement learning task in the monkey J. Neurophysiol. 1992; 68 :2222-2236 Crossref Scopus (112) PubMed Google Scholar ). Thus, our limited sampling of kinematic and perturbation parameters ( Figures 3 and 5 I–5P) cannot reveal the exact combination of motor command, perturbation, self-generated error or feedback signals encoded in complex spiking.

Section: STAR★Methods

REAGENT or RESOURCE SOURCE IDENTIFIER Antibodies GAD67 Millipore MAB5406; RRID: AB_2278725 Alexa-647 donkey anti-mouse Jackson 715-605-151; RRID: AB_2340863 Bacterial and virus strains AAV2/1-CAG-FLEX-GCaMP6f UNC Vector core N/A AAV2/1-CaMK2a-GCaMP6f UNC Vector core N/A CAV2-CMV-Cre Soudais et al., 2001 73. Soudais, C. ∙ Laplace-Builhe, C. ∙ Kissa, K. ... Preferential transduction of neurons by canine adenovirus vectors and their efficient retrograde transport in vivo FASEB J. 2001; 15 :2283-2285 Crossref Scopus (201) PubMed Google Scholar N/A AAVretro-EF1a-Cre Salk Vector Core N/A AAV8-EF1a-DIO-eArch3.0-mCherry Stanford Vector core GVVC-AAV-199 AAV8-EF1a-DIO-BreaChES-mCherry Stanford Vector core GVVC-AAV-200 Chemicals, peptides, and recombinant proteins Isoflurane Henry Schein CAS 26675-46-7 DAPI Thermo D1306; RRID: AB_2629482 Pentobarbital Beuthanasia N/A C&B Metabond Quick Adhesive Parkell UN1247 Experimental models: Organisms/strains Mouse: PCP2-Cre Jackson Labs 004146; RRID:IMSR_JAX:004146 Mouse: C57BL/6 Jackson Labs 000664; RRID:IMSR_JAX:000664 Mouse: Ai148 Jackson Labs 030328; RRID:IMSR_JAX:030328 Software and algorithms MATLAB Mathworks https://www.mathworks.com ; RRID: SCR_001622 NoRMCorre Simons Foundation/Flatiron institute; Pnevmatikakis and Giovannucci, 2017 65. Pnevmatikakis, E.A. ∙ Giovannucci, A. NoRMCorre: An online algorithm for piecewise rigid motion correction of calcium imaging data J. Neurosci. Methods. 2017; 291 :83-94 Crossref Scopus (407) PubMed Google Scholar https://github.com/flatironinstitute/NoRMCorre Turboreg Thevenaz et al., 1998 76. Thévenaz, P. ∙ Ruttimann, U.E. ∙ Unser, M. A pyramid approach to subpixel registration based on intensity IEEE Trans. Image Process. 1998; 7 :27-41 Crossref Scopus (2212) PubMed Google Scholar http://bigwww.epfl.ch/thevenaz/turboreg/ ; RRID: SCR_014308 ScanImage Vidrio Technologies http://scanimage.vidriotechnologies.com/display/SIH;jsessionid=4B3E98685F56437E5E01AE0AE049C232 ; RRID: SCR_014307 MPScope Nguyen et al., 2006 58. Nguyen, Q.-T. ∙ Tsai, P.S. ∙ Kleinfeld, D. MPScope: a versatile software suite for multiphoton microscopy J. Neurosci. Methods. 2006; 156 :351-359 Crossref Scopus (94) PubMed Google Scholar MPScope; RRID: SCR_000065 LabVIEW National Instruments https://www.ni.com/en-us/shop/labview.html ; RRID: SCR_014325 PCA/ICA Mukamel et al., 2009 56. Mukamel, E.A. ∙ Nimmerjahn, A. ∙ Schnitzer, M.J. Automated analysis of cellular signals from large-scale calcium imaging data Neuron. 2009; 63 :747-760 Full Text Full Text (PDF) Scopus (473) PubMed Google Scholar https://www.mathworks.com/matlabcentral/fileexchange/25405-emukamel-cellsort . EXTRACT Inan et al., 2021 38. Inan, H. ∙ Schmuckermair, C. ∙ Tasci, T. ... Fast and statistically robust cell extraction from large-scale neural calcium imaging datasets bioRxiv. 2021; 2021.03.24.436279 Crossref Scopus (0) Google Scholar https://github.com/schnitzer-lab/EXTRACT-public Open table in a new tab
Further information and requests for resources and reagents should be directed to and will be fulfilled by the Lead Contact, Mark J. Schnitzer ( mschnitz@stanford.edu ).
This study did not generate new unique reagents.
We performed analyses using publicly available software (see below and Key Resources ) and custom routines written in MATLAB (Mathworks). The data of this study and the MATLAB code are available from the authors upon reasonable request.
The Stanford University Administrative Panel on Laboratory Animal Care (APLAC) approved all animal experiments. For Ca 2+ imaging in Purkinje cells, we used 11 (9 males and 2 females) PCP2-Cre driver mice with a Bl6-129 genetic background; 14 male wild-type C57/bl6 mice; and 3 (1 male and 2 female) PCP2-Cre / Ai148 ( Daigle et al., 2018 17. Daigle, T.L. ∙ Madisen, L. ∙ Hage, T.A. ... A suite of transgenic driver and reporter mouse lines with enhanced brain cell type targeting and functionality Cell. 2018; 174 :465-480 Full Text Full Text (PDF) Scopus (390) PubMed Google Scholar ) transgenic mice ( Figure 2 ). In the cerebellum, the PCP2-Cre / Ai148 mice expressed the GCaMP6f Ca 2+ indicator selectively in Purkinje cells. However, for unknown reasons the expression was not complete; a substantial fraction of, but not all, Purkinje neurons expressed the Ca 2+ indicator ( Figure 2 A). Mice were aged 6-16 weeks at the start of procedures, were in good health and normal immune status, and did not undergo any other procedures or experiments prior to those of this study. Mice were singly or group-housed in standard cages with at least weekly bedding changes.
Except for the studies of Figures 2 and S2 , to express the GCaMP6f Ca 2+ indicator ( Chen et al., 2013 13. Chen, T.-W. ∙ Wardill, T.J. ∙ Sun, Y. ... Ultrasensitive fluorescent proteins for imaging neuronal activity. Nature. 2013; 499 :295-300 Crossref Scopus (4196) PubMed Google Scholar ) selectively in Purkinje cells, we used a viral strategy. Specifically, we injected AAV2/1-CAG-FLEX-GCaMP6f virus (titer: 9.4 × 10 12 GC⋅mL –1 ) into the right cerebellar cortex of PCP2-Cre mice, or AAV2/1-CaMK2a-GCaMP6f virus (titer: 3.6 × 10 13 GC⋅mL –1 ) into the right cerebellar cortex of C57/bl6 mice. To express Cre-recombinase in nucleo-olivary neurons in the right cerebellar fastigial nucleus, we injected CAV2-CMV-Cre virus ( Soudais et al., 2001 73. Soudais, C. ∙ Laplace-Builhe, C. ∙ Kissa, K. ... Preferential transduction of neurons by canine adenovirus vectors and their efficient retrograde transport in vivo FASEB J. 2001; 15 :2283-2285 Crossref Scopus (201) PubMed Google Scholar ) (titer: 4.2 × 10 12 GC⋅mL –1 ) or AAVretro-EF1a-Cre ( Tervo et al., 2016 75. Tervo, D.G.R. ∙ Hwang, B.-Y. ∙ Viswanathan, S. ... A designer AAV variant permits efficient retrograde access to projection neurons Neuron. 2016; 92 :372-382 Full Text Full Text (PDF) Scopus (780) PubMed Google Scholar ) into the inferior olive. To express eArch3.0 ( Mattis et al., 2012 53. Mattis, J. ∙ Tye, K.M. ∙ Ferenczi, E.A. ... Principles for applying optogenetic tools derived from direct comparative analysis of microbial opsins Nat. Methods. 2012; 9 :159-172 Crossref Scopus (585) Google Scholar ) or BreaChES ( Kim et al., 2017 43. Kim, C.K. ∙ Ye, L. ∙ Jennings, J.H. ... Molecular and circuit-dynamical identification of top-down neural mechanisms for restraint of reward seeking Cell. 2017; 170 :1013-1027 Full Text Full Text (PDF) Scopus (97) PubMed Google Scholar ) in Cre-positive fastigial neurons, we injected AAV8-EF1a-DIO-eArch3.0-mCherry virus (titer: 6.5 × 10 12 GC⋅mL –1 ) or AAV8-EF1a-DIO-BreaChES-mCherry (titer: 4 × 10 12 GC⋅mL –1 ).
Following our laboratory’s published procedures ( Nimmerjahn et al., 2009 59. Nimmerjahn, A. ∙ Mukamel, E.A. ∙ Schnitzer, M.J. Motor behavior activates Bergmann glial networks Neuron. 2009; 62 :400-412 Full Text Full Text (PDF) Scopus (233) PubMed Google Scholar ), we performed surgeries on isoflurane-anesthetized mice (1.25%–2.5% in 0.5–1.5 L/min of O 2 ). Mice underwent one, two or three surgical procedures, to inject viral vectors into the brain, attach a metal head-plate to the cranium, and prepare the mice for in vivo Ca 2+ imaging, in that order. Transgenic PCP2-Cre/Ai148 mice that expressed the GCaMP6f Ca 2+ indicator in Purkinje cells did not undergo the first surgery.
In the first surgery, after anesthetizing the mice we cleaned the skin and made a small incision. We then drilled open a ∼0.3 mm diameter craniotomy over the right vermis of cerebellar lobule V, ipsilateral to the reaching arm and ∼1 mm anterior to the post-lambda fissure on the cranial midline. Using a glass pipette (30–50 μm tip diameter), we injected 400–600 nL of AAV2/1-CAG-FLEX-GCaMP6f virus in PCP2-Cre mice or AAV2/1-CaMK2a-GCaMP6f in wild-type mice, at a depth of 180–350 μm. We allowed the virus to incubate for 2–5 weeks before experiments, to allow adequate expression of GCaMP6f.
In the second surgery we attached an aluminum head-plate to the skull. We cleaned and removed skin to reveal part of the skull and centered the plate’s 6-mm-diameter opening over the cerebellum. We treated the skull with Metabond adhesive and affixed the holding plate with dental cement (Coltene Whaledent). The custom-made plate was shaped to allow the additional attachment of two stainless steel bars to the cranium. Together, these steel bars held the head in place during active mouse behavior via three attachment points, two rostral and one caudal, as we found that the use of all three clamping points was helpful for minimizing cranial motion. To the rostral part of the cranium we fixed one of the bars, oriented along the medio-lateral direction, so that during imaging experiments we could clamp it on both sides to external fixtures. To the caudal part of the cranium we fixed the other bar, angled at 45° to the horizontal plane, providing a third clamping point.
Finally, we opened a 4-mm-diameter craniotomy above cerebellar lobule V in the right vermis (100–700 μm anterior to the primary fissure, 0.3–1.2 mm lateral). In some mice, we performed this procedure prior to training during the head-plate implantation surgery described above (in these cases, the second surgery was performed 1–2 days after virus injection); in other cases, we did not open the cranial window until after the mice had successfully undergone behavioral training (in these cases, 2–5 weeks after virus injection). In some mice we also removed the dura. In some cases, we applied Kwik-Sil (World Precision Instruments) to the border of the craniotomy. We then covered the brain with a 3-mm-diameter coverslip that we had previously attached beneath a 7-mm-diameter coverslip using ultraviolet-light activated epoxy (Norland NOA81). We fixed the 7-mm-diameter coverslip to the cranium with a stainless-steel shim retaining ring and dental cement. In other cases, we directly implanted into the skull opening a 3-mm-diameter coverslip affixed to the bottom of a 1-mm-long, 3-mm-diameter stainless-steel tube. In all cases, mice recovered for 1–2 days prior to behavioral training.
We built a robotic manipulandum with two degrees of mechanical freedom using two direct drive (no transmission) direct current (dc) motors (Maxon RE-max 21). During design of the robot, we took particular care to create a system capable of providing high quality force feedback to the mice, with no mechanical backlash, near-zero friction, low mechanical inertia, a broad temporal frequency bandwidth, and extreme back-drivability. The motors were arranged in a double SCARA configuration (e.g., A. Figielski et al., 2007, ISIC IEEE Int. Conf. on Systems, Man, and Cybernetics, conference) and coupled to two high-resolution optical rotary encoders (Gurley Precision Instruments R120B). The calculated resolution of the encoders at the mouse’s grasping point on the joystick was 0.006 mm in the lateral direction and 0.003 mm in the forward direction.
Our robotic and behavioral apparatus involved a nested hierarchy of three different levels of feedback control: two real-time controllers operating at 10 kHz and 1 kHz, respectively, and a graphical user interface controller operating at ∼50–200 Hz. At the lowest level, we monitored the current drawn by each motor using an inductive sensor (Honeywell) and an analog input signal recorder (National Instruments 9215). Field programmable gate arrays (FPGAs) (National Instruments LX50 programmed in Labview) performed torque control using the current signals via a standard proportional-integrative feedback controller operating at 10 kHz. Rotational quadrature signals from the encoders entered digital input lines and allowed position control using a standard proportional-integrative-derivative (PID) feedback controller operating at 1 kHz.
The second level of control ran at 1 kHz on a real-time operating system (RTOS; National Instruments cRIO-9024, programmed in Labview), which performed kinematic transformations from the coordinates of the robot joints to Cartesian coordinates. We used the RTOS to set the physical dynamics of the robot that the mouse would experience, such as the movement friction of the robotic manipulandum. We did this by reading state variables and updating the output forces to desired values at 1 kHz. Using positional feedback control in the RTOS, we also created in software virtual walls that terminated arm-movements, external forces that perturbed reaching movements ( Figures 5 I–5P), and virtual channels that constrained reaches to one-dimensional trajectories.
The highest level of control involved a Windows personal computer (PC) programmed in Labview. This level allowed us to specify trial parameters, compute and deliver rewards, and log data. The RTOS sampled positional data at 200 Hz, which was transferred from the RTOS buffer via network to a buffer on the Windows PC, and written to disk following experiments. We also video-recorded the animal’s behavior at a frame rate of 15 or 20 Hz using an infrared camera (Imaging Source).
Mice followed a water-restriction protocol in which they were limited to ∼1 mL intake per day. Mice trained for 5–11 days for 0.5–1.5 h daily, depending on reward satiety. We monitored the animals’ weight daily, checked their coat quality, and provided supplementary saline injections as necessary. During training, the robotic manipulandum was positioned approximately 6 cm in front of and 6 cm below the shoulder, depending on the mouse’s size. Mice were allowed to initiate a reach when the robotic arm returned to the home position, provided the mice applied no appreciable force to the robot for a brief inter-trial period, as determined from the force needed for the robot to hold the handle at the start position.
As training progressed, we made the reward criteria increasingly stringent. We required longer movements (in all cases) and greater accuracy (in the planar task). We rewarded the mouse for reaches with a radial endpoint >6–7 mm. We did not reward slow or discontinuous movements, which the robot terminated before their completion. In both tasks, we used a virtual wall, as programmed in the RTOS, to constrain the arm’s maximum range of movement to 8 mm.
For the task in Figures 5 I–5P, in which mice were constrained to making linear movements in the forward direction, the RTOS canceled the mouse’s lateral movement using the 1 kHz PID feedback controller. For perturbation delivery, on the day of imaging only and on a random subset of trials, the robot deflected the hand after 3 mm of linear movement. These leftward or rightward perturbations then increased in amplitude (up to a maximum displacement of 4–6 mm) as a function of the mouse’s forward motion. Leftward and rightward perturbations each occurred once every eight trials, in a random order, intermixed with trials with no perturbation. On trials without a robotic perturbation of the movement, the mouse received a sugar water reward on all trials for which the arm movement was >7 mm in extent.
During a subset of two-photon imaging studies, we used a pair of CMOS cameras (Imaging Source DMK 23UV024) to track the mouse’s body movements. We synchronized the two cameras to each other and to the two-photon microscope at a 20 Hz rate of image frame acquisition. One camera was positioned to capture a side view of the mouse’s body, as imaged through a transparent plastic tube that we used to restrain the mouse’s body trunk. The other camera captured a ventral view of the mouse’s body, as observed via a mirror placed beneath the plastic tube. For each reaching trial, we manually scored the behavior videos to track the motion of 6 body coordinates (anterior-posterior and dorsal-ventral positions of the right forelimb; medial-lateral and anterior-posterior positions of the left and right hindlimbs) from –1 s to +100 ms relative to forelimb movement onset, as detected by the robotic handle.
For all Ca 2+ imaging studies we used custom-built two-photon imaging instrumentation. A Ti:sapphire laser (SpectraPhysics, MaiTai) provided ultrashort-pulsed illumination of 920 nm wavelength. For the studies of Figure 2 and Figure S2 , we used a custom two-photon mesoscope ( Rumyantsev et al., 2020 69. Rumyantsev, O.I. ∙ Lecoq, J.A. ∙ Hernandez, O. ... Fundamental bounds on the fidelity of sensory cortical coding Nature. 2020; 580 :100-105 Crossref Scopus (98) PubMed Google Scholar ) equipped with a specialized microscope objective lens for two-photon imaging across a wide field-of-view ( Sofroniew et al., 2016 72. Sofroniew, N.J. ∙ Flickinger, D. ∙ King, J. ... A large field of view two-photon mesoscope with subcellular resolution for in vivo imaging eLife. 2016; 5 :e14472 Crossref Scopus (383) PubMed Google Scholar ), which allowed us to acquire images over a 2 × 2 mm 2 field-of-view at a 17.5 Hz frame rate (842 × 842 pixels). For all other studies we used a custom two-photon microscope of a traditional design, equipped with a 0.95 numerical aperture (NA) 20× microscope objective lens (Olympus XLUMPlanFl), except in optogenetic experiments, for which we used a 1.0 NA 20× objective lens (Olympus XLUMPlanFl). We acquired image frames at 20 Hz across a field-of-view of either 110 μm × 270 μm using MPScope software ( Nguyen et al., 2006 58. Nguyen, Q.-T. ∙ Tsai, P.S. ∙ Kleinfeld, D. MPScope: a versatile software suite for multiphoton microscopy J. Neurosci. Methods. 2006; 156 :351-359 Crossref Scopus (94) PubMed Google Scholar ) (130 × 280 pixels per frame; 2.6 kHz line scan rate) or of 130 μm × 265 μm using ScanImage software (Vidrio Technologies) (130 × 256 pixels per frame, 2.7 kHz line scan rate).
Data acquisition occurred during both the forward and backward portions of the scanning motion in both the x and y directions of the image frame, such that successive image lines and successive frames were sampled in opposite directions along the x- and y- axes, respectively. During optogenetic experiments, we placed two additional filters in the fluorescence emission pathway to block the 594-nm-wavelength laser light used for optogenetic inhibition. At the start of an imaging experiment, upon placing the mouse under the two-photon microscope, we chose a field-of-view for study with minimal curvature of the brain, few blood vessels, and bright fluorescence signals.
In mice anesthetized with 1.5%–2.0% isoflurane in ∼0.6 L/min O 2 , we guided a pipette filled with artificial cerebrospinal fluid (125 mM NaCl, 5 mM KCl, 10 mM D- Glucose, 10 mM HEPES, 2 mM CaCl2, 2 mM MgSO4; pH to 7.4 with NaOH) ( Nimmerjahn et al., 2009 59. Nimmerjahn, A. ∙ Mukamel, E.A. ∙ Schnitzer, M.J. Motor behavior activates Bergmann glial networks Neuron. 2009; 62 :400-412 Full Text Full Text (PDF) Scopus (233) PubMed Google Scholar ) and a red fluorescent dye (Sulforhodamine-101) into the imaging field of view in the cerebellar cortex. We used dual-color two-photon microscopy to visualize the pipette in the red fluorescence channel and the GCaMP6f-labeled neurons in the green channel. We acquired electrophysiological data at 10 kHz. We placed the pipette tip ∼70 μm into the brain, in the cerebellar molecular layer and just dorsal to the chosen Purkinje cell body, so that the electrical recordings generally contained only complex (Na + and Ca 2+ ) spikes, and not simple (Na + ) spikes, as distinguished by their different electrical waveforms ( Ekerot and Oscarsson, 1981 23. Ekerot, C.F. ∙ Oscarsson, O. Prolonged depolarization elicited in Purkinje cell dendrites by climbing fibre impulses in the cat J. Physiol. 1981; 318 :207-221 Crossref Scopus (59) PubMed Google Scholar ). When we attained a stable electrical recording, we centered the field-of-view approximately above the tip of the pipette.
In mice used for combined, two-photon imaging and optogenetic studies, during the first surgery (described above) we additionally injected either CAV2-Cre virus (3 mice) into the left inferior olive ( Soudais et al., 2001 73. Soudais, C. ∙ Laplace-Builhe, C. ∙ Kissa, K. ... Preferential transduction of neurons by canine adenovirus vectors and their efficient retrograde transport in vivo FASEB J. 2001; 15 :2283-2285 Crossref Scopus (201) PubMed Google Scholar ), or AAVretro-EF1a-Cre (7 mice) bilaterally into both inferior olives. To perform these injections, we retracted the neck muscles overlying the caudal-most aspect of the brain, where the skull has terminated and only a thick, semi-transparent dura covers the brain. We pierced a small hole in the dura and brought a glass pipette (30–50 μm tip diameter) containing viral solution to the rostro-caudal boundary between the cerebellum and brainstem, which were visible under the dura. The pipette entered the brain at this boundary (medio-lateral: 550 μm) at a 40.5° angle from the vertical axis. We inserted the pipette to a depth of 2.7 mm from the brain surface and injected 500 nL of virus.
We then injected either AAV8-EF1a-DIO-eArch3.0-mCherry into the right fastigial nucleus (3 mice) or both fastigial nuclei (4 mice), or AAV8-EFa-DIO-BreaChES-mCherry into both fastigial nuclei (3 mice). To target the fastigial nucleus, we applied saline to the thin skull overlying the posterior cerebellar cortex, which made the cerebellar lobules visible through the skull. We drilled a 0.3-mm-diameter craniotomy at the rostro-caudal boundary between cerebellar lobules VII and VIII, 900 μm to the right of the midline. We inserted a glass pipette containing viral solution into the brain at a 66° azimuthal angle from the vertical axis and to a depth of 1.75 mm beneath the brain surface. We then injected 500 nL of virus. To allow illumination of the fastigial nucleus, we implanted a multimode optical fiber (400-μm-diameter core, Thorlabs) in the right fastigial nucleus (3 mice) or both fastigial nuclei (7 mice). The fiber entered the brain at the same coordinates used for virus injection and was implanted at a depth of 1.15 mm, slightly dorsal to the locus of virus injection. The optical fiber terminated just outside the skull in a ferrule that we cemented to the skull using Metabond adhesive (Parkell). The ferrule allowed the detachable connection of a fiber optic patch cord (400-μm-diameter core) that delivered laser illumination for the optogenetics experiments.
We verified by histological analysis that cells expressing eArch3.0 were inhibitory neurons in the deep cerebellar nuclei. We anesthetized the mice with pentobarbital (Beuthanasia) and transcardially perfused them with phosphate-buffered saline (PBS) and then 4% paraformaldehyde (PFA). We extracted the brains and kept them in 4% PFA for 24 h, followed by 24 h in 30% sucrose solution. We cut 40-μm-thick tissue sections on a cryotome (Leica). We bathed the sections in blocking solution (10% normal donkey serum (NDS) in PBS) for 1 h. We labeled the sections for 24 h using the mouse monoclonal GAD67 antibody (Millipore MAB5406; 1:500 dilution in 10% NDS in PBS). We then rinsed the sections with PBS and then labeled them with the secondary antibody (Alexa-647 labeled donkey anti-mouse, Jackson Immunoresearch; 1:500 dilution in 10% NDS in PBS). Finally, to visualize cell bodies, we stained the sections with DAPI (Sigma, 0.1 μg/mL of PBS for 5 min). We imaged tissue sections of the cerebellar cortex and nuclei using a confocal microscope (Leica TCS SP5).
We used a 594-nm-wavelength laser (Cobolt Mambo or Coherent OBIS) coupled to one or two optical fibers (400-μm-diameter core; Thorlabs) that we connected to the ferrule(s) implanted on the mouse skull. Illumination power was 15 mW at the tip of the fiber, which sufficed to activate the opsins. On trials randomly chosen for optogenetic manipulation (20% of trials for bilateral stimulation studies, 10% of trials on each side for alternating unilateral stimulation studies), a shutter opened at the start of the trial and permitted the laser light to enter the optical fiber. At ∼500 ms after reach termination, the shutter closed. Thus, light exposure lasted ∼1 s on trials when the mouse initiated a reach soon after trial onset.
To correct for any rigid, lateral displacements of the field-of-view, first we used either TurboReg image registration software ( Thévenaz et al., 1998 76. Thévenaz, P. ∙ Ruttimann, U.E. ∙ Unser, M. A pyramid approach to subpixel registration based on intensity IEEE Trans. Image Process. 1998; 7 :27-41 Crossref Scopus (2212) PubMed Google Scholar ), or NormCorre ( Pnevmatikakis and Giovannucci, 2017 65. Pnevmatikakis, E.A. ∙ Giovannucci, A. NoRMCorre: An online algorithm for piecewise rigid motion correction of calcium imaging data J. Neurosci. Methods. 2017; 291 :83-94 Crossref Scopus (407) PubMed Google Scholar ) to align each image frame to the mean determined by averaging all image frames in the movie dataset. This registration procedure did not correct for axial displacements of the brain. However, as previously ( Nimmerjahn et al., 2009 59. Nimmerjahn, A. ∙ Mukamel, E.A. ∙ Schnitzer, M.J. Motor behavior activates Bergmann glial networks Neuron. 2009; 62 :400-412 Full Text Full Text (PDF) Scopus (233) PubMed Google Scholar ) we estimated axial displacements to be <8 μm. Thus, these displacements did not impair our ability to detect the Ca 2+ spikes that pervade Purkinje neurons’ dendritic trees, since these para-sagittally oriented dendritic arbors never left the focal plane during dorsal-ventral displacements. For spatial registration in the lateral ( x-y ) dimensions, images required corrective displacements with s.d. of 2.5 μm and 3.3 μm in x and y, respectively. To temporally align the behavioral and Ca 2+ imaging data, we programmed the RTOS to output a digital pulse each time it recorded a behavioral data sample (200 Hz acquisition rate). We used MPScope to acquire this digital pulse train concurrently with two-photon image acquisition. Alternatively, we used ScanImage to output a frame clock signal that we acquired concurrently with the behavioral data transmitted by the robot’s electronics controller.
To identify individual Purkinje cells in the two-photon imaging data, for all experiments, except for the mesoscope studies of Figure 2 , we used an established, automated cell sorting algorithm based on principle and independent component analyses (PCA/ICA) validated previously for studies of two-photon Ca 2+ imaging studies of Purkinje neurons ( Mukamel et al., 2009 56. Mukamel, E.A. ∙ Nimmerjahn, A. ∙ Schnitzer, M.J. Automated analysis of cellular signals from large-scale calcium imaging data Neuron. 2009; 63 :747-760 Full Text Full Text (PDF) Scopus (473) PubMed Google Scholar ).
To process the data of Figure 2 , we used a cell-extraction algorithm, EXTRACT (H. Inan et al., 2017, Adv. in Neural Info. Processing Systems, conf.; Inan et al., 2021 38. Inan, H. ∙ Schmuckermair, C. ∙ Tasci, T. ... Fast and statistically robust cell extraction from large-scale neural calcium imaging datasets bioRxiv. 2021; 2021.03.24.436279 Crossref Scopus (0) Google Scholar ), that is based on a framework of robust statistical estimation and that provided superior speed and sensitivity for processing the large image datasets (4 mm 2 field-of-view) acquired on the two-photon mesoscope. Before applying EXTRACT, we first performed several pre-processing steps. We spatially filtered the raw movie data with an anisotropic high-pass filter (second-order Butterworth), for which the cutoff frequencies were 0.01 μm -1 and 0.005 μm -1 in the x- and y- directions, respectively. We used an anisotropic filter of this form due to the elongation of the Purkinje cell dendritic arbors in the y -direction. To remove slow time-variations in the fluorescence signals, we subtracted from each pixel in the movie a time-varying estimate of its baseline fluorescence intensity value. We computed this baseline estimate by constructing a down-sampled time trace of the pixel’s mode intensity values across successive 30 s-intervals, and then up-sampling this trace back to time bins of 57 ms via linear interpolation of the mode values.
After this pre-processing, we applied EXTRACT to identify candidate Purkinje cells. We used an automated procedure to check the attributes of each candidate Purkinje cell, including the cell's area, the solidity of the cell's image, and the signal-to-noise ratio of the cell’s Ca 2+ activity trace. Candidate cells for which any of these attributes were not representative of typical Purkinje cells were automatically excluded from further analyses. Further, we visually checked all remaining candidate Purkinje cells and removed any whose shape differed from typical forms of Purkinje cell dendritic trees or that lacked clear Ca 2+ transients.
After extracting spatial filters corresponding to individual Purkinje cells, whether from PCA/ICA or from EXTRACT, we truncated the filters by setting to zero the weights of all pixels with values less than 1.5 s.d. above the mean pixel weight, averaged across the entire spatial filter. We applied these truncated spatial filters to the raw fluorescence videos to extract fluorescence traces for each Purkinje neuron.
To estimate the times of Ca 2+ spikes at a temporal resolution finer than the image frame acquisition time, we made use of the anatomical arrangement of the Purkinje neurons’ dendritic trees in our images. The long axes of the dendritic trees were all approximately parallel to the slow axis of laser-scanning and generally spanned many fast-scan image lines. Hence, for each dendritic tree we converted the photocurrent data from each image line into a movie with only one spatial dimension, as if we had simply performed rapid laser line-scanning across the neuron. For each line in this computed movie, we weighted the fluorescence values from all pixels according to the weights of the cell’s truncated spatial filter, determined as above.
Generally, individual dendrites had non-uniform spatial forms across the field of view. Thus, some image lines contained superior Ca 2+ signals than others. To account for this, we designed a local smoothing function for computing each line’s signal that incorporated some signals from neighboring lines, rather than considering each line independently. To compute the signal contribution of line n (with n ranging from 1–130), we averaged lines n – W /2 through n + W /2, where W was an even integer chosen separately for each line. To determine the window W, we sought a metric of the line signal’s fidelity. An estimate of the true (free of sampling bias) line signal available to us was the raw frame signal, since it incorporated information from all lines. For each line, we therefore interpolated successive frame signals to match the line signal’s sampling times. For each line, we then chose the value of W as the minimum even integer that produced a line signal whose correlation coefficient with the interpolated frame signal was at least 0.9. In this way, lines of high fidelity used very small local smoothing windows, whereas lines in lower fidelity neighborhoods of the image used large local smoothing windows. We then normalized the contributions of each line such that its largest spikes had the same average magnitude as those in the interpolated frame-averaged signal. We combined all line signals into a single time trace with a time bin corresponding to the line-scan rate of 2.6 kHz.
We next corrected for drifts in fluorescence much slower than Ca 2+ transients. To obtain an estimate of slow drifts, we computed the 10th-percentile value of each 2 s segment of the signal. We subtracted this metric of baseline drift from the signal trace and applied half-wave rectification to preclude negative deflections. To reduce the impact of noise on spike-timing estimates, we smoothed the rectified trace with a low-pass Butterworth filter (–3 dB frequency: 6.5 Hz). To account for the decay kinetics of the GCaMP6f Ca 2+ indicator, we deconvolved the smoothed trace with an exponential function (decay time: 150 ms). We determined the neuron’s spike times as the times of signal peaks in the deconvolved trace ( Figure 3 B and Figure S3 D). By performing concurrent Ca 2+ imaging and electrical recordings of individual Purkinje neurons, we confirmed that this cell sorting procedure correctly identifies complex spikes and their precise times of occurrence ( Figures 3 B and 3C; Figure S3 ).
We assessed the concordance between the spike time estimates attained from the concurrently acquired optical and electrical recordings by comparing the times of peaks in the optical and electrical spike waveforms. We identified complex spikes in the electrical recordings as threshold-crossing events, using a threshold value that we manually verified to detect all visible complex spikes. We denoted the time of the electrical waveform’s first peak as the complex spike’s occurrence time. We identified complex spikes in the optical recordings and estimated the times of their occurrences as described above. Comparisons between the two sets of spike trains revealed that our procedures for analyzing the optical data resulted in >90% correct spike detection and <5% false-positive detection. The paired recordings also revealed that the optical traces allowed high-fidelity detection of complex spikes for inter-spike intervals as brief as ∼100 ms, but could not resolve individual spikes separated by inter-spike intervals briefer than this. In mice, baseline rates of complex spiking are 0.5–2 Hz, and peak rates are generally <10 Hz ( Badura et al., 2013 4. Badura, A. ∙ Schonewille, M. ∙ Voges, K. ... Climbing fiber input shapes reciprocity of Purkinje cell firing Neuron. 2013; 78 :700-713 Full Text Full Text (PDF) Scopus (103) PubMed Google Scholar ), hence this degree of spike resolution suffices to resolve the vast majority of complex spikes in the mouse cerebellum.
We determined the systematic offset between the spike times in the paired optical and electrical datasets as the mean difference between all corresponding pairs of spike times. We determined the stochastic error in the estimation of spike times from the optical data as the s.d. of the spike time offsets ( Figure 3 C), which was 6.1–11 ms. This 6–11 ms timing accuracy is chiefly limited by the rise-time of the GCaMP6f Ca 2+ indicator (∼50 ms) and the finite photon flux, not the 2.6 kHz line-scanning rate, and is more than sufficient given the 25-ms time bins used for analyses throughout the paper.
We extracted interneuron Ca 2+ signals similarly to how we did so for Purkinje neurons. We used the PCA/ICA algorithm to extract spatial filters for the interneuron cell bodies. Due to the strongly correlated patterns of activity among the interneurons, the algorithm often yielded filters covering more than one interneuron. Given the uniformity of the responses seen across the visible interneurons, we analyzed interneuron dynamics based on a single time trace that reflected their collective dynamics. To attain this time trace, we first truncated all interneuron spatial filters by setting to zero the weights of all pixels with values less than 1.5 s.d. above the mean pixel weight, averaged across each spatial filter. We created a single interneuron filter by summing all of the truncated filters, and applied the resultant spatial filter to the raw video data to yield a time trace reflecting the time-dependence of aggregate, interneuron activity levels.
Due to the overlapping sets of pixels occupied by Purkinje dendrites and interneurons, and the substantially greater levels of Ca 2+ activation in Purkinje neurons, we sometimes observed a bleed-through of nearby Purkinje signals into the interneuron activity trace. To determine the level of crosstalk, we performed a least-squares regression of the individual Purkinje neurons’ fluorescence traces onto the interneuron trace. This yielded a set of weights, one for each Purkinje neuron, which reflected the extent to which each Purkinje cell’s Ca 2+ signals had contaminated the interneuron trace. To remove the cross talk, we used these weights and subtracted from the interneuron trace the weighted sum of the signals from the individual Purkinje neurons. This yielded the component of the original interneuron trace that was unaccounted for by spatial bleed-through from Purkinje cells. We verified that the resultant trace reported interneuron activation at time points in the videos with visually obvious interneuron Ca 2+ transients.
We temporally aligned traces of neural activity across different reaching trials by first registering each arm motion trace to one of two different temporal markers and then identifying the 25-ms time bin in the Ca 2+ -imaging data closest in time to the behavioral marker. For all studies except those of perturbations, we temporally registered the traces to the time of movement onset, defined as the time at which the handle velocity rose above 5 mm · s -1 . This choice allowed us to reliably compare neural activity before and after reaching began. For studies of mechanically perturbed reaches ( Figures 5 I–5P), we temporally aligned the activity traces to the time at which the perturbation had laterally deflected the handle to ±4 mm.
To compute the average reaching-evoked pattern of neural ensemble activity, we computed each cell’s reach-triggered average spiking response. We averaged the traces across all Purkinje neurons to obtain an estimate of the mean ensemble response.
To construct the cross-correlation plots in Figures 2 J and S2 C, we took each pair of Purkinje cells and computed the pair’s anatomical displacement and the mean cross-correlation coefficient (at zero time-lag) between the two cells’ Ca 2+ spike trains. This procedure is illustrated in Figures S2 A and S2B. We computed the correlation coefficients using all arm-reaching trials in a recording session (79–234 trials for each mouse studied with the two-photon mesoscope). We binned the displacements between the cell pairs in spatial bins of 40 μm × 40 μm and then determined the mean correlation coefficient averaged over all cell pairs within each spatial bin ( Figures 2 J and S2 C). We compared the results of this analysis on days early (Days 1, 2) and late (Day 7, 8) in motor learning, during reaching and inter-trial periods. (1.2 s window centered either on or −2.9 s prior to movement onset, respectively). To create the plots of Figure S2 D, we took the cross-correlation maps from each mouse and session and determined the mean correlation coefficient as a function of the radial displacement from the origin point on the map. We then averaged the results over all animals and recording sessions.
To analyze the spatiotemporal coherence of Purkinje cell Ca 2+ spiking activity, we applied a sliding time window (350 ms) to each cell’s raster trace of complex spiking activity ( Figure S2 E). Within each 350-ms-window, we identified all cells that spiked at least once, and we designated each cell’s activation time as the mean of its spike times within the window. Given N c active cells within a specific 350-ms-interval, we performed a least-squares, bi-variate linear regression of the N c × 2 matrix containing the x and y coordinates of each one of the cell onto the N c × 1 vector of activation times. We used the resulting r -value from the regression as a measure of how well the linear fit was able to predict cells’ relative spike times based on their physical positions ( Figure S2 G).
To determine whether an r- value was statistically significant, we performed an identical analysis of shuffled datasets in which the spatial locations of the active cells within each 350-ms-window were randomly permuted. By examining many different permutations, we estimated the statistical distribution of r- values across the set of all shuffled datasets and hence the p value of the actual r- value determined for the real data. We constructed a histogram of these p-values across all mice and all 350-ms-time windows ( Figure S2 I).
To assess the time-dependence of spatially coherent neural activity across the course of a reaching trial ( Figure S2 J), we examined all 350-ms-time-windows that had p values <10 −4 ( Figure S2 I). We plotted the time-dependent probability that an individual reach would evoke neural activity with such a high degree of spatial coherence, and we averaged these plots over all reaching trials and all mice within the same experimental condition. We smoothed the resulting traces with a Gaussian kernel (0.5 s time constant).
To compute the time-dependent rate of reach-triggered concerted neural silence, we scored each 25-ms-time bin according to whether or not every Purkinje neuron in the field-of-view was concurrently silent for the entire preceding 75 ms. We then averaged the results across behavioral trials to determine the time-dependent probability of reach-triggered concerted silence. In other cases, we computed the maximal duration of concerted silence, or the total duration of concerted silence summed over the entire trial.
When creating trial-shuffled datasets, for each neuron we independently and randomly permuted the cell’s spike trains across the different reaching trials. This maneuver preserved the timing of each spike with respect to the aligned behavioral data while removing within-trial correlations between neurons. For each behavioral condition we used 200–1000 distinct random permutations so as to construct shuffled data. To determine the mean rate at which synchronized spiking arose in the shuffled data, we first computed the mean rate of synchronized spiking for each shuffle and then took the mean across all shuffles. When performing permutation tests, we computed the parameter of interest (e.g., the rate of concerted silence or synchronized spiking) for each shuffled dataset and compared the resulting values to those from the actual data. If n of the 1000 permutations yielded parameter values that exceeded the values in the real data, we estimated the p-value as n /1000. If n = 0, then p < 0.001 and an exact p-value could not be computed.
In cases in which we discretized synchronized spiking events, we used a threshold stipulating that ≥20% of all visible Purkinje cells must have fired Ca 2+ spikes in the same 25-ms time bin. To compute a binary time trace of the occurrences of these events, we first summed the time-varying binary spike trains of all Purkinje cells in the visible ensemble. We then binarized the resulting trace by thresholding it at a value corresponding to 20% of the total number of cells in the Ca 2+ -imaging movie. Thus, the trace of synchronized spikes had ‘1’ entries for time bins when ≥20% of the cells spiked, and ‘0’ entries in all other time bins. In other cases, we simply tabulated the fraction of cells synchronously spiking at each point in time.
To identify epochs when the mouse was at rest, we identified all intervals lasting >1 s during which the robot detected no substantial arm motions (velocity <0.8 mm⋅s -1 and position within 3 mm of origin) within 200 ms of the interval’s starting and ending time points. We examined the video of the mouse’s behavior for each identified resting period and retained only those during which the mouse made no overt forelimb movements. To extract epochs of arm reaching, we identified from the robot’s recordings all reaches that were >5 mm in total length, advanced >3 mm in the radial direction, and initiated <1 mm away from the manipulandum’s baseline position.
To compute the statistical frequencies of various spiking patterns, we divided all reaching and resting epochs into data blocks of duration 325 ms. Since resting epochs did not always occur in multiples of 325 ms, we used the remainders only if the resulting blocks were 275–375 ms long. We computed the spiking rate during each block. Using the 7 spiking rate levels listed in Figure 4 L, we assigned each data block to the spiking rate level to which it was closest. For all of the blocks assigned to each spiking rate level, we counted the number of concurrent spiking events that occurred with different numbers of neurons active. This allowed us to compute the statistical distribution of concurrent spiking events of different sizes.
To probe the capability to discriminate reaching from resting epochs based on neural activity metrics, we used receiver operating characteristic (ROC) analysis and the above set of reaching and resting data blocks. Since the goal of this analysis was to assess the reliability of concerted neural silence as an indicator of reaching, we restricted the selection of reaching epochs to the main interval during which concerted silence occurred, [100 ms, 400 ms] relative to reaching onset. As part of the ROC analysis, we used two different methods of assigning each data block a score. The first method assigned each block a score equal to its ensemble average spike rate. The second method used as the score the duration of the longest episode of concerted silence across the data block.
For each set of scores, we then attempted to characterize each data block according to whether it occurred during a reaching or resting epoch. All blocks with a score above a minimum threshold were estimated to have occurred during reaching; blocks with scores below the threshold were estimated to have occurred during rest. For a given choice of the threshold value, the proportion of data blocks that were incorrectly estimated to have occurred during reaching was designated as the false-positive rate. Similarly, the proportion of data blocks incorrectly estimated to have occurred during resting yielded the false-negative rate. We varied the threshold value across the entire range of scores and tabulated the resulting true- and false-positive rates. The resulting plot of the true- versus false-positive rates equaled the ROC curve for that method of scoring.
We computed the ROC curve for each mouse and scoring method. Finally, for each mouse and scoring method we computed the area under the ROC curve ( Figure 4 M). This area equals the probability that an observer faced with a choice between one data block that occurred during reaching and one that occurred during resting could correctly discriminate between the two.
To examine synchronous activity in the frequency domain ( Figures S5 H–S5J), we computed the average power spectrum of ensemble spiking during reaching, within the interval [–1000 ms, 1000 ms] relative to reach onset. Temporal windows smaller than this generally provided an insufficient number of data points to compute accurate spectral estimates. We used the time-dependent fraction of active neurons, determined as the normalized sum of the individual spike trains, as a measure of ensemble activity. We then computed the power spectrum of ensemble spiking on each trial using the multi-taper method (Chronux toolbox in MATLAB). This method computes the power spectrum of a single, finite-length trial using multiple orthogonal windows to obtain multiple independent estimates of the spectrum. These windows, or tapers, are given by the Slepian sequence for a particular trial duration and at a particular frequency band. The Slepian sequence guarantees minimum side-lobe energy outside the frequency band of interest. We averaged the resulting spectra across all trials. To determine the contribution of correlated activity between neurons, we simulated the spectrum of an independent ensemble. We produced a shuffled dataset in which single-trial correlations between neurons were absent, and we compared the resulting spectrum to that of the real data.
The spectral content of the sum of multiple signals (i.e., the ensemble spike rate) contains a component arising from the autocorrelations of the individual signals and a component arising from the correlations between the different signals. We thus examined each component individually. First we computed the mean cross-spectrum between all pairs of neurons. We then computed the power spectrum of each individual neuron’s spike train.
To compute movement stereotypy metrics ( Figure 3 ), for each imaging session we computed the mean movement trajectory by independently averaging across all trials the forward and lateral coordinates of the reaching motion, temporally aligned to movement onset and terminating 200 ms after the average time at which movement ended. For this analysis, we defined the end of movement as follows. For arm movements that reached the virtual wall at 8 mm from the forepaw’s point of origin, we defined the end of movement as the time at which the forepaw’s radial displacement from its starting point exceeded 7.5 mm. For movements that did not reach the virtual wall, we defined the end of movement as the first time at which the position was within 0.5 mm of the final position. For each mouse this approach yielded a net time interval, termed t win , over which we performed the stereotypy analysis. For each movement trial, this approach yielded a pair of t win -length vectors, one for forward and one for lateral motion. We concatenated these two into a single vector of length 2 t win . To assess the similarity of this vector on an individual trial to its trial-averaged form, we computed the Pearson correlation coefficient between the two. Alternatively, we computed the root-mean-square-difference between the corresponding elements of the two vectors. To determine the angle of each movement, we computed tan -1 ( x f / y f ), where ( x f , y f ) was the reach’s endpoint position.
Inferior olivary neurons have an intrinsic ∼10-Hz rhythmicity in their sub-threshold membrane potential dynamics ( Bazzigaluppi et al., 2012a 5. Bazzigaluppi, P. ∙ De Gruijl, J.R. ∙ van der Giessen, R.S. ... Olivary subthreshold oscillations and burst activity revisited Front. Neural Circuits. 2012; 6 :91 Crossref Scopus (50) PubMed Google Scholar ; Khosrovani et al., 2007 42. Khosrovani, S. ∙ Van Der Giessen, R.S. ∙ De Zeeuw, C.I. ... In vivo mouse inferior olive neurons exhibit heterogeneous subthreshold oscillations and spiking patterns Proc. Natl. Acad. Sci. USA. 2007; 104 :15911-15916 Crossref Scopus (75) PubMed Google Scholar ). Groups or ‘micro-compartments’ of these cells are interconnected by electrical gap junctions that promote synchronization of the cells’ sub-threshold oscillations ( De Zeeuw et al., 1998 20. De Zeeuw, C.I. ∙ Simpson, J.I. ∙ Hoogenraad, C.C. ... Microcircuitry and function of the inferior olive Trends Neurosci. 1998; 21 :391-400 Full Text Full Text (PDF) Scopus (351) PubMed Google Scholar ; De Zeeuw et al., 1997 19. De Zeeuw, C.I. ∙ Koekkoek, S.K.E. ∙ Wylie, D.R.W. ... Association between dendritic lamellar bodies and complex spike synchrony in the olivocerebellar system J. Neurophysiol. 1997; 77 :1747-1758 Crossref Scopus (63) PubMed Google Scholar ). To model these dynamics, we computationally simulated a network of coupled Kuramoto phase oscillators ( Kuramoto, 1984 46. Kuramoto, Y. Chemical Oscillations, Waves, and Turbulence Springer, 1984 Crossref Google Scholar ), governed by: 𝑑 ⁢ 𝜃 𝑖 𝑑 ⁢ 𝑡 = 𝜔 𝑖 + κ ⁡ ( 𝑡 ) ⋅ ∑ 𝑛 𝑗 = 1 𝑠 ⁢ 𝑖 ⁢ 𝑛 ⁢ ( 𝜃 𝑗 − 𝜃 𝑖 ) . Here 𝜃 𝑖 ⁡ ( 𝑡 ) is the time-varying oscillatory phase of the subthreshold membrane voltage of the i ’th cell, 𝜔 𝑖 is its natural frequency of oscillation, n is the total number of cells in a micro-compartment, and κ ( 𝑡 ) is a time-dependent parameter describing the strength of their gap junction coupling, which is physiologically modified by shunting inhibition mediated by inputs from the deep cerebellar nuclei ( Bengtsson and Hesslow, 2006 7. Bengtsson, F. ∙ Hesslow, G. Cerebellar control of the inferior olive Cerebellum. 2006; 5 :7-14 Crossref Scopus (93) PubMed Google Scholar ; Best and Regehr, 2009 8. Best, A.R. ∙ Regehr, W.G. Inhibitory regulation of electrically coupled neurons in the inferior olive is mediated by asynchronous release of GABA Neuron. 2009; 62 :555-565 Full Text Full Text (PDF) Scopus (106) PubMed Google Scholar ; Devor and Yarom, 2000 21. Devor, A. ∙ Yarom, Y. GABAergic modulation of olivary oscillations Prog. Brain Res. 2000; 124 :213-220 Crossref PubMed Google Scholar ; Lang et al., 1996 47. Lang, E.J. ∙ Sugihara, I. ∙ Llinás, R. GABAergic modulation of complex spike activity by the cerebellar nucleoolivary pathway in rat J. Neurophysiol. 1996; 76 :255-275 Crossref Scopus (182) PubMed Google Scholar ; Lefler et al., 2014 50. Lefler, Y. ∙ Yarom, Y. ∙ Uusisaari, M.Y. Cerebellar inhibitory input to the inferior olive decreases electrical coupling and blocks subthreshold oscillations Neuron. 2014; 81 :1389-1400 Full Text Full Text (PDF) Scopus (96) PubMed Google Scholar ). We chose values of 𝜔 𝑖 randomly from a Gaussian distribution with a mean of 10 Hz and a SD of 2 Hz.
These oscillator dynamics in turn determined each cell’s membrane potential dynamics, 𝑉 𝑖 ⁡ ( 𝑡 ) = s i n ⁡ 𝜃 𝑖 ⁡ ( 𝑡 ) + 𝐷 ⁢ 𝐶 ⁡ ( 𝑡 ) + 𝜀 ⁡ ( 𝑡 ) , where DC ( t ) is a time-varying input that is shared between all the cells and intended to model the general level of motor-related synaptic inputs. 𝜀 ⁡ ( 𝑡 ) is a term representing input fluctuations; in practice we randomly chose values of 𝜀 ⁡ ( 𝑡 ) from a Gaussian-distribution with a s.d. of 4.6% of the spike threshold. This modest level of noise was set so that cells had a ∼1 Hz mean spike rate and was based on intracellular electrophysiological recordings showing that the spike threshold of olivary neurons is close to the transmembrane potential value at the peak depolarization of the subthreshold voltage oscillations in these cells ( Bazzigaluppi et al., 2012a 5. Bazzigaluppi, P. ∙ De Gruijl, J.R. ∙ van der Giessen, R.S. ... Olivary subthreshold oscillations and burst activity revisited Front. Neural Circuits. 2012; 6 :91 Crossref Scopus (50) PubMed Google Scholar ). Accordingly, we set the peak-to-peak amplitude of the voltage oscillations in the simulation to be 91% of the spike threshold. The value of DC ( t ) was zero, except for intermittent periods when it was 1.4% of spike threshold. Figure 7 shows results from simulations (2 ms time steps) of networks of size n = 30, 100 or 500, with all cell pairs interconnected; we varied κ from 0–5 in increments of 0.06, and for each κ value we acquired data for a simulated duration of 5 s. For visual clarity, the plots of Figure 7 C each show results from randomly chosen sets of 5000 time-steps.
In analytic studies of Kuramoto oscillator networks, it is common to define an order parameter that describes the network’s instantaneous level of phase coherence: 𝑟 = ∣ ⟨ 𝑒 𝑖 ⁢ 𝜃 𝑗 ⁡ ( 𝑡 ) ⟩ ∣ , where brackets, ⟨ ⋅ ⟩ , indicate an average over all n oscillators, and | · | denotes the absolute value. A value of r = 1 indicates that all the oscillators have the same phase, whereas a value of r = 0 indicates that the phases are uniformly distributed. To plot distributions in Figures 7 E–7G comparably to how we treated the Ca 2+ imaging data, we binned and binarized spikes in the simulations using 25-ms-time bins. In the unlikely event a cell fired two spikes in a single time bin, we recorded only the first spike in the bin.
In the limit of a large number of oscillators, we can analytically compute the coherence parameter, 𝑟 , as a function of the coupling, κ, using the mean field theory of Kuramoto oscillators ( Acebrón et al., 2005 2. Acebrón, J.A. ∙ Bonilla, L.L. ∙ Pérez Vicente, C.J. ... The Kuramoto model: A simple paradigm for synchronization phenomena Rev. Mod. Phys. 2005; 77 :137-185 Crossref Scopus (2487) Google Scholar ). This theory develops a Fokker-Planck equation describing the time-evolution of the distribution of oscillator phases and frequencies and then finds steady-state solutions in which the coherence, 𝑟 , attains stable values. Using Equation 12 from ( Acebrón et al., 2005 2. Acebrón, J.A. ∙ Bonilla, L.L. ∙ Pérez Vicente, C.J. ... The Kuramoto model: A simple paradigm for synchronization phenomena Rev. Mod. Phys. 2005; 77 :137-185 Crossref Scopus (2487) Google Scholar ), in the case when the distribution of natural oscillation frequencies, 𝜔 𝑖 , is a Gaussian with SD, σ , then any non-zero value of 𝑟 must obey the following relation: 𝑧 – 1 = 1 ∫ – 1 𝑑 𝑢 ⁢ √ 1 – 𝑢 2 2 ⁢ 𝜋 𝑒 − ( 𝑟 ⁢ 𝑧 ⁢ 𝑢 ) 2 2 where 𝑧 = κ / σ is a dimensionless quantity, the coupling amplitude in units of the frequency dispersion. The right-hand side of this equation, as a function of 𝑟 , achieves a maximal value of √ 𝜋 / 8 when 𝑟 = 0 and decreases with increasing 𝑟 . Thus, there can be no non-zero solution for 𝑟 unless 𝑧 > √ 8 / 𝜋 ≈ 1 . 6 . Indeed, the function 𝑟 ⁡ ( 𝑧 ) exhibits a sharp transition from 𝑟 = 0 for 𝑧 ≤ √ 8 / 𝜋 , to 𝑟 > 0 for 𝑧 > √ 8 / 𝜋 , reflecting a discrete bifurcation from zero to partial phase coherence. The numerical solution for 𝑟 ⁡ ( 𝑧 ) is shown in the dashed black lines in Figure 7 C, and it shows that a very small change in 𝑧 = κ / σ at around 𝑧 ≈ 1.6 can implement a significant state change to phase synchronization, as measured by the order parameter 𝑟 . The numerical simulations confirm this prediction, particularly for large values of n .
For the studies of Figure S7 , we simulated a grid of Kuramoto oscillators that were coupled locally, instead of uniformly as in Figure 7 . Thus, the phase dynamics were governed by 𝑑 ⁢ 𝜃 𝑖 𝑑 ⁢ 𝑡 = 𝜔 𝑖 + κ ⁡ ( 𝑡 ) · ∑ 𝑁 𝑗 = 1 𝛫 𝑖 ⁢ 𝑗 ⁢ s i n ⁡ ( 𝜃 𝑗 − 𝜃 𝑖 ) where the coupling weights 𝐾 𝑖 ⁢ 𝑗 between neurons were 1 for nearest neighbor cells, 0.5 for next-nearest neighbors, 0.25 for next-next-nearest neighbors, and 0 otherwise, as shown in Figures S7 A and S7B. The membrane dynamics of each cell were determined as in the model of Figure 7 , using the same values of DC ( t ) and 𝜀 ⁡ ( 𝑡 ) .
We used MATLAB (Mathworks) to perform all statistics tests. For basic comparisons of the medians of two sample sets, we used the Wilcoxon rank-sum test, referred to as a rank-sum test in the main text. To probe whether the median difference between paired sample sets was non-zero, we used the Wilcoxon signed-rank test, termed a signed-rank test in the main text. For tests on frequency distributions, we used Pearson’s chi-squared test, an approximate test that requires relatively large sample sizes, as justified by the many thousands of spiking events in our sample sets. We used exact permutation tests to compare real and shuffled data as outlined above.

Section: Acknowledgments

We acknowledge funding to M.J.S. from DARPA, NIH and HHMI, a NSF NeuroNex grant to K.D., M.J.S., and L.L., funding to L.L. from NIH and HHMI, grants to S.G. from the Simons Foundation and the NSF CAREER program, and a Burroughs Wellcome Fund CASI to M.J.W. We thank J. Li for animal husbandry and histological analyses, E. Kremer for CAV2-Cre virus, and J.E. Fitzgerald, C.K. Kim, A. Nimmerjahn, S. Sinha, and J. Tucciarone for technical advice.
M.J.W. and M.J.S. designed experiments. M.J.W. performed experiments and analyzed data. M.J.W. and J.S. designed and built the robot. O.R. and J.L. designed and built the mesoscope, and O.H. used it with M.J.W. to acquire data. H.I. created the cell extraction algorithm for the mesoscope imaging data, which G.M. and M.J.W. analyzed. T.H.K. created optical designs for performing optogenetic manipulations during Ca 2+ imaging. C.R. and K.D. provided optogenetics reagents. J.Z.L. prepared viral vectors. L.L. contributed mouse resources and reagents and edited the paper. S.G., M.J.W., M.J.S., and G.M. made and analyzed the computational model. M.J.S. supervised the project. M.J.W. and M.J.S. wrote and edited the paper.
O.R., M.J.S., J.L., T.H.K., and J.S. are inventors on a patent, assigned to Stanford, for the two-photon mesoscope. K.D. and C.R. have disclosed all novel opsins to Stanford, which has submitted patent applications to facilitate commercial application and translation; all opsin methods, protocols, clones, and sequences are freely available to nonprofit institutions and investigators.
