Title: Constant Sub-second Cycling between Representations of Possible Futures in the Hippocampus


Abstract: Summary

Cognitive faculties such as imagination, planning, and decision-making entail the ability to represent hypothetical experience. Crucially, animal behavior in natural settings implies that the brain can represent hypothetical future experience not only quickly but also constantly over time, as external events continually unfold. To determine how this is possible, we recorded neural activity in the hippocampus of rats navigating a maze with multiple spatial paths. We found neural activity encoding two possible future scenarios (two upcoming maze paths) in constant alternation at 8 Hz: one scenario per ∼125-ms cycle. Further, we found that the underlying dynamics of cycling (both inter- and intra-cycle dynamics) generalized across qualitatively different representational correlates (location and direction). Notably, cycling occurred across moving behaviors, including during running. These findings identify a general dynamic process capable of quickly and continually representing hypothetical experience, including that of multiple possible futures.

Section: Introduction

Traditional approaches to cognition have focused on the neural representation of external stimuli ( Mountcastle, 1998 98. Mountcastle, V.B. Perceptual Neuroscience: The Cerebral Cortex Harvard University Press, 1998 Google Scholar ). In contrast, the ability to construct and simulate hypothetical experience, whether of a counterfactual past, an alternative present, or a possible future, has only more recently begun to be widely understood as fundamental to the brain ( Buzsáki, 2006; Buckner and Carroll, 2007; Gilbert and Wilson, 2007; Suddendorf and Corballis, 2007; Seligman et al., 2013; Mullally and Maguire, 2014; Smallwood and Schooler, 2015 10. Buckner, R.L. ∙ Carroll, D.C. Self-projection and the brain Trends Cogn. Sci. 2007; 11 :49-57 Full Text Full Text (PDF) Scopus (1548) PubMed Google Scholar 13. Buzsáki, G. Rhythms of the Brain Oxford University Press, 2006 Crossref Google Scholar 49. Gilbert, D.T. ∙ Wilson, T.D. Prospection: experiencing the future Science. 2007; 317 :1351-1354 Crossref Scopus (584) PubMed Google Scholar 99. Mullally, S.L. ∙ Maguire, E.A. Memory, Imagination, and Predicting the Future: A Common Brain Mechanism? Neuroscientist. 2014; 20 :220-234 Crossref Scopus (85) PubMed Google Scholar 115. Seligman, M.E. ∙ Railton, P. ∙ Baumeister, R.F. ... Navigating into the future or driven by the past Perspect. Psychol. Sci. 2013; 8 :119-141 Crossref Scopus (0) PubMed Google Scholar 121. Smallwood, J. ∙ Schooler, J.W. The science of mind wandering: empirically navigating the stream of consciousness Annu. Rev. Psychol. 2015; 66 :487-518 Crossref PubMed Google Scholar 123. Suddendorf, T. ∙ Corballis, M.C. The evolution of foresight: What is mental time travel, and is it unique to humans? Behav. Brain Sci. 2007; 30 :299-313, discussion 313–351 Crossref Scopus (965) PubMed Google Scholar ). This ability—which we here refer to as “generativity”—is essential for a range of cognitive faculties (e.g., planning, imagination, and decision-making), indicating a unifying role in cognition. Despite this importance, it remains unclear how generativity is implemented in the brain at the neural level.
Here, behavior and ecology provide direct insight. Generativity contributes to behavior ultimately through projection into the future; future projection enables outcome prediction, which advantageously guides ongoing behavior. Thus, an account of behaviors that entail future projection can identify biologically necessary properties of generative representation. Crucially, in natural (ecological) settings, high-speed behaviors such as predation and escape are known to require subjects to decide between possible future scenarios not only extremely quickly, but also constantly, as external events continually unfold ( Cisek and Kalaska, 2010; Cisek, 2012 23. Cisek, P. Making decisions through a distributed consensus Curr. Opin. Neurobiol. 2012; 22 :927-936 Crossref Scopus (146) PubMed Google Scholar 24. Cisek, P. ∙ Kalaska, J.F. Neural mechanisms for interacting with a world full of action choices Annu. Rev. Neurosci. 2010; 33 :269-298 Crossref Scopus (657) PubMed Google Scholar ). This observation implies that the underlying process that generates representations of possible future scenarios has matching properties: sub-second speed and constant operation over time.
Previous work has identified candidate patterns of neural activity encoding possible future scenarios, but these patterns have been found to occur only intermittently and in association with relatively slow (∼1 Hz or less), overtly deliberative behaviors; namely, head scanning ( Johnson and Redish, 2007; Redish, 2016 63. Johnson, A. ∙ Redish, A.D. Neural ensembles in CA3 transiently encode paths forward of the animal at a decision point J. Neurosci. 2007; 27 :12176-12189 Crossref Scopus (500) PubMed Google Scholar 110. Redish, A.D. Vicarious trial and error Nat. Rev. Neurosci. 2016; 17 :147-159 Crossref Scopus (261) PubMed Google Scholar ) and immobility ( Carr et al., 2011; Pfeiffer and Foster, 2013; Buzsáki, 2015; Foster, 2017; Joo and Frank, 2018 14. Buzsáki, G. Hippocampal sharp wave-ripple: A cognitive biomarker for episodic memory and planning Hippocampus. 2015; 25 :1073-1188 Crossref Scopus (341) PubMed Google Scholar 17. Carr, M.F. ∙ Jadhav, S.P. ∙ Frank, L.M. Hippocampal replay in the awake state: a potential substrate for memory consolidation and retrieval Nat. Neurosci. 2011; 14 :147-153 Crossref Scopus (389) PubMed Google Scholar 43. Foster, D.J. Replay Comes of Age Annu. Rev. Neurosci. 2017; 40 :581-602 Crossref Scopus (55) PubMed Google Scholar 65. Joo, H.R. ∙ Frank, L.M. The hippocampal sharp wave-ripple in memory retrieval for immediate use and consolidation Nat. Rev. Neurosci. 2018; 19 :744-757 Crossref Scopus (18) PubMed Google Scholar 107. Pfeiffer, B.E. ∙ Foster, D.J. Hippocampal place-cell sequences depict future paths to remembered goals Nature. 2013; 497 :74-79 Crossref Scopus (456) PubMed Google Scholar ). As a consequence, it has remained unknown how the brain is capable of representing possible future scenarios quickly and constantly.
To investigate how generativity is implemented in the brain, we sought first to specify a candidate neural substrate. Importantly, generative thinking has been found to activate and require the hippocampus ( Buckner, 2010; McCormick et al., 2018 9. Buckner, R.L. The role of the hippocampus in prediction and imagination Annu. Rev. Psychol. 2010; 61 :27-48 C1–8 Crossref Scopus (220) PubMed Google Scholar 90. McCormick, C. ∙ Rosenthal, C.R. ∙ Miller, T.D. ... Mind-wandering in people with hippocampal damage J. Neurosci. 2018; 38 :2745-2754 Crossref Scopus (33) PubMed Google Scholar ), a brain region traditionally linked to memory and spatial navigation. Indeed, recent work on spatially selective hippocampal neurons (place cells) has found activity patterns encoding single generative scenarios in the form of single hypothetical spatial paths ( Johnson and Redish, 2007; Carr et al., 2011; Pfeiffer and Foster, 2013; Buzsáki, 2015; Redish, 2016; Foster, 2017; Joo and Frank, 2018 14. Buzsáki, G. Hippocampal sharp wave-ripple: A cognitive biomarker for episodic memory and planning Hippocampus. 2015; 25 :1073-1188 Crossref Scopus (341) PubMed Google Scholar 17. Carr, M.F. ∙ Jadhav, S.P. ∙ Frank, L.M. Hippocampal replay in the awake state: a potential substrate for memory consolidation and retrieval Nat. Neurosci. 2011; 14 :147-153 Crossref Scopus (389) PubMed Google Scholar 43. Foster, D.J. Replay Comes of Age Annu. Rev. Neurosci. 2017; 40 :581-602 Crossref Scopus (55) PubMed Google Scholar 63. Johnson, A. ∙ Redish, A.D. Neural ensembles in CA3 transiently encode paths forward of the animal at a decision point J. Neurosci. 2007; 27 :12176-12189 Crossref Scopus (500) PubMed Google Scholar 65. Joo, H.R. ∙ Frank, L.M. The hippocampal sharp wave-ripple in memory retrieval for immediate use and consolidation Nat. Rev. Neurosci. 2018; 19 :744-757 Crossref Scopus (18) PubMed Google Scholar 107. Pfeiffer, B.E. ∙ Foster, D.J. Hippocampal place-cell sequences depict future paths to remembered goals Nature. 2013; 497 :74-79 Crossref Scopus (456) PubMed Google Scholar 110. Redish, A.D. Vicarious trial and error Nat. Rev. Neurosci. 2016; 17 :147-159 Crossref Scopus (261) PubMed Google Scholar ). Despite this advance, these generative activity patterns have been found to occur only intermittently (∼1 Hz or slower) and thus cannot implement the speed and constant operation required by natural behavior.
We conjectured that identifying a candidate pattern of neural activity might require a methodological approach inspired by natural behavior: specifically, (1) use of a task that requires naturalistic behavior (self-generated locomotion) and that can be solved rapidly by means of generative representation, such as of upcoming spatial paths ( Figure 1 A), and (2) analysis of neural activity inclusive of periods of high-speed movement. We speculated that these two methods together could prove to be sufficient if applied to the study of neural substrates implicated in generativity.
Taking this approach, we recorded and analyzed hippocampal place cell activity in a simple self-paced task that benefits from generative representation. In a bifurcating maze, subjects (rats) allowed to move at high speed (∼50 cm/s) had to choose correctly between two upcoming locations—the left (L) versus right (R) maze arm—without relying on external directing cues (spatial alternation task, see Figure S1 A; recording configuration, see Figure 1 B; cells analyzed were putative principal cells [n = 1,756 cells from 12 subjects; CA1, 978; CA2, 250; CA3, 528] firing at least 100 spikes [mean ± SD, 912 ± 810 spikes] in a ∼15-min recording epoch; survey of mean firing rates is shown in Figure S1 B) ( Karlsson and Frank, 2009; Kim and Frank, 2009; Kay et al., 2016 67. Karlsson, M.P. ∙ Frank, L.M. Awake replay of remote experiences in the hippocampus Nat. Neurosci. 2009; 12 :913-918 Crossref Scopus (351) PubMed Google Scholar 69. Kay, K. ∙ Sosa, M. ∙ Chung, J.E. ... A hippocampal network for spatial coding during immobility and sleep Nature. 2016; 531 :185-190 Crossref Scopus (69) PubMed Google Scholar 72. Kim, S.M. ∙ Frank, L.M. Hippocampal lesions impair rapid learning of a continuous spatial alternation task PLoS ONE. 2009; 4 :e5494 Crossref Scopus (41) PubMed Google Scholar ). Importantly, the bifurcation in the task maze enables unambiguous detection of generative neural activity; in the time period prior to the subject’s choice of arm, neural activity encoding the arm not chosen would necessarily constitute neural activity encoding a possible future scenario (see schematic in Figures 1 C and 1D). Leveraging this experimental paradigm, we examined the activity of place cells encoding either the L or R arm (surveyed in Figures S1 D–S1F), focusing on periods of movement prior to subjects’ overt choice of arm.
Unexpectedly, we found that place cells encoding the L versus R arms could fire in strikingly regular alternation at ∼8 Hz; i.e., a given cell firing on every other 8 Hz cycle (see example cell pairs in Figures 1 E–1J and 2 A–2D and survey of cell pairs in Figure 1 K). This pattern of activity was significant in two ways. First, this pattern was unexpected given the classical description of place cells as firing characteristically on adjacent 8 Hz cycles ( O’Keefe and Recce, 1993; Huxter et al., 2003; Zugaro et al., 2005 58. Huxter, J. ∙ Burgess, N. ∙ O’Keefe, J. Independent rate and temporal coding in hippocampal pyramidal cells Nature. 2003; 425 :828-832 Crossref Scopus (382) PubMed Google Scholar 105. O’Keefe, J. ∙ Recce, M.L. Phase relationship between hippocampal place units and the EEG theta rhythm Hippocampus. 1993; 3 :317-330 Crossref PubMed Google Scholar 139. Zugaro, M.B. ∙ Monconduit, L. ∙ Buzsáki, G. Spike phase precession persists after transient intrahippocampal perturbation Nat. Neurosci. 2005; 8 :67-71 Crossref Scopus (63) PubMed Google Scholar ; see examples of classic firing in Figures S1 L–S1O). Second, this pattern was the first indication that possible future scenarios (the two upcoming arms) could be encoded with both sub-second speed (i.e., firing within single 8 Hz cycles) and constancy over time (i.e., firing regularly every other 8 Hz cycle).
We further found that place cells encoding opposite heading directions (direction-selective place cells; McNaughton et al., 1983a 92. McNaughton, B.L. ∙ Barnes, C.A. ∙ O’Keefe, J. The contributions of position, direction, and velocity to single unit activity in the hippocampus of freely-moving rats Exp. Brain Res. 1983; 52 :41-49 Crossref Scopus (649) PubMed Google Scholar ; surveyed in Figures S1 G–S1I) could fire in regular alternation at 8 Hz (see example cell pairs in Figures 2 E–2J), a finding we revisit later. Overall quantification indicated that regular alternation at 8 Hz was a surprisingly common pattern in the hippocampus (8%–9% of cell pair samples; Figure S2 ). To refer to this dynamic pattern of neural firing, we hereafter use the term “constant cycling,” denoting the combination of regularity and alternation.
Importantly, 8 Hz matches the frequency of hippocampal theta ( Buzsáki, 2002; Colgin, 2013 12. Buzsáki, G. Theta oscillations in the hippocampus Neuron. 2002; 33 :325-340 Full Text Full Text (PDF) Scopus (1781) PubMed Google Scholar 25. Colgin, L.L. Mechanisms and functions of theta rhythms Annu. Rev. Neurosci. 2013; 36 :295-312 Crossref Scopus (153) PubMed Google Scholar ), a neural rhythm overtly expressed in the local field potential (LFP) (see example raw trace and spectrum in Figure S1 J, filtered at 5–11 Hz and shown in plots as θ throughout; e.g., Figure 1 G) and known to entrain hippocampal neural firing ( O’Keefe, 2007; Mizuseki et al., 2009; Kay et al., 2016 69. Kay, K. ∙ Sosa, M. ∙ Chung, J.E. ... A hippocampal network for spatial coding during immobility and sleep Nature. 2016; 531 :185-190 Crossref Scopus (69) PubMed Google Scholar 95. Mizuseki, K. ∙ Sirota, A. ∙ Pastalkova, E. ... Theta oscillations provide temporal windows for local circuit computation in the entorhinal-hippocampal loop Neuron. 2009; 64 :267-280 Full Text Full Text (PDF) Scopus (339) PubMed Google Scholar 102. O’Keefe, J. Hippocampal neurophysiology in the behaving animal Anderson, P. ∙ Morris, R. ∙ Amaral, D. (Editors) The Hippocampus Book Oxford University Press, 2007; 475-548 Google Scholar ). Indeed, theta entrained the firing of the majority of cells in the dataset (90% or 1,485 of 1,644 cells; Figure S1 K), consistent with theta entrainment of 8 Hz cycling and previous work showing theta entrainment of competing neural populations during spatial foraging ( Harris et al., 2003; Deshmukh et al., 2010; Jezek et al., 2011; Brandon et al., 2013 7. Brandon, M.P. ∙ Bogaard, A.R. ∙ Schultheiss, N.W. ... Segregation of cortical head direction cell assemblies on alternating θ cycles Nat. Neurosci. 2013; 16 :739-748 Crossref Scopus (49) PubMed Google Scholar 31. Deshmukh, S.S. ∙ Yoganarasimha, D. ∙ Voicu, H. ... Theta modulation in the medial and the lateral entorhinal cortices J. Neurophysiol. 2010; 104 :994-1006 Crossref Scopus (85) PubMed Google Scholar 52. Harris, K.D. ∙ Csicsvari, J. ∙ Hirase, H. ... Organization of cell assemblies in the hippocampus Nature. 2003; 424 :552-556 Crossref Scopus (504) PubMed Google Scholar 62. Jezek, K. ∙ Henriksen, E.J. ∙ Treves, A. ... Theta-paced flickering between place-cell maps in the hippocampus Nature. 2011; 478 :246-249 Crossref Scopus (151) PubMed Google Scholar ). Given these results, we analyzed periods when theta is continuously active; namely, periods of locomotor behavior such as walking and running ( O’Keefe, 2007; Kay and Frank, 2019 68. Kay, K. ∙ Frank, L.M. Three brain states in the hippocampus and cortex Hippocampus. 2019; 29 :184-238 Crossref Scopus (4) PubMed Google Scholar 102. O’Keefe, J. Hippocampal neurophysiology in the behaving animal Anderson, P. ∙ Morris, R. ∙ Amaral, D. (Editors) The Hippocampus Book Oxford University Press, 2007; 475-548 Google Scholar ).
Prior work has claimed that anatomical ( Marr, 1971; McNaughton and Morris, 1987; Lisman et al., 2005 83. Lisman, J.E. ∙ Talamini, L.M. ∙ Raffone, A. Recall of memory sequences by interaction of the dentate and CA3: a revised model of the phase precession Neural Netw. 2005; 18 :1191-1201 Crossref Scopus (95) PubMed Google Scholar 88. Marr, D. Simple memory: a theory for archicortex Philos. Trans. R. Soc. Lond. B Biol. Sci. 1971; 262 :23-81 Crossref PubMed Google Scholar 91. McNaughton, B.L. ∙ Morris, R.G. Hippocampal synaptic enhancement and information storage within a distributed memory system Trends Neurosci. 1987; 10 :408-415 Abstract Full Text (PDF) Scopus (846) Google Scholar ) and behavioral ( Buzsáki, 1989; O’Keefe, 2007; Kay and Frank, 2019 11. Buzsáki, G. Two-stage model of memory trace formation: a role for “noisy” brain states Neuroscience. 1989; 31 :551-570 Crossref Scopus (1052) PubMed Google Scholar 68. Kay, K. ∙ Frank, L.M. Three brain states in the hippocampus and cortex Hippocampus. 2019; 29 :184-238 Crossref Scopus (4) PubMed Google Scholar 102. O’Keefe, J. Hippocampal neurophysiology in the behaving animal Anderson, P. ∙ Morris, R. ∙ Amaral, D. (Editors) The Hippocampus Book Oxford University Press, 2007; 475-548 Google Scholar ) correlates of hippocampal neural activity are essential to understand function. We therefore sought to determine whether constant cycling at 8 Hz had any such correlates. To do so, we analyzed single-cell firing ( Figure 3 ), for which constant cycling would manifest as “skipped” cycles ( Deshmukh et al., 2010; Brandon et al., 2013 7. Brandon, M.P. ∙ Bogaard, A.R. ∙ Schultheiss, N.W. ... Segregation of cortical head direction cell assemblies on alternating θ cycles Nat. Neurosci. 2013; 16 :739-748 Crossref Scopus (49) PubMed Google Scholar 31. Deshmukh, S.S. ∙ Yoganarasimha, D. ∙ Voicu, H. ... Theta modulation in the medial and the lateral entorhinal cortices J. Neurophysiol. 2010; 104 :994-1006 Crossref Scopus (85) PubMed Google Scholar ) (cycle skipping; see example cells in Figures 3 A–3E and survey of cells in Figure 3 F). Notably, single-cell analysis does not require two particular cells to fire in alternation, making fewer assumptions about cell participation from cycle to cycle.
To quantify cycle skipping in single cells, we calculated a cycle skipping index (CSI) similar to measures used in studies of the entorhinal cortex ( Deshmukh et al., 2010; Brandon et al., 2013 7. Brandon, M.P. ∙ Bogaard, A.R. ∙ Schultheiss, N.W. ... Segregation of cortical head direction cell assemblies on alternating θ cycles Nat. Neurosci. 2013; 16 :739-748 Crossref Scopus (49) PubMed Google Scholar 31. Deshmukh, S.S. ∙ Yoganarasimha, D. ∙ Voicu, H. ... Theta modulation in the medial and the lateral entorhinal cortices J. Neurophysiol. 2010; 104 :994-1006 Crossref Scopus (85) PubMed Google Scholar ); in particular, the CSI measures the tendency of single cells to fire on adjacent cycles versus on every other cycle, ranging from −1 (only adjacent) to 1 (only every other).
The subsequent quantification revealed both an anatomical and a behavioral correlate: (1) cycle skipping was more prevalent in cells in subregions CA2 and CA3 than in CA1 (median [interquartile range] [n = number of cell samples]; CA1: −0.15 [−0.27, 0.01] [n = 2,230], CA2: −0.11 [−0.30, 0.21] [n = 564], CA3: 0.01 [−0.21, 0.36] [n = 869]; CA2 versus CA1, p = 0.0039; CA3 versus CA1, p = 4.5e−33; rank-sum tests) (see distributions in Figure 3 G), and (2) cycle skipping was more prevalent when subjects approached versus departed from the choice point (choice imminent versus choice passed, corresponding to outbound versus inbound periods in the center maze arm, respectively; diagrammed at the top of Figure 3 H) (median [interquartile range] [n = number of cell samples]; CA1 imminent: −0.13 [−0.29, 0.10] [n = 518], CA1 passed: −0.18 [−0.34, −0.04] [n = 522], CA2 imminent: −0.02 [−0.30, 0.52] [n = 120], CA2 passed: −0.25 [−0.46, −0.12] [n = 120], CA3 imminent: 0.05 [−0.26, 0.50] [n = 231], CA3 passed: −0.16 [−0.35, 0.11] [n = 179]; CA1 imminent versus passed: p = 0.00017, CA2 imminent versus passed: p = 1.9e−7, CA3 imminent versus passed: p = 1.1e−5; rank-sum tests) (see distributions in Figure 3 H).
To assess whether these findings were due to a simple relationship between cycle skipping and overall amount of firing, we also tested whether there was any correlation between CSI and average firing rate. The resulting correlation values were not significant (Spearman’s ρ = 0.01, p = 0.40; n = 3,663 path-based cell samples across CA1, CA2, and CA3), indicating that enhancement of cycle skipping was not simply due to differing overall firing. Instead, the results in Figures 3 G and 3H implicate structural and behavioral factors, respectively, with the latter suggesting that behavior-level choice (here between upcoming maze paths) recruits the constant cycling firing pattern globally across hippocampal neurons.
We hypothesized that constant cycling firing, which we first found to encode possible future scenarios in pairs of cells ( Figures 1 and 2 ), might in fact be coherently expressed across entire populations of hippocampal neurons. To test this possibility, we analyzed hippocampal neural firing at the population level ( Figure 4 ). Preliminary inspection of firing across co-recorded cells suggested constant cycling at 8 Hz between possible future locations (L versus R maze arms) prior to the behavioral choice (see example cell population firing in Figure S3 ). For formal analysis, we used a decoding algorithm that is maximally inclusive of the recorded neural firing data (clusterless decoding [ Kloosterman et al., 2014; Deng et al., 2015 30. Deng, X. ∙ Liu, D.F. ∙ Kay, K. ... Clusterless Decoding of Position from Multiunit Activity Using a Marked Point Process Filter Neural Comput. 2015; 27 :1438-1460 Crossref Scopus (17) PubMed Google Scholar 75. Kloosterman, F. ∙ Layton, S.P. ∙ Chen, Z. ... Bayesian Decoding using Unsorted Spikes in the Rat Hippocampus J. Neurophysiol. 2014; 111 :217-227 Crossref Scopus (40) PubMed Google Scholar ] of all electrodes [across regions] reporting putative principal cells; STAR Methods ). Given the behavior-level correlates identified above (i.e., possible future locations in Figures 1 and 2 A–2D and choice imminent periods in Figure 3 H), we decoded location when subjects approached the choice point (see decoding examples in Figures 4 A–4C and S4 A–S4F). As expected from previously established results showing ∼100-ms population firing encoding sequences of locations along a single path (schematized in Figure S1 C; Feng et al., 2015; Wikenheiser and Redish, 2015 39. Feng, T. ∙ Silva, D. ∙ Foster, D.J. Dissociation between the experience-dependent development of hippocampal theta sequences and single-trial phase precession J. Neurosci. 2015; 35 :4890-4902 Crossref Scopus (51) PubMed Google Scholar 132. Wikenheiser, A.M. ∙ Redish, A.D. Hippocampal theta sequences reflect current goals Nat. Neurosci. 2015; 18 :289-294 Crossref Scopus (170) PubMed Google Scholar ), the decoded firing data showed ∼100-ms periods in which location projected away from the subject (see example instances highlighted by open arrowheads in Figures 4 A and S4 A).
Remarkably, the decoded output showed periods of constant cycling at 8 Hz between L versus R maze arms (constant cycling detected as L/R switching across 4 or more successive cycles, seen as alternating periods of L [blue] versus R [red] decoded locations [color density] in Figures 4 A–4C and S4 A–S4F), recalling the constant cycling at 8 Hz observed in cell pairs ( Figures 1 and 2 A–2D). To test whether constant cycling between L versus R representations may have occurred because of random or noisy activity, we carried out two shuffle analyses. First, we shuffled the order of decoded cycles across the dataset (10,000 permutations; cycles segregated with respect to the 8 Hz theta rhythm) and measured the frequency (p value) with which constant cycling occurred in the observed versus shuffled data (study-wide shuffle). This analysis indicated that the constant cycling pattern was unlikely to have occurred by chance (p = 0.0034, observed [red line] versus shuffled [black histogram] prevalence of constant cycling shown in Figures 4 D and S4 G). Second, individual periods of constant cycling were tested by shuffling within each recording epoch (individual period shuffles), identifying particular periods that were unlikely to have occurred by chance (93 of 141 total constant cycling periods at p < 0.05; see shuffle p values and period durations in Figures 4 E and 4F and S4 H and S4I).
Previous work has described hippocampal neural activity encoding possible future locations as occurring specifically in association with overtly deliberative behavior such as head scans (vicarious trial and error [ Johnson and Redish, 2007; Redish, 2016 63. Johnson, A. ∙ Redish, A.D. Neural ensembles in CA3 transiently encode paths forward of the animal at a decision point J. Neurosci. 2007; 27 :12176-12189 Crossref Scopus (500) PubMed Google Scholar 110. Redish, A.D. Vicarious trial and error Nat. Rev. Neurosci. 2016; 17 :147-159 Crossref Scopus (261) PubMed Google Scholar ]); this claim led us to ask whether constant cycling at 8 Hz was restricted to such behaviors. We found this not to be the case: constant cycling at 8 Hz commonly occurred during high movement speed in the absence of head scans and, thus, did not depend on overtly deliberative behavior ( Figures 4 G and S4 J). We also asked whether decoded activity during movement was reliably associated with future behavior; in particular, the subject’s upcoming choice of L versus R maze arms. We found that the decoded activity did not reliably predict L versus R ( Figure S5 ), indicating that the cycling dynamic reflected a flexible underlying process not deterministically controlled by overt choice, at least under the present conditions (maze navigation and learning prior to asymptotic performance).
How does the hippocampus represent possible futures as fast as at 8 Hz? The finding that 8 Hz cycling was paced by the theta rhythm ( Figures 4 , S3 , and S4 ; also evident in Figures 1 and 2 ) suggested that investigating theta would clarify the underlying dynamic process. We thought that this process might in fact operate at a timescale finer than full theta cycles; the above observation of cycling of future possibilities across theta cycles (inter-cycle coding) suggests a structured process that generates an individual possibility within each theta cycle (intra-cycle coding).
Intriguingly, classic work ( O’Keefe and Recce, 1993; Skaggs et al., 1996 105. O’Keefe, J. ∙ Recce, M.L. Phase relationship between hippocampal place units and the EEG theta rhythm Hippocampus. 1993; 3 :317-330 Crossref PubMed Google Scholar 120. Skaggs, W.E. ∙ McNaughton, B.L. ∙ Wilson, M.A. ... Theta phase precession in hippocampal neuronal populations and the compression of temporal sequences Hippocampus. 1996; 6 :149-172 Crossref Scopus (946) PubMed Google Scholar ) has identified an instance of intra-cycle coding: place cells fire at specific phases within theta cycles so that early- versus late-phase firing encodes current versus future location, respectively ( O’Keefe and Recce, 1993; Skaggs et al., 1996; Feng et al., 2015; Wikenheiser and Redish, 2015 39. Feng, T. ∙ Silva, D. ∙ Foster, D.J. Dissociation between the experience-dependent development of hippocampal theta sequences and single-trial phase precession J. Neurosci. 2015; 35 :4890-4902 Crossref Scopus (51) PubMed Google Scholar 105. O’Keefe, J. ∙ Recce, M.L. Phase relationship between hippocampal place units and the EEG theta rhythm Hippocampus. 1993; 3 :317-330 Crossref PubMed Google Scholar 120. Skaggs, W.E. ∙ McNaughton, B.L. ∙ Wilson, M.A. ... Theta phase precession in hippocampal neuronal populations and the compression of temporal sequences Hippocampus. 1996; 6 :149-172 Crossref Scopus (946) PubMed Google Scholar 132. Wikenheiser, A.M. ∙ Redish, A.D. Hippocampal theta sequences reflect current goals Nat. Neurosci. 2015; 18 :289-294 Crossref Scopus (170) PubMed Google Scholar ). Importantly, this classic case refers only to neural firing related to a single spatial path; this differs from the present study, in which we initially observed neural firing related to multiple alternative spatial paths (as defined either by the maze bifurcation [ Figures 1 and 2 A–2D] or by heading direction [ Figures 2 E–2J]), indicating encoding of hypothetical scenarios. In light of these findings, we conjectured that the classic correlate of intra-cycle coding—current versus future location—might in fact be an instantiation of a decidedly more abstract correlate: namely, current versus hypothetical experience. As such, neural firing encoding any type of hypothetical (whether of location, direction, or other correlates) would occur at the late phase of theta, akin to firing encoding future location in the classic case ( O’Keefe and Recce, 1993; Skaggs et al., 1996; Feng et al., 2015; Wikenheiser and Redish, 2015 39. Feng, T. ∙ Silva, D. ∙ Foster, D.J. Dissociation between the experience-dependent development of hippocampal theta sequences and single-trial phase precession J. Neurosci. 2015; 35 :4890-4902 Crossref Scopus (51) PubMed Google Scholar 105. O’Keefe, J. ∙ Recce, M.L. Phase relationship between hippocampal place units and the EEG theta rhythm Hippocampus. 1993; 3 :317-330 Crossref PubMed Google Scholar 120. Skaggs, W.E. ∙ McNaughton, B.L. ∙ Wilson, M.A. ... Theta phase precession in hippocampal neuronal populations and the compression of temporal sequences Hippocampus. 1996; 6 :149-172 Crossref Scopus (946) PubMed Google Scholar 132. Wikenheiser, A.M. ∙ Redish, A.D. Hippocampal theta sequences reflect current goals Nat. Neurosci. 2015; 18 :289-294 Crossref Scopus (170) PubMed Google Scholar ).
To investigate this possibility, we first determined whether intra-cycle coding generalizes to the representation of possible future locations (L versus R, schematized in Figure S1 D) at the population and single-cell levels. At the population level ( Figure 4 ), we measured the theta phase when decoded position was in one of three locations in the maze: the center arm, the subsequently chosen (choice) arm, or non-chosen (alternative) arm. The resulting phase histograms ( Figures 4 H and S4 K, histograms at two resolutions: 12-bin (left) and 2-bin (right); n = 1,683 maze passes across 7 subjects) and quantification (referencing 2-bin histograms in Figures 4 H and S4 K) indicated that the alternative arm was represented selectively on the second half of theta (alternative [purple] versus center [black], p = 3.1e−6; alternative [purple] versus uniform distribution [0.5 proportion, dashed line], p = 3.2e−6; signed-rank tests), equivalent to representation of the choice arm (choice [gray] versus center [black], p = 4.6e−44; choice [gray] versus uniform distribution [0.5 proportion, dashed line], p = 2.0e−47; signed-rank tests) and to future location, as in the classic single-path case ( O’Keefe and Recce, 1993; Skaggs et al., 1996; Feng et al., 2015; Wikenheiser and Redish, 2015 39. Feng, T. ∙ Silva, D. ∙ Foster, D.J. Dissociation between the experience-dependent development of hippocampal theta sequences and single-trial phase precession J. Neurosci. 2015; 35 :4890-4902 Crossref Scopus (51) PubMed Google Scholar 105. O’Keefe, J. ∙ Recce, M.L. Phase relationship between hippocampal place units and the EEG theta rhythm Hippocampus. 1993; 3 :317-330 Crossref PubMed Google Scholar 120. Skaggs, W.E. ∙ McNaughton, B.L. ∙ Wilson, M.A. ... Theta phase precession in hippocampal neuronal populations and the compression of temporal sequences Hippocampus. 1996; 6 :149-172 Crossref Scopus (946) PubMed Google Scholar 132. Wikenheiser, A.M. ∙ Redish, A.D. Hippocampal theta sequences reflect current goals Nat. Neurosci. 2015; 18 :289-294 Crossref Scopus (170) PubMed Google Scholar ).
Importantly, this result yielded further insight into single-cell firing ( Figures 5 A and 6 A–6D). Subsets of single place cells are known to fire at different mean rates depending on which path (e.g., L versus R) the subject subsequently takes ( Frank et al., 2000; Wood et al., 2000; Ferbinteanu and Shapiro, 2003 40. Ferbinteanu, J. ∙ Shapiro, M.L. Prospective and retrospective memory coding in the hippocampus Neuron. 2003; 40 :1227-1239 Full Text Full Text (PDF) Scopus (351) PubMed Google Scholar 47. Frank, L.M. ∙ Brown, E.N. ∙ Wilson, M. Trajectory encoding in the hippocampus and entorhinal cortex Neuron. 2000; 27 :169-178 Full Text Full Text (PDF) PubMed Google Scholar 135. Wood, E.R. ∙ Dudchenko, P.A. ∙ Robitsek, R.J. ... Hippocampal neurons encode information about different types of memory episodes occurring in the same location Neuron. 2000; 27 :623-633 Full Text Full Text (PDF) Scopus (657) PubMed Google Scholar ), a pattern we here refer to as outbound path coding. In light of cycling between differing upcoming locations ( Figure 4 ), it would be expected that place cells showing outbound path coding (higher mean firing when the preferred path is going to be chosen) fire to some extent even when subjects choose the cells’ non-preferred path; furthermore, such non-preferred firing should occur mainly at later theta phases, given the later theta phase specificity of alternative path representation at the population level ( Figure 4 H). Visual inspection of single-cell firing (see examples in Figures 5 A and 6 A and survey in Figure 6 B) and quantification of firing phase confirmed both implications ( Figures 6 C and 6D, histograms at two resolutions: 12-bin and 2-bin; quantification references second half of theta in 2-bin histograms, n = 132 cell samples; non-preferred [non-pref] versus preferred [pref], p = 1.2e−8; non-pref versus uniform distribution [0.5 proportion, dashed line], p = 2.2e−10; signed-rank tests). Thus, firing on the non-preferred path is consistent with representation of a possible future, or hypothetical, location.
Unexpectedly, single-cell analysis indicated that theta phase also governed the well-established hippocampal representation of heading direction ( McNaughton et al., 1983a; Battaglia et al., 2004; Davidson et al., 2009 4. Battaglia, F.P. ∙ Sutherland, G.R. ∙ McNaughton, B.L. Local sensory cues and place cell directionality: additional evidence of prospective coding in the hippocampus J. Neurosci. 2004; 24 :4541-4550 Crossref Scopus (93) PubMed Google Scholar 29. Davidson, T.J. ∙ Kloosterman, F. ∙ Wilson, M.A. Hippocampal replay of extended experience Neuron. 2009; 63 :497-507 Full Text Full Text (PDF) Scopus (344) PubMed Google Scholar 92. McNaughton, B.L. ∙ Barnes, C.A. ∙ O’Keefe, J. The contributions of position, direction, and velocity to single unit activity in the hippocampus of freely-moving rats Exp. Brain Res. 1983; 52 :41-49 Crossref Scopus (649) PubMed Google Scholar ). Visual inspection of single-cell firing ( Figures 5 B and 6 E; see survey in Figure 6 F) and quantification of firing phase ( Figures 6 G and 6H, histograms at two resolutions: 12-bin and 2-bin; quantification references second half of theta in 2-bin histograms, n = 665 cell samples; non-pref versus pref, p = 1.6e−35; non-pref versus uniform distribution [0.5 proportion, dashed line], p = 4.9e−29; signed-rank tests) revealed that firing occurring when subjects traveled in cells’ non-pref direction occurred at later phases of theta, a pattern echoing the outbound path case ( Figures 6 A–6D). In this way, firing in the non-preferred direction is consistent with representation of the non-current, or hypothetical, direction. It is worth noting that past surveys of directional selectivity in single cells have found a markedly wide distribution of selectivity values ( Battaglia et al., 2004 4. Battaglia, F.P. ∙ Sutherland, G.R. ∙ McNaughton, B.L. Local sensory cues and place cell directionality: additional evidence of prospective coding in the hippocampus J. Neurosci. 2004; 24 :4541-4550 Crossref Scopus (93) PubMed Google Scholar ; Figure S1 I; unlike that of location, Figure S1 F), consistent with the possibility that single-cycle dynamics (not captured by time-averaging) in fact govern the representation of direction.
The generalization of intra-cycle coding to direction suggested that other correlates might be similarly organized via phase. Indeed, extending our analysis, we observed equivalent theta phase coding for additional representational firing patterns in the hippocampus: inbound path coding ( Frank et al., 2000; Wood et al., 2000; Ferbinteanu and Shapiro, 2003 40. Ferbinteanu, J. ∙ Shapiro, M.L. Prospective and retrospective memory coding in the hippocampus Neuron. 2003; 40 :1227-1239 Full Text Full Text (PDF) Scopus (351) PubMed Google Scholar 47. Frank, L.M. ∙ Brown, E.N. ∙ Wilson, M. Trajectory encoding in the hippocampus and entorhinal cortex Neuron. 2000; 27 :169-178 Full Text Full Text (PDF) PubMed Google Scholar 135. Wood, E.R. ∙ Dudchenko, P.A. ∙ Robitsek, R.J. ... Hippocampal neurons encode information about different types of memory episodes occurring in the same location Neuron. 2000; 27 :623-633 Full Text Full Text (PDF) Scopus (657) PubMed Google Scholar ) and extra-field firing ( Johnson and Redish, 2007 63. Johnson, A. ∙ Redish, A.D. Neural ensembles in CA3 transiently encode paths forward of the animal at a decision point J. Neurosci. 2007; 27 :12176-12189 Crossref Scopus (500) PubMed Google Scholar ) (see inbound path examples in Figure 5 C; collected results are shown in Figure S6 A). The finding of equivalent temporal organization across multiple neural codes characterized by alternative hypotheticals—here of location, direction, and path—suggests a single common process that generates representations of hypothetical scenarios, including those of possible futures, and expresses these representations selectively on later phases of theta.
Lastly, we determined whether there was any direct relationship between intra-cycle structure and the previously observed inter-cycle firing ( Figures 1 , 2 , 3 , and 4 ), which had indicated encoding of hypotheticals at a longer timescale. Quantification of inter-cycle firing (cycle skipping in single cells, characterized initially in Figure 3 ) conditioned on intra-cycle structure (whether firing occurred on the first versus second half of theta cycles) indicated that inter-cycle firing was stronger for firing from the second half of theta cycles ( Figure S6 B), consistent with a common process that underlies representation of hypotheticals.
The finding that theta phase (intra-cycle) coding, long established for the representation of location ( O’Keefe and Recce, 1993; Skaggs et al., 1996 105. O’Keefe, J. ∙ Recce, M.L. Phase relationship between hippocampal place units and the EEG theta rhythm Hippocampus. 1993; 3 :317-330 Crossref PubMed Google Scholar 120. Skaggs, W.E. ∙ McNaughton, B.L. ∙ Wilson, M.A. ... Theta phase precession in hippocampal neuronal populations and the compression of temporal sequences Hippocampus. 1996; 6 :149-172 Crossref Scopus (946) PubMed Google Scholar ), generalizes to non-locational correlates at the single-cell level ( Figures 6 and S6 A) raises the possibility that theta phase organizes non-locational representations across entire populations of hippocampal neurons.
To determine whether this was the case, we analyzed the hippocampal representation of heading direction, a non-locational variable long known to be a robust correlate of single-cell firing ( McNaughton et al., 1983a; Eichenbaum et al., 1999; Battaglia et al., 2004 4. Battaglia, F.P. ∙ Sutherland, G.R. ∙ McNaughton, B.L. Local sensory cues and place cell directionality: additional evidence of prospective coding in the hippocampus J. Neurosci. 2004; 24 :4541-4550 Crossref Scopus (93) PubMed Google Scholar 36. Eichenbaum, H. ∙ Dudchenko, P. ∙ Wood, E. ... The hippocampus, memory, and place cells: is it spatial memory or a memory space? Neuron. 1999; 23 :209-226 Full Text Full Text (PDF) Scopus (671) PubMed Google Scholar 92. McNaughton, B.L. ∙ Barnes, C.A. ∙ O’Keefe, J. The contributions of position, direction, and velocity to single unit activity in the hippocampus of freely-moving rats Exp. Brain Res. 1983; 52 :41-49 Crossref Scopus (649) PubMed Google Scholar ). Initially, we observed instances of population-level activity consistent with intra-cycle organization by inspecting firing in co-recorded place cells grouped by directional selectivity ( Figure S7 A). For formal analysis, we inferred the representation of direction from population-level hippocampal neural firing with the same decoding approach as applied previously to location (clusterless decoding of all electrodes [across regions] reporting putative principal cells; STAR Methods ). Notably, the decoded output exhibited periods of less than 100-ms duration within which the decoded representation switched from current to hypothetical direction and back (upper decoded data in Figures S6 C and S6D). Quantification with respect to theta phase revealed that current versus hypothetical direction were preferentially expressed on the first versus second halves of theta, respectively, indicating phase organization at the population level ( Figure S6 E). Leveraging this finding, we subsequently decoded in windows that sampled each half of the theta cycle (half-theta cycle windows in the middle and lower decoded data in Figures S6 C and S6D).
Strikingly, decoding revealed periods of constant half-theta cycling of direction (see example decoded data in Figures 7 A–7C and S7 B–S7E; constant half-theta cycling defined as representational switching across 4 or more successive half-theta cycles, seen as alternating periods of outbound [blue] versus inbound [red] in the decoded direction). To test whether constant half-theta cycling between outbound versus inbound might have occurred because of random or noisy activity, we carried out two shuffling analyses. First, we shuffled the order of decoded cycles across the dataset (10,000 permutations) and measured the frequency (p value) with which constant half-theta cycling occurred in the observed versus shuffled data (study-wide shuffle). This analysis indicated that the constant half-theta cycling activity pattern was unlikely to have occurred by chance (p < 0.0001, the lower bound of the test; observed [red line] versus shuffled [black histogram] prevalence of constant half-theta cycling shown in Figure 7 D). Second, individual periods of constant half-theta cycling were tested by shuffling within each recording epoch (individual period shuffles), identifying particular periods that were unlikely to have occurred by chance (767 of 12,147 total constant half-theta cycling periods at p < 0.05, see shuffle p values in Figures 7 E [4+ half-cycles] and S7 F [8+ half-cycles] and period durations in Figure 7 F). Importantly, as in periods of constant cycling of location ( Figures 4 G and S4 J), periods of constant half-theta cycling of direction could occur at a wide range of linear and angular speeds ( Figures 7 G and S7 G), including during running.

Section: Discussion

We present two main findings: (1) neural firing capable of fast and continual representation of multiple possible future scenarios (constant cycling at 8 Hz) and (2) generalization of the underlying cycling dynamics (both inter- and intra-cycle dynamics) across qualitatively different representational correlates, here location and direction (cycle coding of hypotheticals). Cycling dynamics were detectable at three levels of neural organization (the single-cell [ Figures 3 , 5 , and 6 ], cell-pair [ Figures 1 and 2 ], and population [ Figures 4 and 7 ] levels) and, further, had both anatomical ( Figure 3 G) and behavioral ( Figure 3 H) correlates.
Recent work has established that high-level cognitive functions such as planning and deliberation rely on the brain’s ability to represent hypothetical (rather than ongoing) experience, an ability we here refer to as generativity. Unlike stimulus-driven activity as classically described in sensory neural circuits ( Mountcastle, 1998 98. Mountcastle, V.B. Perceptual Neuroscience: The Cerebral Cortex Harvard University Press, 1998 Google Scholar ), the origins of generative neural activity remain poorly understood. Here, place cells in the hippocampus offer a model system given their known generativity; in particular, their representation of hypothetical spatial paths ( Lisman and Redish, 2009; Pfeiffer and Foster, 2013; Wikenheiser and Redish, 2015; Redish, 2016; Foster, 2017 43. Foster, D.J. Replay Comes of Age Annu. Rev. Neurosci. 2017; 40 :581-602 Crossref Scopus (55) PubMed Google Scholar 82. Lisman, J. ∙ Redish, A.D. Prediction, sequences and the hippocampus Philos. Trans. R. Soc. Lond. B Biol. Sci. 2009; 364 :1193-1201 Crossref Scopus (126) PubMed Google Scholar 107. Pfeiffer, B.E. ∙ Foster, D.J. Hippocampal place-cell sequences depict future paths to remembered goals Nature. 2013; 497 :74-79 Crossref Scopus (456) PubMed Google Scholar 110. Redish, A.D. Vicarious trial and error Nat. Rev. Neurosci. 2016; 17 :147-159 Crossref Scopus (261) PubMed Google Scholar 132. Wikenheiser, A.M. ∙ Redish, A.D. Hippocampal theta sequences reflect current goals Nat. Neurosci. 2015; 18 :289-294 Crossref Scopus (170) PubMed Google Scholar ).
In this study, we find that the rat place cell representation of possible futures has an unexpected conjunction of four properties: constancy over time, sub-second speed, temporal segmentation (akin to time-division multiplexing; Akam and Kullmann, 2014; Caruso et al., 2018 1. Akam, T. ∙ Kullmann, D.M. Oscillatory multiplexing of population codes for selective communication in the mammalian brain Nat. Rev. Neurosci. 2014; 15 :111-122 Crossref Scopus (121) PubMed Google Scholar 19. Caruso, V.C. ∙ Mohl, J.T. ∙ Glynn, C. ... Single neurons may encode simultaneous stimuli by switching between activity patterns Nat. Commun. 2018; 9 :2715 Crossref Scopus (1) PubMed Google Scholar ), and rhythmicity (pacing by the 8 Hz theta rhythm). Further, these temporal properties generalize across (at least) two qualitatively different representational correlates (location and direction). Together, these properties and their generalization specify putative mechanisms of generativity in three ways: time, neural substrates, and generality.
With respect to time, segmentation within theta cycles (an intra-cycle dynamic; Hasselmo et al., 2002; Kunec et al., 2005; Siegle and Wilson, 2014; Wilson et al., 2015 54. Hasselmo, M.E. ∙ Bodelón, C. ∙ Wyble, B.P. A proposed function for hippocampal theta rhythm: separate phases of encoding and retrieval enhance reversal of prior learning Neural Comput. 2002; 14 :793-817 Crossref Scopus (469) PubMed Google Scholar 77. Kunec, S. ∙ Hasselmo, M.E. ∙ Kopell, N. Encoding and retrieval in the CA3 region of the hippocampus: a model of theta-phase separation J. Neurophysiol. 2005; 94 :70-82 Crossref Scopus (75) PubMed Google Scholar 117. Siegle, J.H. ∙ Wilson, M.A. Enhancement of encoding and retrieval functions through theta phase-specific manipulation of hippocampus eLife. 2014; 3 :e03061 Crossref PubMed Google Scholar 134. Wilson, M.A. ∙ Varela, C. ∙ Remondes, M. Phase organization of network computations Curr. Opin. Neurobiol. 2015; 31 :250-253 Crossref PubMed Google Scholar ) specifies a mechanism that can switch between representations of current versus hypothetical experience as fast as twice the frequency of theta (equivalent to 16 Hz); in addition, segmentation across theta cycles (an inter-cycle dynamic; Harris et al., 2003; Deshmukh et al., 2010; Jezek et al., 2011; Brandon et al., 2013 7. Brandon, M.P. ∙ Bogaard, A.R. ∙ Schultheiss, N.W. ... Segregation of cortical head direction cell assemblies on alternating θ cycles Nat. Neurosci. 2013; 16 :739-748 Crossref Scopus (49) PubMed Google Scholar 31. Deshmukh, S.S. ∙ Yoganarasimha, D. ∙ Voicu, H. ... Theta modulation in the medial and the lateral entorhinal cortices J. Neurophysiol. 2010; 104 :994-1006 Crossref Scopus (85) PubMed Google Scholar 52. Harris, K.D. ∙ Csicsvari, J. ∙ Hirase, H. ... Organization of cell assemblies in the hippocampus Nature. 2003; 424 :552-556 Crossref Scopus (504) PubMed Google Scholar 62. Jezek, K. ∙ Henriksen, E.J. ∙ Treves, A. ... Theta-paced flickering between place-cell maps in the hippocampus Nature. 2011; 478 :246-249 Crossref Scopus (151) PubMed Google Scholar ) specifies a mechanism that can switch between representations of hypotheticals as fast as the frequency of theta (8 Hz). The present observation of these two dynamics builds on previous results demonstrating representational switching at the population level in the hippocampus ( Johnson and Redish, 2007; Jezek et al., 2011; Kelemen and Fenton, 2016 62. Jezek, K. ∙ Henriksen, E.J. ∙ Treves, A. ... Theta-paced flickering between place-cell maps in the hippocampus Nature. 2011; 478 :246-249 Crossref Scopus (151) PubMed Google Scholar 63. Johnson, A. ∙ Redish, A.D. Neural ensembles in CA3 transiently encode paths forward of the animal at a decision point J. Neurosci. 2007; 27 :12176-12189 Crossref Scopus (500) PubMed Google Scholar 70. Kelemen, E. ∙ Fenton, A.A. Coordinating different representations in the hippocampus Neurobiol. Learn. Mem. 2016; 129 :50-59 Crossref Scopus (21) PubMed Google Scholar ) by showing that structured sub-second dynamics can govern the representation of behaviorally explicit alternative scenarios, moreover doing so constantly over time. It is also worth remarking how these two dynamics elaborate upon previous cycle-based frameworks ( Lisman and Redish, 2009; Sanders et al., 2015 82. Lisman, J. ∙ Redish, A.D. Prediction, sequences and the hippocampus Philos. Trans. R. Soc. Lond. B Biol. Sci. 2009; 364 :1193-1201 Crossref Scopus (126) PubMed Google Scholar 113. Sanders, H. ∙ Rennó-Costa, C. ∙ Idiart, M. ... Grid Cells and Place Cells: An Integrated View of their Navigational and Memory Function Trends Neurosci. 2015; 38 :763-775 Full Text Full Text (PDF) Scopus (38) PubMed Google Scholar ) for understanding hippocampal neural representation; the intra-cycle dynamic corresponds to transitions from current (in the first half-cycle) to hypothetical (in the second half-cycle), whereas the inter-cycle dynamic corresponds to activation of differing hypotheticals (across successive second half-cycles). Furthermore, with regard to external input, either dynamic was observed to occur in the absence of inducing sensory stimuli—i.e., spontaneously—and under naturalistic conditions (here self-paced, goal-directed navigation); these dynamics were also seen in the absence of overtly deliberative behaviors such as head scans (vicarious trial-and-error; Redish, 2016 110. Redish, A.D. Vicarious trial and error Nat. Rev. Neurosci. 2016; 17 :147-159 Crossref Scopus (261) PubMed Google Scholar ). Most immediately, these various properties indicate that models of network-level theta dynamics ( Tsodyks et al., 1996; Thurley et al., 2008; Navratilova et al., 2012a; Wang et al., 2015; Chadwick et al., 2016; Mark et al., 2017 21. Chadwick, A. ∙ van Rossum, M.C. ∙ Nolan, M.F. Flexible theta sequence compression mediated via phase precessing interneurons eLife. 2016; 5 :e20349 Crossref Scopus (5) PubMed Google Scholar 87. Mark, S. ∙ Romani, S. ∙ Jezek, K. ... Theta-paced flickering between place-cell maps in the hippocampus: A model based on short-term synaptic plasticity Hippocampus. 2017; 27 :959-970 Crossref Scopus (5) PubMed Google Scholar 100. Navratilova, Z. ∙ Giocomo, L.M. ∙ Fellous, J.M. ... Phase precession and variable spatial scaling in a periodic attractor map model of medial entorhinal grid cells with realistic after-spike dynamics Hippocampus. 2012; 22 :772-789 Crossref Scopus (99) PubMed Google Scholar 125. Thurley, K. ∙ Leibold, C. ∙ Gundlfinger, A. ... Phase precession through synaptic facilitation Neural Comput. 2008; 20 :1285-1324 Crossref Scopus (26) PubMed Google Scholar 127. Tsodyks, M.V. ∙ Skaggs, W.E. ∙ Sejnowski, T.J. ... Population dynamics and theta rhythm phase precession of hippocampal place cell firing: a spiking neuron model Hippocampus. 1996; 6 :271-280 Crossref PubMed Google Scholar 131. Wang, Y. ∙ Romani, S. ∙ Lustig, B. ... Theta sequences are essential for internally generated hippocampal firing fields Nat. Neurosci. 2015; 18 :282-288 Crossref Scopus (110) PubMed Google Scholar ) require additional or alternative mechanisms.
With respect to neural substrates, the rhythmic entrainment of 8 Hz cycling to the theta rhythm implicates brain regions linked to the generation and expression of theta ( Buzsáki, 2002; Colgin, 2013 12. Buzsáki, G. Theta oscillations in the hippocampus Neuron. 2002; 33 :325-340 Full Text Full Text (PDF) Scopus (1781) PubMed Google Scholar 25. Colgin, L.L. Mechanisms and functions of theta rhythms Annu. Rev. Neurosci. 2013; 36 :295-312 Crossref Scopus (153) PubMed Google Scholar ). Indeed, previous work has reported cycling firing at 8 Hz in subpopulations of neurons in several of these regions (medial septum [ King et al., 1998 73. King, C. ∙ Recce, M. ∙ O’Keefe, J. The rhythmicity of cells of the medial septum/diagonal band of Broca in the awake freely moving rat: relationships with behaviour and hippocampal theta Eur. J. Neurosci. 1998; 10 :464-477 Crossref Scopus (130) PubMed Google Scholar ] and entorhinal cortex [ Jeffery et al., 1995; Deshmukh et al., 2010; Brandon et al., 2013 7. Brandon, M.P. ∙ Bogaard, A.R. ∙ Schultheiss, N.W. ... Segregation of cortical head direction cell assemblies on alternating θ cycles Nat. Neurosci. 2013; 16 :739-748 Crossref Scopus (49) PubMed Google Scholar 31. Deshmukh, S.S. ∙ Yoganarasimha, D. ∙ Voicu, H. ... Theta modulation in the medial and the lateral entorhinal cortices J. Neurophysiol. 2010; 104 :994-1006 Crossref Scopus (85) PubMed Google Scholar 61. Jeffery, K.J. ∙ Donnett, J.G. ∙ O’Keefe, J. Medial septal control of theta-correlated unit firing in the entorhinal cortex of awake rats Neuroreport. 1995; 6 :2166-2170 Crossref PubMed Google Scholar ]). Additionally, multiple theta generators have been found within the hippocampus itself ( Buzsáki, 2006; Montgomery et al., 2009 13. Buzsáki, G. Rhythms of the Brain Oxford University Press, 2006 Crossref Google Scholar 97. Montgomery, S.M. ∙ Betancur, M.I. ∙ Buzsáki, G. Behavior-dependent coordination of multiple theta dipoles in the hippocampus J. Neurosci. 2009; 29 :1381-1394 Crossref Scopus (113) PubMed Google Scholar ), reminiscent of the finding that cycling firing is expressed at different levels in CA1 versus CA2 and CA3 neurons ( Figure 3 G). These various results suggest privileged roles for structurally defined neural circuits within and beyond the hippocampus. At the same time, the present results implicate a distributed mechanism: cell firing (in single cells or cell pairs) could exhibit cycle skipping in one condition but not another (see examples in Figures 1 G, 1H, 2 , and 3 B), indicating that a larger scale of organization is required to explain how cycling is generated.
With respect to generality, the finding that cycling dynamics are shared across the representations of location and direction (intra-cycle, Figures 5 and 6 ; inter-cycle, Figures 1 and 2 ) and likely other representations ( Figure S6 A), indicates that, at least for the rat hippocampus, generative activity for different correlates is produced by a theta-associated common mechanism. Indeed, it could be that such a mechanism might structure additional (and possibly all) hippocampal representational correlates involving hypotheticals. Still, it is important to note that the theta rhythm appears to be expressed in a species-specific manner, with an apparent lack of continuous activation in humans, primates, and bats ( Las and Ulanovsky, 2014 78. Las, L. ∙ Ulanovsky, N. Hippocampal Neurophysiology Across Species Derdikman, D. ∙ Knierim, J.J. (Editors) Space, Time and Memory in the Hippocampal Formation Springer Vienna, 2014; 431-461 Crossref Scopus (13) Google Scholar ). One important possibility, suggested by recent findings in bats ( Eliav et al., 2018 37. Eliav, T. ∙ Geva-Sagiv, M. ∙ Yartsev, M.M. ... Nonoscillatory Phase Coding and Synchronization in the Bat Hippocampal Formation Cell. 2018; 175 :1119-1130.e15 Full Text Full Text (PDF) Scopus (0) PubMed Google Scholar ), is that cycle-based dynamics could occur without continuous rhythmicity. Indeed, from an algorithmic viewpoint, constant cycling, defined as a process that regularly represents differing items (e.g., alternative locations) at segregated and internally generated times (cycles), does not entail any particular spectral bandwidth, much less any particular neural rhythm. Further, intra-cycle coding of hypotheticals, defined as a process that represents a radically abstract correlate (current versus hypothetical experience) at internally specified times (cycle phases), likewise does not entail any particular frequency or rhythm. Thus these structured dynamic processes are not only plausibly observable in other neurobiological systems, but also plausibly implementable in artificial representational systems.
Beyond the hippocampus, the present findings imply that similar neural representations dependent on theta dynamics (intra- and inter-cycle) could be the case in brain regions directly or indirectly connected to the hippocampus ( David and Pierre, 2007; Sirota et al., 2008; van Strien et al., 2009 28. David, A. ∙ Pierre, L. Hippocampal neuroanatomy Andersen, P. ∙ Morris, R. ∙ Amaral, D. ... (Editors) The Hippocampus Book Oxford University Press, 2007 Google Scholar 118. Sirota, A. ∙ Montgomery, S. ∙ Fujisawa, S. ... Entrainment of neocortical neurons and gamma oscillations by the hippocampal theta rhythm Neuron. 2008; 60 :683-697 Full Text Full Text (PDF) Scopus (525) PubMed Google Scholar 128. van Strien, N.M. ∙ Cappaert, N.L. ∙ Witter, M.P. The anatomy of memory: an interactive overview of the parahippocampal-hippocampal network Nat. Rev. Neurosci. 2009; 10 :272-282 Crossref Scopus (472) PubMed Google Scholar ), including regions associated with mnemonic, evaluative, and executive function; indeed, pacing of neural firing by theta has been observed throughout the brain ( Buzsáki, 2002, 2006; Berke et al., 2004; O’Keefe, 2007; Sirota et al., 2008; Colgin, 2013; Redish, 2016; Alexander et al., 2018; Tingley and Buzsáki, 2018 2. Alexander, A.S. ∙ Rangel, L.M. ∙ Tingley, D. ... Neurophysiological signatures of temporal coordination between retrosplenial cortex and the hippocampal formation Behav. Neurosci. 2018; 132 :453-468 Crossref Scopus (9) PubMed Google Scholar 6. Berke, J.D. ∙ Okatan, M. ∙ Skurski, J. ... Oscillatory entrainment of striatal neurons in freely moving rats Neuron. 2004; 43 :883-896 Full Text Full Text (PDF) Scopus (321) PubMed Google Scholar 12. Buzsáki, G. Theta oscillations in the hippocampus Neuron. 2002; 33 :325-340 Full Text Full Text (PDF) Scopus (1781) PubMed Google Scholar 13. Buzsáki, G. Rhythms of the Brain Oxford University Press, 2006 Crossref Google Scholar 25. Colgin, L.L. Mechanisms and functions of theta rhythms Annu. Rev. Neurosci. 2013; 36 :295-312 Crossref Scopus (153) PubMed Google Scholar 102. O’Keefe, J. Hippocampal neurophysiology in the behaving animal Anderson, P. ∙ Morris, R. ∙ Amaral, D. (Editors) The Hippocampus Book Oxford University Press, 2007; 475-548 Google Scholar 110. Redish, A.D. Vicarious trial and error Nat. Rev. Neurosci. 2016; 17 :147-159 Crossref Scopus (261) PubMed Google Scholar 118. Sirota, A. ∙ Montgomery, S. ∙ Fujisawa, S. ... Entrainment of neocortical neurons and gamma oscillations by the hippocampal theta rhythm Neuron. 2008; 60 :683-697 Full Text Full Text (PDF) Scopus (525) PubMed Google Scholar 126. Tingley, D. ∙ Buzsáki, G. Transformation of a Spatial Map across the Hippocampal-Lateral Septal Circuit Neuron. 2018; 98 :1229-1242.e5 Full Text Full Text (PDF) Scopus (15) PubMed Google Scholar ). More generally, the present findings suggest that neural representation depends on temporal relationships to fast patterns of activity generated within the brain ( Engel et al., 2001; Buzsáki and Draguhn, 2004; Buzsáki, 2006; Rich and Wallis, 2016 13. Buzsáki, G. Rhythms of the Brain Oxford University Press, 2006 Crossref Google Scholar 15. Buzsáki, G. ∙ Draguhn, A. Neuronal oscillations in cortical networks Science. 2004; 304 :1926-1929 Crossref Scopus (3113) PubMed Google Scholar 38. Engel, A.K. ∙ Fries, P. ∙ Singer, W. Dynamic predictions: oscillations and synchrony in top-down processing Nat. Rev. Neurosci. 2001; 2 :704-716 Crossref Scopus (2083) PubMed Google Scholar 111. Rich, E.L. ∙ Wallis, J.D. Decoding subjective decisions from orbitofrontal cortex Nat. Neurosci. 2016; 19 :973-980 Crossref Scopus (88) PubMed Google Scholar ). Such dependencies could be missed when neural activity is evaluated only over long timescales (e.g., across trials) or only relative to externally observable events (e.g., task cues and behaviors).
The present findings also have vital implications for the neural basis of decision-making. Previous work suggests that a crucial property of decision-making is speed; in natural environments and with natural behaviors (e.g., predation and escape), decision-making requires a representational mechanism capable of responding to rapidly and continually evolving external conditions (e.g., the behavior of other agents) so that behavior can be re-directed with commensurate speed ( Cisek and Kalaska, 2010; Cisek, 2012 23. Cisek, P. Making decisions through a distributed consensus Curr. Opin. Neurobiol. 2012; 22 :927-936 Crossref Scopus (146) PubMed Google Scholar 24. Cisek, P. ∙ Kalaska, J.F. Neural mechanisms for interacting with a world full of action choices Annu. Rev. Neurosci. 2010; 33 :269-298 Crossref Scopus (657) PubMed Google Scholar ). Constant sub-second cycling dynamics in the hippocampus meet this requirement, raising the possibility that hippocampal activity in particular, and short-timescale neural representation in general, can in fact drive decisions. Consistent with this possibility, single-cell expression of cycling was most prevalent immediately prior to behaviorally reported choice.
Lastly, we note that the present results could help clarify the neural basis of various cognitive faculties characterized by generativity (e.g., recollection, prospection, and imagination; Schacter et al., 2012; Mullally and Maguire, 2014; Smallwood and Schooler, 2015 99. Mullally, S.L. ∙ Maguire, E.A. Memory, Imagination, and Predicting the Future: A Common Brain Mechanism? Neuroscientist. 2014; 20 :220-234 Crossref Scopus (85) PubMed Google Scholar 114. Schacter, D.L. ∙ Addis, D.R. ∙ Hassabis, D. ... The future of memory: remembering, imagining, and the brain Neuron. 2012; 76 :677-694 Full Text Full Text (PDF) Scopus (544) PubMed Google Scholar 121. Smallwood, J. ∙ Schooler, J.W. The science of mind wandering: empirically navigating the stream of consciousness Annu. Rev. Psychol. 2015; 66 :487-518 Crossref PubMed Google Scholar ). Previous work has found that these memory-based faculties are associated with activity in a subset of brain regions inclusive of the hippocampus ( Hassabis et al., 2007; Buckner, 2010; Mullally and Maguire, 2014; Miller et al., 2017; Stachenfeld et al., 2017; McCormick et al., 2018 9. Buckner, R.L. The role of the hippocampus in prediction and imagination Annu. Rev. Psychol. 2010; 61 :27-48 C1–8 Crossref Scopus (220) PubMed Google Scholar 53. Hassabis, D. ∙ Kumaran, D. ∙ Vann, S.D. ... Patients with hippocampal amnesia cannot imagine new experiences Proc. Natl. Acad. Sci. USA. 2007; 104 :1726-1731 Crossref Scopus (805) PubMed Google Scholar 90. McCormick, C. ∙ Rosenthal, C.R. ∙ Miller, T.D. ... Mind-wandering in people with hippocampal damage J. Neurosci. 2018; 38 :2745-2754 Crossref Scopus (33) PubMed Google Scholar 94. Miller, K.J. ∙ Botvinick, M.M. ∙ Brody, C.D. Dorsal hippocampus contributes to model-based planning Nat. Neurosci. 2017; 20 :1269-1276 Crossref Scopus (44) PubMed Google Scholar 99. Mullally, S.L. ∙ Maguire, E.A. Memory, Imagination, and Predicting the Future: A Common Brain Mechanism? Neuroscientist. 2014; 20 :220-234 Crossref Scopus (85) PubMed Google Scholar 122. Stachenfeld, K.L. ∙ Botvinick, M.M. ∙ Gershman, S.J. The hippocampus as a predictive map Nat. Neurosci. 2017; 20 :1643-1653 Crossref Scopus (80) PubMed Google Scholar ), a foundational observation that refers to activity monitored at longer timescales (seconds to minutes). The present findings highlight that (1) methodologically, monitoring activity at the sub-second timescale in these identified regions may be necessary to resolve competing representations, and (2) mechanistically, neural representation in these identified regions may be governed by sub-second dynamics of internally generated activity. This mechanistic basis may also extend to strikingly similar internally generated sub-second patterns that govern sensory perception ( VanRullen, 2016; Fiebelkorn et al., 2018; Helfrich et al., 2018 41. Fiebelkorn, I.C. ∙ Pinsk, M.A. ∙ Kastner, S. A dynamic interplay within the frontoparietal network underlies rhythmic spatial attention Neuron. 2018; 99 :842-853.e8 Full Text Full Text (PDF) Scopus (42) PubMed Google Scholar 55. Helfrich, R.F. ∙ Fiebelkorn, I.C. ∙ Szczepanski, S.M. ... Neural mechanisms of sustained attention are rhythmic Neuron. 2018; 99 :854-865.e5 Full Text Full Text (PDF) Scopus (50) PubMed Google Scholar 129. VanRullen, R. Perceptual Cycles Trends Cogn. Sci. 2016; 20 :723-735 Full Text Full Text (PDF) Scopus (138) PubMed Google Scholar ) and sensorimotor actions ( Kepecs et al., 2006; Kleinfeld et al., 2016 71. Kepecs, A. ∙ Uchida, N. ∙ Mainen, Z.F. The sniff as a unit of olfactory processing Chem. Senses. 2006; 31 :167-179 Crossref Scopus (194) PubMed Google Scholar 74. Kleinfeld, D. ∙ Deschênes, M. ∙ Ulanovsky, N. Whisking, Sniffing, and the Hippocampal θ-Rhythm: A Tale of Two Oscillators PLoS Biol. 2016; 14 :e1002385 Crossref Scopus (13) PubMed Google Scholar ); these patterns, currently thought to reflect adaptive mechanisms for sampling information from the external world, may be coordinated with the sub-second patterns of generative activity described here, which can in turn be likened to sampling from internal representations. Such internal sampling could implement optimal decision-making using prior knowledge ( Fiser et al., 2010; Pouget et al., 2013; Vul et al., 2014; Rich and Wallis, 2016; Shadlen and Shohamy, 2016 42. Fiser, J. ∙ Berkes, P. ∙ Orbán, G. ... Statistically optimal perception and learning: from behavior to neural representations Trends Cogn. Sci. 2010; 14 :119-130 Full Text Full Text (PDF) Scopus (298) PubMed Google Scholar 108. Pouget, A. ∙ Beck, J.M. ∙ Ma, W.J. ... Probabilistic brains: knowns and unknowns Nat. Neurosci. 2013; 16 :1170-1178 Crossref Scopus (203) PubMed Google Scholar 111. Rich, E.L. ∙ Wallis, J.D. Decoding subjective decisions from orbitofrontal cortex Nat. Neurosci. 2016; 19 :973-980 Crossref Scopus (88) PubMed Google Scholar 116. Shadlen, M.N. ∙ Shohamy, D. Decision Making and Sequential Sampling from Memory Neuron. 2016; 90 :927-939 Full Text Full Text (PDF) PubMed Google Scholar 130. Vul, E. ∙ Goodman, N. ∙ Griffiths, T.L. ... One and done? Optimal decisions from very few samples Cogn. Sci. 2014; 38 :599-637 Crossref Scopus (105) PubMed Google Scholar ) or, more generally, be used to construct and simulate hypothetical experience.

Section: STAR★Methods

REAGENT or RESOURCE SOURCE IDENTIFIER Experimental Models: Organisms/Strains Long-Evans rats ( Rattus norvegicus ) Charles River Strain code: 006 Software and Algorithms MATLAB R2019a MathWorks https://www.mathworks.com/products/matlab.html NSpike Data Acquisition Software, version 2 L.M.F. and James MacArthur, Harvard Instrumentation Design Laboratory N/A Matclust version 1.4 Mattias Karlsson https://www.mathworks.com/matlabcentral/fileexchange/39663-matclust Other 12.7 μm Nichrome wire Sandvik - Kanthal Item: PX000004 Open table in a new tab
Further information and requests for resources and reagents should be directed to and will be fulfilled by the Lead Contact, Loren Frank ( loren@phy.ucsf.edu ). New reagents were not generated in this study.
Neural activity (single-neuron (cell) firing and local field potential (LFP) activity) was recorded from the dorsal hippocampus (regions CA1, CA2, CA3, and DG) of 12 male Long-Evans rats ( Rattus norvegicus ; 4-9 months old, weighing 500–600 g) performing a spatial alternation task ( Karlsson and Frank, 2009; Kim and Frank, 2009; Kay et al., 2016 67. Karlsson, M.P. ∙ Frank, L.M. Awake replay of remote experiences in the hippocampus Nat. Neurosci. 2009; 12 :913-918 Crossref Scopus (351) PubMed Google Scholar 69. Kay, K. ∙ Sosa, M. ∙ Chung, J.E. ... A hippocampal network for spatial coding during immobility and sleep Nature. 2016; 531 :185-190 Crossref Scopus (69) PubMed Google Scholar 72. Kim, S.M. ∙ Frank, L.M. Hippocampal lesions impair rapid learning of a continuous spatial alternation task PLoS ONE. 2009; 4 :e5494 Crossref Scopus (41) PubMed Google Scholar ); task described in detail below. Rats were housed in a humidity- and temperature-controlled facility with a 12-hour light-dark cycle. All experiments were conducted during the light cycle. Before the start of experiments, rats from the same breeding cohort were housed in pairs; at the start of experiments, rats were single-housed. All experimental procedures were in accordance with University of California San Francisco Institutional Animal Care and Use Committee and US National Institutes of Health guidelines. Data from all subjects have been reported in earlier studies ( Karlsson and Frank, 2008, 2009; Carr et al., 2012; Kay et al., 2016 18. Carr, M.F. ∙ Karlsson, M.P. ∙ Frank, L.M. Transient slow gamma synchrony underlies hippocampal memory replay Neuron. 2012; 75 :700-713 Full Text Full Text (PDF) Scopus (100) PubMed Google Scholar 66. Karlsson, M.P. ∙ Frank, L.M. Network dynamics underlying the formation of sparse, informative representations in the hippocampus J. Neurosci. 2008; 28 :14271-14281 Crossref Scopus (112) PubMed Google Scholar 67. Karlsson, M.P. ∙ Frank, L.M. Awake replay of remote experiences in the hippocampus Nat. Neurosci. 2009; 12 :913-918 Crossref Scopus (351) PubMed Google Scholar 69. Kay, K. ∙ Sosa, M. ∙ Chung, J.E. ... A hippocampal network for spatial coding during immobility and sleep Nature. 2016; 531 :185-190 Crossref Scopus (69) PubMed Google Scholar ).
Subjects were food deprived to 85% of their baseline weight and pre-trained to run on a 1-m linear track for liquid reward (sweetened evaporated milk). After subjects alternated reliably, they were implanted with microdrives containing 14 (two subjects), 21 (three subjects), 25 (one subject), or 30 (six subjects) independently movable four-wire electrodes (tetrodes ( Wilson and McNaughton, 1993; Gray et al., 1995 50. Gray, C.M. ∙ Maldonado, P.E. ∙ Wilson, M. ... Tetrodes markedly improve the reliability and yield of multiple single-unit isolation from multi-unit recordings in cat striate cortex J. Neurosci. Methods. 1995; 63 :43-54 Crossref Scopus (495) PubMed Google Scholar 133. Wilson, M.A. ∙ McNaughton, B.L. Dynamics of the hippocampal ensemble code for space Science. 1993; 261 :1055-1058 Crossref PubMed Google Scholar )) targeting dorsal hippocampus (all subjects) and medial entorhinal cortex (two subjects).
In five subjects, right and left dorsal hippocampus were targeted at AP: −3.7 mm, ML: ± 3.7 mm. In two subjects, dorsal hippocampus was targeted at AP: −3.6 mm, ML: +2.2 mm, in addition to medial entorhinal cortex at AP: −9.1, ML: +5.6, at a 10 degree angle in the sagittal plane. In five subjects, right dorsal hippocampus was targeted at AP: −3.3 to −4.0 mm, ML: +3.5 to +3.9 mm, moreover, in two of these subjects, the septal pole of right hippocampus was targeted with an additional six tetrodes targeted to AP: −2.3 mm, ML: +1.1 mm. Targeting locations were used to position stainless steel cannulae containing 6, 14, 15, or 21 independently driveable tetrodes. The cannulae were circular except in four cases targeting dorsal hippocampus in which they were elongated into ovals (major axis ∼2.5 mm, minor axis ∼1.5 mm; two subjects with major axis 45° relative to midline, along the transverse axis of dorsal hippocampus; two subjects with major axis 135° relative to midline, along the longitudinal axis of dorsal hippocampus). Data from tetrodes targeting both right and left dorsal hippocampus were analyzed in this study.
In five subjects, viral vectors with optogenetic transgenes were targeted to either right dorsal CA2 (three subjects, AAV2/5-CaMKII-hChR2(H134R)-EYFP, UNC Vector Core, 135 nL at AP: −3.6 mm, ML: +4.2 mm, DV: −4.5 mm), dorsal DG (one subject, AAV2/5-I12B-ChR2-GFP), 225 nL at AP: −3.75 mm, ML: +2.2 mm, DV: 3.9 mm and AP: −3.75 mm, ML: +1.8 mm, DV: −4.5 mm), or right supramammilary nucleus (one subject, AAV2/5-hSyn-ChETA-EYFP, Penn Vector Core, 135 nL at AP: −4.3 mm, ML: +1.8 mm, and −8.9 mm along a trajectory angled at 6° in the coronal plane). Viruses were delivered during the implant surgery using a glass micropipette (tip manually cut to ∼25 μm diameter) attached to an injector (Nanoject, Drummond Scientific). In addition, a driveable optical fiber (62.5/125 μm core/cladding) was integrated in the tetrode microdrive assembly to enable light delivery to hippocampus. This fiber was advanced to its final depth (2.5–3 mm) within 7 days of implantation. Data reported in this study were collected before light stimulation. No overt differences in neural activity were observed in subjects that received virus ( Kay et al., 2016 69. Kay, K. ∙ Sosa, M. ∙ Chung, J.E. ... A hippocampal network for spatial coding during immobility and sleep Nature. 2016; 531 :185-190 Crossref Scopus (69) PubMed Google Scholar ).
Over the course of two weeks following implantation, the tetrodes were advanced to the principal cell layers of CA1 (all subjects), CA2 (5 subjects), CA3 (11 subjects), and DG (3 subjects). In several subjects, tetrodes were also left in cortex overlying dorsal hippocampus. Neural signals were recorded relative to a reference tetrode positioned in corpus callosum above right dorsal hippocampus. The reference tetrode reported voltage relative to a ground screw installed in skull overlying cerebellum, and local field potential (LFP) from this tetrode was also recorded. All tetrode final locations were histologically verified (see below).
After 5–7 days of recovery after surgery, subjects were once again food deprived to 85% of their baseline weight, and again pre-trained to run on a linear track for liquid reward. At ∼14 days after surgery, six subjects were then introduced to one task W-maze and recorded for 3 to 6 days before being introduced to a second task W-maze, located in a separate part of the recording room and rotated 90° relative to the first. On recording days in which the second task W-maze was used, recordings were also conducted in the first task W-maze. In two subjects, recordings were conducted in both task W-mazes on every recording day. The W-mazes were 76 × 76 cm with 7-cm-wide track sections. The two task W-mazes were separated by an opaque barrier.
In each W-maze, subjects were rewarded for performing a hippocampus-dependent continuous alternation task ( Figure S1 A). Liquid reward (sweetened evaporated milk) was dispensed via plastic tubing connected to a hole at the bottom of each of the three reward wells, miniature bowls 3 cm in diameter. In eight subjects, reward was dispensed via syringes operated manually by an experimenter who was located in a separate part of the recording room. In five subjects, entry of the subject’s head into reward wells was sensed by an infrared beam break circuit attached to the well, and reward was automatically delivered by syringe pumps (OEM syringe pumps, Braintree Scientific) either immediately or after an imposed delay lasting from 0.5 to 2 s. Task recording epochs (elsewhere also referred to as “recording epochs”) lasting ∼15 min were preceded and followed by rest recording epochs lasting ∼20 min in a high-walled black box (floor edges 25–35 cm and height 50 cm), during which rats often groomed, quietly waited, and slept. Two subjects also ran in an open field environment for scattered food (grated cheese) after W-maze recordings, with additional interleaved rest epochs. Tetrode positions were adjusted after each day’s recordings.
Data were collected using the NSpike data acquisition system (L.M.F. and J. MacArthur, Harvard Instrumentation Design Laboratory). During recording, an infrared diode array with a large and a small cluster of diodes was affixed to headstage preamplifiers to enable tracking of head position and head direction. Following recording, position and direction were reconstructed using a semi-automated analysis of digital video (30 Hz) of the experiment. Spike data were recorded relative to the reference tetrode, sampled at 30 kHz, digitally filtered between 600 Hz and 6 kHz (2-pole Bessel for high- and low-pass), and threshold crossing events were saved to disk. Local field potentials (LFPs) were sampled at 1.5 kHz and digitally filtered between 0.5 Hz and 400 Hz. LFPs analyzed were relative to the reference tetrode except where otherwise indicated.
Single-cell (unit) neural firing was identified by clustering spikes using peak amplitude, principal components, and spike width as variables (MatClust, M.P.K.). Only well-isolated units with stable spike waveform amplitudes were clustered. A single set of cluster bounds defined in amplitude and width space could often isolate units across an entire recording session. In cases where there was a shift in amplitudes across time, units were clustered only when that shift was coherent across multiple clusters and when plots of amplitude versus time showed a smooth shift. No units were clustered in which part of the cluster was cut off at spike threshold. Units were not tracked across days.
After recordings, subjects were anesthetized with isoflurane, electrolytically lesioned at each tetrode (30 μA of positive current for 3 s applied to two channels of each tetrode), and allowed to recover overnight. In one subject, no electrolytic lesions were made, and tetrode tracks rather than lesions were used to identify recording sites. Subjects were euthanized with pentobarbital and were perfused intracardially with PBS followed by 4% paraformaldehyde in PBS. The brain was post-fixed in situ overnight, after which the tetrodes were retracted and the brain removed, cryoprotected (30% sucrose in PBS), and embedded in OCT compound. Coronal (10 subjects) and sagittal (2 subjects) sections (50 μm) were taken with a cryostat. Sections were either Nissl-stained with cresyl violet or stained with the fluorescent Nissl reagent NeuroTrace Blue (1:200) (Life Technologies, N-21479). In four subjects, the sections were blocked (5% donkey serum in 0.3% Triton-X in TBS, used for all incubations) for 1 h, incubated with RGS14 ( Lee et al., 2010; Kohara et al., 2014; Dudek et al., 2016 35. Dudek, S.M. ∙ Alexander, G.M. ∙ Farris, S. Rediscovering area CA2: unique properties and functions Nat. Rev. Neurosci. 2016; 17 :89-102 Crossref Scopus (90) PubMed Google Scholar 76. Kohara, K. ∙ Pignatelli, M. ∙ Rivest, A.J. ... Cell type-specific genetic and optogenetic tools reveal hippocampal CA2 circuits Nat. Neurosci. 2014; 17 :269-279 Crossref Scopus (200) PubMed Google Scholar 79. Lee, S.E. ∙ Simons, S.B. ∙ Heldt, S.A. ... RGS14 is a natural suppressor of both synaptic plasticity in CA2 neurons and hippocampal-based learning and memory Proc. Natl. Acad. Sci. USA. 2010; 107 :16994-16998 Crossref Scopus (85) PubMed Google Scholar ) antibody (1:400) (Antibodies Inc., 75-140) overnight, washed, and subsequently incubated with fluorescent secondary antibody (1:400) (Alexa 568, Life Technologies). CA2 recording sites were designated as those in which the electrolytic lesion or end of tetrode track overlapped with the dispersed cytoarchitectural zone characteristic of CA2 ( Lorente de Nó, 1934; David and Pierre, 2007; Lee et al., 2015; Lu et al., 2015; Mankin et al., 2015; Dudek et al., 2016 28. David, A. ∙ Pierre, L. Hippocampal neuroanatomy Andersen, P. ∙ Morris, R. ∙ Amaral, D. ... (Editors) The Hippocampus Book Oxford University Press, 2007 Google Scholar 35. Dudek, S.M. ∙ Alexander, G.M. ∙ Farris, S. Rediscovering area CA2: unique properties and functions Nat. Rev. Neurosci. 2016; 17 :89-102 Crossref Scopus (90) PubMed Google Scholar 80. Lee, H. ∙ Wang, C. ∙ Deshmukh, S.S. ... Neural Population Evidence of Functional Heterogeneity along the CA3 Transverse Axis: Pattern Completion versus Pattern Separation Neuron. 2015; 87 :1093-1105 Full Text Full Text (PDF) Scopus (53) PubMed Google Scholar 84. Lorente de Nó, R. Studies on the structure of the cerebral cortex. II. Continuation of the study of the ammonic system J. Psychol. Neurol. 1934; 46 :113-177 Google Scholar 85. Lu, L. ∙ Igarashi, K.M. ∙ Witter, M.P. ... Topography of place maps along the CA3-to-CA2 axis of the hippocampus Neuron. 2015; 87 :1078-1092 Full Text Full Text (PDF) Scopus (51) PubMed Google Scholar 86. Mankin, E.A. ∙ Diehl, G.W. ∙ Sparks, F.T. ... Hippocampal CA2 activity patterns change over time to a larger extent than between spatial contexts Neuron. 2015; 85 :190-201 Full Text Full Text (PDF) Scopus (101) PubMed Google Scholar ). It is important to note that CA2 sites defined in this way include recording locations that have been designated in previous studies as ‘CA3a’.
All analyses were carried out using custom software written in MATLAB (Mathworks).
Units (single cells) analyzed in the study were those that fired at least 100 spikes in at least one task epoch and had at least 50 spikes in their auto-correlogram (from 0-40 ms; t = 0 excluded). Across all cells, a scatterplot of mean firing rate (from the task recording epoch with highest mean rate), spike width, and autocorrelation function mean (0-40 ms; low values indicating burst firing) showed two clusters ( Ranck, 1973; Fox and Ranck, 1981; Buzsáki et al., 1983; Skaggs and McNaughton, 1996; Csicsvari et al., 1999; Mizuseki et al., 2009; Kay et al., 2016 16. Buzsáki, G. ∙ Leung, L.W. ∙ Vanderwolf, C.H. Cellular bases of hippocampal EEG in the behaving rat Brain Res. 1983; 287 :139-171 Crossref Scopus (340) PubMed Google Scholar 27. Csicsvari, J. ∙ Hirase, H. ∙ Czurkó, A. ... Oscillatory coupling of hippocampal pyramidal cells and interneurons in the behaving Rat J. Neurosci. 1999; 19 :274-287 Crossref PubMed Google Scholar 46. Fox, S.E. ∙ Ranck, Jr., J.B. Electrophysiological characteristics of hippocampal complex-spike cells and theta cells Exp. Brain Res. 1981; 41 :399-410 Crossref Scopus (314) PubMed Google Scholar 69. Kay, K. ∙ Sosa, M. ∙ Chung, J.E. ... A hippocampal network for spatial coding during immobility and sleep Nature. 2016; 531 :185-190 Crossref Scopus (69) PubMed Google Scholar 95. Mizuseki, K. ∙ Sirota, A. ∙ Pastalkova, E. ... Theta oscillations provide temporal windows for local circuit computation in the entorhinal-hippocampal loop Neuron. 2009; 64 :267-280 Full Text Full Text (PDF) Scopus (339) PubMed Google Scholar 109. Ranck, Jr., J.B. Studies on single neurons in dorsal hippocampal formation and septum in unrestrained rats. I. Behavioral correlates and firing repertoires Exp. Neurol. 1973; 41 :461-531 Crossref Scopus (890) PubMed Google Scholar 119. Skaggs, W.E. ∙ McNaughton, B.L. Replay of neuronal firing sequences in rat hippocampus during sleep following spatial experience Science. 1996; 271 :1870-1873 Crossref Scopus (659) PubMed Google Scholar ). Putative principal cells corresponded with the cluster showing low firing rate (< 4 Hz), large spike width, and low autocorrelation mean, while putative interneurons corresponded to the cluster characterized by high firing rate, small spike width, and high autocorrelation mean. Thirty-seven cells with ambiguous features were left unclassified and not further analyzed.
Total putative principal unit counts across recording sites were CA1: 978, CA2: 250, CA3: 528, DG: 17. Following previous work ( Kay et al., 2016; Oliva et al., 2016 69. Kay, K. ∙ Sosa, M. ∙ Chung, J.E. ... A hippocampal network for spatial coding during immobility and sleep Nature. 2016; 531 :185-190 Crossref Scopus (69) PubMed Google Scholar 106. Oliva, A. ∙ Fernández-Ruiz, A. ∙ Buzsáki, G. ... Role of Hippocampal CA2 Region in Triggering Sharp-Wave Ripples Neuron. 2016; 91 :1342-1355 Full Text Full Text (PDF) Scopus (54) PubMed Google Scholar ), subpopulations of CA2-site putative principal cells were identified by determining whether cells were positively modulated (CA2 P cells) versus non-positively modulated (CA2 N cells) by the sharp wave-ripple network pattern; since the firing activity of cells of either type can overlap with periods of locomotion ( Kay et al., 2016 69. Kay, K. ∙ Sosa, M. ∙ Chung, J.E. ... A hippocampal network for spatial coding during immobility and sleep Nature. 2016; 531 :185-190 Crossref Scopus (69) PubMed Google Scholar ), cells of either type were included in subsequent analyses (as cells recorded in CA2) as long as subsequent relevant criteria were met.
For later analyses, the 2D position of subject was converted into 1D position (linearized position) along the three arms (center, left, and right arms) of the task maze. The three arms meet at the maze's central junction, with the center arm composed of a one linear segment, and the left and right arms composed of two linear segments. Linearization requires specification of the six segment endpoints (2D coordinates; three corresponding to the locations of the three reward wells, and three corresponding to the junctions between linear segments); these endpoints were specified manually prior to analysis of neural data.
Linearized position was obtained by projecting the 2D position of subject onto the nearest linear segment and measuring the distance, along the maze arms, from the center well (defined as 0 cm). Every positional data point was assigned to one of the five maze segments and to one of the three maze arms.
The choice boundary was defined as the linearized position 10 cm beyond the central junction; the choice boundary was interpreted as the position where spatial choice (left versus right) for outbound maze paths ( Figure S1 A) was overtly reported by the subjects’ behavior. The center zone was defined as the set of linear positions (largely corresponding to the center arm) prior to choice boundary. Note that the choice boundary refers to the boundary with either the L or R arm (e.g., either of the two interfaces between color-coded regions in behavioral maps of Figure 4 ).
Analyses in this study refer to periods of time defined by subjects’ behavior, whether with regard to movement, position/orientation in the maze, or execution of the spatial alternation task.
Locomotor periods were defined as times when the subject’s head speed was >4 cm/s. Single-cell and cell-pair analyses were restricted to locomotor periods, while decoding analyses included additional 0.5 s flanking periods, described further below.
Task paths were defined as the four spatial trajectories relevant to the task (two outbound: Center to Left (outbound left) and Center to Right (outbound right); two inbound: Left to Center (inbound left) and Right to Center (inbound right); diagrammed in Figure S1 A).
Locomotor periods were fully subdivided into two types of periods defined by heading direction: outbound or inbound. Outbound versus inbound periods were times when the subject’s head direction was aligned to outbound versus inbound task paths (given the assigned maze segment; see above), respectively; furthermore, alignment was binary: the assigned direction (outbound versus inbound) was the one yielding the smaller angle (0 to 180°) along the maze segment.
Maze passes were defined as single contiguous periods where the animal traveled from one reward well to another (or returned to the same well); these periods were comprised largely of locomotor periods but also included occasional intervening non-locomotor periods (i.e., head scans [ Monaco et al., 2014; Redish, 2016 96. Monaco, J.D. ∙ Rao, G. ∙ Roth, E.D. ... Attentive scanning behavior drives one-trial potentiation of hippocampal place fields Nat. Neurosci. 2014; 17 :725-731 Crossref Scopus (58) PubMed Google Scholar 110. Redish, A.D. Vicarious trial and error Nat. Rev. Neurosci. 2016; 17 :147-159 Crossref Scopus (261) PubMed Google Scholar ] and stops). Maze passes were classified into nine types: four corresponding to the four task paths (path passes; two outbound and two inbound), two corresponding to traversals between the two outer wells (left to right and right to left), and three corresponding to backtracking traversals in which the subject left one of the three wells and returned to that same well without reaching a different well. Backtrack passes were detected only if the pass lasted at least 2 s and the subject traveled at least 20 cm from the well in linearized position. The start and end of maze passes were times when the linear position of the subject diverged from and met the linearized positions of the start and end wells, respectively.
Path periods were defined as the subset of times within path passes when (i) the subject was located in one of the three maze segments defining the current task path and (ii) the subject’s heading direction was the same as (aligned to) the direction defining the current task path.
Spatial firing was quantified using linearized (1D) position; 2D spatial firing maps (e.g., Figure 1 ) are plotted only for illustration. If data from two unique maze environments were available for a cell, and the cell fired at least 100 spikes in both environments, then the cell was analyzed in the two unique maze environments independently. Thus cells in the dataset could contribute more than one sample to subsequent analyses (cell samples). If multiple recording epochs in one maze environment were available, then the cell was analyzed in recording epoch for which the cell had the highest mean firing rate.
Given the known direction- ( McNaughton et al., 1983a; Battaglia et al., 2004; Foster and Wilson, 2006 4. Battaglia, F.P. ∙ Sutherland, G.R. ∙ McNaughton, B.L. Local sensory cues and place cell directionality: additional evidence of prospective coding in the hippocampus J. Neurosci. 2004; 24 :4541-4550 Crossref Scopus (93) PubMed Google Scholar 44. Foster, D.J. ∙ Wilson, M.A. Reverse replay of behavioural sequences in hippocampal place cells during the awake state Nature. 2006; 440 :680-683 Crossref Scopus (819) PubMed Google Scholar 92. McNaughton, B.L. ∙ Barnes, C.A. ∙ O’Keefe, J. The contributions of position, direction, and velocity to single unit activity in the hippocampus of freely-moving rats Exp. Brain Res. 1983; 52 :41-49 Crossref Scopus (649) PubMed Google Scholar ) and path- ( Frank et al., 2000; Wood et al., 2000; Ferbinteanu and Shapiro, 2003; Ito et al., 2015 40. Ferbinteanu, J. ∙ Shapiro, M.L. Prospective and retrospective memory coding in the hippocampus Neuron. 2003; 40 :1227-1239 Full Text Full Text (PDF) Scopus (351) PubMed Google Scholar 47. Frank, L.M. ∙ Brown, E.N. ∙ Wilson, M. Trajectory encoding in the hippocampus and entorhinal cortex Neuron. 2000; 27 :169-178 Full Text Full Text (PDF) PubMed Google Scholar 59. Ito, H.T. ∙ Zhang, S.J. ∙ Witter, M.P. ... A prefrontal-thalamo-hippocampal circuit for goal-directed spatial navigation Nature. 2015; 522 :50-55 Crossref Scopus (157) PubMed Google Scholar 135. Wood, E.R. ∙ Dudchenko, P.A. ∙ Robitsek, R.J. ... Hippocampal neurons encode information about different types of memory episodes occurring in the same location Neuron. 2000; 27 :623-633 Full Text Full Text (PDF) Scopus (657) PubMed Google Scholar ) selectivity of hippocampal cell firing, analysis was performed on locomotor data subdivided in two ways, either (I) direction or (II) path.
(I) For direction, analysis was performed separately for outbound versus inbound periods, moreover separately for each of the three maze arms; thus a given cell in a given maze environment could contribute up to three samples in subsequent direction-based analyses (direction-based cell samples; outbound and inbound).
(II) For path, analysis was performed separately for periods corresponding to the four task path types (for which a minimum of five available passes were required for each path type); thus a given cell in a given maze environment could contribute up to four samples in subsequent path-based analyses (path-based cell samples; outbound left, outbound right, inbound left, and inbound right). Two days of recordings for one subject were excluded from analysis for lack of path passes in both outer maze arms.
For each cell sample, a time-averaged firing map was calculated for each period type ((I) direction-based firing map, (II) path-based firing map). First, total spike counts and occupancy durations were tabulated in 2-cm bins. Both occupancy and spike counts per bin were smoothed with a Gaussian window (σ = 4 cm), then spike counts were divided by occupancy to produce the cell’s smoothed occupancy-normalized firing map. In sporadic cases, spatial bins with insufficient occupancy (<50 ms in a 2-cm bin) were excluded from analysis. For each time-averaged firing map, the peak (spatial) firing rate was defined as the maximum value across position bins; spatial firing fields (place fields) were detected as sets of contiguous positions with rate >2 Hz and at least 10 cm large.
Note that in the case of direction-based firing maps (in Figures 2 E–2L, 5 B, and 6 E), the spatial bin at the center junction appears as a minimum as a result of the above procedure of calculating firing maps for each of the three maze arms separately. In plots, the value of this spatial bin was linearly interpolated; this value was otherwise excluded from subsequent quantifications.
Two-dimensional time-averaged firing maps (plotted for illustration) were calculated with an analogous procedure using 1-cm square bins and a symmetric 2D Gaussian smoothing window (σ = 3 cm).
To measure the specificity of representation at the single-cell level, a selectivity index was calculated, specifically one for location (Left (L) versus Right (R) arms; survey in Figure S1 F) and one for heading direction (Outbound (O) versus Inbound (I); survey in Figure S1 I).
If data from two unique maze environments were available for a cell, and the cell fired at least 100 spikes in both environments, then the cell was analyzed (selectivity indices calculated) in the two unique maze environments independently. Thus cells in the dataset could contribute more than one cell sample to subsequent analyses (cell samples). If multiple recording epochs in one maze environment were available, then the cell was analyzed in recording epoch for which the cell had the highest mean firing rate.
The location selectivity index was calculated for cell samples for which the 1D firing maps that had at least one place field in either the L or R maze arm. To assess cell activity directly relevant to the spatial choice critical to the task (outbound approach to the L versus R maze arm bifurcation, Figures 1 C and S1 A), analysis was performed only for outbound direction-based cell samples (defined above; inbound cell samples yielded a similar result). Furthermore, two inclusion criteria were imposed to ensure accurate estimates: first, data were only considered from positions beyond the choice boundary (i.e., the L or R arm); second, only cell samples with at least 100 spikes in the L or R arm were considered.
The direction selectivity index was calculated for direction-based cell samples that had at least one place field in either the O or I direction.
The selectivity index was defined as (fr 2 – fr 1 )/(fr 1 +fr 2 ), where fr is firing rate and 1, 2 correspond to two alternative conditions: for location, 1: L, 2: R; for direction: 1: O, 2: I. For single-cell surveys in Figures S1 F and S1I, fr was defined as the peak firing rate from the time-averaged spatial firing maps (see above); in other analyses, both peak and mean firing rate were used, and stated explicitly if so.
For each subject, a tetrode in CA3 yielding clustered putative principal cells (i.e., located in the principal cell layer) was designated as the LFP recording site. In a minority of recording epochs (30 out of 287) for which a tetrode in the principal cell layer of CA3 was not available, a tetrode located in principal cell layer of CA1 was used instead.
To isolate activity in the frequency range of hippocampal theta ( Buzsáki, 2002; Mizuseki et al., 2009 12. Buzsáki, G. Theta oscillations in the hippocampus Neuron. 2002; 33 :325-340 Full Text Full Text (PDF) Scopus (1781) PubMed Google Scholar 95. Mizuseki, K. ∙ Sirota, A. ∙ Pastalkova, E. ... Theta oscillations provide temporal windows for local circuit computation in the entorhinal-hippocampal loop Neuron. 2009; 64 :267-280 Full Text Full Text (PDF) Scopus (339) PubMed Google Scholar ), LFP from these recording sites was filtered at 5–11 Hz. Peaks and troughs of the filtered LFP were detected and used to define half-cycles (π radians) by linear interpolation ( Jezek et al., 2011; Belluscio et al., 2012 5. Belluscio, M.A. ∙ Mizuseki, K. ∙ Schmidt, R. ... Cross-frequency phase-phase coupling between θ and γ oscillations in the hippocampus J. Neurosci. 2012; 32 :423-435 Crossref Scopus (298) PubMed Google Scholar 62. Jezek, K. ∙ Henriksen, E.J. ∙ Treves, A. ... Theta-paced flickering between place-cell maps in the hippocampus Nature. 2011; 478 :246-249 Crossref Scopus (151) PubMed Google Scholar ). To establish a common reference phase, a phase histogram (π/6 or 30° bin size) of aggregate single (principal) cell firing in CA1 was calculated across locomotor periods for each recording day; the phase of maximal CA1 firing was then defined to be 0° ( Skaggs et al., 1996 120. Skaggs, W.E. ∙ McNaughton, B.L. ∙ Wilson, M.A. ... Theta phase precession in hippocampal neuronal populations and the compression of temporal sequences Hippocampus. 1996; 6 :149-172 Crossref Scopus (946) PubMed Google Scholar ), with the half-cycle offset (±π) corresponding to the phase segregating individual cycles. Theta cycles were identified as individual cycles whose duration was consistent with the 5-11 Hz frequency range (<200 ms (5 Hz) and >90 ms (11 Hz)); sporadic cycles not meeting this criterion were disregarded in subsequent analyses that explicitly reference theta cycles or theta phase.
To survey the prevalence and strength of theta rhythmicity in neural firing, theta phase histograms of single-cell firing were calculated. For a given cell, theta phase locking analysis was performed for locomotor periods (>4 cm/s), and moreover only when at least 50 spikes were available in these periods. Firing was combined across all available task recording epochs. For CA2 ( Figure S1 K, middle column), cells previously classified as N cells (see above) were excluded from this analysis since theta-locking measures for these cells in the present dataset have been reported previously ( Kay et al., 2016 69. Kay, K. ∙ Sosa, M. ∙ Chung, J.E. ... A hippocampal network for spatial coding during immobility and sleep Nature. 2016; 531 :185-190 Crossref Scopus (69) PubMed Google Scholar ).
To identify temporal patterns in neural activity, firing correlograms (CG) (time histograms; ±1.5 s, 5-ms bins) were calculated for single cells (auto-correlograms, ACG; t = 0 bin set to 0) and cell pairs (cross-correlograms, XCG). Data analyzed was restricted to locomotor periods that lasted at least 1.5 s, with further subdivisions described below. When multiple recording epochs for a given maze environment were available, data was pooled across epochs. If data from two unique maze environments were available, then data from the two unique maze environments were analyzed independently; thus a cell pair (XCG) or single cell (ACG) could contribute more than one CG (cell-pair sample and cell sample, respectively).
Two types of CGs were calculated: count and corrected. Count CGs were calculated by summing CGs (spike counts) across all data periods. For corrected CGs, CGs from each individual data period were first triangle-corrected ( Bair et al., 2001; Mizuseki et al., 2009 3. Bair, W. ∙ Zohary, E. ∙ Newsome, W.T. Correlated firing in macaque visual area MT: time scales and relationship to behavior J. Neurosci. 2001; 21 :1676-1697 Crossref PubMed Google Scholar 95. Mizuseki, K. ∙ Sirota, A. ∙ Pastalkova, E. ... Theta oscillations provide temporal windows for local circuit computation in the entorhinal-hippocampal loop Neuron. 2009; 64 :267-280 Full Text Full Text (PDF) Scopus (339) PubMed Google Scholar ) to offset bias due to data periods of variable lengths (corrected spike counts); the corrected CG was then obtained by taking the mean over all individual data period CGs.
CGs (count and corrected) were then processed at two timescales: coarse (±1 s window) and fine (±0.4 s window). At each timescale, CGs were convolved with Gaussian kernels of the appropriate bandwidth (coarse, σ = 50 ms; fine, σ = 10 ms; meant to capture behavior- and theta- timescale activity, respectively ( Geisler et al., 2007; Cheng and Frank, 2008; Diba and Buzsáki, 2008 22. Cheng, S. ∙ Frank, L.M. New experiences enhance coordinated neural activity in the hippocampus Neuron. 2008; 57 :303-313 Full Text Full Text (PDF) Scopus (137) PubMed Google Scholar 32. Diba, K. ∙ Buzsáki, G. Hippocampal network dynamics constrain the time lag between pyramidal cells across modified environments J. Neurosci. 2008; 28 :13448-13456 Crossref Scopus (0) PubMed Google Scholar 48. Geisler, C. ∙ Robbe, D. ∙ Zugaro, M. ... Hippocampal place cell assemblies are speed-controlled oscillators Proc. Natl. Acad. Sci. USA. 2007; 104 :8149-8154 Crossref Scopus (145) PubMed Google Scholar )) and then peak-normalized within the respective (coarse or fine) time window. Count CGs thus processed are shown in single example plots (e.g. Figures 1 I and 1J) and survey plots (XCG: Figure 1 K, Figures S2 F–S2H; ACG: Figure 3 F) (example raw count CGs shown in Figure S2 E), while corrected CGs thus processed were used for subsequent quantitative analyses. Both plots and analyses were restricted to CGs with at least 100 spikes in the fine timescale window (±0.4 s). Cycling firing at 8 Hz (also termed “skip” firing ( Deshmukh et al., 2010; Brandon et al., 2013; Jankowski et al., 2014 7. Brandon, M.P. ∙ Bogaard, A.R. ∙ Schultheiss, N.W. ... Segregation of cortical head direction cell assemblies on alternating θ cycles Nat. Neurosci. 2013; 16 :739-748 Crossref Scopus (49) PubMed Google Scholar 31. Deshmukh, S.S. ∙ Yoganarasimha, D. ∙ Voicu, H. ... Theta modulation in the medial and the lateral entorhinal cortices J. Neurophysiol. 2010; 104 :994-1006 Crossref Scopus (85) PubMed Google Scholar 60. Jankowski, M.M. ∙ Islam, M.N. ∙ Wright, N.F. ... Nucleus reuniens of the thalamus contains head direction cells eLife. 2014; 3 :e03075 Crossref Scopus (45) Google Scholar )) was overtly present in both count and corrected CGs.
CGs were calculated from locomotor period data subdivided by either (I) path (II) direction, or (III) choice condition. As with other analyses in this study, locomotor periods were defined as periods of movement speed >4 cm/s; a threshold of >20 cm/s was also used to evaluate whether a firing pattern of interest (cycle skipping, see further below) required low movement speed.
(I) For path, CGs were calculated from data separated by periods corresponding to the four task path types; thus a given cell (or cell pair) in a given maze environment could contribute up to four samples in subsequent path-based analyses (path-based cell (or cell-pair) samples). Path-based CGs were used to survey firing in the dataset (ACG: Figures 3 A–3F, XCG: Figure S2 H) and to compare differences between recording regions ( Figure 3 G) and differences with respect to an additional condition (theta phase, Figure S6 B). Note that by subdividing data by path type, both the path- and direction- selectivity of hippocampal place cell firing are respected in the analysis; in this way, firing patterns that may differ between conditions may be best distinguished. In the case of differing recording regions, the finding of significant differences in firing patterns ( Figure 3 G) was also observed with additional analysis variations: namely, without any subdivision of data, by subdividing by direction, and also by using higher movement speed thresholds (e.g., >20 cm/s) (data not presented).
(II) For direction, CGs were calculated from data subdivided into outbound versus inbound periods; thus a given cell (or cell pair) in a given maze environment could contribute up to two samples in subsequent path-based analyses (direction-based cell (or cell-pair) samples). Direction-based XCGs are shown in Figure 1 (outbound only), Figure 2 , Figures S1 L–S1O (outbound only), and Figures S2 A–S2E (outbound only), and also surveyed across all cell pairs in Figures S2 F (outbound) and S2 G (inbound). Direction-based ACGs (data not presented) were qualitatively similar to path-based ACGs ( Figures 2 E and 2F).
(III) For choice condition, CGs were calculated from data (a) recorded from linearized positions within the choice boundary, and (b) subdivided into outbound versus inbound periods; given (b), a given cell in a given maze environment could contribute up to two samples in subsequent analyses (choice-based cell samples). Choice-based CGs were subsequently analyzed (via the cycle skipping index, see below; Figure 3 H) to assess whether choice behavior (choice passed: inbound samples; choice imminent: outbound samples) was a correlate of an activity pattern investigated in the present study (cycling firing at 8 Hz).
Cycling firing at 8 Hz was detected and quantified with a cycle skipping index (CSI) that was conceptually equivalent to a previously described theta skipping index ( Deshmukh et al., 2010; Brandon et al., 2013 7. Brandon, M.P. ∙ Bogaard, A.R. ∙ Schultheiss, N.W. ... Segregation of cortical head direction cell assemblies on alternating θ cycles Nat. Neurosci. 2013; 16 :739-748 Crossref Scopus (49) PubMed Google Scholar 31. Deshmukh, S.S. ∙ Yoganarasimha, D. ∙ Voicu, H. ... Theta modulation in the medial and the lateral entorhinal cortices J. Neurophysiol. 2010; 104 :994-1006 Crossref Scopus (85) PubMed Google Scholar ); the goal of either approach is to measure the lack of firing on adjacent theta (∼8 Hz) cycles. In the present study, the term “cycling” was adopted to refer explicitly to the observation that periods of “skipping” (i.e. lack of firing) in the firing of one group of cells can correspond to periods of firing in another group of cells, furthermore in the case where the two groups encode mutually exclusive scenarios (initially seen at the cell-pair level; Figures 1 and 2).
Two types of CSI were calculated: one for single cells (cell CSI) and one for cell pairs (cell-pair CSI); for both, the calculation was performed on corrected CGs (ACG for cell CSI; XCG for cell-pair CSI) that had at least 100 spikes within the fine timescale window (±0.4 s) and that were smoothed and peak-normalized (see above).
For each ACG, two local maxima (peaks: p 1 and p 2 ) within two respective time windows were detected: p 1 , the peak nearest t = 0 in the 90-200 ms window; p 2 , the peak nearest t = 0 in the 200-400 ms window. In some cases, a peak was not detected within a time window: for p 1 , the maximum value in the window was then used; for p 2 , the minimum value in the window was then used. C e l l C S I = ( p 2 – p 1 ) / m a x ⁡ ( p 1 ⁢ , p 2 ) . For two ACGs (path-based samples), the CSI could not be calculated due to an absence of spiking in both the 1 st and 2 nd peak time windows.
To evaluate whether there was a monotonic relationship between cycling firing and the overall amount of firing, Spearman’s correlation was calculated between cell CSI and average firing rate within the sample condition (i.e., firing rate across the same periods used to calculate the CSI).
For each XCG, five local maxima (peaks: p 0 , p ± 1 , p ± 2 ) within five respective time windows were detected. First, p 0 , the peak nearest t = 0 in the ±90 ms window, was identified (if no peak was detected, then p 0 was taken as the value at t = 0). The four remaining peaks were then detected in time windows relative to the time bin of p 0 as follows: p ± 1 , the two peaks nearest p 0 in the ±90-200 ms windows; and p ± 2 , the two peaks nearest p 0 in the ±200-400 ms windows. C e l l - p a i r C S I = ( p 0 , ⁢ 2 – p 1 ) / m a x ⁡ ( p 0 , ⁢ 2 , p 1 ) ⁢ w h e r e p 0 , ⁢ 2 = m e a n ⁡ ( m a x ⁡ ( p - 2 , p + 2 ) , ⁢ p 0 ) p 1 = m e a n ⁡ ( p - 1 , p + 1 )
Cell-pair samples having at least 100 spikes in their XCG at the fine timescale (±0.4 s) were classified into one of four types: (1) classic, (2) anti-synchronous cycling (anti), (3) super-synchronous cycling (super), and (4) off cycling (off). Classic corresponds to the pattern of co-firing expected given single-cell firing on adjacent cycles ( Figures S1 L–S1O), as previously described in the hippocampus ( O’Keefe and Recce, 1993; Skaggs et al., 1996; Huxter et al., 2003; Zugaro et al., 2005; Diba and Buzsáki, 2008 32. Diba, K. ∙ Buzsáki, G. Hippocampal network dynamics constrain the time lag between pyramidal cells across modified environments J. Neurosci. 2008; 28 :13448-13456 Crossref Scopus (0) PubMed Google Scholar 58. Huxter, J. ∙ Burgess, N. ∙ O’Keefe, J. Independent rate and temporal coding in hippocampal pyramidal cells Nature. 2003; 425 :828-832 Crossref Scopus (382) PubMed Google Scholar 105. O’Keefe, J. ∙ Recce, M.L. Phase relationship between hippocampal place units and the EEG theta rhythm Hippocampus. 1993; 3 :317-330 Crossref PubMed Google Scholar 120. Skaggs, W.E. ∙ McNaughton, B.L. ∙ Wilson, M.A. ... Theta phase precession in hippocampal neuronal populations and the compression of temporal sequences Hippocampus. 1996; 6 :149-172 Crossref Scopus (946) PubMed Google Scholar 139. Zugaro, M.B. ∙ Monconduit, L. ∙ Buzsáki, G. Spike phase precession persists after transient intrahippocampal perturbation Nat. Neurosci. 2005; 8 :67-71 Crossref Scopus (63) PubMed Google Scholar ). Anti corresponds to a pattern of co-firing in which the two cells consistently fire on alternate 8 Hz cycles. Super corresponds to a pattern of co-firing in which the two cells consistently fire together every other 8 Hz cycle. Off corresponds to a pattern of co-firing showing either relatively more or relatively less firing every other 8 Hz cycle, yet for which synchronization within 8 Hz cycles was ambiguous.
Formal criteria were as follows: classic pairs were those with cell-pair CSI < 0.3; anti cell pairs were those with p 0 (see above) detected within the ±40 ms window in the XCG, and had cell-pair CSI < −0.3; super cell pairs were those with p 0 detected in ±40 ms in the XCG, and had cell-pair CSI > 0.3; off cell pairs were all other cell pairs that had |cell-pair CSI| > 0.3.
The goal of these criteria was primarily to identify cell pairs that unequivocally exhibited cycling firing ( Figures S2 E–S2H) rather than to demarcate cell pair types optimally; from informal observations, the cell-pair CSI cutoff value presently chosen (0.3) tends to over-classify cell pairs as classic. Given the adopted criteria, cell pair proportions were tabulated ( Figures S2 F–S2H). Similar results were obtained when cell pairs recorded from the same tetrode were excluded (yielding similar proportions; see caption of Figures S2 F–S2H for all numerical values).
It is important to note that the present analysis approach assumes that cycling dynamics do not exceed two cycle types (A-B-A-B-…), though it is possible that cycling dynamics occur with three or more cycle types. Given this particular limitation, single-cell measures ( Figure 3 ) were also adopted to quantify cycling dynamics; the cell pair results are presented here as an initial simple approach to the observation of constant cycling dynamics in the hippocampus ( Figures 1 , 2 , and S2 ), and to facilitate comparison to recent results in entorhinal cortex ( Deshmukh et al., 2010; Brandon et al., 2013 7. Brandon, M.P. ∙ Bogaard, A.R. ∙ Schultheiss, N.W. ... Segregation of cortical head direction cell assemblies on alternating θ cycles Nat. Neurosci. 2013; 16 :739-748 Crossref Scopus (49) PubMed Google Scholar 31. Deshmukh, S.S. ∙ Yoganarasimha, D. ∙ Voicu, H. ... Theta modulation in the medial and the lateral entorhinal cortices J. Neurophysiol. 2010; 104 :994-1006 Crossref Scopus (85) PubMed Google Scholar ).
To evaluate neural representation at the population level, Bayesian decoding of unsorted neural spikes (i.e., unassigned by experimenter to single cells) was performed ( Kloosterman et al., 2014; Deng et al., 2015 30. Deng, X. ∙ Liu, D.F. ∙ Kay, K. ... Clusterless Decoding of Position from Multiunit Activity Using a Marked Point Process Filter Neural Comput. 2015; 27 :1438-1460 Crossref Scopus (17) PubMed Google Scholar 75. Kloosterman, F. ∙ Layton, S.P. ∙ Chen, Z. ... Bayesian Decoding using Unsorted Spikes in the Rat Hippocampus J. Neurophysiol. 2014; 111 :217-227 Crossref Scopus (40) PubMed Google Scholar ). The inclusion of unsorted spikes is advantageous for population-level analysis in that recorded data subject to analysis are maximized: all spike sources monitored by electrodes are analyzed. Furthermore, recent studies report improved decoding performance for hippocampal data ( Kloosterman et al., 2014; Deng et al., 2015 30. Deng, X. ∙ Liu, D.F. ∙ Kay, K. ... Clusterless Decoding of Position from Multiunit Activity Using a Marked Point Process Filter Neural Comput. 2015; 27 :1438-1460 Crossref Scopus (17) PubMed Google Scholar 75. Kloosterman, F. ∙ Layton, S.P. ∙ Chen, Z. ... Bayesian Decoding using Unsorted Spikes in the Rat Hippocampus J. Neurophysiol. 2014; 111 :217-227 Crossref Scopus (40) PubMed Google Scholar ). This improvement is deducible given that (i) spikes with similar waveforms emanate from the same cells ( McNaughton et al., 1983b; Gray et al., 1995; Henze et al., 2000 50. Gray, C.M. ∙ Maldonado, P.E. ∙ Wilson, M. ... Tetrodes markedly improve the reliability and yield of multiple single-unit isolation from multi-unit recordings in cat striate cortex J. Neurosci. Methods. 1995; 63 :43-54 Crossref Scopus (495) PubMed Google Scholar 56. Henze, D.A. ∙ Borhegyi, Z. ∙ Csicsvari, J. ... Intracellular features predicted by extracellular recordings in the hippocampus in vivo J. Neurophysiol. 2000; 84 :390-400 Crossref PubMed Google Scholar 93. McNaughton, B.L. ∙ O’Keefe, J. ∙ Barnes, C.A. The stereotrode: a new technique for simultaneous isolation of several single units in the central nervous system from multiple unit records J. Neurosci. Methods. 1983; 8 :391-397 Crossref Scopus (377) PubMed Google Scholar ), a correspondence that does not depend on spike sorting, and (ii) multi-tetrode recording in hippocampus routinely yields a substantial number of high-amplitude spikes left unsorted prior to analysis ( Davidson et al., 2009 29. Davidson, T.J. ∙ Kloosterman, F. ∙ Wilson, M.A. Hippocampal replay of extended experience Neuron. 2009; 63 :497-507 Full Text Full Text (PDF) Scopus (344) PubMed Google Scholar ). In the present study, two variables were separately decoded: location ( Wilson and McNaughton, 1993; Brown et al., 1998; Zhang et al., 1998; Pfeiffer and Foster, 2013 8. Brown, E.N. ∙ Frank, L.M. ∙ Tang, D. ... A statistical paradigm for neural spike train decoding applied to position prediction from ensemble firing patterns of rat hippocampal place cells J. Neurosci. 1998; 18 :7411-7425 Crossref PubMed Google Scholar 107. Pfeiffer, B.E. ∙ Foster, D.J. Hippocampal place-cell sequences depict future paths to remembered goals Nature. 2013; 497 :74-79 Crossref Scopus (456) PubMed Google Scholar 133. Wilson, M.A. ∙ McNaughton, B.L. Dynamics of the hippocampal ensemble code for space Science. 1993; 261 :1055-1058 Crossref PubMed Google Scholar 137. Zhang, K. ∙ Ginzburg, I. ∙ McNaughton, B.L. ... Interpreting neuronal population activity by reconstruction: unified framework with application to hippocampal place cells J. Neurophysiol. 1998; 79 :1017-1044 Crossref Scopus (416) PubMed Google Scholar ) and heading direction ( McNaughton et al., 1983a; Battaglia et al., 2004; Foster and Wilson, 2006; Davidson et al., 2009 4. Battaglia, F.P. ∙ Sutherland, G.R. ∙ McNaughton, B.L. Local sensory cues and place cell directionality: additional evidence of prospective coding in the hippocampus J. Neurosci. 2004; 24 :4541-4550 Crossref Scopus (93) PubMed Google Scholar 29. Davidson, T.J. ∙ Kloosterman, F. ∙ Wilson, M.A. Hippocampal replay of extended experience Neuron. 2009; 63 :497-507 Full Text Full Text (PDF) Scopus (344) PubMed Google Scholar 44. Foster, D.J. ∙ Wilson, M.A. Reverse replay of behavioural sequences in hippocampal place cells during the awake state Nature. 2006; 440 :680-683 Crossref Scopus (819) PubMed Google Scholar 92. McNaughton, B.L. ∙ Barnes, C.A. ∙ O’Keefe, J. The contributions of position, direction, and velocity to single unit activity in the hippocampus of freely-moving rats Exp. Brain Res. 1983; 52 :41-49 Crossref Scopus (649) PubMed Google Scholar ), each variable long established as single-cell representational correlates in the hippocampus ( Eichenbaum et al., 1999 36. Eichenbaum, H. ∙ Dudchenko, P. ∙ Wood, E. ... The hippocampus, memory, and place cells: is it spatial memory or a memory space? Neuron. 1999; 23 :209-226 Full Text Full Text (PDF) Scopus (671) PubMed Google Scholar ).
To limit analysis to population-level activity, decoding was performed only for recording epochs for which there were at least 20 putative principal cells clustered and firing at least 100 spikes, moreover only for subjects with at least three such epochs available (83 epochs across 7 subjects). Within each epoch, spikes included for analysis were required to (i) exceed 60 μV on at least one tetrode channel (ii) be recorded on a tetrode that yielded at least one clustered putative principal cell. Across qualifying epochs, 4-17 (median: 9) tetrodes per epoch met criterion (ii); these tetrodes were predominantly in CA1 and CA3, with a subset of epochs (34 out of 83 epochs) also including tetrodes in CA2 and DG. Restricting decoding to CA1 and CA3 tetrodes yielded qualitatively equivalent findings (data not presented). In example plots (e.g., Figures 4 A–4C and 7 A–7C), the unsorted spikes that were analyzed were aggregated across tetrodes and shown as multi-unit activity (MUA).
For both location and direction, the decoding procedure was performed within each ∼15 min recording epoch; data used to construct an encoding model were from locomotor periods while decoded data was from locomotor periods and flanking 0.5 s periods (stopping periods). Flanking stopping periods were included in the analysis since the theta rhythm and associated neural firing are known to continue to be expressed during these times; these periods were also included to assess neural activity possibly associated with head scanning behaviors ( Johnson and Redish, 2007; Redish, 2016 63. Johnson, A. ∙ Redish, A.D. Neural ensembles in CA3 transiently encode paths forward of the animal at a decision point J. Neurosci. 2007; 27 :12176-12189 Crossref Scopus (500) PubMed Google Scholar 110. Redish, A.D. Vicarious trial and error Nat. Rev. Neurosci. 2016; 17 :147-159 Crossref Scopus (261) PubMed Google Scholar ), which can encompass brief low-speed periods. In plots, neural activity overlapping with stopping periods are shown separately from neural activity that occurred solely during locomotor periods (open bars/circles versus black bars/points, respectively, in Figures 4 E–4G, 7 E and 7F, and S7 F).
For location, spikes were analyzed independently in inbound versus outbound periods since location encoding in the hippocampus is known to be direction-specific ( McNaughton et al., 1983a; Battaglia et al., 2004; Foster and Wilson, 2006; Davidson et al., 2009 4. Battaglia, F.P. ∙ Sutherland, G.R. ∙ McNaughton, B.L. Local sensory cues and place cell directionality: additional evidence of prospective coding in the hippocampus J. Neurosci. 2004; 24 :4541-4550 Crossref Scopus (93) PubMed Google Scholar 29. Davidson, T.J. ∙ Kloosterman, F. ∙ Wilson, M.A. Hippocampal replay of extended experience Neuron. 2009; 63 :497-507 Full Text Full Text (PDF) Scopus (344) PubMed Google Scholar 44. Foster, D.J. ∙ Wilson, M.A. Reverse replay of behavioural sequences in hippocampal place cells during the awake state Nature. 2006; 440 :680-683 Crossref Scopus (819) PubMed Google Scholar 92. McNaughton, B.L. ∙ Barnes, C.A. ∙ O’Keefe, J. The contributions of position, direction, and velocity to single unit activity in the hippocampus of freely-moving rats Exp. Brain Res. 1983; 52 :41-49 Crossref Scopus (649) PubMed Google Scholar ). For direction, spikes analyzed were restricted to periods when subjects were located in the three parallel longer segments of the maze, specified as linearized positions (defined with respect to the center reward well; see above) that were either less than or more than 40 cm from the linearized position of the central junction (shown as lighter gray positions in example behavioral maps in Figures 7 A–7C and S7 B–S7E). This restriction was imposed to facilitate comparison to previous studies; in particular, prior work on hippocampal directional coding in mazes ( McNaughton et al., 1983a; Battaglia et al., 2004; Foster and Wilson, 2006; Wu and Foster, 2014 4. Battaglia, F.P. ∙ Sutherland, G.R. ∙ McNaughton, B.L. Local sensory cues and place cell directionality: additional evidence of prospective coding in the hippocampus J. Neurosci. 2004; 24 :4541-4550 Crossref Scopus (93) PubMed Google Scholar 44. Foster, D.J. ∙ Wilson, M.A. Reverse replay of behavioural sequences in hippocampal place cells during the awake state Nature. 2006; 440 :680-683 Crossref Scopus (819) PubMed Google Scholar 92. McNaughton, B.L. ∙ Barnes, C.A. ∙ O’Keefe, J. The contributions of position, direction, and velocity to single unit activity in the hippocampus of freely-moving rats Exp. Brain Res. 1983; 52 :41-49 Crossref Scopus (649) PubMed Google Scholar 136. Wu, X. ∙ Foster, D.J. Hippocampal replay captures the unique topological structure of a novel environment J. Neurosci. 2014; 34 :6459-6469 Crossref Scopus (84) PubMed Google Scholar ) has generally referred to straight rather than jointed (e.g., perpendicularly connected) maze tracks.
For location, decoding windows were 20 ms with 4 ms overlap between windows. For direction, two types of decoding windows were used (illustrated in Figures S6 C and S6D): (i) 20 ms with 4 ms overlap (sliding window decoder), and (ii) windows correspondent with theta half-cycles (half-cycle decoder; Figures 7 and S7 B–S7G). For (ii), theta phase estimated from LFP (see above) was used to identify windows of duration π/4 (90°) centered on first and second halves of theta (i.e., first-half window: (−3 ∗ π/4, -π/4); second-half window: (π/4, 3 ∗ π/4)). These windows were chosen on the basis of results at both the single-cell ( Figures 5 B, 6 E–6H, and S6 A) and population ( Figure S6 E) levels indicating that representation of non-current (hypothetical) direction is systematically weakest and strongest at approximately –π/2 and π/2, respectively.
It is worth noting that decoding is performed in sub-second time windows (20-50 ms) to assess temporal dynamics; in contrast, the encoding model is constructed from data pooled across the ∼15 min recording epoch without referencing any temporal dynamics in the epoch.
A two-stage decoding algorithm described previously ( Kloosterman et al., 2014; Deng et al., 2015 30. Deng, X. ∙ Liu, D.F. ∙ Kay, K. ... Clusterless Decoding of Position from Multiunit Activity Using a Marked Point Process Filter Neural Comput. 2015; 27 :1438-1460 Crossref Scopus (17) PubMed Google Scholar 75. Kloosterman, F. ∙ Layton, S.P. ∙ Chen, Z. ... Bayesian Decoding using Unsorted Spikes in the Rat Hippocampus J. Neurophysiol. 2014; 111 :217-227 Crossref Scopus (40) PubMed Google Scholar ) was used. In the first stage (encoding), the mapping between spikes and the representational variable (location or direction) was modeled as an N-dimensional probability distribution (mark space, M), where each spike corresponds to an N-dimensional vector (mark). In M, N-1 dimensions correspond to the feature space of spikes while the remaining dimension corresponds to the representational variable. M is estimated from all spikes occurring during encoding periods using kernel density estimation. In the present case, N is 5, where 4 dimensions correspond to the amplitude (μV) of the spike on each of the spike’s 4 parent tetrode channels while the remaining dimension corresponds to the value of the representational variable (X; location: linearized position (cm); direction: −1 for inbound, 1 for outbound) observed from the subject at the time of the spike. Each spike contributed a 5-D Gaussian kernel, with the 4 amplitude dimensions contributing symmetrically (each σ = 20 μV), symmetric in the amplitude dimensions). For location, the representation dimension of M was linearized position divided into 1-cm bins, with each spike contributing a Gaussian kernel (σ = 8 cm). For direction, the representation dimension of M was two-bin distribution, with each spike contributing a Kronecker delta kernel.
In the second stage, decoding was performed using Bayes’ rule: p ⁡ ( X | s p i k e s ) = c ∗ p ⁢ ( s p i k e s | ⁢ X ) ∗ p ⁡ ( X ) . where spikes refers to the set of spike marks observed in the decoding window, and c is a normalization constant.
Each p(⋅) term is a probability density over the representational dimension of M; p(X|spikes) is the posterior (decoded output; estimate of the representational correlate X); p(spikes|X) is the likelihood (encoding model); p(X) is the prior.
To obtain p(spikes|X), the aggregate spiking activity across tetrodes was modeled as a marked point process with mark space M, with spikes in each decoding time window treated as independent and following a Poisson distribution with rate parameter fully characterized by M (derivation and formalism in earlier report ( Deng et al., 2015 30. Deng, X. ∙ Liu, D.F. ∙ Kay, K. ... Clusterless Decoding of Position from Multiunit Activity Using a Marked Point Process Filter Neural Comput. 2015; 27 :1438-1460 Crossref Scopus (17) PubMed Google Scholar )).
Next, the prior p(X) was taken to be either uniform or history-dependent. For decoding of direction, a uniform p(X) was used given a lack of prior knowledge of population-level representation of direction in the hippocampus. For decoding of location, both uniform ( Karlsson and Frank, 2009; Kloosterman et al., 2014; Pfeiffer and Foster, 2013 67. Karlsson, M.P. ∙ Frank, L.M. Awake replay of remote experiences in the hippocampus Nat. Neurosci. 2009; 12 :913-918 Crossref Scopus (351) PubMed Google Scholar 75. Kloosterman, F. ∙ Layton, S.P. ∙ Chen, Z. ... Bayesian Decoding using Unsorted Spikes in the Rat Hippocampus J. Neurophysiol. 2014; 111 :217-227 Crossref Scopus (40) PubMed Google Scholar 107. Pfeiffer, B.E. ∙ Foster, D.J. Hippocampal place-cell sequences depict future paths to remembered goals Nature. 2013; 497 :74-79 Crossref Scopus (456) PubMed Google Scholar ) and history-dependent ( Brown et al., 1998; Zhang et al., 1998; Johnson et al., 2006; Johnson and Redish, 2007 8. Brown, E.N. ∙ Frank, L.M. ∙ Tang, D. ... A statistical paradigm for neural spike train decoding applied to position prediction from ensemble firing patterns of rat hippocampal place cells J. Neurosci. 1998; 18 :7411-7425 Crossref PubMed Google Scholar 63. Johnson, A. ∙ Redish, A.D. Neural ensembles in CA3 transiently encode paths forward of the animal at a decision point J. Neurosci. 2007; 27 :12176-12189 Crossref Scopus (500) PubMed Google Scholar 64. Johnson, A. ∙ Jackson, J. ∙ Redish, A.D. Measuring distributed properties of neural representations beyond the decoding of local variables—implications for cognition Information Processing by Neuronal Populations Cambridge University Press, 2006; 95-119 Google Scholar 137. Zhang, K. ∙ Ginzburg, I. ∙ McNaughton, B.L. ... Interpreting neuronal population activity by reconstruction: unified framework with application to hippocampal place cells J. Neurophysiol. 1998; 79 :1017-1044 Crossref Scopus (416) PubMed Google Scholar ) priors were used to assess the generality of the population-level result (constant cycling at 8 Hz between alternative locations) across decoding approaches (history-dependent prior: Figure 4 ; both priors: Figure S4 ). The advantage of a uniform prior is that it minimizes assumptions about the decoded activity; the advantage of a history-dependent prior is that it models known properties of the decoded activity.
Taking previous work ( Johnson et al., 2006; Johnson and Redish, 2007 63. Johnson, A. ∙ Redish, A.D. Neural ensembles in CA3 transiently encode paths forward of the animal at a decision point J. Neurosci. 2007; 27 :12176-12189 Crossref Scopus (500) PubMed Google Scholar 64. Johnson, A. ∙ Jackson, J. ∙ Redish, A.D. Measuring distributed properties of neural representations beyond the decoding of local variables—implications for cognition Information Processing by Neuronal Populations Cambridge University Press, 2006; 95-119 Google Scholar ) as a starting point, the history-dependent prior was designed to model the observation that population-level spiking in the hippocampus characteristically encodes locational sequences that evolve at virtual speeds exceeding 1 m/s ( Davidson et al., 2009; Gupta et al., 2012; Feng et al., 2015; Zheng et al., 2016 29. Davidson, T.J. ∙ Kloosterman, F. ∙ Wilson, M.A. Hippocampal replay of extended experience Neuron. 2009; 63 :497-507 Full Text Full Text (PDF) Scopus (344) PubMed Google Scholar 39. Feng, T. ∙ Silva, D. ∙ Foster, D.J. Dissociation between the experience-dependent development of hippocampal theta sequences and single-trial phase precession J. Neurosci. 2015; 35 :4890-4902 Crossref Scopus (51) PubMed Google Scholar 51. Gupta, A.S. ∙ van der Meer, M.A. ∙ Touretzky, D.S. ... Segmentation of spatial experience by hippocampal θ sequences Nat. Neurosci. 2012; 15 :1032-1039 Crossref Scopus (133) PubMed Google Scholar 138. Zheng, C. ∙ Bieri, K.W. ∙ Hsiao, Y.T. ... Spatial Sequence Coding Differs during Slow and Fast Gamma Rhythms in the Hippocampus Neuron. 2016; 89 :398-408 Full Text Full Text (PDF) Scopus (59) PubMed Google Scholar ). This property can be captured by a Markovian state-space model ( Deng et al., 2015 30. Deng, X. ∙ Liu, D.F. ∙ Kay, K. ... Clusterless Decoding of Position from Multiunit Activity Using a Marked Point Process Filter Neural Comput. 2015; 27 :1438-1460 Crossref Scopus (17) PubMed Google Scholar ) implemented by a prior defined at each time step as the product of a constant 1-step transition matrix and the posterior from the previous time step. To eliminate bias for the decoded output to evolve in a particular direction, state transitions were modeled as a 2D random walk ( Brown et al., 1998; Zhang et al., 1998; Johnson et al., 2006 8. Brown, E.N. ∙ Frank, L.M. ∙ Tang, D. ... A statistical paradigm for neural spike train decoding applied to position prediction from ensemble firing patterns of rat hippocampal place cells J. Neurosci. 1998; 18 :7411-7425 Crossref PubMed Google Scholar 64. Johnson, A. ∙ Jackson, J. ∙ Redish, A.D. Measuring distributed properties of neural representations beyond the decoding of local variables—implications for cognition Information Processing by Neuronal Populations Cambridge University Press, 2006; 95-119 Google Scholar 137. Zhang, K. ∙ Ginzburg, I. ∙ McNaughton, B.L. ... Interpreting neuronal population activity by reconstruction: unified framework with application to hippocampal place cells J. Neurophysiol. 1998; 79 :1017-1044 Crossref Scopus (416) PubMed Google Scholar ) where, for simplicity, the three arms of the maze were treated as locations in a radially symmetric Y shape (120° between arms). Transition probabilities between maze locations were calculated as the value of a Gaussian (σ = 1 cm) evaluated at the Euclidean distance between each location in the Y. To model virtual speeds exceeding 1 m/s, the transition matrix was exponentiated by 10 ( Johnson et al., 2006; Johnson and Redish, 2007 63. Johnson, A. ∙ Redish, A.D. Neural ensembles in CA3 transiently encode paths forward of the animal at a decision point J. Neurosci. 2007; 27 :12176-12189 Crossref Scopus (500) PubMed Google Scholar 64. Johnson, A. ∙ Jackson, J. ∙ Redish, A.D. Measuring distributed properties of neural representations beyond the decoding of local variables—implications for cognition Information Processing by Neuronal Populations Cambridge University Press, 2006; 95-119 Google Scholar ); thus for decoding windows that shifted every 4 ms, the 1-cm scale of the Gaussian corresponds to a virtual speed of 2.5 m/s, with exponentiation by 10 corresponding to 25 m/s. The resulting prior is approximately an order of magnitude more conservative (diffuse over spatial locations) compared to priors modeling virtual speeds of ∼2-5 m/s ( Johnson and Redish, 2007 63. Johnson, A. ∙ Redish, A.D. Neural ensembles in CA3 transiently encode paths forward of the animal at a decision point J. Neurosci. 2007; 27 :12176-12189 Crossref Scopus (500) PubMed Google Scholar ). It is also worth noting that since the model (transition matrix) is constant, it cannot impose temporal structure (e.g. cycling dynamics).
To determine whether constant cycling at 8 Hz between alternative locations (i.e., left (L) versus right (R) maze arm; observed initially in cell pairs ( Figures 1 , 2 , and S2 )) occurred at the population level, the output of the clusterless decoding of location (decoded posteriors; see above) was analyzed. Moreover, to investigate explicitly the finding of elevated cycling dynamics when subjects were approaching the L versus R spatial choice ( Figure 3 H, suggesting cycling between L versus R locations), analysis was conducted on the decoded output from the three types of maze passes (defined above) involving this behavior: outbound Left path passes, outbound Right path passes, and backtrack passes from the center well. Analysis was restricted to locomotor periods and flanking stopping periods (0.5 s), to periods when the subject was located within the choice boundary (center zone), and to periods when the subject was located at least one-third of the linear distance to the choice boundary along the center arm; the latter two restrictions were imposed to focus analysis on neural activity expressly associated with choice approach.
First, 8 Hz cycles were segregated on the basis of the ∼8 Hz theta rhythm. Prior results suggest that population-level representation of locational sequences occur within individual theta cycles ( Skaggs et al., 1996; Davidson et al., 2009; Gupta et al., 2012; Feng et al., 2015; Wikenheiser and Redish, 2015 29. Davidson, T.J. ∙ Kloosterman, F. ∙ Wilson, M.A. Hippocampal replay of extended experience Neuron. 2009; 63 :497-507 Full Text Full Text (PDF) Scopus (344) PubMed Google Scholar 39. Feng, T. ∙ Silva, D. ∙ Foster, D.J. Dissociation between the experience-dependent development of hippocampal theta sequences and single-trial phase precession J. Neurosci. 2015; 35 :4890-4902 Crossref Scopus (51) PubMed Google Scholar 51. Gupta, A.S. ∙ van der Meer, M.A. ∙ Touretzky, D.S. ... Segmentation of spatial experience by hippocampal θ sequences Nat. Neurosci. 2012; 15 :1032-1039 Crossref Scopus (133) PubMed Google Scholar 120. Skaggs, W.E. ∙ McNaughton, B.L. ∙ Wilson, M.A. ... Theta phase precession in hippocampal neuronal populations and the compression of temporal sequences Hippocampus. 1996; 6 :149-172 Crossref Scopus (946) PubMed Google Scholar 132. Wikenheiser, A.M. ∙ Redish, A.D. Hippocampal theta sequences reflect current goals Nat. Neurosci. 2015; 18 :289-294 Crossref Scopus (170) PubMed Google Scholar ): thus the initial step was to identify an appropriate phase by which to segregate theta cycles. To this end, the theta phase distribution of the representation of alternative locations (L or R maze arm) was calculated for each recording epoch; specifically, the decoded probability density located in either the L or R arm (integrating over position bins) was histogrammed in 30° theta phase bins (linear interpolation of 5-11 Hz LFP, see above). The phase bin having the minimum probability density was then used to segregate all theta cycles in the epoch.
Second, candidate 8 Hz cycles representing the alternative locations (L or R maze arm) were identified and binarized. Candidate cycles were identified as the segregated theta cycles that had probability density >0.1 for either the L or R maze arm (L/R density; the remainder corresponding to the center arm); then, for each candidate cycle, the arm with the higher probability density was designated as the location (L versus R) represented.
Third, constant cycling periods were detected. In general, constant cycling can be defined as cycle-to-cycle switching of representation across at least 3 successive cycles, i.e., A-B-C-D where B is not A, C is not B, and D is not C. For binary alternatives, constant cycling is defined only for the special case of A-B-A-B; accordingly, for the present case of L versus R, putative constant cycling periods were detected as cases where the representation switched for at least 3 successive cycles (L-R-L-R… or R-L-R-L…), corresponding to a minimum total duration of 4 cycles. The start and end of single constant cycling periods were defined as the beginning of the first cycle to the end of the last cycle, respectively. Note that constant cycling periods were only detected within periods of contiguous candidate theta cycles (contig period).
To evaluate whether constant cycling could have resulted from random activity or noisy data, the observation of constant cycling was tested against a null model in which cycle order was random, i.e., temporal shuffling. Testing was moreover conducted at two different levels: (I) the study-wide level (study-wide shuffle) and (II) at the level of individual periods (individual period shuffles).
(I) The study-wide shuffle ( Figures 4 D and S4 G) was performed to test whether constant cycling was a non-random activity pattern. A p value was calculated by randomly shuffling (10000 permutations) the order of all candidate theta cycles within every contig period across all recording epochs. For each shuffle, constant cycling periods were then re-detected, after which the total number of cycles participating in the re-detected constant cycling periods was tabulated; the p value was the proportion of shuffles for which the total number of such cycles (i.e. those belonging to constant cycling periods) was equal to or greater than the number in the observed data.
(II) Individual period shuffles ( Figures 4 E and S4 H) were performed to measure how non-random single periods of constant cycling were. In contrast to the study-wide shuffle, the goal was to identify individual constant cycling periods that were not likely to have occurred by chance. A p value was calculated for each observed constant cycling period by randomly shuffling (10000 permutations) the order of candidate theta cycles within the same recording epoch and within time periods of the same path pass type (outbound Left, outbound Right, or center well backtrack) as that of the observed constant cycling period; the p value of the constant cycling period was proportion of shuffles for which a constant cycling period of the same or greater cycle duration was detected within the same contig period as the observed constant cycling period. The p value thus measures the frequency of the representational activity pattern (an individual constant cycling period) with respect to the empirical prevalence of the components of that pattern (L versus R candidate theta cycles from the same recording epoch and path pass type). A criterion of p < 0.05 was then adopted to identify individual constant cycling periods subject to further analyses ( Figures 4 F, 4G, S4 I, and S4J).
To determine whether constant (half-theta) cycling between directions (suggested by initial observations; Figure S7 A) could occur at the population level, the output of the clusterless decoding of direction (decoded posteriors; see above) was analyzed. Analysis was conducted for all locomotor periods and flanking stopping periods (0.5 s). Furthermore, analysis was performed on the output of the theta half-cycle decoder, as single-cell and population-level results (single-cell: Figure S6 A, third row; population: Figure S6 E) suggested that this decoder would be maximally sensitive to representations of alternative directions.
First, the decoded half-cycles were binarized (illustration in Figures S6 C and S6D): for each half-cycle, the direction having the higher probability density was designated as the direction represented (outbound (O) versus inbound (I); see above).
Second, constant cycling periods were detected with a procedure analogous to that of location. In general, constant cycling can be defined as cycle-to-cycle switching of representation that occurs contiguously for least 3 successive cycles, i.e., A-B-C-D where B is not A, C is not B, and D is not C. For binary alternatives, constant cycling is defined only for the special case of A-B-A-B; accordingly, for the present case of O versus I, putative constant cycling periods were detected as cases where the representation switched for at least 3 successive theta half-cycles (O-I-O-I… or I-O-I-O…), corresponding to a minimum total duration of 4 theta half-cycles. The start and end of single constant cycling periods were defined as the beginning of the first theta half-cycle to the end of the last theta half-cycle, respectively. Note that constant cycling periods were only detected within periods of contiguous theta half-cycles (contig period).
Third, constant cycling periods were identified as occurring within three types of directional periods: inbound, outbound, or mixed directional periods. The first two types were identified if the detected constant cycling period occurred entirely within the respective (inbound or outbound) directional period. The mixed period type was identified if the constant cycling period overlapped with both inbound and outbound periods.
As in the case of location (see above), to evaluate whether constant cycling could have resulted from random activity or noisy data, the observation of constant cycling was tested against a null model in which cycle order was random, i.e., temporal shuffling. Testing was moreover conducted at two different levels: (I) the study-wide level (study-wide shuffle) and (II) at the level of individual periods (individual period shuffles).
(I) The study-wide shuffle ( Figure 7 D) was performed to test whether constant cycling was a non-random activity pattern. A p value was calculated by randomly shuffling (10000 permutations) the order of all half-theta cycles within every contig period across all recording epochs. For each shuffle, constant cycling periods were then re-detected, after which the total number of half-theta cycles participating in the re-detected constant cycling periods was tabulated; the p value was the proportion of shuffles for which the total number of such half-theta cycles (i.e. those in constant cycling periods) was equal to or greater than the number in the observed data.
(II) Individual period shuffles ( Figure 7 E) were performed to measure how non-random single periods of constant cycling were. In contrast to the study-wide shuffle, the goal was to identify individual constant cycling periods that were not likely to have occurred by chance. A p value was calculated for each observed constant cycling period by randomly shuffling (10000 permutations) the order of half-theta cycles within the same recording epoch and within the same directional period type (inbound or outbound) as that of the observed constant cycling period; the p value of the constant cycling period was proportion of shuffles for which a constant cycling period of the same or greater cycle duration was detected within the same contig period as the observed constant cycling period; for individual constant cycling periods that occurred during mixed directional periods, shuffling was performed simultaneously and separately for the half-theta cycles that occurred respectively within outbound versus inbound periods. The p value measures the frequency of the representational activity pattern (an individual constant cycling period) with respect to the empirical prevalence of the components of the pattern (O versus I half-theta cycles from the same recording epoch and directional period type). A criterion of p < 0.05 was then adopted to identify individual constant cycling periods subject to further analyses ( Figures 7 F and 7G). In addition, analysis of individual constant cycling periods lasting at least 8 (half-theta) cycles was also conducted ( Figures S7 F and S7G).
To assess whether population-level activity in the hippocampus could predict spatial choice ( Figure S5 ), Bayesian decoding of hippocampal neural firing was performed using the clusterless decoding algorithm (see above).
The decoding procedure (data criteria, analysis times, algorithm; see above) was the same as that of location and direction, but with the following specifications: (1) the data analyzed were from outbound path pass periods (left (L) and right (R); each pass treated as a single trial), (2) the representational variable was the path chosen (L versus R in a two-bin distribution; −1: L path, 1: R path), (3) each spike during outbound path periods (occurring during either a L or R outbound path pass; see above for path period definition) contributed a Kronecker delta kernel to the two-bin choice dimension of the mark space (M; the encoding model), and (4) spikes used to encode and decode were restricted to the windows of duration π/4 (90°) centered on 1 st and 2 nd halves of theta (1 st -half window: (−3 ∗ π/4, -π/4); 2 nd -half window: (π/4, 3 ∗ π/4)), respectively (half-cycle encoder and half-cycle decoder, respectively). Analysis was restricted to path passes (trials) that had at least 12 2 nd -half windows available for decoding.
To evaluate different frameworks for interpreting hippocampal representation, three approaches to the decoding procedure were taken (described and schematized in Figures S5 A–S5C); each approach stipulates a specific subset of data for encoding and decoding.
The decoded output (posterior probabilities) was analyzed as follows. Within each trial, the probability density corresponding to the R choice was averaged across second-half (decoding) windows. If this average probability exceeded 0.5, then the decoded choice was taken to be R; otherwise, the decoded choice was taken to be L.
A body of work ( Eichenbaum et al., 1999; O’Keefe, 2007 36. Eichenbaum, H. ∙ Dudchenko, P. ∙ Wood, E. ... The hippocampus, memory, and place cells: is it spatial memory or a memory space? Neuron. 1999; 23 :209-226 Full Text Full Text (PDF) Scopus (671) PubMed Google Scholar 102. O’Keefe, J. Hippocampal neurophysiology in the behaving animal Anderson, P. ∙ Morris, R. ∙ Amaral, D. (Editors) The Hippocampus Book Oxford University Press, 2007; 475-548 Google Scholar ) establishing that single neurons in the hippocampus encode externally observable variables was the basis of the present investigation into the neural representation of hypotheticals. Specifically, past findings indicate that single hippocampal neurons reliably (over single trials, recording epochs, days, and months ( Thompson and Best, 1990; Lever et al., 2002; O’Keefe, 2007 81. Lever, C. ∙ Wills, T. ∙ Cacucci, F. ... Long-term plasticity in hippocampal place-cell representation of environmental geometry Nature. 2002; 416 :90-94 Crossref Scopus (299) PubMed Google Scholar 102. O’Keefe, J. Hippocampal neurophysiology in the behaving animal Anderson, P. ∙ Morris, R. ∙ Amaral, D. (Editors) The Hippocampus Book Oxford University Press, 2007; 475-548 Google Scholar 124. Thompson, L.T. ∙ Best, P.J. Long-term stability of the place-field activity of single units recorded from the dorsal hippocampus of freely behaving rats Brain Res. 1990; 509 :299-308 Crossref Scopus (254) PubMed Google Scholar )) fire more in specific conditions (e.g., a particular location, direction, path, etc.) versus other conditions (other locations, directions, paths, etc.), establishing that these cells encode the relevant variable (representational correlate). Methodologically, time-averaged tuning curves (e.g., place cell maps ( Wilson and McNaughton, 1993; O’Keefe, 2007; Pfeiffer and Foster, 2013 102. O’Keefe, J. Hippocampal neurophysiology in the behaving animal Anderson, P. ∙ Morris, R. ∙ Amaral, D. (Editors) The Hippocampus Book Oxford University Press, 2007; 475-548 Google Scholar 107. Pfeiffer, B.E. ∙ Foster, D.J. Hippocampal place-cell sequences depict future paths to remembered goals Nature. 2013; 497 :74-79 Crossref Scopus (456) PubMed Google Scholar 133. Wilson, M.A. ∙ McNaughton, B.L. Dynamics of the hippocampal ensemble code for space Science. 1993; 261 :1055-1058 Crossref PubMed Google Scholar )) have been used to estimate single-cell encodings. This analysis approach to single cells was adopted, though with two differences.
The first difference was simply terminological: to make the underlying approach explicit (rather than the particular representational correlate, e.g., location, direction, etc.), the higher versus lower firing conditions were generically termed the “preferred” (P) versus “non-preferred” (NP) conditions, respectively.
The second difference was conceptual: in cases where single-cell firing was higher in the P (versus NP) condition, firing in the NP condition was subsequently interpreted not as noise, but as possibly reflecting covert representation of the P condition, i.e., the non-current, or hypothetical, condition. Thus the goal of analysis was to identify whether cells were tuned to fire more in one condition (P) versus another (NP), with the provisional interpretation that firing in the P versus NP condition encodes current versus hypothetical experience, respectively.
Data from each cell were analyzed as samples (cell samples) with the following criteria. If data from two unique maze environments were available for a cell, and the cell fired at least 100 spikes in the both environments, then the cell was analyzed in the two unique maze environments independently. Thus cells in the dataset could contribute more than one cell sample to subsequent analyses. If multiple recording epochs in one maze environment were available, then the recording epoch with the most recorded spikes was analyzed.
Four types of representational firing patterns were studied: (1) outbound path ( Frank et al., 2000; Wood et al., 2000; Ito et al., 2015 47. Frank, L.M. ∙ Brown, E.N. ∙ Wilson, M. Trajectory encoding in the hippocampus and entorhinal cortex Neuron. 2000; 27 :169-178 Full Text Full Text (PDF) PubMed Google Scholar 59. Ito, H.T. ∙ Zhang, S.J. ∙ Witter, M.P. ... A prefrontal-thalamo-hippocampal circuit for goal-directed spatial navigation Nature. 2015; 522 :50-55 Crossref Scopus (157) PubMed Google Scholar 135. Wood, E.R. ∙ Dudchenko, P.A. ∙ Robitsek, R.J. ... Hippocampal neurons encode information about different types of memory episodes occurring in the same location Neuron. 2000; 27 :623-633 Full Text Full Text (PDF) Scopus (657) PubMed Google Scholar ) (previously termed prospective trajectory), (2) inbound path ( Frank et al., 2000; Wood et al., 2000; Ito et al., 2015 47. Frank, L.M. ∙ Brown, E.N. ∙ Wilson, M. Trajectory encoding in the hippocampus and entorhinal cortex Neuron. 2000; 27 :169-178 Full Text Full Text (PDF) PubMed Google Scholar 59. Ito, H.T. ∙ Zhang, S.J. ∙ Witter, M.P. ... A prefrontal-thalamo-hippocampal circuit for goal-directed spatial navigation Nature. 2015; 522 :50-55 Crossref Scopus (157) PubMed Google Scholar 135. Wood, E.R. ∙ Dudchenko, P.A. ∙ Robitsek, R.J. ... Hippocampal neurons encode information about different types of memory episodes occurring in the same location Neuron. 2000; 27 :623-633 Full Text Full Text (PDF) Scopus (657) PubMed Google Scholar ) (previously termed retrospective trajectory), (3) directional ( McNaughton et al., 1983a; Battaglia et al., 2004 4. Battaglia, F.P. ∙ Sutherland, G.R. ∙ McNaughton, B.L. Local sensory cues and place cell directionality: additional evidence of prospective coding in the hippocampus J. Neurosci. 2004; 24 :4541-4550 Crossref Scopus (93) PubMed Google Scholar 92. McNaughton, B.L. ∙ Barnes, C.A. ∙ O’Keefe, J. The contributions of position, direction, and velocity to single unit activity in the hippocampus of freely-moving rats Exp. Brain Res. 1983; 52 :41-49 Crossref Scopus (649) PubMed Google Scholar ), and (4) a putative type termed “extra-field” ( Johnson and Redish, 2007; Rubin et al., 2014 63. Johnson, A. ∙ Redish, A.D. Neural ensembles in CA3 transiently encode paths forward of the animal at a decision point J. Neurosci. 2007; 27 :12176-12189 Crossref Scopus (500) PubMed Google Scholar 112. Rubin, A. ∙ Yartsev, M.M. ∙ Ulanovsky, N. Encoding of head direction by hippocampal place cells in bats J. Neurosci. 2014; 34 :1067-1080 Crossref Scopus (37) PubMed Google Scholar ). As described above, path- and direction-based 1D firing maps for each cell sample were calculated.
For (1), outbound path-based (outbound left (L) versus outbound right (R)) firing maps were analyzed; P versus NP refers to L versus R (or vice versa) paths. For (2), inbound path-based (inbound left (L) versus inbound right (R)) firing maps were analyzed; P versus NP refers to L versus R (or vice versa) paths. For (3), direction-based (inbound (I) versus outbound (O)) firing maps from each of the three maze arms were analyzed independently, with firing maps from each arm contributing independent cell samples if satisfying additional criteria specified below; for each cell sample, P versus NP refers to the I versus O heading direction, respectively (or vice versa). For (4), all four path-based maps were analyzed (outbound L, outbound R, inbound L, inbound R); P versus NP refers to the task paths with versus without at least one detected spatial firing field.
For each firing map, spatial firing fields (place fields), defined as contiguous linear positions of firing rate > 2 Hz and at least 10 cm large, were detected separately in the following alternative conditions. For (1), (2), and (3), there were two alternative conditions: namely, for (1) and (2), L versus R path, while for (3), O versus I direction. For (4), there were four alternative conditions: outbound L versus outbound R versus inbound L versus inbound R path. The inclusion criteria and identification of P versus NP conditions for each type of representational correlate are as follows. (1) Outbound path. Place field detection was performed separately in two locational zones in the maze: the center zone (see above) and the outer maze arms (L and R). Only cell samples that had at least one place field detected in either of the outer arms (L or R), in addition to at least one place field detected in the center zone, were analyzed (note that since the location zones were contiguous, a place field detected in both zones could correspond to a single place field that extends across zones). Next, for the outer maze arms, the peak firing rate of all detected place fields were compared; the path type (L or R) corresponding to the maze arm (L or R) with highest peak firing rate place field was designated as the cell’s preferred (P) condition (e.g. L path), with the other condition designated as the cell’s non-preferred (NP) condition (e.g. R path). (2) Inbound path. Place field detection was restricted to the center arm. Only cell samples that had at least one place field for either path (L or R) were analyzed. The path type (L or R) with the highest peak firing rate place field was designated as the cell’s preferred (P) condition (e.g. L path), with the other condition designated as the cell’s non-preferred (NP) condition (e.g. R path). (3) Directional. Place field detection was performed independently in each maze arm. Only cell samples that had at least one place field for either direction (I or O) were analyzed. The direction (I or O) with the place field with the highest peak firing rate was designated as the cell’s preferred (P) condition (e.g. I direction), with the other condition designated as the non-preferred (NP) condition (e.g. O direction). (4) Extra-field. Place field detection was performed separately for each of the four task-based firing maps. Task paths with at least one detected place field were designated as the cell’s preferred (P) condition(s), while task paths for which no place fields were detected were designated as the cell’s non-preferred (NP) condition(s). Note that this definition of extra-field firing (i.e., firing in the NP condition) refers to path- and direction- specific firing, while previously described approaches focus on location-specific firing ( Johnson and Redish, 2007; Rubin et al., 2014 63. Johnson, A. ∙ Redish, A.D. Neural ensembles in CA3 transiently encode paths forward of the animal at a decision point J. Neurosci. 2007; 27 :12176-12189 Crossref Scopus (500) PubMed Google Scholar 112. Rubin, A. ∙ Yartsev, M.M. ∙ Ulanovsky, N. Encoding of head direction by hippocampal place cells in bats J. Neurosci. 2014; 34 :1067-1080 Crossref Scopus (37) PubMed Google Scholar ); the approaches are otherwise conceptually similar.
Past work indicates that the degree of path- and direction-specific firing exists on a continuum, with some cells firing almost exclusively in the preferred condition, while other cells fire equivalently in either condition (e.g. “bidirectional” cells or “pure” place cells). Since only cells showing differential firing between conditions can encode the relevant variable, it was therefore necessary to measure the selectivity of firing between conditions. To this end, the selectivity index (SI, defined above) was calculated for P versus NP conditions; the SI was moreover calculated for both peak firing rate (from spatial firing maps) and mean firing rate.
A cell sample was classified as showing differential P versus NP firing if two criteria were met: (1) the SI was >0.2 (equivalent to 1.5x higher firing rate in the P condition; other threshold values yielded qualitatively equivalent results) for both peak firing rates and mean firing rates, (2) the cell sample in the NP condition had no more than one detected place field. These criteria were adopted to limit analyses to cases where there was unequivocally higher firing on average in the P (versus NP) condition.
To determine whether single-cell firing putatively encoding hypothetical experience (firing in non-preferred (NP) vs. preferred (P) conditions; see above) showed temporal organization at the sub-second timescale, neural firing in cells that were classified as showing selective firing was analyzed with respect to the phase of the ∼8 Hz theta rhythm. Analysis was restricted to locomotor periods. In brief, spikes were subdivided by condition (P versus NP), then analyzed separately.
The set of spikes analyzed was approximately the same as those used to construct firing maps, but with three differences: (1) a small proportion of spikes (∼5%) were ignored if they did not occur within periods in which there was a valid estimate of theta phase (see above), (2) in the case of path firing (L versus R), spikes were taken from all times during path passes between reward wells, with no exclusion of periods in which the rat was temporarily not within or oriented along the completed path, and (3) in the case of path firing (L versus R), spikes were limited to those that occurred within the center zone. Criterion (2) was adopted to take an inclusive approach to the spikes analyzed, particularly given prior findings showing that path-selective firing generalizes to instances where the path is behaviorally interrupted ( Ferbinteanu and Shapiro, 2003 40. Ferbinteanu, J. ∙ Shapiro, M.L. Prospective and retrospective memory coding in the hippocampus Neuron. 2003; 40 :1227-1239 Full Text Full Text (PDF) Scopus (351) PubMed Google Scholar ). Criterion (3) was adopted to restrict analysis to locations conventionally analyzed for path-specific firing (i.e., locations that overlap between paths).
Four representational correlates (see above) were analyzed: (1) outbound path, (2) inbound path, (3) direction, (4) extra-field. For each cell sample, the theta phases of the spikes in the P versus NP conditions were then each used to construct separate theta phase histograms. Phase histograms were then constructed at two resolutions: 12-bin (30° bins) and 2-bin (180° bins; first and second half of cycle); the former (12-bin) solely for plots, while the latter (2-bin) for both plots and statistical testing of the basic hypothesis that representation in the hippocampus differs between the first and second halves of the theta cycle. Cell samples analyzed were restricted to those with at least 20 spikes in the phase histogram in the NP condition and with non-uniform phase histograms (Rayleigh tests at p < 0.05) in both the P and NP conditions.
For these cell samples, spike theta phases were averaged (circular mean) to obtain the mean angle in the P and NP conditions ( Figures 6 B and 6F; first column in Figure S6 A). Second, phase histograms were normalized and then averaged across cell samples ( Figures 6 C, 6D, 6G, and 6H; second and fourth columns in Figure S6 A). To evaluate whether firing associated with the alternative (i.e., hypothetical) condition was enhanced on the 2 nd half of the theta cycle, two statistical comparisons were conducted for the 2-bin phase histograms: (a) the proportion of firing on the 2 nd half of theta in the NP condition versus 0.5 and (b) the proportion of firing on the 2 nd half of theta in the NP condition versus the proportion of firing on the 2 nd half of theta in the P condition.
To determine whether representation of current versus hypothetical experience showed temporal organization at the population level, the output of the clusterless decoding algorithm (see above), for both location and direction, was analyzed with respect to the phase of the ∼8 Hz theta rhythm. Analysis was performed for locomotor periods. The analysis was analogous to the single-cell analysis (see above) in that theta phase was quantified separately (i.e. separate theta phase histograms) for different conditions; the preferred (P) versus non-preferred (NP) conditions at the single-cell level respectively correspond, here at the population-level, to current versus hypothetical conditions, defined as follows.
The current condition is defined as the actual (veridical) state of the subject for a given representational correlate (e.g., the subject’s actual location if the representation is location), while the hypothetical condition is defined as the non-current state of the subject (e.g., a location remote from the subject’s actual location, or the direction opposite to that of the subject’s actual direction). The analysis procedure for each representational correlate studied presently (location and direction) is described in turn.
To evaluate theta phase organization of the locational representation ( Figures 4 H and S4 K), the output of the clusterless decoding of location was analyzed for all outbound path passes (n = 1683 path passes across 7 subjects) when the subject was located in center zone. Two types of current condition were defined: current maze arm (Center) and the maze arm (L or R) chosen by the subject in the path pass (Choice, Figure 4 H); the alternative condition (Alt) was defined as the maze arm (L or R) not chosen by the subject in the path pass. Theta histograms were pooled across all decoding windows occurring within each path pass. Path passes were moreover analyzed inclusively, with no exclusion of times in which the subject was temporarily not within or oriented along the completed path; this inclusive approach was adopted given prior findings showing that path-selective firing can generalize even to passes where the path is behaviorally interrupted ( Ferbinteanu and Shapiro, 2003 40. Ferbinteanu, J. ∙ Shapiro, M.L. Prospective and retrospective memory coding in the hippocampus Neuron. 2003; 40 :1227-1239 Full Text Full Text (PDF) Scopus (351) PubMed Google Scholar ).
To evaluate theta phase organization of the directional representation ( Figure S6 E), the output of the clusterless decoding of direction (sliding window decoder; see above) was analyzed for each of the 7 subjects for which decoding was performed. The current condition was the subject’s current heading direction (outbound (O) or inbound (I)), while the hypothetical condition was the other direction (O or I). Theta histograms were constructed from decoding windows pooled across all epochs for each subject.
Theta phase histograms (current and alternative/hypothetical) were calculated by first identifying the theta phase at the center time (average of start and end time) of each decoding window. Then, for each decoding window, the posterior probability density corresponding to each condition (current and alternative/hypothetical) was added to the corresponding theta phase histogram.
Phase histograms were constructed at two resolutions: 12-bin (30° bins) and 2-bin (180° bins; 1 st and 2 nd half of cycle); the former (12-bin) solely for plots, while the latter (2-bin) for both plots and statistical testing of the basic hypothesis that representation differs between the 1 st and 2 nd halves of the theta cycle. Phase histograms were then normalized within condition (current versus alternative/hypothetical) and averaged across samples (passes or subjects). To evaluate whether population-level representation associated with the alternative/hypothetical condition was enhanced on the 2 nd half of the theta cycle, two statistical comparisons were conducted for the 2-bin phase histograms: (a) the proportion of decoding density of the alternative/hypothetical condition on the 2 nd half of theta versus 0.5 and (b) the proportion of decoding density of the alternative/hypothetical condition on the 2 nd half of theta versus the proportion of decoding density of the current condition on the 2 nd half of theta.
Statistical tests and corresponding p values are reported within the text of the Results sections; however, for findings presented in Supplementary Figures, this information is instead reported within the correspondent Supplementary Figure legend. Measures of dispersion are reported either in the text of the Results section or in figure legends, as appropriate. All statistical tests were two-sided.
All data and custom-written code are available upon request.

Section: Acknowledgments

We thank L. Tian, X. Wei, U. Eden, X. Deng, C. Theofanopoulou, S. Muller, A. Palmigiano, and members of the Frank laboratory for comments and discussion, and we also thank J. Cunningham and L. Paninski for organizational support during preparation of the manuscript. This work was supported by the Howard Hughes Medical Institute, the Simons Collaboration for the Global Brain (521921 and 542981), an NIH grant (R01 MH090188 and R01 MH105174), the NSF NeuroNex award (DBI-1707398), and the Gatsby Charitable Foundation.
K.K. and L.M.F. initially observed the phenomena. K.K., J.E.C., M.S., M.P.K., and M.C.L. conducted experiments and collected data. K.K., L.M.F., and D.F.L. designed analyses. K.K. analyzed the data, and J.S.S contributed to preliminary analyses. K.K. and L.M.F. wrote the paper.
The authors declare no competing interests.
