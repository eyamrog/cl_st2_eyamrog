Title: The evolution and diversification of oakleaf butterflies


Abstract: Summary

Oakleaf butterflies in the genus Kallima have a polymorphic wing phenotype, enabling these insects to masquerade as dead leaves. This iconic example of protective resemblance provides an interesting evolutionary paradigm that can be employed to study biodiversity. We integrated multi-omic data analyses and functional validation to infer the evolutionary history of Kallima species and investigate the genetic basis of their variable leaf wing patterns. We find that Kallima butterflies diversified in the eastern Himalayas and dispersed to East and Southeast Asia. Moreover, we find that leaf wing polymorphism is controlled by the wing patterning gene cortex , which has been maintained in Kallima by long-term balancing selection. Our results provide macroevolutionary and microevolutionary insights into a model species originating from a mountain ecosystem.

Section: Introduction

Mountain ecosystems harbor extraordinarily diverse terrestrial biodiversity in which dramatic elevational gradients may have promoted the formation of microenvironments and accelerated diversification ( Rahbek et al., 2019a 90. Rahbek, C. ∙ Borregaard, M.K. ∙ Antonelli, A. ... Building mountain biodiversity: geological and evolutionary processes Science. 2019; 365 :1114-1119 Crossref Scopus (186) PubMed Google Scholar ). For example, geographic changes resulting from orogenic activity, combined with climate change, caused the Qinghai-Tibetan Plateau (QTP) uplift and produced diverse habitats for a variety of organisms ( Favre et al., 2015 26. Favre, A. ∙ Päckert, M. ∙ Pauls, S.U. ... The role of the uplift of the Qinghai-Tibetan Plateau for the evolution of Tibetan biotas Biol. Rev. Camb. Philos. Soc. 2015; 90 :236-253 Crossref Scopus (422) PubMed Google Scholar ). Montane biota and its relationship to lowland biodiversity hotspots have been topics of intense research interest, in which relevant studies have generally been conducted above the species level ( Rahbek et al., 2019b 91. Rahbek, C. ∙ Borregaard, M.K. ∙ Colwell, R.K. ... Humboldt's enigma: what causes global patterns of mountain biodiversity? Science. 2019; 365 :1108-1113 Crossref Scopus (0) PubMed Google Scholar ). Here, we focus on cryptic oakleaf butterflies of the genus Kallima (Nymphalidae: Nymphalinae), whose members are phenotypically diverse and distributed in montane and lowland biodiversity hotspots ( Küppers, 2015a 53. Küppers, P.V. Butterflies of the world, Part 44: Nymphalidae XXV: Kallima Verlag Goecke & Evers, 2015 Google Scholar ; Myers et al., 2000 77. Myers, N. ∙ Mittermeier, R.A. ∙ Mittermeier, C.G. ... Biodiversity hotspots for conservation priorities Nature. 2000; 403 :853-858 Crossref Scopus (19192) PubMed Google Scholar ; Tsukada, 1985 110. Tsukada, E. Butterflies of the South East Asian Islands Plapac Co., Ltd., in: Nymphalidae (1). Vol 4. 1985 Google Scholar ). The highly variable wing patterns and pan-Asian distribution of this group make it uniquely suited to study how geographic changes and natural selection shape phenotypic and species diversity.
Because leaves are ubiquitous in nature, leaf masquerade mimicry exists widely throughout the animal kingdom as a special form of plant resemblance ( Komárek, 2003 49. Komárek, S. Mimicry, Aposematism and Related Phenomena: Mimetism in Nature and the History of its Study Lincom Europa, 2003 Google Scholar ), as observed in Amazon leaffish ( Monocirrhus polyacanthus ), Malayan leaf frog ( Megophrys nasuta ), leaf insects (Phylliidae), and leaf-mimic katydids (various Tetigoniidae). Kallima butterflies are among the most well-known and striking examples of leaf mimics, regarded by Alfred Russel Wallace as “the most wonderful and undoubted case of protective resemblance in a butterfly” ( Wallace, 1889 118. Wallace, A.R. Darwinism: an Exploitation of the Theory of Natural Selection with Some of its Applications MacMillan, 1889 Google Scholar ). When the wings of Kallima butterflies are folded back, they look like dead, brown leaves, including wing pattern elements resembling the leaf midrib, secondary veins, petiole, and variable markings resembling decay. The extreme, cryptic wing patterns of these species seem to provide strong evidence for natural selection ( Beddard, 1892 6. Beddard, F.E. Animal Coloration: an Account of the Principal Facts and Theories Relating to the Colours and Markings of Animals S. Sonnenschein & Company, 1892 Google Scholar ; Morgan, 1903 76. Morgan, T.H. Evolution and Adaptation MacMillan, 1903 Google Scholar ), although many authors have denied that complex mimetic phenotypes can evolve gradually ( Goldschmidt, 1945 30. Goldschmidt, R.B. Mimetic polymorphism, a controversial chapter of Darwinism Q. Rev. Biol. 1945; 20 :147-164 Crossref Google Scholar ; Punnett, 1915 88. Punnett, R.C. Mimicry in Butterflies University of Cambridge, 1915 Google Scholar ; Watson, 1936 120. Watson, D.M.S. A discussion on the present state of theory of natural selection Proc. R. Soc. Lond. B. 1936; 121 :43-73 Crossref Google Scholar ). Therefore, Kallima butterflies have drawn considerable attention in multiple biological disciplines including taxonomy, phylogeography, physiology, and morphology, over the past few decades ( Kamalanathan and Mohanraj, 2012 46. Kamalanathan, V. ∙ Mohanraj, P. The life cycle and immature stages of Kallima albofasciata , the endemic Oakleaf, in the Andaman Islands (Indian Ocean, Bay of Bengal) J. Insect Sci. 2012; 12 :66 Crossref Scopus (2) PubMed Google Scholar ; Küppers, 2015a 53. Küppers, P.V. Butterflies of the world, Part 44: Nymphalidae XXV: Kallima Verlag Goecke & Evers, 2015 Google Scholar , 2015b 54. Küppers, P.V. Verlag Goecke & Evers, in: Butterflies of the world, Supplement 25: The Leaf Butterflies of the Genus Kallima Doubleday. Vol 1849. 2015 Google Scholar ; Nakamura, 2014 80. Nakamura, N. Distribution of Kallima inachus (Doyere,[1840]) and related species (Lepidoptera, Nymphalidae) in Indochina and adjacent regions with status alteration of Kallima inachus alicia Joicey & Talbot, 1921 Butterflies (Teinopalpus). 2014; 66 :22-39 Google Scholar ; Shirozu and Nakanishi, 1984 101. Shirozu, T. ∙ Nakanishi, A. A revision of the genus Kallima Doubleday (Lepidoptera, Nymphalidae): I. Generic classification Lepid. Sci. 1984; 34 :97-110 Google Scholar ; Tang et al., 2013 106. Tang, Y. ∙ Zhou, C. ∙ Chen, X. ... Foraging behavior of the dead leaf butterfly, Kallima inachus J. Insect Sci. 2013; 13 :58 Crossref Scopus (4) PubMed Google Scholar ; Zhou et al., 2013 133. Zhou, C. ∙ Chen, X. ∙ He, R. COII phylogeography reveals surprising divergencies within the cryptic butterfly Kallima inachus (Doyére, 1840) (Lepidoptera: Nymphalidae: Kallimini) in southeastern Asia. Pan-Pac Entomol. 2013; 88 :381-398 Google Scholar ), and we recently reported a reference genome assembly of Kallima inachus ( Yang et al., 2020 126. Yang, J. ∙ Wan, W. ∙ Xie, M. ... Chromosome-level reference genome assembly and gene editing of the dead-leaf butterfly Kallima inachus Mol. Ecol. Resour. 2020; 20 :1080-1092 Crossref Scopus (12) PubMed Google Scholar ). There is increasing evidence that the main characteristics of the leaf-like wing pattern tend to be produced by gradual selection rather than saltation (large, sudden mutational changes) ( Alexander, 2019 2. Alexander, V.N. The mechanism for mimicry: instant biosemiotic selection or gradual Darwinian fine-tuning selection? Biosemiotics. 2019; 12 :39-55 Crossref Scopus (0) Google Scholar ; Suffert, 1927 103. Suffert, F. Zur vergleichende Analyse der schmetterlingszeichnung Biol. Zbl. 1927; 47 :385-413 Google Scholar ; Suzuki et al., 2014 104. Suzuki, T.K. ∙ Tomita, S. ∙ Sezutsu, H. Gradual and contingent evolutionary emergence of leaf mimicry in butterfly wing patterns BMC Evol. Biol. 2014; 14 :229 Crossref PubMed Google Scholar , 2019 105. Suzuki, T.K. ∙ Tomita, S. ∙ Sezutsu, H. Multicomponent structures in camouflage and mimicry in butterfly wing patterns J. Morphol. 2019; 280 :149-166 Crossref Scopus (12) PubMed Google Scholar ). These studies have laid the foundation for exploration of the genomic basis of the various wing pattern elements that together constitute the mimetic phenotype.
In the present study, we performed a holistic analysis to characterize the genetic and species diversity of Kallima butterflies. At the macroevolutionary level, we traced the origin of the genus Kallima by sequencing the genomes of 105 butterflies from 21 nymphalid genera. Phylogenetic and population genetic analyses suggest that Kallima butterflies diversified on the Asian mainland, with several lineages dispersing to areas that are currently islands to the south and east. Subsequent demographic and biogeographical modeling efforts indicate that the eastern Himalayas are a center of Kallima diversification. At the microevolutionary level, to dissect the genomic basis of leaf wing polymorphism, we focused on K. inachus and performed genome-wide association studies (GWASs) by sequencing the genomes of 78 K. inachus butterflies with polymorphic phenotypes. A combination of evidence obtained from de novo genome assembly, gene expression, chromatin interaction analyses, and CRISPR-Cas9 genome editing led to the identification of a known wing pattern regulator, the cortex gene ( Nadeau et al., 2016 78. Nadeau, N.J. ∙ Pardo-Diaz, C. ∙ Whibley, A. ... The gene cortex controls mimicry and crypsis in butterflies and moths Nature. 2016; 534 :106-110 Crossref Scopus (125) PubMed Google Scholar ; Van't Hof et al., 2016 115. Van't Hof, A.E. ∙ Campagne, P. ∙ Rigden, D.J. ... The industrial melanism mutation in British peppered moths is a transposable element Nature. 2016; 534 :102-105 Crossref Scopus (131) PubMed Google Scholar ; van der Burg et al., 2020 112. van der Burg, K.R.L. ∙ Lewis, J.J. ∙ Brack, B.J. ... Genomic architecture of a genetically assimilated seasonal color pattern Science. 2020; 370 :721-725 Crossref Scopus (14) PubMed Google Scholar ), that plays a major role in controlling leaf wing polymorphism, likely by regulating a potential downstream gene, snake , involved in butterfly pigmentation and color switching ( Nishikawa et al., 2013 81. Nishikawa, H. ∙ Iga, M. ∙ Yamaguchi, J. ... Molecular basis of wing coloration in a Batesian mimic butterfly, Papilio polytes Sci. Rep. 2013; 3 :3184 Crossref Scopus (33) PubMed Google Scholar ; Yoda et al., 2020 127. Yoda, S. ∙ Otaguro, E. ∙ Nobuta, M. ... Molecular mechanisms underlying pupal protective color switch in Papilio polytes butterflies Front. Ecol. Evol. 2020; 8 :1-14 Crossref Scopus (4) Google Scholar ). Furthermore, through population genetic analyses, we show that leaf mimicry is maintained by balancing selection, possibly as a type of negative frequency-dependent selection, providing a rare and remarkable example with clear survival value supporting the role of long-term balancing selection in adaptive evolution. In summary, we explore the evolution of Kallima butterflies and provide genetic evidence for the morphogenesis of leaf mimicry, which serves as a complex, charismatic model for understanding microevolution, macroevolution, adaptation, and Darwinian gradualism.

Section: Results

To characterize the evolutionary history of leaf mimicry in Kallima butterflies, we collected 36 samples from the genus Kallima including specimens of Kallima knyvettii , Kallima limborgii amplirufa , Kallima paralekta , Kallima incognita , two subspecies of Kallima alicia , and two subspecies of K. inachus , from 11 geographic locations in East and Southeast Asia ( Figure 1 A; Table S1 ). Notably, the sampling locations of three Kallima species overlapped in Medog, southeastern Tibet, suggesting that the eastern Himalayan region could represent either a hotspot of diversification or a glacial refuge. To test this hypothesis and disentangle the relationships among Kallima species and populations, we analyzed whole-genome sequencing data from 105 butterfly samples from 21 nymphalid genera and constructed phylogenies using genome-wide SNPs ( Figure 1 B; Figures S1 A and S1B). The Kallima species formed a monophyletic group, but Kallima and the other leaf-mimicking species that we sampled formed a polyphyletic assemblage. These species included Doleschallia bisaltide (autumn leaf butterfly), Kallimoides rumia (African leaf butterfly), and Junonia cymodoce (blue leaf butterfly), suggesting multiple origins of leaf masquerade mimicry in Nymphalidae. Delving deeper into the genus Kallima , both principal component analysis (PCA) and ADMIXTURE analysis ( Alexander et al., 2009 1. Alexander, D.H. ∙ Novembre, J. ∙ Lange, K. Fast model-based estimation of ancestry in unrelated individuals Genome Res. 2009; 19 :1655-1664 Crossref Scopus (3770) PubMed Google Scholar ) indicated the existence of lineages with distinct genetic structure roughly corresponding to recognized species ( Figures 1 C–1E; Figure S1 C). We calculated the fixation index ( F ST ) across the genome for Kallima butterflies and observed that the F ST values increased at increasing levels in the taxonomic hierarchy: populations, subspecies, and species ( Table S2 ). Furthermore, we estimated historical population sizes using pairwise sequentially Markovian coalescent (PSMC) and SMC++ models ( Li and Durbin, 2011 61. Li, H. ∙ Durbin, R. Inference of human population history from individual whole-genome sequences Nature. 2011; 475 :493-496 Crossref Scopus (1181) PubMed Google Scholar ; Terhorst et al., 2017 109. Terhorst, J. ∙ Kamm, J.A. ∙ Song, Y.S. Robust and scalable inference of population history from hundreds of unphased whole genomes Nat. Genet. 2017; 49 :303-309 Crossref Scopus (256) PubMed Google Scholar ). Unlike other mainland Kallima butterflies, K. knyvettii has consistently had a small effective population size ( Figure 2 A; Figures S2 A and S2B). Both K. limborgii amplirufa and K. paralekta had less nucleotide diversity (π) than other mainland species/subspecies ( Table S2 ). To further investigate population dynamics of these species, we performed genome-wide demographic inference using the Generalized Phylogenetic Coalescent Sampler (G-PhoCS) ( Gronau et al., 2011 32. Gronau, I. ∙ Hubisz, M.J. ∙ Gulko, B. ... Bayesian inference of ancient human demography from individual genome sequences Nat. Genet. 2011; 43 :1031-1034 Crossref Scopus (367) PubMed Google Scholar ) and Treemix ( Pickrell and Pritchard, 2012 86. Pickrell, J.K. ∙ Pritchard, J.K. Inference of population splits and mixtures from genome-wide allele frequency data PLOS Genet. 2012; 8 :e1002967 Crossref Scopus (1184) PubMed Google Scholar ). Both population genetic analyses yielded evidence supporting extensive, directional gene flow from Medog in southeastern Tibet to insular populations of K. alicia alicia on Hainan and K. paralekta on Java, respectively; from the Medog population of K. incognita to K. paralekta on Java and K. l. amplirufa on the Thai-Malay Peninsula, and from the nominate subspecies on the mainland to the island subspecies of K. inachus formosana on Taiwan ( Figures 2 B–2D; Figures S2 D and S3 ; Table S3 ). However, little gene flow was detected between the mainland populations of K. incognita and K. inachus chinensis ( Figure S3 ). These results suggest dispersal from the Asian mainland to peripheral islands following the earlier divergence of K. incognita and K. inachus . The inferred divergence times of K. i. formosana and K. paralekta in the mid-Pleistocene ( Figures 2 C and 2D) corresponded to a period of intense global sea level fluctuations that continued until the end of the Pleistocene ( Voris, 2000 117. Voris, H.K. Maps of Pleistocene sea levels in Southeast Asia: shorelines, river systems and time durations J. Biogeogr. 2000; 27 :1153-1167 Crossref Scopus (1451) Google Scholar ; Woodruff, 2010 123. Woodruff, D.S. Biogeography and conservation in Southeast Asia: how 2.7 million years of repeated environmental fluctuations affect today's patterns and the future of the remaining refugial-phase biodiversity Biodivers. Conserv. 2010; 19 :919-941 Crossref Scopus (300) Google Scholar ). The continental islands of Hainan and Taiwan were connected to the mainland by land bridges, and Java, Sumatra, and Borneo were connected to the Thai-Malay peninsula in a single landmass known as Sundaland ( Cannon et al., 2009 13. Cannon, C.H. ∙ Morley, R.J. ∙ Bush, A.B.G. The current refugial rainforests of Sundaland are unrepresentative of their biogeographic past and highly vulnerable to disturbance Proc. Natl. Acad. Sci. USA. 2009; 106 :11188-11193 Crossref Scopus (253) PubMed Google Scholar ; Lohman et al., 2011 67. Lohman, D.J. ∙ de Bruyn, M. ∙ Page, T. ... Biogeography of the Indo-Australian archipelago Annu. Rev. Ecol. Evol. Syst. 2011; 42 :205-226 Crossref Scopus (335) Google Scholar ). Thus, it is likely that many Kallima taxa that are currently restricted to islands were formerly part of large, panmictic populations that became isolated when sea levels rose. We then evaluated the suitability of the climate for Kallima butterflies using the maximum entropy model (Maxent) ( Phillips et al., 2006 84. Phillips, S.J. ∙ Anderson, R.P. ∙ Schapire, R.E. Maximum entropy modeling of species geographic distributions Ecol. Modell. 2006; 190 :231-259 Crossref Scopus (111) Google Scholar ). The results of our niche model support the notion that the eastern Himalayan area has been climatically suitable for Kallima butterflies since the last interglacial (LIG) and that land bridges that formed during the last glacial maximum (LGM) facilitated secondary contact and gene flow among Kallima species/subspecies ( Figure 2 E; Figure S2 C). In summary, these results suggest that Kallima butterflies likely differentiated in the eastern Himalayas and subsequently dispersed to areas that are now islands.
Since Kallima butterflies have polymorphic leaf wing patterns, we characterized the ventral wing morphology of K. i. chinensis into discrete wing forms ( Figure 3 A; Figures S4 A and S4B). To assess phenotypic segregation, we established several crosses of K. i. chinensis with different wing forms and were fascinated to discover ten discrete leaf wing forms in total, which were likely determined by combinations of five alleles ( P , V , S , R , and M , for plain , veined , scrambled , rippled , and moldy , respectively, describing the wing patterns) located at a single Mendelian locus ( Figures 3 A and 3B). To map the leaf mimicry locus genetically, we sequenced genomes of 78 K. i. chinensis specimens from China and conducted GWASs to compare multiple forms ( Table S1 ). The top-associated GWAS hit was a striking, major peak on chromosome 26 ( Figures 3 C and 3D; Figures S4 C–S4G). Moreover, we noted that cortex was the only gene located in the top-associated region identified in the genomic comparisons of multiple forms ( Figure 3 D; Data S1 ). The gene is known to control wing and body color patterns in silkworms, Batesian mimicry polymorphism in Papilio clytia , Müllerian mimicry in Heliconius butterflies, industrial melanism in British peppered moths, and seasonal wing coloration in Junonia coenia ( Ito et al., 2016 41. Ito, K. ∙ Katsuma, S. ∙ Kuwazaki, S. ... Mapping and recombination analysis of two moth colour mutations, Black moth and Wild wing spot, in the silkworm Bombyx mori Heredity. 2016; 116 :52-59 Crossref Scopus (9) PubMed Google Scholar ; Nadeau et al., 2016 78. Nadeau, N.J. ∙ Pardo-Diaz, C. ∙ Whibley, A. ... The gene cortex controls mimicry and crypsis in butterflies and moths Nature. 2016; 534 :106-110 Crossref Scopus (125) PubMed Google Scholar ; Van’t Hof et al., 2016 115. Van't Hof, A.E. ∙ Campagne, P. ∙ Rigden, D.J. ... The industrial melanism mutation in British peppered moths is a transposable element Nature. 2016; 534 :102-105 Crossref Scopus (131) PubMed Google Scholar ; van der Burg et al., 2020 112. van der Burg, K.R.L. ∙ Lewis, J.J. ∙ Brack, B.J. ... Genomic architecture of a genetically assimilated seasonal color pattern Science. 2020; 370 :721-725 Crossref Scopus (14) PubMed Google Scholar ; VanKuren et al., 2019 114. VanKuren, N.W. ∙ Massardo, D. ∙ Nallu, S. ... Butterfly mimicry polymorphisms highlight phylogenetic limits of gene reuse in the evolution of diverse adaptations Mol. Biol. Evol. 2019; 36 :2842-2853 Crossref Scopus (16) PubMed Google Scholar ). Therefore, cortex is particularly important for lepidopteran wing morphogenesis, and variants of this gene have repeatedly experienced natural selection. Notably, these associated hits all presented strong but different patterns of linkage disequilibrium (LD) within the cortex region ( Figure 4 A); thus, we hypothesized that multiple mechanisms may independently lead to the reduction or suppression of recombination among different cortex haplotypes. To test this hypothesis, we performed de novo genome assembly for four K. i. chinensis samples and obtained four individual genomes containing five complete cortex haplotypes ( Figure 4 B; Table S1 ). Indeed, we identified two chromosomal inversions spanning haplotypes V and R with distinct lengths and boundaries, corresponding to different patterns of associated hits ( Figure 4 B; Figure S5 A). Given that the cortex genes of two other nymphalid genera, Heliconius and Junonia , have a conserved distal transcription start site (TSS) specific to wing development ( Hanly et al., 2022 34. Hanly, J.J. ∙ Livraghi, L. ∙ Heryanto, C. ... A large deletion at the cortex locus eliminates butterfly wing patterning G3(Bethesda). 2022; 12 jkac021 Google Scholar ; Nadeau et al., 2016 78. Nadeau, N.J. ∙ Pardo-Diaz, C. ∙ Whibley, A. ... The gene cortex controls mimicry and crypsis in butterflies and moths Nature. 2016; 534 :106-110 Crossref Scopus (125) PubMed Google Scholar ; van der Burg et al., 2020 112. van der Burg, K.R.L. ∙ Lewis, J.J. ∙ Brack, B.J. ... Genomic architecture of a genetically assimilated seasonal color pattern Science. 2020; 370 :721-725 Crossref Scopus (14) PubMed Google Scholar ), we also annotated the distal TSS and additional exons based on available RNA-seq data and sequence homology in genomic DNA for haplotypes V and P ( Figure 4 B). The inversion observed in V contained only cortex and its predicted proximal promoter and exon regions based on RNA-seq data, but the predicted distal promoter region based on homology was excluded and showed the opposite orientation, whereas the inversion found in R contained both cortex and multiple flanking genes, such as two trehalase genes ( Treh-1a and Treh-1b ) ( Data S1 ). Since Treh-1a is required for the development of the red autumn morph of Junonia coenia ( van der Burg et al., 2020 112. van der Burg, K.R.L. ∙ Lewis, J.J. ∙ Brack, B.J. ... Genomic architecture of a genetically assimilated seasonal color pattern Science. 2020; 370 :721-725 Crossref Scopus (14) PubMed Google Scholar ), these trehalase genes might also be involved in the expression of phenotype R . Moreover, a phylogenetic analysis of the five haplotypes resulted in separate clusters of V and R grouped with M and S , respectively, suggesting the involvement of independent chromosomal rearrangement across the cortex region ( Figures S5 B and S5C). We also addressed the reduced linkage in S using high-throughput chromosome conformation capture (Hi-C) based on one individual with an SS genotype, which revealed that the cortex region was a putative topologically associating domain (TAD) including only the cortex gene ( Figure 4 C; Figure S5 E; Data S1 ). A related observation was that this putative TAD was not detected in the Hi-C data generated using several samples including P , S , and R haplotypes. Moreover, we demonstrated that the cortex gene in M had a pronounced signature of positive selection (branch-site model, p < 0.01) in the form of a nonsynonymous substitution (K96H) (empirical Bayes analysis, p > 95%) ( Figures S5 B–S5D). To further investigate the reduced recombination between cortex haplotypes, we calculated the proportion of transposable elements (TEs) among the five haplotypes and observed that more long interspersed nuclear elements (LINEs) and long terminal repeat (LTR) elements accumulated in the four derived haplotypes than in the original haplotype P ( Figure S5 F). The accumulation of LINEs and LTR elements mainly accounted for the differences in the proportion of TEs observed between cortex haplotypes. In particular, more LINEs accumulated near the breakpoint regions of the inversions in V (21.99%) and R (21.47%) than in the homologous regions in P (12.62% and 15.4%), indicating that TEs may contribute to the reduction in recombination between cortex haplotypes. We also performed functional validation of cortex using CRISPR-Cas9-mediated genome editing. Loss of cortex function in mosaic knockouts (mKOs) led to the disruption of leaf wing phenotypes ( Figures 4 D, S5 G, and S5H). Scale pigmentation on the dorsal and ventral wings of cortex mKOs was faded around the lateral vein region, and the pattern elements mimicking the leaf midrib vein were blurred and darkened, which was consistent with the effects of cortex mKO observed in multiple Heliconius species, Danaus plexippus , and Junonia coenia ( Livraghi et al., 2021 66. Livraghi, L. ∙ Hanly, J.J. ∙ Van Bellghem, S.M. ... Cortex cis-regulatory switches establish scale colour identity and pattern diversity in Heliconius eLife. 2021; 10 :e68549 Crossref Scopus (12) PubMed Google Scholar ; van der Burg, 2020 112. van der Burg, K.R.L. ∙ Lewis, J.J. ∙ Brack, B.J. ... Genomic architecture of a genetically assimilated seasonal color pattern Science. 2020; 370 :721-725 Crossref Scopus (14) PubMed Google Scholar ) and suggested a conserved function of cortex in regulating butterfly scale cell development. In sum, our results provide clear evidence that the cortex gene plays a key role in controlling leaf mimicry, which is shaped by natural selection, and both structural and nonstructural genetic mechanisms have contributed to maintaining leaf wing polymorphism.
To investigate the development of leaf wing patterns in K. i. chinensis , we explored the expression of cortex via quantitative reverse transcription PCR (qRT-PCR) and evaluated transcriptome-wide gene expression via RNA-seq in veined ( VP ) and plain ( PP ) forms during a series of wing developmental stages ( Figures 5 A–5C; Table S1 ; Data S1 ). In both forms, cortex was expressed at low levels based on bulk RNA-seq data. However, we did identify a number of known Hox and wing patterning genes that were differentially expressed in our samples. Notably, ultrabithorax , which is important for determining hindwing identity in many species of Lepidoptera ( Matsuoka and Monteiro, 2021 72. Matsuoka, Y. ∙ Monteiro, A. Hox genes are essential for the development of eyespots in Bicyclus anynana butterflies Genetics. 2021; 217 :1-9 Crossref PubMed Google Scholar ; Tendolka et al., 2021 107. Tendolkar, A. ∙ Pomerantz, A.F. ∙ Heryanto, C. ... Ultrabithorax is a micromanager of hindwing identity in butterflies and moths Front. Ecol. Evol. 2021; 9 :161 Crossref Scopus (3) Google Scholar ), was also upregulated in the hindwings of K. i. chinensis ( Figure 5 B). Subsequently, we examined the expression of cortex in qRT-PCR comparisons, which showed similar and variable expression in plain and veined individuals in the fifth-instar larval stage and the prepupal stage, likely owing to its much lower expression level than the reference gene ef1α ( Figure 5 C). However, we observed significant upregulation and wing-biased expression of cortex in veined individuals relative to plain individuals 1 day after pupation, followed by a decreased but still significantly high expression level 3 days after pupation ( Figure 5 C). In addition, the in situ hybridization of cortex in fifth-instar larval-stage wings showed spatial correspondence to the margin region of the adult wing in the plain ( PP ) form ( Figure S6 A). Our results demonstrate the spatiotemporal regulation of cortex expression across developmental stages, tissues, and forms.
According to the observed expression profiles of cortex , we characterized the differentially expressed genes between body and wing tissues, forewings and hindwings, and veined and plain forms in focal developmental stages, which showed different expression patterns between body and wing tissues and generally upregulated expression patterns in hindwings relative to forewings ( Figure 5 B; Data S1 ). Notably, the comparison of veined ( VP ) and plain ( PP ) hindwing discs on days 1 and 3 after pupation identified a significantly upregulated gene, snake ( Figure 5 B; Data S1 ). Since snake is involved in swallowtail butterfly pupal and wing pigmentation ( Nishikawa et al., 2013 81. Nishikawa, H. ∙ Iga, M. ∙ Yamaguchi, J. ... Molecular basis of wing coloration in a Batesian mimic butterfly, Papilio polytes Sci. Rep. 2013; 3 :3184 Crossref Scopus (33) PubMed Google Scholar ; Yoda et al., 2020 127. Yoda, S. ∙ Otaguro, E. ∙ Nobuta, M. ... Molecular mechanisms underlying pupal protective color switch in Papilio polytes butterflies Front. Ecol. Evol. 2020; 8 :1-14 Crossref Scopus (4) Google Scholar ) and shows expression patterns correlated with those of cortex , we consider it a putative downstream target in the leaf wing developmental pathway. We also examined the expression of genes adjacent to cortex and identified multiple genes that were upregulated in pupal wings relative to the abdomen, such as B9d1 , PRG4 , DPH7 , His3.3A , and parn ( Data S1 ). Many of these genes were involved in the long inversion region of R , suggesting their potential roles in forming the rippled pattern. Moreover, we noted that another wing pattern gene, WntA , ( Martin et al., 2012 71. Martin, A. ∙ Papa, R. ∙ Nadeau, N.J. ... Diversification of complex butterfly wing patterns by repeated regulatory evolution of a Wnt ligand Proc. Natl. Acad. Sci. USA. 2012; 109 :12632-12637 Crossref Scopus (162) PubMed Google Scholar ; Mazo-Vargas et al., 2017 73. Mazo-Vargas, A. ∙ Concha, C. ∙ Livraghi, L. ... Macroevolutionary shifts of WntA function potentiate butterfly wing-pattern diversity Proc. Natl. Acad. Sci. USA. 2017; 114 :10701-10706 Crossref Scopus (85) PubMed Google Scholar ) was upregulated 1 day after pupation and showed similar patterns of expression in veined ( VP ) and plain ( PP ) forms, suggesting that it may play a conserved role in wing development of different forms ( Figures 5 D and 5E; Data S1 ).
Leaf wing polymorphism originated prior to diversification of the genus Kallima and has been maintained throughout its evolutionary history ( Figures 6 A–6C). Based on the dominance and recessiveness as well as the divergence times of different haplotypes ( Figures 3 A, 3B, and 6 A–6C), haplotypes M and S were likely derived from the original, recessive haplotype P , whereas independent chromosomal inversions led to haplotypes V and R . Therefore, we hypothesized that the frequencies of the polymorphic forms, such as trans-specific polymorphisms, which are maintained much longer than other mimicry polymorphisms, have been stabilized by long-term balancing selection ( Joron and Mallet, 1998 45. Joron, M. ∙ Mallet, J.L. Diversity in mimicry: paradox or paradigm? Trends Ecol. Evol. 1998; 13 :461-466 Full Text Full Text (PDF) Scopus (262) PubMed Google Scholar ; Mallet and Joron, 1999 70. Mallet, J. ∙ Joron, M. Evolution of diversity in warning color and mimicry: polymorphisms, shifting balance, and speciation Annu. Rev. Ecol. Syst. 1999; 30 :201-233 Crossref Scopus (0) Google Scholar ). Nevertheless, the theoretical explanation for this hypothesis may be similar to the explanation for polymorphism in Batesian mimicry, in that imperfect leaf mimicry may be improved by suppressing the recombination of different leaf mimetic haplotypes ( Booker et al., 2015 11. Booker, T. ∙ Ness, R.W. ∙ Charlesworth, D. Molecular evolution: breakthroughs and mysteries in Batesian mimicry Curr. Biol. 2015; 25 :R506-R508 Full Text Full Text (PDF) PubMed Google Scholar ; Charlesworth and Charlesworth, 1975 15. Charlesworth, D. ∙ Charlesworth, B. Theoretical genetics of Batesian mimicry II. Evolution of supergenes J. Theor. Biol. 1975; 55 :305-324 Crossref Scopus (86) PubMed Google Scholar ). We examined the nucleotide variation in cortex and neighboring genes by comparing different haplotypes using Hudson-Kreitman-Aguadé (HKA) tests ( Hudson et al., 1987 40. Hudson, R.R. ∙ Kreitman, M. ∙ Aguadé, M. A test of neutral molecular evolution based on nucleotide data Genetics. 1987; 116 :153-159 Crossref PubMed Google Scholar ), which consistently revealed a significant excess of nucleotide polymorphism in cortex relative to neighboring genes in comparisons among M , P , S , and V . This excess polymorphism suggests the effect of balancing selection on cortex , which may be an important driving force for maintaining leaf wing polymorphism in Kallima butterflies ( Table S4 ). One exception was the increased polymorphism of both cortex and parn in comparison with R , revealing strong LD and genetic hitchhiking due to the long span of the chromosomal inversion found in R ( Figure 4 B; Table S4 ). We also observed varying intron lengths in cortex relative to the stable intron lengths observed in neighboring genes, indicating the existence of intron variants in cortex and a possible role of alternative splicing or expression regulation in promoting leaf wing polymorphism ( Figure S6 B).
To further dissect the type of balancing selection affecting Kallima , we counted phenotype and genotype frequencies and selection coefficients in a local population of K. i. chinensis and observed a large proportion of P , V , and S haplotypes and a small proportion of recently differentiated R and M haplotypes in this population ( Figure S6 C; Data S2 ). In addition, the inferred cortex sequence network had five distinct clades, supporting the stabilization of polymorphism after early origination ( Figure S6 D). Since R and M only existed in heterozygotes in both field samples and butterflies obtained from lab crosses ( Figure 3 B; Figure S6 C), we hypothesized that homozygote disadvantage limited R and M to low frequencies with respect to the major role of frequency-dependent selection in maintaining leaf wing polymorphism, similar to a recently reported scenario of inversion polymorphism and mutation load in Heliconius numata ( Jay et al., 2021 42. Jay, P. ∙ Chouteau, M. ∙ Whibley, A. ... Mutation load at a mimicry supergene sheds new light on the evolution of inversion polymorphisms Nat. Genet. 2021; 53 :288-293 Crossref Scopus (32) PubMed Google Scholar ). We further explored the driving forces of leaf wing polymorphism by simulating evolutionary scenarios with different population genetic parameters, and a model that showed a good fit to the observed data was an outbred population subject to negative frequency-dependent selection with different fitness levels assigned to different forms ( Figure S6 E; Data S2 ). These results point to an important role of long-term balancing selection in maintaining Kallima leaf wing polymorphism, with both negative frequency-dependent selection and homozygote disadvantage acting on different haplotypes.

Section: Discussion

Since the discovery of homeobox genes ( Laughon and Scott, 1984 56. Laughon, A. ∙ Scott, M.P. Sequence of a Drosophila segmentation gene: protein structure homology with DNA-binding proteins Nature. 1984; 310 :25-31 Crossref PubMed Google Scholar ; McGinnis et al., 1984 74. McGinnis, W. ∙ Garber, R.L. ∙ Wirz, J. ... A homologous protein-coding sequence in Drosophila homeotic genes and its conservation in other metazoans Cell. 1984; 37 :403-408 Abstract Full Text (PDF) Scopus (548) PubMed Google Scholar ; Scott and Weiner, 1984 99. Scott, M.P. ∙ Weiner, A.J. Structural relationships among genes that control development: sequence homology between the Antennapedia, Ultrabithorax, and fushi tarazu loci of Drosophila Proc. Natl. Acad. Sci. USA. 1984; 81 :4115-4119 Crossref PubMed Google Scholar ), the roles of genes in the evolution of morphological diversity have been investigated in multiple systems with the aim of interpreting and synthesizing developmental constraints and evolvability ( Carroll, 2008 14. Carroll, S.B. Evo-devo and an expanding evolutionary synthesis: a genetic theory of morphological evolution Cell. 2008; 134 :25-36 Full Text Full Text (PDF) Scopus (1273) PubMed Google Scholar ; Gilbert et al., 1996 29. Gilbert, S.F. ∙ Opitz, J.M. ∙ Raff, R.A. Resynthesizing evolutionary and developmental biology Dev. Biol. 1996; 173 :357-372 Crossref Scopus (472) PubMed Google Scholar ; Hoekstra and Coyne, 2007 38. Hoekstra, H.E. ∙ Coyne, J.A. The locus of evolution: evo devo and the genetics of adaptation Evolution. 2007; 61 :995-1016 Crossref Scopus (692) PubMed Google Scholar ). Notably, multiple studies on color patterns have made great strides in revealing the underlying genetics of phenotypic diversity, such as inversion polymorphisms of the P locus controlling mimicry wing patterns in Heliconius numata ( Joron et al., 2011 44. Joron, M. ∙ Frezal, L. ∙ Jones, R.T. ... Chromosomal rearrangements maintain a polymorphic supergene controlling butterfly mimicry Nature. 2011; 477 :203-206 Crossref Scopus (351) PubMed Google Scholar ), the agouti-related peptide 2 gene involved in switching stripe patterns in African cichlid fishes ( Kratochwil et al., 2018 51. Kratochwil, C.F. ∙ Liang, Y. ∙ Gerwin, J. ... Agouti-related peptide 2 facilitates convergent evolution of stripe patterns across cichlid fish radiations Science. 2018; 362 :457-460 Crossref Scopus (77) PubMed Google Scholar ), and the transcription factor-encoding Pannier gene, leading to melanic pattern polymorphisms in the harlequin ladybird ( Ando et al., 2018 3. Ando, T. ∙ Matsuda, T. ∙ Goto, K. ... Repeated inversions within a pannier intron drive diversification of intraspecific colour patterns of ladybird beetles Nat. Commun. 2018; 9 :3843 Crossref Scopus (33) PubMed Google Scholar ; Gautier et al., 2018 28. Gautier, M. ∙ Yamaguchi, J. ∙ Foucaud, J. ... The genomic basis of color pattern polymorphism in the harlequin ladybird Curr. Biol. 2018; 28 :3296-3302.e7 Full Text Full Text (PDF) Scopus (0) PubMed Google Scholar ). In the present study, we used diverse leaf wing butterflies as a system to address long-standing questions concerning the evolution and maintenance of complex, mimetic wing patterning and polymorphisms. By characterizing the evolution and underlying genetic basis of leaf resemblance in Kallima butterflies, we determined that the evolution of leaf wing polymorphism was a gradual process in which toolkit genes were involved in producing these diverse wing patterns. In particular, cortex plays a complex role in controlling leaf mimicry diversity. There is clear evidence of phenotypic diversity driven by natural selection acting on chromosomal inversions and dimensional chromatin interactions at the DNA level. In addition, there are differences in the spatiotemporal regulation of gene expression at the RNA level. These findings demonstrate that the wing pattern gene cortex has been repeatedly employed in generating adaptive wing patterns in Lepidoptera and, thus, further illustrate the genetic basis and evolvability of wing development under the highly conserved nymphalid ground plan ( Jiggins et al., 2017 43. Jiggins, C.D. ∙ Wallbank, R.W. ∙ Hanly, J.J. Waiting in the wings: what can we learn about gene co-option from the diversification of butterfly wing patterns? Philos. Trans. R. Soc. Lond. B Biol. Sci. 2017; 372 :20150485 Crossref Scopus (32) PubMed Google Scholar ; Oliver et al., 2012 82. Oliver, J.C. ∙ Tong, X.L. ∙ Gall, L.F. ... A single origin for nymphalid butterfly eyespots followed by widespread loss of associated gene expression PLoS Genet. 2012; 8 :e1002893 Crossref Scopus (63) PubMed Google Scholar ; Van Belleghem et al., 2017 111. Van Belleghem, S.M. ∙ Rastas, P. ∙ Papanicolaou, A. ... Complex modular architecture around a simple toolkit of wing pattern genes Nat. Ecol. Evol. 2017; 1 :52 Crossref Scopus (116) PubMed Google Scholar ).
In addition to resynthesizing developmental constraints and evolvability in butterfly wings, the trans-specific leaf wing polymorphism provides extraordinary evidence of plant resemblance phenotypes subject to long-term balancing selection, whereas most other mimetic butterflies exhibit intraspecific balanced polymorphism causing them to resemble toxic species, such as the rich local polymorphism observed in Müllerian mimetic Heliconius numata ( Jay et al., 2021 42. Jay, P. ∙ Chouteau, M. ∙ Whibley, A. ... Mutation load at a mimicry supergene sheds new light on the evolution of inversion polymorphisms Nat. Genet. 2021; 53 :288-293 Crossref Scopus (32) PubMed Google Scholar ; Joron et al., 2011 44. Joron, M. ∙ Frezal, L. ∙ Jones, R.T. ... Chromosomal rearrangements maintain a polymorphic supergene controlling butterfly mimicry Nature. 2011; 477 :203-206 Crossref Scopus (351) PubMed Google Scholar ) and Batesian mimetic Elymnias hypermnestra ( Ruttenberg et al., 2021 98. Ruttenberg, D.M. ∙ VanKuren, N.W. ∙ Nallu, S. ... The evolution and genetics of sexually dimorphic ‘dual’ mimicry in the butterfly Elymnias hypermnestra Proc. Biol. Sci. 2021; 288 :20202192 PubMed Google Scholar ). In contrast to leaf masquerade species, which, in the case of Kallima , have resembled leaves for millions of years aided by balanced polymorphism, Müllerian and Batesian mimetic butterflies rapidly evolve different wing patterns. For example, the butterflies of the Batesian mimetic Papilio polytes species group share an ancestral polymorphism, but two of the three species in the species group have secondarily lost this polymorphism ( Zhang et al., 2017 131. Zhang, W. ∙ Westerman, E. ∙ Nitzany, E. ... Tracing the origin and evolution of supergene mimicry in butterflies Nat. Commun. 2017; 8 :1269 Crossref Scopus (26) PubMed Google Scholar ). Owing to the generally transient nature of balancing selection caused by the creation of genetic load, the majority of available relevant evidence comes from intraspecific studies ( Hedrick, 2007 37. Hedrick, P.W. Balancing selection Curr. Biol. 2007; 17 :R230-R231 Full Text Full Text (PDF) Scopus (37) PubMed Google Scholar ). Balanced polymorphism shared by multiple species is relatively unusual but has been documented in genes associated with host-pathogen interactions, vertebrate major histocompatibility complex (MHC) genes, and genes involved in the responses to biotic and abiotic stresses in Arabidopsis thaliana and related species, among others ( Fijarczyk and Babik, 2015 27. Fijarczyk, A. ∙ Babik, W. Detecting balancing selection in genomes: limits and prospects Mol. Ecol. 2015; 24 :3529-3545 Crossref Scopus (105) PubMed Google Scholar ; Wu et al., 2017 124. Wu, Q. ∙ Han, T.S. ∙ Chen, X. ... Long-term balancing selection contributes to adaptation in Arabidopsis and its relatives Genome Biol. 2017; 18 :217 Crossref Scopus (22) PubMed Google Scholar ); this phenomenon is difficult to resolve without clear functional information. Thus, functional evidence of long-term balanced wing polymorphism in Kallima butterflies provides rare insight into the nature of selection maintaining polymorphisms, shedding light on these forces driving evolutionary innovation and genetic diversity.
Furthermore, we explored how species and genetic diversity has been shaped by climate change and the Earth’s history at macro and micro scales. Our findings indicate the eastern Himalayan region where the rapid uplift of the QTP occurred ( Coleman and Hodges, 1995 18. Coleman, M. ∙ Hodges, K. Evidence for Tibetan Plateau uplift before 14 Myr ago from a new minimum age for east–west extension Nature. 1995; 374 :49-52 Crossref Scopus (553) Google Scholar ; Royden et al., 2008 97. Royden, L.H. ∙ Burchfiel, B.C. ∙ van der Hilst, R.D. The geological evolution of the Tibetan Plateau Science. 2008; 321 :1054-1058 Crossref Scopus (1192) PubMed Google Scholar ) as a center of Kallima butterfly diversification. We integrated microevolutionary and macroevolutionary approaches with evidence from genomic, demographic, and biogeographic analyses to trace the origin and evolution of Kallima butterflies. Diversification coincided with the uplift period of the QTP during the late Miocene and early Pliocene ( Figures 6 A and 6B; Li and Fang, 1999 63. Li, J.J. ∙ Fang, X.M. Uplift of the Tibetan Plateau and environmental changes Chin. Sci. Bull. 1999; 44 :2117-2124 Crossref Scopus (372) Google Scholar ; Royden et al., 2008 97. Royden, L.H. ∙ Burchfiel, B.C. ∙ van der Hilst, R.D. The geological evolution of the Tibetan Plateau Science. 2008; 321 :1054-1058 Crossref Scopus (1192) PubMed Google Scholar ; Zheng et al., 2000 132. Zheng, H.B. ∙ Powell, C.M. ∙ An, Z.S. ... Pliocene uplift of the northern Tibetan Plateau Geology. 2000; 28 :715-718 Crossref Scopus (389) Google Scholar ). The orogeny of the plateau formed a dramatic elevational gradient and diversified habitats for butterflies in southeastern Tibet and northwestern Yunnan ( Favre et al., 2015 26. Favre, A. ∙ Päckert, M. ∙ Pauls, S.U. ... The role of the uplift of the Qinghai-Tibetan Plateau for the evolution of Tibetan biotas Biol. Rev. Camb. Philos. Soc. 2015; 90 :236-253 Crossref Scopus (422) PubMed Google Scholar ), creating opportunities for isolation, habitat specialization, and divergence. Today, this region supports a diverse and highly endemic fauna, which allowed us to identify several Kallima species in southeastern Tibet and detect directional gene flow from this region. However, some rare Kallima species with limited geographic ranges remain unsampled; therefore, although this study offers insight into the conserved gene regulatory networks and spectacular phenotypic diversity of Kallima butterflies, many questions about the evolution of these astounding, leaf-mimicking butterflies remain to be answered more than 150 years after they were first observed by Alfred Russel Wallace.
Due to low frequencies of K. i. chinensis with rare leaf wing forms in nature, we did not rear and collect sufficient individuals, which prevented us from delving into the detailed functional basis of all leaf-wing patterns, especially the potential functional elements in multiple cortex haplotypes and their regulatory features. Additionally, given the limited genomic DNA quality of specimens from K. alicia , K. incognita , K. paralekta , and K. limborgii , we did not perform de novo assembly of cortex haplotypes from these species. We were also unable to sample K. albofasciata , K. horsfieldii , or K. spiridiva . Therefore, additional Kallima specimens will be needed in follow-up studies to adequately address the above issues.

Section: STAR★Methods

REAGENT or RESOURCE SOURCE IDENTIFIER Antibodies Anti-digoxigenin alkaline phosphatase, Fab fragments Roche Applied Science 11093274910, RRID: AB_2734716 Biological samples Adult butterfly thoracic tissues, see Table S1 This paper N/A Pupal butterfly wing disc tissues, see Table S1 This paper N/A Pupal butterfly body tissues, See Table S1 This paper N/A Larval butterfly wing disc tissues This paper N/A Chemicals, peptides, and recombinant proteins RNA later ™ Stabilization Solution Thermo Fisher Scientific AM7020 TRIzol™ Reagent Invitrogen 15596026 EnGen® Spy Cas9 NLS New England Biolabs M0646M Digoxigenin-11-UTP Roche Applied Science 11209256910 BM Purple AP Substrate Roche Applied Science 11442074001 Critical commercial assays KAPA Hyper Prep Kit Roche Applied Science KK8504 Ligation Sequencing Kit Oxford Nanopore Technologies SQK-LSK109 KAPA RNA Hyper Library Preparation Kit Roche Applied Science KK8560 TURBO DNA-free™ Kit Invitrogen AM1907 HiScript cDNA Synthesis Kit Vazyme Biotech R211-01 TB Green Premix Ex Taq ™ II (Tli RNaseH Plus) Takara Bio RR820Q RiboMAX™ Large Scale RNA Production Systems-SP6 and T7 Promega P1280, P1300 MAXIscript T7 kit Life Technology AM1314 TransDirect® Animal Tissue PCR Kit Trans AD201-01 HiPure Insect DNA Kit Magen D3129-03 Deposited data Illumina paired-end raw reads This paper; NCBI Sequence Archive (SRA) PRJNA698415 Illumina paired-end raw reads This paper; NCBI Sequence Archive (SRA) PRJNA698433 Illumina paired-end raw reads This paper; NCBI Sequence Archive (SRA) PRJNA533504 de novo genome assemblies This paper; Dryad data https://doi.org/10.5061/dryad.3xsj3txhj Experimental models: Organisms/strains Kallima inachus (lab reared) Leshan Shawan Xiong’s Butterfly Garden N/A Oligonucleotides Forward primer for cortex : AGTGGGGAGAGGGTCGTAG This paper N/A Reverse primer for cortex : CCTCGTCCAAGTAAACGGGAA This paper N/A Forward primer for ef1α : GCTGAGCGTGAACGTGGTAT This paper N/A Reverse primer for ef1α : GACGATGAGCACGGCGCAAT This paper N/A Forward primer for the sgRNA target region: CTATTTGGCATAAGCAGGT This paper N/A Reverse primer for the sgRNA target region: GATTCTAGTTGTCTCACTCCA This paper N/A Recombinant DNA pEASY ®-T1 Cloning Vector TransGen Biotech CT101-01 T-Vector pMD19 Takara 3271 Software and algorithms Trimmomatic v0.38 Bolger et al., 2014 10. Bolger, A.M. ∙ Lohse, M. ∙ Usadel, B. Trimmomatic: a flexible trimmer for Illumina sequence data Bioinformatics. 2014; 30 :2114-2120 Crossref Scopus (25831) PubMed Google Scholar http://www.usadellab.org/cms/?page=trimmomatic Bowtie2-2.3.4.3 Langmead and Salzberg, 2012 55. Langmead, B. ∙ Salzberg, S.L. Fast gapped-read alignment with Bowtie 2 Nat. Methods. 2012; 9 :357-359 Crossref Scopus (24558) PubMed Google Scholar http://bowtie-bio.sourceforge.net/bowtie2/index.shtml SAMtools v1.9 Li et al., 2009 62. Li, H. ∙ Handsaker, B. ∙ Wysoker, A. ..., 1000 Genome Project Data Processing Subgroup The sequence alignment/map format and SAMtools Bioinformatics. 2009; 25 :2078-2079 Crossref Scopus (30053) PubMed Google Scholar http://www.htslib.org/ Picard v1.96 Broad Institute http://broadinstitute.github.io/picard/ GATK v3.7 McKenna et al., 2010 75. McKenna, A. ∙ Hanna, M. ∙ Banks, E. ... The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data Genome Res. 2010; 20 :1297-1303 Crossref Scopus (14106) PubMed Google Scholar https://gatk.broadinstitute.org RaxML Stamatakis, 2006 102. Stamatakis, A. RAxML-VI-HPC: maximum likelihood-based phylogenetic analyses with thousands of taxa and mixed models Bioinformatics. 2006; 22 :2688-2690 Crossref Scopus (12950) PubMed Google Scholar https://cme.h-its.org/exelixis/web/software/raxml/index.html iTOL Letunic and Bork, 2011 58. Letunic, I. ∙ Bork, P. Interactive Tree of Life v2: online annotation and display of phylogenetic trees made easy Nucleic Acids Res. 2011; 39 :W475-W478 Crossref Scopus (1106) PubMed Google Scholar https://itol.embl.de/ VCFtools Danecek et al., 2011 19. Danecek, P. ∙ Auton, A. ∙ Abecasis, G. ... The variant call format and VCFtools Bioinformatics. 2011; 27 :2156-2158 Crossref Scopus (6166) PubMed Google Scholar https://vcftools.github.io/index.html LASTZ 1.04.03 Harris, 2007 35. Harris, R.S. Improved pairwise alignment of genomic DNA. Ph.D. Thesis The Pennsylvania State University, 2007 Google Scholar http://www.bx.psu.edu/miller_lab/ Multiz v11.2 Blanchette et al., 2004 9. Blanchette, M. ∙ Kent, W.J. ∙ Riemer, C. ... Aligning multiple genomic sequences with the threaded blockset aligner Genome Res. 2004; 14 :708-715 Crossref Scopus (982) PubMed Google Scholar http://www.bx.psu.edu/miller_lab/ PhyTime Guindon, 2010 33. Guindon, S. Bayesian estimation of divergence times from large sequence alignments Mol. Biol. Evol. 2010; 27 :1768-1781 Crossref Scopus (0) PubMed Google Scholar https://www.stat.auckland.ac.nz/∼guindon/phytime/ TCS Networks in PopART Clement et al., 2000 17. Clement, M. ∙ Posada, D. ∙ Crandall, K.A. TCS: a computer program to estimate gene genealogies Mol. Ecol. 2000; 9 :1657-1659 Crossref PubMed Google Scholar ; Leigh and Bryant, 2015 57. Leigh, J.W. ∙ Bryant, D. POPART: full-feature software for haplotype network construction Methods Ecol. Evol. 2015; 6 :1110-1116 Crossref Scopus (2760) Google Scholar http://popart.otago.ac.nz/ PLINK v1.90b6.7 Purcell et al., 2007 89. Purcell, S. ∙ Neale, B. ∙ Todd-Brown, K. ... PLINK: a tool set for whole-genome association and population-based linkage analyses Am. J. Hum. Genet. 2007; 81 :559-575 Full Text Full Text (PDF) Scopus (18978) PubMed Google Scholar http://zzz.bwh.harvard.edu/plink/ ADMIXTURE Alexander et al., 2009 1. Alexander, D.H. ∙ Novembre, J. ∙ Lange, K. Fast model-based estimation of ancestry in unrelated individuals Genome Res. 2009; 19 :1655-1664 Crossref Scopus (3770) PubMed Google Scholar http://dalexander.github.io/admixture/index.html Haploview v4.2 Barrett et al., 2005 4. Barrett, J.C. ∙ Fry, B. ∙ Maller, J. ... Haploview: analysis and visualization of LD and haplotype maps Bioinformatics. 2005; 21 :263-265 Crossref Scopus (11886) PubMed Google Scholar https://www.broadinstitute.org/haploview/haploview Ldheatmap Shin et al., 2006 100. Shin, J. ∙ Blay, S. ∙ Graham, J. ... LDheatmap: an R function for graphical display of pairwise linkage disequilibria between single nucleotide polymorphisms J. Stat. Softw. 2006; 16 :1-10 Crossref Google Scholar https://sfustatgen.github.io/LDheatmap/index.html IGV v2.5.2 Robinson et al., 2011 96. Robinson, J.T. ∙ Thorvaldsdóttir, H. ∙ Winckler, W. ... Integrative genomics viewer Nat. Biotechnol. 2011; 29 :24-26 Crossref Scopus (7238) PubMed Google Scholar https://software.broadinstitute.org/software/igv/ GARD on the Datamonkey webserver Pond et al., 2006 50. Kosakovsky Pond, S.L.K. ∙ Posada, D. ∙ Gravenor, M.B. ... Automated phylogenetic detection of recombination using a genetic algorithm Mol. Biol. Evol. 2006; 23 :1891-1901 Crossref Scopus (686) PubMed Google Scholar ; Weaver et al., 2018 121. Weaver, S. ∙ Shank, S.D. ∙ Spielman, S.J. ... DataMonkey 2.0: a modern web application for characterizing selective and other evolutionary processes Mol. Biol. Evol. 2018; 35 :773-777 Crossref Scopus (333) PubMed Google Scholar http://www.datamonkey.org/GARD/ PAML Zhang et al., 2005 128. Zhang, J. ∙ Nielsen, R. ∙ Yang, Z. Evaluation of an improved branch-site likelihood method for detecting positive selection at the molecular level Mol. Biol. Evol. 2005; 22 :2472-2479 Crossref Scopus (1287) PubMed Google Scholar http://abacus.gene.ucl.ac.uk/software/paml.html SVMorph Teng et al., 2021 108. Teng, D.Q. ∙ Li, F.Y. ∙ Zhang, W. Using comprehensive machine-learning models to classify complex morphological characters Ecol. Evol. 2021; 11 :10421-10431 Crossref Scopus (1) PubMed Google Scholar https://github.com/TDQ233/SVMorph PSMC Li and Durbin, 2011 61. Li, H. ∙ Durbin, R. Inference of human population history from individual whole-genome sequences Nature. 2011; 475 :493-496 Crossref Scopus (1181) PubMed Google Scholar https://github.com/lh3/psmc SMC++ Terhorst et al., 2017 109. Terhorst, J. ∙ Kamm, J.A. ∙ Song, Y.S. Robust and scalable inference of population history from hundreds of unphased whole genomes Nat. Genet. 2017; 49 :303-309 Crossref Scopus (256) PubMed Google Scholar https://github.com/popgenmethods/smcpp G-PhoCS Gronau et al., 2011 32. Gronau, I. ∙ Hubisz, M.J. ∙ Gulko, B. ... Bayesian inference of ancient human demography from individual genome sequences Nat. Genet. 2011; 43 :1031-1034 Crossref Scopus (367) PubMed Google Scholar http://compgen.cshl.edu/GPhoCS/ Treemix Pickrell and Pritchard, 2012 86. Pickrell, J.K. ∙ Pritchard, J.K. Inference of population splits and mixtures from genome-wide allele frequency data PLOS Genet. 2012; 8 :e1002967 Crossref Scopus (1184) PubMed Google Scholar https://bitbucket.org/nygcresearch/treemix/wiki/Home Maxent Phillips et al., 2006 84. Phillips, S.J. ∙ Anderson, R.P. ∙ Schapire, R.E. Maximum entropy modeling of species geographic distributions Ecol. Modell. 2006; 190 :231-259 Crossref Scopus (111) Google Scholar http://biodiversityinformatics.amnh.org/open_source/maxent/ SDMtoolbox v2.4 Brown et al., 2017 12. Brown, J.L. ∙ Bennett, J.R. ∙ French, C.M. SDMtoolbox 2.0: the next generation Python-based GIS toolkit for landscape genetic, biogeographic and species distribution model analyses PeerJ. 2017; 5 :e4095 Crossref Scopus (250) PubMed Google Scholar http://www.sdmtoolbox.org/ ArcMap 10.7 Esri https://desktop.arcgis.com/en/arcmap/ Nanofit v2.3.0 De Coster et al., 2018 21. De Coster, W. ∙ D'Hert, S. ∙ Schultz, D.T. ... NanoPack: visualizing and processing long-read sequencing data Bioinformatics. 2018; 34 :2666-2669 Crossref Scopus (661) PubMed Google Scholar https://github.com/wdecoster/nanofilt NextDenovo v2.2-beta.0 Nextomics https://github.com/Nextomics/NextDenovo NextPolish v1.1.0 Hu et al., 2020 39. Hu, J. ∙ Fan, J.P. ∙ Sun, Z.Y. ... NextPolish: a fast and efficient genome polishing tool for long-read assembly Bioinformatics. 2020; 36 :2253-2255 Crossref Scopus (148) PubMed Google Scholar https://github.com/Nextomics/NextPolish Geneious v9.1.4 Kearse et al., 2012 47. Kearse, M. ∙ Moir, R. ∙ Wilson, A. ... Geneious Basic: an integrated and extendable desktop software platform for the organization and analysis of sequence data Bioinformatics. 2012; 28 :1647-1649 Crossref Scopus (12028) PubMed Google Scholar https://www.geneious.com/ progressiveMauve Darling et al., 2010 20. Darling, A.E. ∙ Mau, B. ∙ Perna, N.T. progressiveMauve: multiple genome alignment with gene gain, loss and rearrangement PLoS One. 2010; 5 :e11147 Crossref Scopus (2579) PubMed Google Scholar http://darlinglab.org/mauve/user-guide/progressivemauve.html BWA Li and Durbin, 2009 60. Li, H. ∙ Durbin, R. Fast and accurate short read alignment with Burrows-Wheeler transform Bioinformatics. 2009; 25 :1754-1760 Crossref Scopus (25404) PubMed Google Scholar http://bio-bwa.sourceforge.net/ Juicer Durand et al., 2016b 25. Durand, N.C. ∙ Shamim, M.S. ∙ Machol, I. ... Juicer provides a one-click system for analyzing loop-resolution Hi-C experiments Cell Syst. 2016; 3 :95-98 Full Text Full Text (PDF) PubMed Google Scholar https://github.com/aidenlab Juicebox Durand et al., 2016a 24. Durand, N.C. ∙ Robinson, J.T. ∙ Shamim, M.S. ... Juicebox provides a visualization system for Hi-C contact maps with unlimited zoom Cell Syst. 2016; 3 :99-101 Full Text Full Text (PDF) PubMed Google Scholar https://github.com/aidenlab HiCExplorer Wolff et al., 2020 122. Wolff, J. ∙ Rabbani, L. ∙ Gilsbach, R. ... Galaxy HiCExplorer 3: a web server for reproducible Hi-C, capture Hi-C and single-cell Hi-C data analysis, quality control and visualization Nucleic Acids Res. 2020; 48 :W177-W184 Crossref PubMed Google Scholar https://github.com/deeptools/HiCExplorer TADtool Kruse et al., 2016 52. Kruse, K. ∙ Hug, C.B. ∙ Hernández-Rodríguez, B. ... TADtool: visual parameter identification for TAD-calling algorithms Bioinformatics. 2016; 32 :3190-3192 Crossref Scopus (35) PubMed Google Scholar https://github.com/vaquerizaslab BLASTX NCBI https://blast.ncbi.nlm.nih.gov/Blast.cgi sgRNAcas9 v3.0 Xie et al., 2014 125. Xie, S. ∙ Shen, B. ∙ Zhang, C. ... sgRNAcas9: a software package for designing CRISPR sgRNA and evaluating potential off-target cleavage sites PLoS One. 2014; 9 :e100448 Crossref Scopus (242) PubMed Google Scholar https://sourceforge.net/projects/sgrnacas9/ STAR v2.7.1a Dobin et al., 2013 22. Dobin, A. ∙ Davis, C.A. ∙ Schlesinger, F. ... STAR: ultrafast universal RNA-seq aligner Bioinformatics. 2013; 29 :15-21 Crossref Scopus (17570) PubMed Google Scholar https://github.com/alexdobin/STAR RSEM v1.3.1 Li and Dewey, 2011 59. Li, B. ∙ Dewey, C.N. RSEM: accurate transcript quantification from RNA-seq data with or without a reference genome BMC Bioinform. 2011; 12 :323 Crossref Scopus (10030) PubMed Google Scholar https://deweylab.github.io/RSEM DESeq2 Love et al., 2014 68. Love, M.I. ∙ Huber, W. ∙ Anders, S. Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2 Genome Biol. 2014; 15 :550 Crossref Scopus (29293) PubMed Google Scholar https://bioconductor.org/packages/release/bioc/html/DESeq2.html Trinity v2.8.5 Grabherr et al., 2011 31. Grabherr, M.G. ∙ Haas, B.J. ∙ Yassour, M. ... Full-length transcriptome assembly from RNA-Seq data without a reference genome Nat. Biotechnol. 2011; 29 :644-652 Crossref Scopus (12057) PubMed Google Scholar https://github.com/trinityrnaseq/trinityrnaseq RepeatModeler v1.0.11 Robert Hubley & Arian Smit http://www.repeatmasker.org/RepeatModeler/ RepeatMasker v4.1.1 Smit, AFA, Hubley, R & Green, P. http://repeatmasker.org/ Custom codes This paper https://github.com/TDQ233/Kallima-inachus ; https://github.com/wstree/kallima-project Other Nikon SMZ18 stereomicroscope Nikon N/A HP LaserJet Pro M227fdw scanner HP N/A Nikon DS-Ri2 digital camera Nikon N/A Canon 70D digital camera Canon N/A Illumina HiSeq Xten platform Illunima N/A Nanopore promethION platform Oxford Nanopore Technologies N/A Roche LightCycler 96 detection system Roche Applied Science N/A Open table in a new tab
Further information and requests for resources and reagents should be directed to and will be fulfilled by the lead contact, Wei Zhang ( weizhangvv@pku.edu.cn ).
All materials generated in this study are available from the lead contact upon request.
Livestock to start colonies of lab-reared K. inachus butterflies was supplied by Leshan Shawan Xiong’s Butterfly Garden (Leshan, China), which has a breeding license. Colonies were maintained at 26–28°C under approximately 70% relative humidity and a 14:10 light:dark cycle. Adults were fed fruit juice or a mixture of honey and alcohol. Larvae of K. inachus were raised on the host plant Strobilanthes cusia (Acanthaceae). Female and male individuals were selected to mate at a ratio of 1:1 with access to sufficient food and host plants for oviposition. Butterfly samples were collected in the field with the permission and assistance of Medog Forestry Bureau (China), Medog National Natural Reserve (China), Ya’an Forestry Bureau (China), Fengtongzhai National Natural Reserve (China), Wuzhishan National Natural Reserve (China), and Ruili Forestry Bureau (China) or supplied by Leshan Shawan Xiong’s Butterfly Garden (Leshan, China), Changde Xiaoyejia Arts & Crafts Co. Ltd. (Changde, China), Wuhan Diezhongdie Creative Culture Co. Ltd. (Wuhan, China), and Shanghai Qiuyu Biotechnology Co. Ltd. (Shanghai, China) with breeding, collecting or import licenses.
For Illumina sequencing, genomic DNA from adult butterfly thoracic tissues was isolated using a phenol–chloroform DNA extraction protocol. Illumina paired-end libraries were constructed using the KAPA Hyper Prep Kit and sequenced on the Illumina HiSeq Xten platform at Novogene. Raw reads were demultiplexed using sample-specific barcodes. For Nanopore sequencing, genomic DNA was isolated from adult butterfly thoracic tissues from individuals representing the veined , scrambled , rippled , and moldy wing forms. The long-read Nanopore sequencing library was prepared using a SQK-LSK109 Ligation Sequencing Kit and sequenced on the Nanopore promethION platform at GrandOmics. For Hi-C sequencing, genomic DNA was isolated from adult butterfly thoracic tissue from a homozygous scrambled individual. Library preparation was performed principally following previously described methodologies ( Belton et al., 2012 7. Belton, J.M. ∙ McCord, R.P. ∙ Gibcus, J.H. ... Hi-C: a comprehensive technique to capture the conformation of genomes Methods. 2012; 58 :268-276 Crossref Scopus (464) PubMed Google Scholar ; Lieberman-Aiden et al., 2009 65. Lieberman-Aiden, E. ∙ van Berkum, N.L. ∙ Williams, L. ... Comprehensive mapping of long-range interactions reveals folding principles of the human genome Science. 2009; 326 :289-293 Crossref Scopus (4672) PubMed Google Scholar ; Ma et al., 2015 69. Ma, W. ∙ Ay, F. ∙ Lee, C. ... Fine-scale chromatin interaction maps reveal the cis-regulatory landscape of human lincRNA genes Nat. Methods. 2015; 12 :71-78 Crossref PubMed Google Scholar ; Nagano et al., 2015 79. Nagano, T. ∙ Lubling, Y. ∙ Yaffe, E. ... Single-cell Hi-C for genome-wide detection of chromatin interactions that occur simultaneously in a single cell Nat. Protoc. 2015; 10 :1986-2003 Crossref Scopus (99) PubMed Google Scholar ), and the library was sequenced on the Illumina HiSeq Xten platform at Novogene. Additional Hi-C data from several different individuals were downloaded from the NCBI Short-Read Archive (SRA) database (accession number PRJNA533504). For RNA-seq and RT–qPCR sampling, individuals with different wing forms were collected in the late fifth-instar larval stage, the prepupal stage, 24 h after pupation, and 72 h after pupation. For each developmental stage, we collected four individuals with the PP genotype and four individuals with the VP genotype. Wing discs were dissected in PBS and stored in RNA later ™ Stabilization Solution at -80°C. RNA was extracted using TRIzol™ Reagent, and the Illumina paired-end libraries were constructed using the KAPA RNA Hyper Library Preparation Kit and sequenced on the Illumina HiSeq Xten platform at Novogene.
Low-quality Illumina sequencing data were filtered from raw reads using Trimmomatic v0.38 ( Bolger et al., 2014 10. Bolger, A.M. ∙ Lohse, M. ∙ Usadel, B. Trimmomatic: a flexible trimmer for Illumina sequence data Bioinformatics. 2014; 30 :2114-2120 Crossref Scopus (25831) PubMed Google Scholar ), and the filtered reads were mapped to the reference genome of K. inachus ( Yang et al., 2020 126. Yang, J. ∙ Wan, W. ∙ Xie, M. ... Chromosome-level reference genome assembly and gene editing of the dead-leaf butterfly Kallima inachus Mol. Ecol. Resour. 2020; 20 :1080-1092 Crossref Scopus (12) PubMed Google Scholar ) using Bowtie2-2.3.4.3 ( Langmead and Salzberg, 2012 55. Langmead, B. ∙ Salzberg, S.L. Fast gapped-read alignment with Bowtie 2 Nat. Methods. 2012; 9 :357-359 Crossref Scopus (24558) PubMed Google Scholar ) with the parameter--very-sensitive-local. The aligned results were converted from SAM format to BAM format using SAMtools v1.9 ( Li et al., 2009 62. Li, H. ∙ Handsaker, B. ∙ Wysoker, A. ..., 1000 Genome Project Data Processing Subgroup The sequence alignment/map format and SAMtools Bioinformatics. 2009; 25 :2078-2079 Crossref Scopus (30053) PubMed Google Scholar ), and were reordered, sorted, and duplicate marked using Picard-tools v1.96 ( http://broadinstitute.github.io/picard/ ). RealignerTargetCreator and IndelRealigner ( McKenna et al., 2010 75. McKenna, A. ∙ Hanna, M. ∙ Banks, E. ... The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data Genome Res. 2010; 20 :1297-1303 Crossref Scopus (14106) PubMed Google Scholar ) in GATK 3.7 were used to realign indels, and UnifiedGenotyper6 ( McKenna et al., 2010 75. McKenna, A. ∙ Hanna, M. ∙ Banks, E. ... The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data Genome Res. 2010; 20 :1297-1303 Crossref Scopus (14106) PubMed Google Scholar ) in GATK3.7 was used to call SNPs according to the following parameters: heterozygosity 0.05, stand_call_conf 50.0, stand_emit_conf 10.0, and dcov 250. We filtered the sites for downstream analyses according to the parameters maf 0.05 and Qual 50 or Qual 30 using VCFtools v0.1.17 ( Danecek et al., 2011 19. Danecek, P. ∙ Auton, A. ∙ Abecasis, G. ... The variant call format and VCFtools Bioinformatics. 2011; 27 :2156-2158 Crossref Scopus (6166) PubMed Google Scholar ).
We constructed maximum-likelihood phylogenetic trees using RAxML ( Stamatakis, 2006 102. Stamatakis, A. RAxML-VI-HPC: maximum likelihood-based phylogenetic analyses with thousands of taxa and mixed models Bioinformatics. 2006; 22 :2688-2690 Crossref Scopus (12950) PubMed Google Scholar ) with the GTRGAMMA model and 100 bootstrap replicates based on genome-wide SNPs, coding sequence (CDS) regions, de novo -assembled cortex haplotypes, and phased cortex CDS regions. For the tree of CDS regions, concatenated CDSs of each individual were generated and extracted using FastaAlternateReferenceMaker ( McKenna et al., 2010 75. McKenna, A. ∙ Hanna, M. ∙ Banks, E. ... The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data Genome Res. 2010; 20 :1297-1303 Crossref Scopus (14106) PubMed Google Scholar ) in GATK 3.7. For the tree of cortex haplotypes, the outgroup cortex haplotype of Junonia coenia was extracted from the reference genome of J. coenia v1.0 ( van der Burg et al., 2019 113. van der Burg, K.R.L. ∙ Lewis, J.J. ∙ Martin, A. ... Contrasting roles of transcription factors spineless and EcR in the highly dynamic chromatin landscape of butterfly wing metamorphosis Cell Rep. 2019; 27 :1027-1038.e3 Full Text Full Text (PDF) Scopus (0) PubMed Google Scholar ), and all the cortex haplotypes were aligned using LASTZ 1.04.03 ( Harris, 2007 35. Harris, R.S. Improved pairwise alignment of genomic DNA. Ph.D. Thesis The Pennsylvania State University, 2007 Google Scholar ) with the plain haplotype as a reference according to the parameter --format=maf –chain. Subsequently, pairwise alignments were merged into a multiple sequence alignment using the roast script of Multiz v11.2 ( Blanchette et al., 2004 9. Blanchette, M. ∙ Kent, W.J. ∙ Riemer, C. ... Aligning multiple genomic sequences with the threaded blockset aligner Genome Res. 2004; 14 :708-715 Crossref Scopus (982) PubMed Google Scholar ) with a guided topology ((( M , P ), ( S , ( R , V ))), Jco ). The multiple sequence alignment was transformed into FASTA format using the maf2fasta script of Multiz v11.2 ( Blanchette et al., 2004 9. Blanchette, M. ∙ Kent, W.J. ∙ Riemer, C. ... Aligning multiple genomic sequences with the threaded blockset aligner Genome Res. 2004; 14 :708-715 Crossref Scopus (982) PubMed Google Scholar ). The cortex haplotype alignment was divided into partitioned sequence alignments in a 50-kb sliding window, and the 50 kb alignment that included the cortex gene and displayed strong linkage disequilibrium was used to construct the tree of cortex haplotypes. We also estimated the divergence times of the genome-wide and cortex haplotype-based phylogenies using PhyTime ( Guindon, 2010 33. Guindon, S. Bayesian estimation of divergence times from large sequence alignments Mol. Biol. Evol. 2010; 27 :1768-1781 Crossref Scopus (0) PubMed Google Scholar ), with the nodes calibrated according to the divergence times between Kallima and Junonia (between 31.0033 and 44.768 Mya), Kallimoides and Junonia (between 27.8345 and 40.7399 Mya), and Historis and Kallima (between 37.827 and 54.7998 Mya) ( Chazot et al., 2019 16. Chazot, N. ∙ Wahlberg, N. ∙ Freitas, A.V.L. ... Priors and posteriors in Bayesian timing of divergence analyses: the age of butterflies revisited Syst. Biol. 2019; 68 :797-813 Crossref Scopus (53) PubMed Google Scholar ). The PhyTime results were further processed using TreeAnnotator ( Drummond et al., 2012 23. Drummond, A.J. ∙ Suchard, M.A. ∙ Xie, D. ... Bayesian phylogenetics with BEAUti and the BEAST 1.7 Mol. Biol. Evol. 2012; 29 :1969-1973 Crossref Scopus (7625) PubMed Google Scholar ). All tree images were generated using iTOL ( Letunic and Bork, 2011 58. Letunic, I. ∙ Bork, P. Interactive Tree of Life v2: online annotation and display of phylogenetic trees made easy Nucleic Acids Res. 2011; 39 :W475-W478 Crossref Scopus (1106) PubMed Google Scholar ). We also double-checked phased sequences by PCR using the genotyping primers (see below in the CRISPR/Cas9-mediated genome editing section) and constructed the cortex haplotype network using the TCS method implemented in PopART ( Clement et al., 2000 17. Clement, M. ∙ Posada, D. ∙ Crandall, K.A. TCS: a computer program to estimate gene genealogies Mol. Ecol. 2000; 9 :1657-1659 Crossref PubMed Google Scholar ; Leigh and Bryant, 2015 57. Leigh, J.W. ∙ Bryant, D. POPART: full-feature software for haplotype network construction Methods Ecol. Evol. 2015; 6 :1110-1116 Crossref Scopus (2760) Google Scholar ).
We converted VCF files to BED files using VCFtools v0.1.17 ( Danecek et al., 2011 19. Danecek, P. ∙ Auton, A. ∙ Abecasis, G. ... The variant call format and VCFtools Bioinformatics. 2011; 27 :2156-2158 Crossref Scopus (6166) PubMed Google Scholar ) and PLINK v1.90b6.7 ( Purcell et al., 2007 89. Purcell, S. ∙ Neale, B. ∙ Todd-Brown, K. ... PLINK: a tool set for whole-genome association and population-based linkage analyses Am. J. Hum. Genet. 2007; 81 :559-575 Full Text Full Text (PDF) Scopus (18978) PubMed Google Scholar ), and filtered the data according to the parameters geno 0.20 and maf 0.05 in PLINK v1.90b6.7 ( Purcell et al., 2007 89. Purcell, S. ∙ Neale, B. ∙ Todd-Brown, K. ... PLINK: a tool set for whole-genome association and population-based linkage analyses Am. J. Hum. Genet. 2007; 81 :559-575 Full Text Full Text (PDF) Scopus (18978) PubMed Google Scholar ). Principal component analysis (PCA) was performed using PLINK v1.90b6.7 ( Purcell et al., 2007 89. Purcell, S. ∙ Neale, B. ∙ Todd-Brown, K. ... PLINK: a tool set for whole-genome association and population-based linkage analyses Am. J. Hum. Genet. 2007; 81 :559-575 Full Text Full Text (PDF) Scopus (18978) PubMed Google Scholar ). Proportions of individual ancestry were inferred using ADMIXTURE ( Alexander et al., 2009 1. Alexander, D.H. ∙ Novembre, J. ∙ Lange, K. Fast model-based estimation of ancestry in unrelated individuals Genome Res. 2009; 19 :1655-1664 Crossref Scopus (3770) PubMed Google Scholar ) by defining genetic clusters from K = 2 to K = 10.
The genome-wide patterns of genetic differentiation ( F ST values) and nucleotide diversity (π values) were calculated using VCFtools v0.1.17 ( Danecek et al., 2011 19. Danecek, P. ∙ Auton, A. ∙ Abecasis, G. ... The variant call format and VCFtools Bioinformatics. 2011; 27 :2156-2158 Crossref Scopus (6166) PubMed Google Scholar ) with a block size of 50 kb, and the standard error was calculated using a jackknife approach. For local regions, a block size of 500 bp was used, and the standard error was calculated using a moving block bootstrap approach ( Zhang et al., 2016 130. Zhang, W. ∙ Dasmahapatra, K.K. ∙ Mallet, J. ... Genome-wide introgression among distantly related Heliconius butterfly species Genome Biol. 2016; 17 :25 Crossref Scopus (74) PubMed Google Scholar ). Pairwise linkage disequilibrium (LD) was estimated by calculating the square of the correlation coefficient (r 2 ) using VCFtools v0.1.17 ( Danecek et al., 2011 19. Danecek, P. ∙ Auton, A. ∙ Abecasis, G. ... The variant call format and VCFtools Bioinformatics. 2011; 27 :2156-2158 Crossref Scopus (6166) PubMed Google Scholar ) according to the parameter --plink --thin 200. LD heatmaps were calculated using Haploview v4.2 ( Barrett et al., 2005 4. Barrett, J.C. ∙ Fry, B. ∙ Maller, J. ... Haploview: analysis and visualization of LD and haplotype maps Bioinformatics. 2005; 21 :263-265 Crossref Scopus (11886) PubMed Google Scholar ) according to the parameter minMAF 0.10 and were visualized using LDheatmap ( Shin et al., 2006 100. Shin, J. ∙ Blay, S. ∙ Graham, J. ... LDheatmap: an R function for graphical display of pairwise linkage disequilibria between single nucleotide polymorphisms J. Stat. Softw. 2006; 16 :1-10 Crossref Google Scholar ). Prior to the detection of positive selection, we extracted cortex CDS regions by visualizing BAM files in IGV v2.5.2 ( Robinson et al., 2011 96. Robinson, J.T. ∙ Thorvaldsdóttir, H. ∙ Winckler, W. ... Integrative genomics viewer Nat. Biotechnol. 2011; 29 :24-26 Crossref Scopus (7238) PubMed Google Scholar ), and the raw reads involving cortex CDS regions were extracted and employed to manually assemble the complete CDS using Geneious v9.1.4 ( Kearse et al., 2012 47. Kearse, M. ∙ Moir, R. ∙ Wilson, A. ... Geneious Basic: an integrated and extendable desktop software platform for the organization and analysis of sequence data Bioinformatics. 2012; 28 :1647-1649 Crossref Scopus (12028) PubMed Google Scholar ). Subsequently, we detected recombination blocks in the cortex CDS alignment using GARD ( Pond et al., 2006 50. Kosakovsky Pond, S.L.K. ∙ Posada, D. ∙ Gravenor, M.B. ... Automated phylogenetic detection of recombination using a genetic algorithm Mol. Biol. Evol. 2006; 23 :1891-1901 Crossref Scopus (686) PubMed Google Scholar ) on the Datamonkey webserver ( Weaver et al., 2018 121. Weaver, S. ∙ Shank, S.D. ∙ Spielman, S.J. ... DataMonkey 2.0: a modern web application for characterizing selective and other evolutionary processes Mol. Biol. Evol. 2018; 35 :773-777 Crossref Scopus (333) PubMed Google Scholar ), which yielded three putative recombination blocks. Positive selection signals in specific lineages were detected with partitioned sequence alignments using the branch-site model implemented in the CodeML program within PAML ( Zhang et al., 2005 128. Zhang, J. ∙ Nielsen, R. ∙ Yang, Z. Evaluation of an improved branch-site likelihood method for detecting positive selection at the molecular level Mol. Biol. Evol. 2005; 22 :2472-2479 Crossref Scopus (1287) PubMed Google Scholar ). We performed HKA tests ( Hudson et al., 1987 40. Hudson, R.R. ∙ Kreitman, M. ∙ Aguadé, M. A test of neutral molecular evolution based on nucleotide data Genetics. 1987; 116 :153-159 Crossref PubMed Google Scholar ) to compare the level of cortex polymorphism to the polymorphism of neighboring genes using sequence data extracted from the reference genome of Vanessa tameamea v1.0 (GenBank: PEHJ00000000.1) for the calculation of interspecific divergence. Genome-wide association studies were performed for individuals presenting different forms. The different forms were identified and classified using SVMorph ( Teng et al., 2021 108. Teng, D.Q. ∙ Li, F.Y. ∙ Zhang, W. Using comprehensive machine-learning models to classify complex morphological characters Ecol. Evol. 2021; 11 :10421-10431 Crossref Scopus (1) PubMed Google Scholar ). The VCF file was first compressed using VCFtools v0.1.17 ( Danecek et al., 2011 19. Danecek, P. ∙ Auton, A. ∙ Abecasis, G. ... The variant call format and VCFtools Bioinformatics. 2011; 27 :2156-2158 Crossref Scopus (6166) PubMed Google Scholar ) according to the parameter --thin 200, and genome-wide association analysis was then performed using PLINK v1.90b6.7 ( Purcell et al., 2007 89. Purcell, S. ∙ Neale, B. ∙ Todd-Brown, K. ... PLINK: a tool set for whole-genome association and population-based linkage analyses Am. J. Hum. Genet. 2007; 81 :559-575 Full Text Full Text (PDF) Scopus (18978) PubMed Google Scholar ) according to the following parameters: --assoc fisher --allow-no-sex --adjust --allow-extra-chr. The false-discovery rate corrected P values were calculated using PLINK v1.90b6.7 ( Purcell et al., 2007 89. Purcell, S. ∙ Neale, B. ∙ Todd-Brown, K. ... PLINK: a tool set for whole-genome association and population-based linkage analyses Am. J. Hum. Genet. 2007; 81 :559-575 Full Text Full Text (PDF) Scopus (18978) PubMed Google Scholar ). Genome-wide F ST values were also calculated between individuals with different forms in a block size of 50 kb using VCFtools v0.1.17 ( Danecek et al., 2011 19. Danecek, P. ∙ Auton, A. ∙ Abecasis, G. ... The variant call format and VCFtools Bioinformatics. 2011; 27 :2156-2158 Crossref Scopus (6166) PubMed Google Scholar ), and the F ST values were standardized into Z scores.
We used the pairwise sequentially Markovian coalescent (PSMC) model ( Li and Durbin, 2011 61. Li, H. ∙ Durbin, R. Inference of human population history from individual whole-genome sequences Nature. 2011; 475 :493-496 Crossref Scopus (1181) PubMed Google Scholar ) and SMC++ ( Terhorst et al., 2017 109. Terhorst, J. ∙ Kamm, J.A. ∙ Song, Y.S. Robust and scalable inference of population history from hundreds of unphased whole genomes Nat. Genet. 2017; 49 :303-309 Crossref Scopus (256) PubMed Google Scholar ) to infer historical effective population sizes. For PSMC analyses, we generated the diploid consensus sequence of each sample using SAMtools ( Li et al., 2009 62. Li, H. ∙ Handsaker, B. ∙ Wysoker, A. ..., 1000 Genome Project Data Processing Subgroup The sequence alignment/map format and SAMtools Bioinformatics. 2009; 25 :2078-2079 Crossref Scopus (30053) PubMed Google Scholar ) and masked bases with a depth lower than a third of the average depth or greater than twice the average depth. The parameters were set as follows: -N25 -t15 -r5 -p "4+25 ∗ 2+4+6". For SMC++ analyses, we employed population data to infer effective population sizes in recent years and applied “-c 100000” to mask the uncalled region. For all the PSMC and SMC++ analyses, we assumed an average mutation rate of μ = 3 × 10 -9 ( Keightley et al., 2015 48. Keightley, P.D. ∙ Pinharanda, A. ∙ Ness, R.W. ... Estimation of the spontaneous mutation rate in Heliconius melpomene Mol. Biol. Evol. 2015; 32 :239-243 Crossref Scopus (116) PubMed Google Scholar ) and an average generation time of g = 0.5 years ( Yang et al., 2020 126. Yang, J. ∙ Wan, W. ∙ Xie, M. ... Chromosome-level reference genome assembly and gene editing of the dead-leaf butterfly Kallima inachus Mol. Ecol. Resour. 2020; 20 :1080-1092 Crossref Scopus (12) PubMed Google Scholar ).
Demographic parameters, such as population sizes, divergence times, and migration rates, were inferred using the Generalized Phylogenetic Coalescent Sampler (G-PhoCS ver1.2.3) software ( Gronau et al., 2011 32. Gronau, I. ∙ Hubisz, M.J. ∙ Gulko, B. ... Bayesian inference of ancient human demography from individual genome sequences Nat. Genet. 2011; 43 :1031-1034 Crossref Scopus (367) PubMed Google Scholar ) with the default settings for a gamma distribution. To do so, we chose individuals of each population with good sequencing coverage and performed filtering steps for the reference genome according to Table S3 , which yielded 5,638 putative neutral loci in total. Considering the genetic distance in the genus Kallima , we performed three analyses, focusing on populations and subspecies in K. inachus , populations and subspecies in K. alicia , and populations in K. incognita and K. paralekta . We estimated possible migration bands twice in multiple independent tests and calibrated the raw estimates by assuming an average mutation rate of μ = 3 × 10 -9 ( Keightley et al., 2015 48. Keightley, P.D. ∙ Pinharanda, A. ∙ Ness, R.W. ... Estimation of the spontaneous mutation rate in Heliconius melpomene Mol. Biol. Evol. 2015; 32 :239-243 Crossref Scopus (116) PubMed Google Scholar ) and an average generation time of g = 0.5 year ( Yang et al., 2020 126. Yang, J. ∙ Wan, W. ∙ Xie, M. ... Chromosome-level reference genome assembly and gene editing of the dead-leaf butterfly Kallima inachus Mol. Ecol. Resour. 2020; 20 :1080-1092 Crossref Scopus (12) PubMed Google Scholar ). The lower migration rates above 0.003 in two replicates were considered significant, and these significant migration bands were tested together in full-model analyses. To determine the number of MCMC iterations, we checked the convergence by visually monitoring the likelihood plots in Tracer v1.7 ( Rambaut et al., 2018 92. Rambaut, A. ∙ Drummond, A.J. ∙ Xie, D. ... Posterior summarization in Bayesian phylogenetics using Tracer 1.7 Syst. Biol. 2018; 67 :901-904 Crossref Scopus (3873) PubMed Google Scholar ) to ensure that the MCMC chains reached an equilibrium distribution. We conducted G-PhoCS analysis with 200,000 MCMC iterations. Migration events were also inferred using TreeMix ( Pickrell and Pritchard, 2012 86. Pickrell, J.K. ∙ Pritchard, J.K. Inference of population splits and mixtures from genome-wide allele frequency data PLOS Genet. 2012; 8 :e1002967 Crossref Scopus (1184) PubMed Google Scholar ) by assuming zero to eight migration edges.
We used the maximum entropy model (Maxent) ( Phillips et al., 2006 84. Phillips, S.J. ∙ Anderson, R.P. ∙ Schapire, R.E. Maximum entropy modeling of species geographic distributions Ecol. Modell. 2006; 190 :231-259 Crossref Scopus (111) Google Scholar ) to evaluate habitat suitability for Kallima butterflies. We downloaded the presence data of K. inachus from the Global Biodiversity Information Facility (GBIF) ( https://www.gbif.org/ ), to which we added our own sample data. The presence data were spatially rarified using SDMtoolbox v2.4 ( Brown et al., 2017 12. Brown, J.L. ∙ Bennett, J.R. ∙ French, C.M. SDMtoolbox 2.0: the next generation Python-based GIS toolkit for landscape genetic, biogeographic and species distribution model analyses PeerJ. 2017; 5 :e4095 Crossref Scopus (250) PubMed Google Scholar ). We downloaded 19 bioclimatic variables of the 2.5 arc-minute scale (CCSM4) from WorldClim ( http://www.worldclim.org/ ) for the projection of the LGM and mid-Holocene periods, and we downscaled the original LIG 30 arc-second data to the 2.5 arc-minute resolution scale to synchronize the resolution. Subsequently, we masked these climate layers to the area that was reasonably surveyed and removed highly correlated variables with a Pearson’s correlation coefficient greater than or equal to 0.8. Data formats were transformed using ArcMap 10.7 ( https://desktop.arcgis.com/en/arcmap ). Ten replicates with cross-validation were performed for each analysis. Vegetation maps and Maxent projection results were overlaid in ArcMap 10.7 ( http://www.bridge.bris.ac.uk/resources/Databases/BIOMES_data ; Bigelow et al., 2003 8. Bigelow, N.H. ∙ Brubaker, L.B. ∙ Edwards, M.E. ... Climate change and Arctic ecosystems: 1. Vegetation changes north of 55°N between the last glacial maximum, mid-Holocene, and present J. Geophys. Res. 2003; 108 Crossref PubMed Google Scholar ; Harrison et al., 2001 36. Harrison, S.P. ∙ Yu, G. ∙ Takahara, H. ... Palaeovegetation: diversity of temperate plants in east Asia Nature. 2001; 413 :129-130 Crossref Scopus (312) PubMed Google Scholar ; Olson et al., 2001 83. Olson, D.M. ∙ Dinerstein, E. ∙ Wikramanayake, E.D. ... Terrestrial ecoregions of the worlds: a new map of life on Earth BioScience. 2001; 51 :933-938 Crossref Google Scholar ; Pickett et al., 2004 85. Pickett, E.J. ∙ Harrison, S.P. ∙ Hope, G. ... Pollen-based reconstructions of biome distributions for Australia, Southeast Asia and the Pacific (SEAPAC region) at 0, 6000 and 18,000 14C yr BP J. Biogeogr. 2004; 31 :1381-1444 Crossref Scopus (105) Google Scholar ; Prentice et al., 2000 87. Prentice, I.C. ∙ Jolly, D. ∙ Afanas’eva, N.B. ... Mid-Holocene and glacial-maximum vegetation geography of the northern continents and Africa J. Biogeogr. 2000; 27 :507-519 Crossref Scopus (0) Google Scholar ; Ray and Adams, 2001 94. Ray, N. ∙ Adams, J.M. A GIS-based vegetation map of the world at the Last Glacial Maximum (25,000–15,000 BP) Internet Archaeol. 2001; 11 Crossref Google Scholar ).
Low-quality Nanopore sequencing data were filtered from raw reads using Nanofit v2.3.0 ( De Coster et al., 2018 21. De Coster, W. ∙ D'Hert, S. ∙ Schultz, D.T. ... NanoPack: visualizing and processing long-read sequencing data Bioinformatics. 2018; 34 :2666-2669 Crossref Scopus (661) PubMed Google Scholar ). De novo genome assembly was performed using NextDenovo v2.2-beta.0 ( https://github.com/Nextomics/NextDenovo ), and base errors were further corrected with Illumina sequencing data using NextPolish v1.1.0 ( Hu et al., 2020 39. Hu, J. ∙ Fan, J.P. ∙ Sun, Z.Y. ... NextPolish: a fast and efficient genome polishing tool for long-read assembly Bioinformatics. 2020; 36 :2253-2255 Crossref Scopus (148) PubMed Google Scholar ). Reference-guided genome assembly of the cortex region of K. inachus was performed using Geneious v9.1.4 ( Kearse et al., 2012 47. Kearse, M. ∙ Moir, R. ∙ Wilson, A. ... Geneious Basic: an integrated and extendable desktop software platform for the organization and analysis of sequence data Bioinformatics. 2012; 28 :1647-1649 Crossref Scopus (12028) PubMed Google Scholar ) by combining the de novo -assembled plain haplotype and the reference genome of K. inachus ( Yang et al., 2020 126. Yang, J. ∙ Wan, W. ∙ Xie, M. ... Chromosome-level reference genome assembly and gene editing of the dead-leaf butterfly Kallima inachus Mol. Ecol. Resour. 2020; 20 :1080-1092 Crossref Scopus (12) PubMed Google Scholar ). To assemble the cortex haplotypes of heterozygous samples, we did not perform an Illumina polishing step for Nanopore sequencing data because it could lead to the fusion of different haplotypes and introduce more mistakes relative to the base errors occurring during Nanopore sequencing. To test the reliability of our unpolished genome assemblies, we aligned Illumina sequencing data from multiple individuals to the de novo -assembled cortex haplotypes. The results were highly consistent between the cortex haplotypes and the Illumina sequencing reads with the corresponding genotypes. In addition, we performed haplotype alignment based on two assembled scaffolds of haplotype P extracted from different individuals and observed complete collinearity and a high degree of base identity between the two scaffolds ( Figure S4 G), suggesting that the assembled cortex scaffolds obtained from the heterozygous individuals were reliable. Five cortex haplotypes ( plain , veined , scrambled , rippled , and moldy ) were extracted from de novo -assembled genomes and aligned to detect rearrangement breakpoints using progressiveMauve ( Darling et al., 2010 20. Darling, A.E. ∙ Mau, B. ∙ Perna, N.T. progressiveMauve: multiple genome alignment with gene gain, loss and rearrangement PLoS One. 2010; 5 :e11147 Crossref Scopus (2579) PubMed Google Scholar ) with the default parameters.
Hi-C raw reads were aligned to the reference-guided genome assembly of the scrambled haplotype using BWA ( Li and Durbin, 2009 60. Li, H. ∙ Durbin, R. Fast and accurate short read alignment with Burrows-Wheeler transform Bioinformatics. 2009; 25 :1754-1760 Crossref Scopus (25404) PubMed Google Scholar ) following the Juicer pipeline ( Durand et al., 2016b 25. Durand, N.C. ∙ Shamim, M.S. ∙ Machol, I. ... Juicer provides a one-click system for analyzing loop-resolution Hi-C experiments Cell Syst. 2016; 3 :95-98 Full Text Full Text (PDF) PubMed Google Scholar ). Normalized Hi-C contact matrices were then generated at several resolutions in .hic format, and multiple tools, such as the head algorithm ( Rao et al., 2014 93. Rao, S.S. ∙ Huntley, M.H. ∙ Durand, N.C. ... A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping Cell. 2014; 159 :1665-1680 Full Text Full Text (PDF) Scopus (3413) PubMed Google Scholar ) in Juicer software juicer_tools.1.7.6, the hicFindTADs algorithm in HiCExplorer software ( Wolff et al., 2020 122. Wolff, J. ∙ Rabbani, L. ∙ Gilsbach, R. ... Galaxy HiCExplorer 3: a web server for reproducible Hi-C, capture Hi-C and single-cell Hi-C data analysis, quality control and visualization Nucleic Acids Res. 2020; 48 :W177-W184 Crossref PubMed Google Scholar ), and TADtool ( Kruse et al., 2016 52. Kruse, K. ∙ Hug, C.B. ∙ Hernández-Rodríguez, B. ... TADtool: visual parameter identification for TAD-calling algorithms Bioinformatics. 2016; 32 :3190-3192 Crossref Scopus (35) PubMed Google Scholar ), were employed for TAD identification. We regarded TAD regions detected by all three tools as putative TADs and manually annotated these regions using BLASTX searches against NCBI’s nr protein database ( https://blast.ncbi.nlm.nih.gov/Blast.cgi ). For the Arrowhead algorithm, the following parameters were used: -k KR, -r 25000, --ignore_sparsity. For the hicFindTADs algorithm, Hi-C contact matrices were first converted into .cool format using hicConvertFormat and TADs were then called with a step size of 40,000 bp. For TADtool, Hi-C contact matrices were first converted into sparse matrix format with a resolution value of 40 kb, and the insulation score was then calculated to identify TADs. The Hi-C heatmap and putative TADs were visualized using Juicebox ( Durand et al., 2016a 24. Durand, N.C. ∙ Robinson, J.T. ∙ Shamim, M.S. ... Juicebox provides a visualization system for Hi-C contact maps with unlimited zoom Cell Syst. 2016; 3 :99-101 Full Text Full Text (PDF) PubMed Google Scholar ) and hicPlotTADs in HiCExplorer software ( Wolff et al., 2020 122. Wolff, J. ∙ Rabbani, L. ∙ Gilsbach, R. ... Galaxy HiCExplorer 3: a web server for reproducible Hi-C, capture Hi-C and single-cell Hi-C data analysis, quality control and visualization Nucleic Acids Res. 2020; 48 :W177-W184 Crossref PubMed Google Scholar ).
A transposable element library of K. inachus was constructed based on the reference genome assembly using RepeatModeler v1.0.11 ( http://www.repeatmasker.org/RepeatModeler/ ). The distribution of transposable elements among different cortex haplotypes was calculated using RepeatMasker v4.1.1 ( http://www.repeatmasker.org ) with the default parameters and the TE library generated by RepeatModeler. The promoter regions were annotated based on the published results of chromatin accessibility profiling in K. inachus ( Wan et al., 2021 119. Wan, W.T. ∙ Dong, Z.W. ∙ Ren, Y.D. ... Chromatin accessibility profiling provides insights into larval cuticle color and adult longevity in butterflies Zool. Res. 2021; 42 :614-619 Crossref PubMed Google Scholar ).
Total RNA was diluted to 200 ng/μL and treated with the TURBO DNA-free™ Kit (Invitrogen) to remove the remaining genomic DNA. cDNA was generated from total RNA using the HiScript cDNA Synthesis Kit (Vazyme). RT – qPCR was performed in a 20-μL system, with 50 ng diluted cDNA and forward and reverse primers at 0.4 μM. Primers were designed to span the cortex intron (F: AGTGGGGAGAGGGTCGTAG, R: CCTCGTCCAAGTAAACGGGAA), and the target products were smaller than 200 bp. We also analyzed the expression of the reference gene ef1α for normalization (F: GCTGAGCGTGAACGTGGTAT, R: GACGATGAGCACGGCGCAAT). The reactions were run on a Roche LightCycler 96 detection system using TB Green Premix Ex Taq II (Tli RNaseH Plus) (Takara).
We designed single-guide RNAs (sgRNAs) and evaluated their specificity using sgRNAcas9 v3.0 ( Xie et al., 2014 125. Xie, S. ∙ Shen, B. ∙ Zhang, C. ... sgRNAcas9: a software package for designing CRISPR sgRNA and evaluating potential off-target cleavage sites PLoS One. 2014; 9 :e100448 Crossref Scopus (242) PubMed Google Scholar ) to search genomic regions against the reference genome of K. inachus ( Yang et al., 2020 126. Yang, J. ∙ Wan, W. ∙ Xie, M. ... Chromosome-level reference genome assembly and gene editing of the dead-leaf butterfly Kallima inachus Mol. Ecol. Resour. 2020; 20 :1080-1092 Crossref Scopus (12) PubMed Google Scholar ) for GN 19 NGG or N 20 NGG sequences. We performed CRISPR/Cas9 mutagenesis assays following previously described methods of CRISPR/Cas9 genome editing in Lepidoptera ( Bassett et al., 2013 5. Bassett, A.R. ∙ Tibbit, C. ∙ Ponting, C.P. ... Highly efficient targeted mutagenesis of Drosophila with the CRISPR/Cas9 system Cell Rep. 2013; 4 :220-228 Full Text Full Text (PDF) Scopus (556) PubMed Google Scholar ; Li et al., 2015 64. Li, X. ∙ Fan, D. ∙ Zhang, W. ... Outbred genome sequencing and CRISPR/Cas9 gene editing in butterflies Nat. Commun. 2015; 6 :8212 Crossref Scopus (127) PubMed Google Scholar ; Zhang and Reed, 2017 129. Zhang, L. ∙ Reed, R.D. A practical guide to CRISPR/Cas9 genome editing in Lepidoptera Diversity and evolution of butterfly Wing patterns Springer, 2017; 155-172 Crossref Scopus (26) Google Scholar ). We generated sgRNAs by in vitro transcription using the MAXIscript T7 kit (Life Technology, Cat No. AM1314) or RiboMAX™ Large-Scale RNA Production Systems (SP6 and T7) (Promega, Cat No. P1280, P1300). Subsequently, we performed the microinjection of sgRNAs and EnGen® Spy Cas9 NLS (NEB, Cat No. M0646M) to collected butterfly eggs between 0.5 h and 1 h or between 1 h and 2 h after oviposition. Injected eggs were placed in transparent plastic boxes until hatching and were fed host leaves ( S. cusia ) until the third-instar stage. The injected larvae were transferred to the host plant S. cusia until emergence. The average hatching rate with the deleterious cortex KOs was 30.69%. For genotyping, we extracted genomic DNA from individual wing tissues showing mutant phenotypes using the TransDirect® Animal Tissue PCR Kit (Trans, Cat No. AD201-01) or a phenol–chloroform protocol and performed PCR using genotyping primers flanking the sgRNA target region (CT-CRISPR-F: CTATTTGGCATAAGCAGGT, CT-CRISPR-R: GATTCTAGTTGTCTCACTCCA). Mosaic mutants were identified by comparing the sizes of the obtained PCR products via standard agarose gel electrophoresis and by comparing sequences via Sanger sequencing. To identify small indels in the sgRNA target regions, PCR products were cloned into the T-Vector pMD19 (Takara, Cat No. 3271) or the pEASY vector (TransGen Biotech) and sequenced. Wing phenotypes were photographed using a scanner (HP LaserJet Pro M227fdw) or a digital camera (Canon 70D or Nikon DS-Ri2) under a microscope (Nikon SMZ18).
Low-quality Illumina reads were filtered from the raw sequence data using Trimmomatic v0.38 ( Bolger et al., 2014 10. Bolger, A.M. ∙ Lohse, M. ∙ Usadel, B. Trimmomatic: a flexible trimmer for Illumina sequence data Bioinformatics. 2014; 30 :2114-2120 Crossref Scopus (25831) PubMed Google Scholar ), and the filtered reads were mapped to the reference genome of K. inachus ( Yang et al., 2020 126. Yang, J. ∙ Wan, W. ∙ Xie, M. ... Chromosome-level reference genome assembly and gene editing of the dead-leaf butterfly Kallima inachus Mol. Ecol. Resour. 2020; 20 :1080-1092 Crossref Scopus (12) PubMed Google Scholar ) using STAR v2.7.1a ( Dobin et al., 2013 22. Dobin, A. ∙ Davis, C.A. ∙ Schlesinger, F. ... STAR: ultrafast universal RNA-seq aligner Bioinformatics. 2013; 29 :15-21 Crossref Scopus (17570) PubMed Google Scholar ). Differentially expressed genes were called using RSEM v1.3.1 ( Li and Dewey, 2011 59. Li, B. ∙ Dewey, C.N. RSEM: accurate transcript quantification from RNA-seq data with or without a reference genome BMC Bioinform. 2011; 12 :323 Crossref Scopus (10030) PubMed Google Scholar ) and DESeq2 ( Love et al., 2014 68. Love, M.I. ∙ Huber, W. ∙ Anders, S. Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2 Genome Biol. 2014; 15 :550 Crossref Scopus (29293) PubMed Google Scholar ), and the results were FDR adjusted. De novo transcriptome assembly was performed using Trinity v2.8.5 ( Grabherr et al., 2011 31. Grabherr, M.G. ∙ Haas, B.J. ∙ Yassour, M. ... Full-length transcriptome assembly from RNA-Seq data without a reference genome Nat. Biotechnol. 2011; 29 :644-652 Crossref Scopus (12057) PubMed Google Scholar ) with default parameters.
In situ hybridization (ISH) assay for cortex was performed principally following a previously described procedure with at least three biological replicates ( Martin et al., 2012 71. Martin, A. ∙ Papa, R. ∙ Nadeau, N.J. ... Diversification of complex butterfly wing patterns by repeated regulatory evolution of a Wnt ligand Proc. Natl. Acad. Sci. USA. 2012; 109 :12632-12637 Crossref Scopus (162) PubMed Google Scholar ). ISH templates were amplified by PCR using primers for cortex (CT-F: ATTTAGGTGACACTATAGAATAGCCAGCTGTGATGGATCTGT, CT-R: AATTAATACGACTCACTATAGGGAGGGTCAAACTTGCAGCACT), and a T7 or SP6 promoter sequence was attached. For sense and antisense riboprobe synthesis, in vitro transcription was performed using RiboMAX™ Large-Scale RNA Production Systems (T7 and SP6) (Promega) supplemented with Digoxigenin-11-UTP (Roche Applied Science). The sense probes were used as the negative control, which showed no effect ( Figure S6 A). Given that the fifth-instar larval stage is the developmental time point associated with the expression of genes involved in the production of complex wing patterns, such as eyespots in multiple nymphalid butterflies ( Oliver et al., 2012 82. Oliver, J.C. ∙ Tong, X.L. ∙ Gall, L.F. ... A single origin for nymphalid butterfly eyespots followed by widespread loss of associated gene expression PLoS Genet. 2012; 8 :e1002893 Crossref Scopus (63) PubMed Google Scholar ; Reed and Serfas, 2004 95. Reed, R.D. ∙ Serfas, M.S. Butterfly wing pattern evolution is associated with changes in a Notch/Distal-less temporal pattern formation process Curr. Biol. 2004; 14 :1159-1166 Full Text Full Text (PDF) Scopus (116) PubMed Google Scholar ), individuals were sampled in the fifth-instar larval stage, and their wing discs were dissected in phosphate-buffered saline (PBS). Tissues were fixed in 4% paraformaldehyde (PFA) in PBS for 30 min, washed in cold phosphate-buffered saline containing 0.01% Tween 20 (PBST), and treated with 25 μg/mL proteinase K. Wing discs were freed from their peripodial membrane and postfixed in 4% PFA for 20 min. After washing in cold PBST, wing discs were gradually transferred to standard hybridization buffer, prehybridized for 1 h at 64°C, and incubated in standard hybridization buffer containing a riboprobe at 30 ng/mL for 40 h at 64°C. For secondary detection of the riboprobe, wing discs were blocked in Tris-buffered saline containing 0.01% Tween 20 (TBST) and 1 g/L BSA and subsequently incubated with a 1:4000 dilution of anti-digoxigenin alkaline phosphatase Fab fragments (Roche) at 4°C for 3 h or overnight. Wing discs were washed once in cold BSA buffer, washed ten times in cold TBST and finally stained with BM Purple (Roche) for 4–8 h. For tissue clearing, wing discs were gradually placed in ethanol and xylene, and the redundant tissue was carefully removed. For imaging, wing discs were transferred back to PBST, mounted in PBS containing 60% glycerol, and imaged using a digital camera (Nikon DS-Ri2) under a microscope (Nikon SMZ18).
To investigate the driving forces leading to the current frequencies of cortex haplotypes, we developed a population genetics model adapted from Zhang et al. (2017) 131. Zhang, W. ∙ Westerman, E. ∙ Nitzany, E. ... Tracing the origin and evolution of supergene mimicry in butterflies Nat. Commun. 2017; 8 :1269 Crossref Scopus (26) PubMed Google Scholar and Villanea et al. (2015) 116. Villanea, F.A. ∙ Safi, K.N. ∙ Busch, J.W. A general model of negative frequency dependent selection explains global patterns of human ABO polymorphism PLoS One. 2015; 10 :e0125003 Crossref Scopus (6) PubMed Google Scholar by incorporating negative frequency-dependent selection (NFDS). In this model, the fitness ( w ) of a genotype was negatively correlated with its frequency ( f ), given the strength of NFDS denoted as z , and the additional beneficial or deleterious effects of a genotype were denoted as a . Our model also comprised a random sampling procedure to simulate the perturbation caused by genetic drift. Therefore, the fitness of each genotype could be calculated as follows: 𝑤 𝑃 ⁢ 𝑃 = 𝑎 𝑃 ⁢ 𝑃 ⁢ ( 1 − 𝑧 ⁢ 𝑓 𝑃 ⁢ 𝑃 ) (Equation 1) 𝑤 𝑆 ⁢ 𝑆 = 𝑎 𝑆 ⁢ 𝑆 ⁢ ( 1 − 𝑧 ⁢ 𝑓 𝑆 ⁢ 𝑉 − 𝑧 ⁢ 𝑓 𝑆 ⁢ 𝑃 − 𝑧 ⁢ 𝑓 𝑆 ⁢ 𝑆 ) (Equation 2) 𝑤 𝑆 ⁢ 𝑃 = 𝑎 𝑆 ⁢ 𝑃 ⁢ ( 1 − 𝑧 ⁢ 𝑓 𝑆 ⁢ 𝑉 − 𝑧 ⁢ 𝑓 𝑆 ⁢ 𝑃 − 𝑧 ⁢ 𝑓 𝑆 ⁢ 𝑆 ) (Equation 3) 𝑤 𝑆 ⁢ 𝑉 = 𝑎 𝑆 ⁢ 𝑉 ⁢ ( 1 − 𝑧 ⁢ 𝑓 𝑆 ⁢ 𝑉 − 𝑧 ⁢ 𝑓 𝑆 ⁢ 𝑃 − 𝑧 ⁢ 𝑓 𝑆 ⁢ 𝑆 ) (Equation 4) 𝑤 𝑉 ⁢ 𝑃 = 𝑎 𝑉 ⁢ 𝑃 ⁢ ( 1 − 𝑧 ⁢ 𝑓 𝑉 ⁢ 𝑉 − 𝑧 ⁢ 𝑓 𝑉 ⁢ 𝑃 ) (Equation 5) 𝑤 𝑉 ⁢ 𝑉 = 𝑎 𝑉 ⁢ 𝑉 ⁢ ( 1 − 𝑧 ⁢ 𝑓 𝑉 ⁢ 𝑉 − 𝑧 ⁢ 𝑓 𝑉 ⁢ 𝑃 ) (Equation 6) 𝑤 𝑀 ⁢ 𝑃 = 𝑎 𝑀 ⁢ 𝑃 ⁢ ( 1 − 𝑧 ⁢ 𝑓 𝑀 ⁢ 𝑃 ) (Equation 7) 𝑤 𝑀 ⁢ 𝑆 = 𝑎 𝑀 ⁢ 𝑆 ⁢ ( 1 − 𝑧 ⁢ 𝑓 𝑀 ⁢ 𝑆 ) (Equation 8) 𝑤 𝑀 ⁢ 𝑉 = 𝑎 𝑀 ⁢ 𝑉 ⁢ ( 1 − 𝑧 ⁢ 𝑓 𝑀 ⁢ 𝑉 ) (Equation 9) 𝑤 𝑀 ⁢ 𝑀 = 0 (Equation 10) 𝑤 𝑅 ⁢ 𝑃 = 𝑎 𝑅 ⁢ 𝑃 ⁢ ( 1 − 𝑧 ⁢ 𝑓 𝑅 ⁢ 𝑃 ) (Equation 11) 𝑤 𝑅 ⁢ 𝑆 = 𝑎 𝑅 ⁢ 𝑆 ⁢ ( 1 − 𝑧 ⁢ 𝑓 𝑅 ⁢ 𝑆 ) (Equation 12) 𝑤 𝑅 ⁢ 𝑉 = 𝑎 𝑅 ⁢ 𝑉 ⁢ ( 1 − 𝑧 ⁢ 𝑓 𝑅 ⁢ 𝑉 ) (Equation 13) 𝑤 𝑀 ⁢ 𝑃 = 𝑎 𝑀 ⁢ 𝑃 ⁢ ( 1 − 𝑧 ⁢ 𝑓 𝑀 ⁢ 𝑃 ) (Equation 14) 𝑤 𝑅 ⁢ 𝑅 = 0 (Equation 15) 𝑤 𝑀 ⁢ 𝑅 = 𝑎 𝑀 ⁢ 𝑅 ⁢ ( 1 − 𝑧 ⁢ 𝑓 𝑀 ⁢ 𝑅 ) (Equation 16) with P , S , V , M , and R denoting five cortex haplotypes. Given that we did not observe individuals with MM or RR genotypes and we only obtained limited individuals with the MR genotype from lab crossings, we set the fitness of MM or RR genotypes as null. We used p , s , v , m , and r to denote the initial frequencies of haplotypes P , S , V , M , and R , respectively. Therefore, the changes in the frequencies of the five haplotypes ( p ’, s ’, v ’, m ’, and r ’) and the mean fitness w mean could be calculated as follows: 𝑝 ′ = ( 𝑝 2 ⁢ 𝑤 𝑃 ⁢ 𝑃 + 𝑠 ⁢ 𝑝 ⁢ 𝑤 𝑆 ⁢ 𝑃 + 𝑣 ⁢ 𝑝 ⁢ 𝑤 𝑉 ⁢ 𝑃 + 𝑚 ⁢ 𝑝 ⁢ 𝑤 𝑀 ⁢ 𝑃 + 𝑟 ⁢ 𝑝 ⁢ 𝑤 𝑅 ⁢ 𝑃 ) 𝑤 𝑚 ⁢ 𝑒 ⁢ 𝑎 ⁢ 𝑛 (Equation 17) 𝑠 ′ = ( 𝑠 2 ⁢ 𝑤 𝑆 ⁢ 𝑆 + 𝑠 ⁢ 𝑝 ⁢ 𝑤 𝑆 ⁢ 𝑃 + 𝑠 ⁢ 𝑣 ⁢ 𝑤 𝑆 ⁢ 𝑉 + 𝑚 ⁢ 𝑠 ⁢ 𝑤 𝑀 ⁢ 𝑆 + 𝑟 ⁢ 𝑠 ⁢ 𝑤 𝑅 ⁢ 𝑆 ) 𝑤 𝑚 ⁢ 𝑒 ⁢ 𝑎 ⁢ 𝑛 (Equation 18) 𝑣 ′ = ( 𝑣 2 ⁢ 𝑤 𝑉 ⁢ 𝑉 + 𝑣 ⁢ 𝑝 ⁢ 𝑤 𝑉 ⁢ 𝑃 + 𝑠 ⁢ 𝑣 ⁢ 𝑤 𝑆 ⁢ 𝑉 + 𝑚 ⁢ 𝑣 ⁢ 𝑤 𝑀 ⁢ 𝑉 + 𝑟 ⁢ 𝑣 ⁢ 𝑤 𝑅 ⁢ 𝑉 ) 𝑤 𝑚 ⁢ 𝑒 ⁢ 𝑎 ⁢ 𝑛 (Equation 19) 𝑚 ′ = ( 𝑚 ⁢ 𝑝 ⁢ 𝑤 𝑀 ⁢ 𝑃 + 𝑚 ⁢ 𝑠 ⁢ 𝑤 𝑀 ⁢ 𝑆 + 𝑚 ⁢ 𝑣 ⁢ 𝑤 𝑀 ⁢ 𝑉 + 𝑚 ⁢ 𝑟 ⁢ 𝑤 𝑀 ⁢ 𝑅 ) 𝑤 𝑚 ⁢ 𝑒 ⁢ 𝑎 ⁢ 𝑛 (Equation 20) 𝑟 ′ = ( 𝑟 ⁢ 𝑝 ⁢ 𝑚 𝑅 ⁢ 𝑃 + 𝑟 ⁢ 𝑠 ⁢ 𝑤 𝑅 ⁢ 𝑆 + 𝑟 ⁢ 𝑣 ⁢ 𝑤 𝑅 ⁢ 𝑉 + 𝑚 ⁢ 𝑟 ⁢ 𝑤 𝑀 ⁢ 𝑅 ) 𝑤 𝑚 ⁢ 𝑒 ⁢ 𝑎 ⁢ 𝑛 (Equation 21) 𝑤 𝑚 ⁢ 𝑒 ⁢ 𝑎 ⁢ 𝑛 = ( 𝑝 2 ⁢ 𝑤 𝑃 ⁢ 𝑃 + 𝑠 2 ⁢ 𝑤 𝑆 ⁢ 𝑆 + 𝑣 2 ⁢ 𝑤 𝑉 ⁢ 𝑉 + 2 ⁢ 𝑠 ⁢ 𝑝 ⁢ 𝑤 𝑆 ⁢ 𝑃 + 2 ⁢ 𝑣 ⁢ 𝑝 ⁢ 𝑤 𝑉 ⁢ 𝑃 + 2 ⁢ 𝑚 ⁢ 𝑝 ⁢ 𝑤 𝑀 ⁢ 𝑃 + 2 ⁢ 𝑟 ⁢ 𝑝 ⁢ 𝑤 𝑅 ⁢ 𝑃 + 2 ⁢ 𝑠 ⁢ 𝑣 ⁢ 𝑤 𝑆 ⁢ 𝑉 + 2 ⁢ 𝑚 ⁢ 𝑠 ⁢ 𝑤 𝑀 ⁢ 𝑆 + 2 ⁢ 𝑟 ⁢ 𝑠 ⁢ 𝑤 𝑅 ⁢ 𝑆 + 2 ⁢ 𝑚 ⁢ 𝑣 ⁢ 𝑤 𝑀 ⁢ 𝑉 + 2 ⁢ 𝑟 ⁢ 𝑣 ⁢ 𝑤 𝑅 ⁢ 𝑉 + 2 ⁢ 𝑚 ⁢ 𝑟 ⁢ 𝑤 𝑀 ⁢ 𝑅 ) (Equation 22)
We first performed preliminary tests including only two original haplotypes, P and S , to repeat the modeling procedure presented by Zhang et al. (2017) 131. Zhang, W. ∙ Westerman, E. ∙ Nitzany, E. ... Tracing the origin and evolution of supergene mimicry in butterflies Nat. Commun. 2017; 8 :1269 Crossref Scopus (26) PubMed Google Scholar by testing z values ranging from 0 to 0.9 to simulate scenarios from neutral drift to strong selection; Ne values ranging from 100 to 100,000 to simulate the effects of genetic drift; a values ranging from 1 to 5 to simulate different levels of advantage; and different sets of initial allele frequencies. Each test included ten separate runs. The preliminary tests indicated that the combination of z and a determined the state of equilibrium ( Data S2 ). Therefore, we chose a moderate strength of NFDS ( z = 0.2), a relatively large population size according to the estimated population size (Ne = 10,000), and a sufficient generation time to fix a derived haplotype (generations = 400) for formal tests. According to the phylogenetic results ( Figures 6 A–6C), we described four separate phases of the evolution of leaf wing polymorphism, assuming that chromosomal inversion originated later in each clade. Phase 1 included two original haplotypes, P and S , assuming S to be a derived haplotype according to dominance-recessiveness; Phase 2 involved the origin of R due to chromosomal inversion occurring in S and included P , S , and R ; Phase 3 involved the origin of M and included P , S , R , and M ; and Phase 4 involved the origin of V due to chromosomal inversion occurring in M and included P , S , R , M , and V . Each phase included multiple tests, and each test included ten separate runs in which the specified haplotypes reached equilibrium. The results of the phase-by-phase simulation showed that NFDS is the main driving force of the maintenance of the five haplotypes, in combination with the additional benefits or disadvantages of different genotypes ( Figure S6 ; Data S2 ).
We extracted genomic DNA from butterfly leg tissues using a HiPure Insect DNA Kit (D3109-02). We identified different cortex haplotypes by amplifying genomic DNA fragments using PCR and performing Sanger sequencing mainly using universal primers designed for exon 6, including CT-exon6F (AGGCT-GTTCATGGGGAAATG) and CT-exon6R (CCACGTTAGTAACATTACGACAGC). We also designed haplotype-specific primers to validate the genotyping results, including CT-V-F (TTCGCGGTATACAAGGCCAG) and CT-V-R (GCAATTCCTTTGACGAGGCG) for haplotype V , CT-E2-F (CGTAATCGTGTTGATAGATTCGTAG) and CT-E3-R (GCTGTAAGTAGG-TAAGTCTAGGA) for haplotype P , and CT-R-F (GTATGCAAGGCCAGGGTCTAA) and CT-R-R (GTATGCAAGGCCAGGGTCTAA) for haplotype R .
The statistical details and methods as well as sample sizes are indicated in the figure legends or methods. Statistical analyses were performed using R, Excel, PLINK, DEseq2, or custom codes. Data are presented as mean ± SEM and are noted in the figure legends and tables. For phylogenetic analyses, a bootstrap approach was used and bootstrap support values are noted in the figures. For population genetic analyses, standard errors were calculated using a moving block bootstrap approach or jackknife approach. A chi-squared test, Fisher's exact test, Student's t -test, or Wilcoxon rank-sum test was used to determine statistical significance, and significance is denoted as ∗ ( P < 0.05), ∗∗ ( P < 0.01), or ∗∗∗ ( P < 0.001) in the figures and tables. For the genome-wide association studies and differential expression analyses, P values were FDR adjusted using the Benjamini-Hochberg method.

Section: Acknowledgments

We thank the Medog Forestry Bureau (China), Medog National Natural Reserve (China), Ya’an Forestry Bureau (China), Fengtongzhai National Natural Reserve (China), Wuzhishan National Natural Reserve (China), Ruili Forestry Bureau (China), Qirong Chen, Jianglang Wu, Shuai Zhan, Ningning Wu, and Lixia Yu for assistance with sample collection. We thank Han Yang, Lei Cao, Jiaxin Ni, Bingyuan Zhou, Fengyuan Li, Hua Zeng, Yanchen Jiang, Xiujia Sun, Ningning Wu, Shuhui Wang, Zixuan Zhang, Tian Lu, Wei Lu, Sufan Yuan, Shuyu He, Weifan Lv, Xingwei Wang, Zi’ang Liu, and Xinlu Ren for assistance with butterfly rearing and helpful discussions. We thank Cheng Li, Yuting Liu, Chao Zhang, and Qingyi Zhou for their assistance with data analysis and helpful discussions. We thank Jinwu He, Qian Shu, and Jiaxin Ni for their help in gene editing or in situ hybridization experiments. We thank Manyuan Long, Hongya Gu, and Fuwen Wei for helpful discussions. We thank the National Center for Protein Sciences at Peking University for assistance with qRT-PCR, and the Computing Platforms of the Center for Life Sciences and the School of Life Sciences for assistance with computation. This project was supported by grants from the National Natural Science Foundation of China (32170420 and 31871271 to W.Z. and 32070482 to X.L.), the Beijing Natural Science Foundation (JQ19021 to W.Z.), the Peking-Tsinghua Center for Life Science, the State Key Laboratory of Protein and Plant Gene Research, Qidong-SLS Innovation Fund to W.Z., the Second Tibetan Plateau Scientific Expedition and Research program (2019QZKK05010603) to W.D., the Major Special Program of the Tibet Autonomous Region (XZ201701-GA-05) to W.D., the Chinese Institute for Brain Research to L.Z., US NSF grant DEB-1541557 to D.J.L., and the Strategic Priority Research Program of the Chinese Academy of Sciences (XDB42000000) to L.Z.
S.W., D.T., P.Y., Yiming Zhang, Yubo Zhang, and W.Z. carried out experiments, analyzed the data, reared butterflies, and collected samples. X.L., G.L., W. Wan, Z.D., D.J.L., D.W., Z.J., Q.W., and Linlin Zhang carried out experiments and analyzed the data. W.D., F.J., Y.W., and E.W. helped design the project and collect samples and interpreted the results. S.H. reared butterflies and collected samples. X.L. and W. Wang helped design the project, provided sequencing data, and interpreted the results. X.Z. and Li Zhang prepared samples for sequencing and interpreted the results. S.W., D.T., and P.Y. contributed to drafting the manuscript. W.Z. conceived and designed the study and wrote the manuscript with input from all coauthors. All authors proofread and approved the manuscript.
The authors declare no competing interests.

Section: Supplemental information (4)

Download all Spreadsheet (48.21 KB) Table S1. Sample information and sequencing statistics, related to Figures 1, 3, 4, and 5 PDF (347.75 KB) Document S1. Tables S2, S3, and S4 Spreadsheet (234.45 KB) Data S1. Annotation of genes and putative TADs across chromosome 26 and differentially expressed genes between wing and body tissues, forewing and hindwing tissues, VP and PP genotypes at the prepupal stage, VP and PP genotypes on day 1 after pupation, and VP and PP genotypes on day 3 after pupation, related to Figures 3, 4, and 5 Spreadsheet (336.95 KB) Data S2. Genotype frequencies and estimates of selection coefficients for the cortex haplotypes of a K. inachus population and population genetics simulations of leaf wing polymorphism, related to Figure 6
