Title: Modularity and robustness of frontal cortical networks


Abstract: Summary

Neural activity underlying short-term memory is maintained by interconnected networks of brain regions. It remains unknown how brain regions interact to maintain persistent activity while exhibiting robustness to corrupt information in parts of the network. We simultaneously measured activity in large neuronal populations across mouse frontal hemispheres to probe interactions between brain regions. Activity across hemispheres was coordinated to maintain coherent short-term memory. Across mice, we uncovered individual variability in the organization of frontal cortical networks. A modular organization was required for the robustness of persistent activity to perturbations: each hemisphere retained persistent activity during perturbations of the other hemisphere, thus preventing local perturbations from spreading. A dynamic gating mechanism allowed hemispheres to coordinate coherent information while gating out corrupt information. Our results show that robust short-term memory is mediated by redundant modular representations across brain regions. Redundant modular representations naturally emerge in neural network models that learned robust dynamics.

Section: Introduction

Persistent neural activity bridges past and future events and underlies cognitive functions such as short-term memory ( Barak et al., 2013 3. Barak, O. ∙ Sussillo, D. ∙ Romo, R. ... From fixed points to chaos: three models of delayed discrimination Prog. Neurobiol. 2013; 103 :214-222 Crossref Scopus (109) PubMed Google Scholar ; Funahashi et al., 1989 21. Funahashi, S. ∙ Bruce, C.J. ∙ Goldman-Rakic, P.S. Mnemonic coding of visual space in the monkey’s dorsolateral prefrontal cortex J. Neurophysiol. 1989; 61 :331-349 Crossref Scopus (2083) PubMed Google Scholar ; Fuster and Alexander, 1971 22. Fuster, J.M. ∙ Alexander, G.E. Neuron activity related to short-term memory Science. 1971; 173 :652-654 Crossref Scopus (1450) PubMed Google Scholar ; Romo et al., 1999 54. Romo, R. ∙ Brody, C.D. ∙ Hernández, A. ... Neuronal correlates of parametric working memory in the prefrontal cortex Nature. 1999; 399 :470-473 Crossref Scopus (641) PubMed Google Scholar ). Persistent activity is distributed across interconnected brain regions ( Chafee and Goldman-Rakic, 1998 9. Chafee, M.V. ∙ Goldman-Rakic, P.S. Matching patterns of activity in primate prefrontal area 8a and parietal area 7ip neurons during a spatial working memory task J. Neurophysiol. 1998; 79 :2919-2940 Crossref Scopus (541) PubMed Google Scholar ; Hernández et al., 2010 29. Hernández, A. ∙ Nácher, V. ∙ Luna, R. ... Decoding a perceptual decision process across cortex Neuron. 2010; 66 :300-314 Full Text Full Text (PDF) Scopus (215) PubMed Google Scholar ; Kopec et al., 2015 41. Kopec, C.D. ∙ Erlich, J.C. ∙ Brunton, B.W. ... Cortical and Subcortical Contributions to Short-Term Memory for Orienting Movements Neuron. 2015; 88 :367-377 Full Text Full Text (PDF) Scopus (72) PubMed Google Scholar ; Svoboda and Li, 2018 65. Svoboda, K. ∙ Li, N. Neural mechanisms of movement planning: motor cortex and beyond Curr. Opin. Neurobiol. 2018; 49 :33-41 Crossref Scopus (185) PubMed Google Scholar ), and it is thought that interactions between brain regions maintain persistent activity and coordinate behavior-related information ( Christophel et al., 2017 12. Christophel, T.B. ∙ Klink, P.C. ∙ Spitzer, B. ... The Distributed Nature of Working Memory Trends Cogn. Sci. 2017; 21 :111-124 Full Text Full Text (PDF) Scopus (422) PubMed Google Scholar ; Svoboda and Li, 2018 65. Svoboda, K. ∙ Li, N. Neural mechanisms of movement planning: motor cortex and beyond Curr. Opin. Neurobiol. 2018; 49 :33-41 Crossref Scopus (185) PubMed Google Scholar ; Wang, 2001 67. Wang, X.J. Synaptic reverberation underlying mnemonic persistent activity Trends Neurosci. 2001; 24 :455-463 Full Text Full Text (PDF) Scopus (799) PubMed Google Scholar ). At the same time, a widely held assumption is that distributed information produces robustness to internal and external perturbations, whereby corrupt information in one brain region can be compensated for by redundant information in other regions ( Barrett et al., 2016 4. Barrett, D.G. ∙ Denève, S. ∙ Machens, C.K. Optimal compensation for neuron loss eLife. 2016; 5 :e12454 Crossref Scopus (29) PubMed Google Scholar ; Christophel et al., 2017 12. Christophel, T.B. ∙ Klink, P.C. ∙ Spitzer, B. ... The Distributed Nature of Working Memory Trends Cogn. Sci. 2017; 21 :111-124 Full Text Full Text (PDF) Scopus (422) PubMed Google Scholar ; Fornito et al., 2015 19. Fornito, A. ∙ Zalesky, A. ∙ Breakspear, M. The connectomics of brain disorders Nat. Rev. Neurosci. 2015; 16 :159-172 Crossref Scopus (1072) PubMed Google Scholar ). To mediate robustness through distributed information, multiple parallel representations must be compartmentalized such that perturbations in one representation do not propagate into another ( Fornito et al., 2015 19. Fornito, A. ∙ Zalesky, A. ∙ Breakspear, M. The connectomics of brain disorders Nat. Rev. Neurosci. 2015; 16 :159-172 Crossref Scopus (1072) PubMed Google Scholar ; Kitano, 2004 40. Kitano, H. Biological robustness Nat. Rev. Genet. 2004; 5 :826-837 Crossref Scopus (1851) PubMed Google Scholar ; Sporns and Betzel, 2016 61. Sporns, O. ∙ Betzel, R.F. Modular Brain Networks Annu. Rev. Psychol. 2016; 67 :613-640 Crossref Scopus (806) PubMed Google Scholar ). Within interconnected networks, corrupt information can spread and degrade connected representations ( Brummitt et al., 2012 7. Brummitt, C.D. ∙ D’Souza, R.M. ∙ Leicht, E.A. Suppressing cascades of load in interdependent networks Proc. Natl. Acad. Sci. USA. 2012; 109 :E680-E689 Crossref Scopus (439) PubMed Google Scholar ). It remains poorly understood how interconnected brain regions interact to coordinate coherent information that supports behavior while maintaining their integrity when parts of the network are perturbed.
Neurons in mouse anterior lateral motor cortex (ALM) exhibit persistent activity that instructs future choice ( Allen et al., 2017 1. Allen, W.E. ∙ Kauvar, I.V. ∙ Chen, M.Z. ... Global Representations of Goal-Directed Behavior in Distinct Cell Types of Mouse Neocortex Neuron. 2017; 94 :891-907 e896 Full Text Full Text (PDF) Scopus (217) PubMed Google Scholar ; Chabrol et al., 2019 8. Chabrol, F.P. ∙ Blot, A. ∙ Mrsic-Flogel, T.D. Cerebellar Contribution to Preparatory Activity in Motor Neocortex Neuron. 2019; 103 :506-519 e504 Full Text Full Text (PDF) Scopus (96) PubMed Google Scholar ; Chen et al., 2017b 11. Chen, T.W. ∙ Li, N. ∙ Daie, K. ... A Map of Anticipatory Activity in Mouse Motor Cortex Neuron. 2017; 94 :866-879 e864 Full Text Full Text (PDF) Scopus (121) PubMed Google Scholar ; Gao et al., 2018 23. Gao, Z. ∙ Davis, C. ∙ Thomas, A.M. ... A cortico-cerebellar loop for motor planning Nature. 2018; 563 :113-116 Crossref Scopus (239) PubMed Google Scholar ; Guo et al., 2014a 25. Guo, Z.V. ∙ Li, N. ∙ Huber, D. ... Flow of cortical activity underlying a tactile decision in mice Neuron. 2014; 81 :179-194 Full Text Full Text (PDF) Scopus (427) PubMed Google Scholar ; Li et al., 2015 43. Li, N. ∙ Chen, T.W. ∙ Guo, Z.V. ... A motor cortex circuit for motor planning and movement Nature. 2015; 519 :51-56 Crossref Scopus (335) PubMed Google Scholar ; Wu et al., 2020 69. Wu, Z. ∙ Litwin-Kumar, A. ∙ Shamash, P. ... Context-Dependent Decision Making in a Premotor Circuit Neuron. 2020; 106 :316-328.e6 Full Text Full Text (PDF) Scopus (45) PubMed Google Scholar ; Zatka-Haas et al., 2021 70. Zatka-Haas, P. ∙ Steinmetz, N.A. ∙ Carandini, M. ... Sensory coding and causal impact of mouse cortex in a visual decision bioRxiv. 2021; Crossref Scopus (0) Google Scholar ). The two cortical hemispheres are strongly coupled through the corpus callosum ( Harris et al., 2019 28. Harris, J.A. ∙ Mihalas, S. ∙ Hirokawa, K.E. ... Hierarchical organization of cortical and thalamic connectivity Nature. 2019; 575 :195-202 Crossref Scopus (276) PubMed Google Scholar ; Oh et al., 2014 49. Oh, S.W. ∙ Harris, J.A. ∙ Ng, L. ... A mesoscale connectome of the mouse brain Nature. 2014; 508 :207-214 Crossref Scopus (1597) PubMed Google Scholar ; Winnubst et al., 2019 68. Winnubst, J. ∙ Bas, E. ∙ Ferreira, T.A. ... Reconstruction of 1,000 Projection Neurons Reveals New Cell Types and Organization of Long-Range Connectivity in the Mouse Brain Cell. 2019; 179 :268-281.e213 Full Text Full Text (PDF) Scopus (245) PubMed Google Scholar ), and both hemispheres work together to maintain choice information ( Li et al., 2016 44. Li, N. ∙ Daie, K. ∙ Svoboda, K. ... Robust neuronal dynamics in premotor cortex during motor planning Nature. 2016; 532 :459-464 Crossref Scopus (262) PubMed Google Scholar ). Choice information is robust to transient perturbations of ALM activity in one hemisphere, and the recovery of choice information is dependent on input from the contralateral hemisphere ( Inagaki et al., 2019 34. Inagaki, H.K. ∙ Fontolan, L. ∙ Romani, S. ... Discrete attractor dynamics underlies persistent activity in the frontal cortex Nature. 2019; 566 :212-217 Crossref Scopus (148) PubMed Google Scholar ; Li et al., 2016 44. Li, N. ∙ Daie, K. ∙ Svoboda, K. ... Robust neuronal dynamics in premotor cortex during motor planning Nature. 2016; 532 :459-464 Crossref Scopus (262) PubMed Google Scholar ).
We examined how ALM hemispheres interact to maintain robust persistent activity by simultaneously recording population activity in both hemispheres. We found highly coordinated activity across hemispheres that maintained coherent parallel representations of choice information. Perturbation revealed unexpected variability in the organization of frontal cortical networks across a population of mice. In some mice, unilateral perturbations did not spread, and each hemisphere maintained choice information during perturbation of the other hemisphere, thus exhibiting a modular organization across hemispheres. Such modular organization was required for the robustness of persistent activity to perturbations. In mice lacking modular organization, unilateral perturbations corrupted information in both hemispheres, and these mice were less able to maintain choice information after perturbations.
Conceptually, the two hemispheres must be independent to retain choice information during unilateral perturbations. At the same time, the hemispheres must communicate to coordinate coherent information and recover information after perturbations. Theoretical analysis of the neural data and modeling suggests that the interhemispheric interaction was dynamically gated by the activity state to simultaneously meet these two conflicting requirements. State-dependent gating organized the two hemispheres into modular representations that limited corrupt information from spreading while permitting coordination between hemispheres. Mice with more potent gating showed superior short-term memory behavior even in the absence of external perturbations. Our results show that robust persistent activity is maintained by redundant modular representations distributed across multiple brain regions.

Section: Results

Mice performed a delayed response task in which they discriminated the location of a tactile stimulus (anterior or posterior) using their whiskers and reported the object location using directional licking (“lick left” or “lick right”) to obtain a water reward. A delay epoch (1.7 s) separated the sensory instruction and the behavioral response. This required mice to use short-term memory to produce correct choice responses ( Figure 1 A; STAR Methods ).
The ALM is critical for this short-term memory ( Chen et al., 2017b 11. Chen, T.W. ∙ Li, N. ∙ Daie, K. ... A Map of Anticipatory Activity in Mouse Motor Cortex Neuron. 2017; 94 :866-879 e864 Full Text Full Text (PDF) Scopus (121) PubMed Google Scholar ; Guo et al., 2014a 25. Guo, Z.V. ∙ Li, N. ∙ Huber, D. ... Flow of cortical activity underlying a tactile decision in mice Neuron. 2014; 81 :179-194 Full Text Full Text (PDF) Scopus (427) PubMed Google Scholar ; Li et al., 2015 43. Li, N. ∙ Chen, T.W. ∙ Guo, Z.V. ... A motor cortex circuit for motor planning and movement Nature. 2015; 519 :51-56 Crossref Scopus (335) PubMed Google Scholar ) ( Figure 1 A). To examine how information is maintained across two ALM hemispheres, we simultaneously recorded populations of neurons from both hemispheres (21–159 neurons in each hemisphere, average 71; STAR Methods ). A similar fraction of pyramidal neurons in each hemisphere distinguished trial type (left ALM, 1328/3189; right ALM, 1318/3160; Wilcoxon rank sum test, p < 0.05, corrected for multiple comparisons; Figure 1 B). In each hemisphere, spatially intermingled neurons were selective for either lick left or lick right trials ( Figures S1 A-S1C; left ALM, 51% lick left, 49% lick right; right ALM, 53%, 47%).
We examined what information is maintained by ALM activity. Trials differed in object location (“stimulus”, anterior versus posterior), lick direction (“choice”, left versus right), and reward (“outcome”, rewarded versus unrewarded). We separately computed neuronal selectivity for stimulus, choice, and outcome ( STAR Methods ) ( Chen et al., 2017b 11. Chen, T.W. ∙ Li, N. ∙ Daie, K. ... A Map of Anticipatory Activity in Mouse Motor Cortex Neuron. 2017; 94 :866-879 e864 Full Text Full Text (PDF) Scopus (121) PubMed Google Scholar ; Zatka-Haas et al., 2021 70. Zatka-Haas, P. ∙ Steinmetz, N.A. ∙ Carandini, M. ... Sensory coding and causal impact of mouse cortex in a visual decision bioRxiv. 2021; Crossref Scopus (0) Google Scholar ). Selectivity during the sample epoch mostly reflected stimulus ( Figures 1 C and S1 D). Stronger stimulus selectivity was observed in the left ALM ( Figures 1 C and S1 E; p < 10 −4 , paired two-tailed t test), contralateral to the tactile stimulus ( Figure 1 A). Choice selectivity arose during the late sample epoch, ramped up through the delay, and reached a maximum during movement initiation ( Figure 1 C). Choice selectivity was similar in both hemispheres ( Figures 1 C and S1 F; p = 0.26, paired two-tailed t test). Outcome selectivity was limited to the response epoch in both hemispheres ( Figure S1 D). These results show that the two ALM hemispheres have parallel representations of choice information during the delay epoch.
To examine the coordination of choice representations across hemispheres, we projected the population activity onto a linear choice decoder (CD) ( Kaufman et al., 2015 38. Kaufman, M.T. ∙ Churchland, M.M. ∙ Ryu, S.I. ... Vacillation, indecision and hesitation in moment-by-moment decoding of monkey motor cortex eLife. 2015; 4 :e04677 Crossref Scopus (66) PubMed Google Scholar ; Kiani et al., 2014 39. Kiani, R. ∙ Cueva, C.J. ∙ Reppas, J.B. ... Dynamics of neural population responses in prefrontal cortex indicate changes of mind on single trials Curr. Biol. 2014; 24 :1542-1547 Full Text Full Text (PDF) Scopus (99) PubMed Google Scholar ; Li et al., 2016 44. Li, N. ∙ Daie, K. ∙ Svoboda, K. ... Robust neuronal dynamics in premotor cortex during motor planning Nature. 2016; 532 :459-464 Crossref Scopus (262) PubMed Google Scholar ). Since the delay epoch activity mostly reflected upcoming choice ( Figures 1 C and S1 D), we built linear decoders that were weighted sums of the neurons’ delay activity to best predict the future lick direction, with separate decoders for the left and right hemispheres ( STAR Methods ; Figure 1 D). This allowed us to monitor choice encoding in a neuronal population by looking at the decoder activity. The trajectory of choice encoding was highly correlated between hemispheres. On single trials, when the left hemisphere signaled lick left or lick right, the right hemisphere almost always signaled the same direction ( Figures 1 E and S1 G). Correlation developed during the late sample epoch, reaching a maximum during the late delay epoch ( Figure S1 H).
To quantify this correlated choice encoding across hemispheres, we examined the trajectory values at the end of the delay epoch (before the “go” cue). Trajectory endpoints were highly correlated across trials ( Figures 1 F and 1G). Choice encoding (lick left or lick right) in each hemisphere could be reliably read out from the decoder activity of the other hemisphere ( Figure 1 H; STAR Methods ). Similarly, the mouse’s lick direction could be predicted from the decoder activity of either hemisphere ( Figure 1 H). Thus, the two hemispheres have coherent choice encoding, and each hemisphere contains redundant choice information.
The correlated ALM choice activity could reflect interactions between the two hemispheres or a common external input ( Figure S2 A). Widespread cortical activity correlates with movements ( Musall et al., 2019 47. Musall, S. ∙ Kaufman, M.T. ∙ Juavinett, A.L. ... Single-trial neural dynamics are dominated by richly varied movements Nat. Neurosci. 2019; 22 :1677-1686 Crossref Scopus (427) PubMed Google Scholar ; Salkoff et al., 2020 56. Salkoff, D.B. ∙ Zagha, E. ∙ McCarthy, E. ... Movement and Performance Explain Widespread Cortical Activity in a Visual Detection Task Cereb. Cortex. 2020; 30 :421-437 Crossref Scopus (83) PubMed Google Scholar ; Stringer et al., 2019 63. Stringer, C. ∙ Pachitariu, M. ∙ Steinmetz, N. ... Spontaneous behaviors drive multidimensional, brainwide activity Science. 2019; 364 :255 Crossref Scopus (645) PubMed Google Scholar ). To examine whether the correlated ALM delay activity could be explained by ongoing movements during the delay epoch, we measured orofacial movements using high-speed cameras and related movements to ALM activity using a convolutional neural network model ( Figures S2 B and S2C; STAR Methods ). The model predicted a substantial fraction of ALM activity in each hemisphere based on movements ( Figure S2 D). Subtracting the movement-related activity still left considerable correlation between the two hemispheres ( Figure S2 E), suggesting that activity reflecting ongoing movements was not the primary driver of the correlation between hemispheres.
Finally, we directly examined whether the correlated activity arose from external input by optogenetically photoinhibiting ALM ( STAR Methods ). We silenced activity in both hemispheres during the early delay epoch using 4 laser spots on each hemisphere that covered the entire ALM and surrounding regions (Figure S2F; STAR Methods ). After bilateral photoinhibition, trial-type selectivity in both hemispheres was abolished ( Figure S2 G). Importantly, activity trajectories of the two hemispheres also became significantly less correlated after photoinhibition ( Figures S2 H and S2I). Video analysis showed that ongoing movements were not sufficient to explain the decorrelated ALM activity after photoinhibition ( Figure S2 J and S2K). This suggests that the correlated activity across hemispheres during the delay epoch could not be fully explained by external input and likely reflected interactions between the two hemispheres.
These results show that the two ALM hemispheres contained parallel representations of choice during short-term memory and that the two hemispheres interact to coordinate coherent choice information to support behavior.
To directly probe interactions between the two ALM hemispheres, we photoinhibited activity in one hemisphere and measured the impact on the other hemisphere ( STAR Methods ). We performed simultaneous bilateral recording and photoinhibition in a large population of mice (135 sessions, 39 mice).
In many mice, neurons in each hemisphere maintained trial-type selectivity while the other hemisphere was silenced ( Figure 2 A). An example session is shown in Figure 2 B. When the right ALM was silenced, selectivity in the left ALM was largely retained. Similarly, selectivity in the right ALM was maintained when the left ALM was silenced. Thus, the two hemispheres exhibited a modular organization, where each hemisphere compartmentalized its representation during perturbations of the other hemisphere.
Interestingly, other mice exhibited different interhemispheric interactions. Figure 2 C shows an example session from a different mouse. When the left ALM was silenced, selectivity in the right ALM was abolished. In contrast, when the right ALM was silenced, selectivity in the left ALM was little affected. Thus, the interaction was asymmetric, where the left ALM appeared to drive selectivity in the right ALM and the right ALM could not maintain its representation while a perturbation was applied to the left ALM.
To quantify the degree to which each hemisphere could maintain its representation during perturbations to the other hemisphere, we calculated the “modularity” of each hemisphere as the fraction of selectivity retained during the epoch when the other hemisphere was silenced ( Figures 2 B and 2C; STAR Methods ). The modularity of each hemisphere varied along a continuum across individual sessions ( Figures 2 D and S3 A–S3E).
The variability in modularity was not due to heterogeneous sampling of neurons ( Figures S3 F and S3G), variability in photoinhibition ( Figures S3 H and S3I), or arousal state ( Figure S3 J). In sessions exhibiting modular organization, choice information was also less correlated between hemispheres in control trials ( Figures 2 E and S4 A–S4F). In asymmetric sessions where one hemisphere drove the other, cross-correlation analysis of activity trajectories between the left and right ALM showed congruent direction of activity flow in control trials ( Figures S4 G and S4H). These results show that differences in modularity reflect distinct interhemispheric interactions.
Modularity varied across individual mice and also varied to a smaller degree within mice across sessions ( Figures S5 A–S5E). Strain, gender, or age did not explain inter-subject variability ( Figures S5 F and S5G). We considered the possibility that distinct interhemispheric interactions reflected differences in mice behavior induced by the task. In asymmetric sessions, the left ALM always drove the right ALM ( Figure 2 D). In the standard task, mice used the right whiskers to discriminate object location, which could result in stronger tactile input to the left hemisphere. Consistent with this idea, stronger stimulus selectivity was observed in the left ALM ( Figures 1 C and S1 E). Additionally, stimulus selectivity emerged earlier in the left ALM in asymmetric sessions ( Figure 2 F). The timing difference may reflect an imbalance of stimulus input to the two hemispheres, where the left ALM received stimulus input and in turn drove selectivity in the right ALM.
To test these notions, we trained a different group of mice on a task in which the tactile stimulus was placed on the left side of the mouse. In addition, the sensorimotor contingency was reversed, i.e., the posterior object location corresponded to lick left ( Figure 3 B). In this fully reversed task, the asymmetry of interhemispheric interactions was reversed such that the right ALM drove the left ALM ( Figure 3 B). Further systematic task manipulations showed that the side of the tactile stimulus, rather than the sensorimotor contingency, drove the shift in interhemispheric asymmetry ( Figures 3 C-D).
These results reveal distinct organizations of frontal hemispheres across individual mice. The interhemispheric interactions could be shaped by task, suggesting that distinct organizations were not hardwired. An imbalance of stimulus input to the two hemispheres may shape the asymmetry of interhemispheric interactions.
Taking advantage of this individual variability, we examined the relationship between distinct organizations across hemispheres and robustness of choice information to unilateral perturbations.
We measured the maintenance of trial-type selectivity following transient unilateral photoinhibition ( Figure 4 A; STAR Methods ). Selectivity recovered on average at the end of the delay epoch (control trial selectivity, 2.87 spikes/s; photoinhibition, 2.24 spikes/s), and behavioral choice was only slightly affected (control, 83.9% correct; photoinhibition 77.3%; n = 79 sessions; 27 mice). However, recovery was variable across sessions ( Figures 4 A–4F). The recovery of selectivity was correlated with the behavioral performance after photoinhibition ( Figure 4 G). Thus, different sessions exhibited different degrees of robustness to perturbations.
Modularity of the unperturbed hemisphere strongly predicted the recovery of selectivity and behavioral performance following unilateral photoinhibition ( Figures 4 H and 4I). In sessions where both hemispheres exhibited high modularity, the recovery was the strongest ( Figures 4 B and 4C). In asymmetric sessions where the driven hemisphere could not maintain selectivity during perturbations of the driver hemisphere, selectivity did not recover after the perturbation ( Figures 4 E and 4F). Recovery of selectivity was coordinated across hemispheres where selectivity recovered to the same degree in both hemispheres ( Figures 4 B and 4E). The degree of recovery in both hemispheres was predicted by the modularity of the unperturbed hemisphere ( Figure 4 H).
Thus, despite redundant choice information across the hemispheres ( Figure 1 ), modular organization was required for maintenance of choice information after unilateral perturbations.
We sought to understand how hemispheres maintain modular representations and recover choice information after perturbations. At an algorithmic level, the unperturbed hemisphere needs to gate out the influence of the perturbed hemisphere ( Figure 5 A). At the same time, interhemispheric input is needed to recover the perturbed hemisphere ( Figure 5 A). To have both properties at the same time, interaction strength between the hemispheres needs to be modulated in a state-dependent way.
We inferred interhemispheric interactions from simultaneous recordings of both hemispheres in control trials. The large single-trial variability of ALM delay activity ( Figures 1 E and 1F) allowed us to observe each hemisphere across different states of activity and examine how interhemispheric interactions might differ across states. To quantify interhemispheric interactions, we constructed a model that predicted ALM single-trial dynamics from the activity within the hemisphere (“analyzed hemisphere”) and the activity from the other hemisphere (“contra hemisphere”). To test for state dependence, we allowed the model to have two different states with potentially different influences from the contra hemisphere. We fit the model parameters to best predict ALM activity. This approach did not necessitate finding state-dependent differences in interhemispheric influence. If having state-dependent influence did not improve predictions of ALM activity, the model would infer the same interhemispheric influence in the two states. For each hemisphere, the model equations take the following form: 𝑋 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 ℎ ⁢ 𝑒 ⁢ 𝑚 ⁢ 𝑖 ⁢ 𝑠 ⁢ 𝑝 ⁢ ℎ ⁢ 𝑒 ⁢ 𝑟 ⁢ 𝑒 𝑡 + 1 = 𝛼 ⁢ 𝑋 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 ℎ ⁢ 𝑒 ⁢ 𝑚 ⁢ 𝑖 ⁢ 𝑠 ⁢ 𝑝 ⁢ ℎ ⁢ 𝑒 ⁢ 𝑟 ⁢ 𝑒 𝑡 + 𝛽 ⁡ ( 𝑧 𝑡 ) ⁢ 𝑋 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 ℎ ⁢ 𝑒 ⁢ 𝑚 ⁢ 𝑖 ⁢ 𝑠 ⁢ 𝑝 ⁢ ℎ ⁢ 𝑒 ⁢ 𝑟 ⁢ 𝑒 𝑡 , 𝛽 ⁡ ( 𝑧 𝑡 ) = { 𝛽 0 ⁡ 𝑖 ⁢ 𝑓 𝑧 𝑡 = ″ 𝑤 ⁢ 𝑒 ⁢ 𝑎 ⁢ 𝑘 ⁢ 𝑙 ⁢ 𝑦 𝑠 ⁢ 𝑒 ⁢ 𝑙 ⁢ 𝑒 ⁢ 𝑐 ⁢ 𝑡 ⁢ 𝑖 ⁢ 𝑣 ⁢ 𝑒 ″ 𝑠 ⁢ 𝑡 ⁢ 𝑎 ⁢ 𝑡 ⁢ 𝑒 𝛽 1 ⁡ 𝑖 ⁢ 𝑓 𝑧 𝑡 = ″ ℎ ⁢ 𝑖 ⁢ 𝑔 ⁢ ℎ ⁢ 𝑙 ⁢ 𝑦 𝑠 ⁢ 𝑒 ⁢ 𝑙 ⁢ 𝑒 ⁢ 𝑐 ⁢ 𝑡 ⁢ 𝑖 ⁢ 𝑣 ⁢ 𝑒 ″ 𝑠 ⁢ 𝑡 ⁢ 𝑎 ⁢ 𝑡 ⁢ 𝑒
where 𝑋 represents the activity of each hemisphere. We predicted activity projections on the CD instead of the full activity of each hemisphere. 𝛼 is a scalar coefficient tying past within-hemisphere activity to future activity. 𝛽 ⁡ ( 𝑧 𝑡 ) is a coefficient that scales the influence of the other hemisphere, which takes on one of two values depending on a binary state variable 𝑧 𝑡 . Switching between the two states was dependent on the strength of choice encoding in the analyzed hemisphere ( STAR Methods ). Specifically, 𝑧 𝑡 was in the “highly selective” state when the CD activity was above a threshold and in the “weakly selective” state when below ( Figures 5 B and 5C).
We first validated the model. The model accurately predicted ALM activity on held-out control trials ( Figures 5 C and S6 A). Importantly, for nearly every session, adding the influence of the other hemisphere significantly improved model prediction ( Figure S6 B; p < 5 × 10 −38 , two-tailed t test). The magnitude of the improvement was moderate because the activities of the two hemispheres were highly correlated, thus a large fraction of ALM activity could already be predicted from a hemisphere’s own past activity. Scrambling the trial identity of the simultaneous recording data abolished the improvement in model prediction ( Figure S6 B). Thus, the model consistently captured interhemispheric interactions.
We then analyzed the model-inferred interhemispheric interactions. The strength of interhemispheric influence inferred from control trials predicted the recovery of neuronal selectivity and behavioral performance following unilateral photoinhibition ( Figure 5 D). The model also captured the asymmetry of interhemispheric organization that was revealed by photoinhibition. In the standard task, the left ALM exhibited a larger influence over the right ALM ( Figure S6 C; p < 5 × 10 −3 , paired two-tailed t test), but the right ALM exhibited a larger influence over the left ALM in the fully reversed task ( Figures 3 and S6 C; p < 10 −2 ). Thus, the model captured session-to-session differences in the strength of interhemispheric interactions.
Finally, we examined the state dependence of interhemispheric interactions. Although we did not constrain the values of the two coefficients 𝛽 ⁡ ( 𝑧 𝑡 ) , the model-inferred coefficients were consistently different in nearly all sessions, indicating state dependence ( Figure S6 D; p < 0.001, paired two-tailed t test). Importantly, the modulation was consistent with a state-dependent gating mechanism: the influence of the other hemisphere was weaker when choice encoding was strong within a hemisphere ( Figure 5 E; p < 10 −19 , paired two-tailed t test). This state-dependent gating could potentially explain how ALM hemispheres maintained choice information during unilateral perturbations and recovered choice information after the perturbation ( Figure 5 A): during photoinhibition, the unperturbed hemisphere is in a highly selective state and thus is weakly influenced by the perturbed hemisphere (producing modularity), whereas the perturbed hemisphere is rendered to a weakly selective state and is therefore strongly influenced by the intact hemisphere (generating error correction).
We directly tested for state-dependent gating using perturbation experiments. The strength of choice encoding during the delay epoch differed substantially across trials ( Figure 5 C). We unilaterally photoinhibited ALM activity during the late delay epoch and examined whether selectivity state of the unperturbed hemisphere could modulate the influence of the perturbation ( Figure 5 F). In trials where the unperturbed hemisphere exhibited weak choice encoding, its selectivity was strongly affected by contralateral photoinhibition ( Figure 5 G). In contrast, when the unperturbed hemisphere exhibited strong choice encoding, its selectivity was less affected ( Figure 5 G; p < 0.05, one-tailed t test).
In summary, our analysis of ALM interhemispheric interactions revealed state-dependent gating of influence between the two hemispheres.
Can the state-dependent gating inferred from control trials explain modular organization and robustness of frontal cortical networks to perturbations?
In state-dependent gating, gating of interhemispheric influence occurs when a hemisphere is in a highly selective state, which potentially produces modularity ( Figure 6 A). We examined the strength of interhemispheric influence in the highly selective state (from Figure 5 E). In asymmetric sessions, the hemisphere with low modularity (driven hemisphere) showed strong influence from the other hemisphere (little gating, Figure 6 A). In modular sessions, the same hemisphere showed little influence from the other hemisphere (strong gating, Figure 6 A; modular versus asymmetric sessions, p < 0.01, one-sided Wilcoxon rank sum test). Modularity of the hemisphere was inversely correlated with the strength of interhemispheric influence ( Figure 6 A). These results show that modularity of a hemisphere (revealed by photoinhibition) could be explained by the gating of interhemispheric influence inferred from control trials.
However, a hemisphere with strong gating is not completely decoupled from the other hemisphere. In state-dependent gating, the same hemisphere in a weakly selective state can still be strongly influenced by the other hemisphere to produce error correction ( Figure 5 A). Supporting this idea, the strength of interhemispheric influence in the weakly selective state predicted the recovery of choice information following photoinhibition ( Figure 5 D). Together, these results suggest that robustness to perturbations is jointly mediated by little influence in the highly selective state (producing modularity) and strong influence in the weakly selective state (generating error correction).
Finally, the potency of state-dependent gating, i.e., how different the influence was between states, predicted differences in behavioral performance across sessions. We quantified the potency of state dependence as the difference in interhemispheric influence between the weakly and highly selective states ( Figure 5 E; STAR Methods ). The potency of state dependence was significantly correlated with behavioral performance in control trials ( Figure 6 B). This suggests that the ability of the two hemispheres to dynamically gate influence and maintain modular representations might help better maintain choice information during normal behavior, possibly by increasing robustness to internal perturbations such as noise.
Together, these results suggest that state-dependent gating is closely related to the mechanism for modular organization and robustness of frontal cortical networks to external and internal perturbations.
We next examined more generally what interhemispheric interactions might arise in highly connected networks required to perform the delayed response task with minimal additional assumptions. We chose recurrent neural networks (RNNs) due to their ability to generate models that are constrained to solve a task without enforcing their solutions ( Sussillo and Abbott, 2009 64. Sussillo, D. ∙ Abbott, L.F. Generating coherent patterns of activity from chaotic neural networks Neuron. 2009; 63 :544-557 Full Text Full Text (PDF) Scopus (653) PubMed Google Scholar ). Our goal was not to build a faithful model of ALM dynamics but to use RNNs as a tool to explore solutions to robust dynamics.
RNNs learned to perform the delayed response task and generated delay activity similar to those observed in the data ( Figures 7 A and 7B). Learned networks were robust to perturbations without experiencing perturbations during training when three conditions were met ( Figures S7 A and S7B): (1) modular initialization—networks were partitioned into modules before training, in which the initial between-module connection weights were smaller than the within-module connection weights; (2) modular training—the internal weights of each module were trained while keeping the between-module weights frozen; (3) nonlinearity—units within the RNN had nonlinear input-output functions ( STAR Methods ). Without these conditions, some learned networks exhibited discrete attractor dynamics but without modular organization, and these networks did not exhibit the robustness to perturbations we observe ( Figure S7 C).
We examined the mechanism by which RNN modules interact to maintain information during perturbations. Since the connectivity and activity of all units is known in simulations, we can directly calculate how a change of activity in one module influences the activity of the other module by calculating activity gradients ( STAR Methods ). Remarkably, even though we did not build in any state-dependent gating mechanisms, the interhemispheric influences of the robust RNNs were modulated such that the influence of the other hemisphere was smaller when a hemisphere was highly selective and greater when it was weakly selective ( Figure 7 C; n = 30 models). Like the neural data, state-dependent gating in RNNs could explain the robustness of RNNs to perturbations: little influence in the highly selective state predicted higher modularity in a hemisphere ( Figure S7 F); strong influence in the weakly selective state predicted better recovery of choice information in the perturbed hemisphere ( Figure S7 G). These results show that RNNs achieved robustness to perturbations by a similar state-dependent gating mechanism as observed in the neural data ( Figures 5 and 6 ).
RNN modeling also provided insight regarding the asymmetry of interhemispheric interactions in ALM. Based on the findings that the asymmetry of interhemispheric influence can be flipped by reversing the side of the tactile stimulus ( Figure 3 ), we hypothesized that it arises from asymmetric strength of sensory input to each hemisphere ( Figure 2 F). We trained RNNs that received unequal input to the two hemispheres ( STAR Methods ). Consistent with our hypothesis, interhemispheric influence in these RNNs developed an asymmetry that was dependent on the relative strength of sensory input to each hemisphere ( Figures 7 D, 7E, S7 D, and S7E).
In summary, robust RNNs showed both state-dependent gating and modular dynamics even though we did not enforce such solutions. Moreover, asymmetric interhemispheric interactions might emerge when sensory inputs to each hemisphere are asymmetric.

Section: Discussion

Our study provides evidence for modular organization in frontal cortical networks that maintain persistent activity. Redundant modular representations distributed across hemispheres coordinate coherent information ( Figure 1 ) while maintaining their integrity when parts of the network are perturbed ( Figure 2 ). Modular organization is required for the robustness of persistent activity to perturbations ( Figure 4 ). A state-dependent gating mechanism allows connected hemispheres to limit corrupt information from spreading while still permitting coordination between hemispheres ( Figures 5 ). State-dependent gating could explain the robustness of frontal cortical networks to external and internal perturbations ( Figure 6 ).
Our results also reveal unexpected individual differences in frontal network organization, which could be shaped by task ( Figure 3 ). Interhemispheric interactions were asymmetric in some mice, in which the hemisphere contralateral to the tactile stimulus drove selectivity in the other hemisphere. Our results suggest that an imbalance of stimulus input to the two hemispheres shapes the asymmetry of interhemispheric interactions ( Figure 2 F). This interpretation is supported by our findings in learned RNNs where the hemisphere receiving stronger sensory input became the driver hemisphere ( Figures 7 D and 7E). Future experiments tracking the activity of both hemispheres in the same animal across learning will shed light on the underlying mechanisms.
Our electrophysiology measured dynamics of neuronal populations from each hemisphere, but modular organization may exist at multiple spatial scales ( Svoboda and Li, 2018 65. Svoboda, K. ∙ Li, N. Neural mechanisms of movement planning: motor cortex and beyond Curr. Opin. Neurobiol. 2018; 49 :33-41 Crossref Scopus (185) PubMed Google Scholar ). Multiple modular representations could be maintained by interdigitated neuronal populations within each hemisphere ( Daie et al., 2021 13. Daie, K. ∙ Svoboda, K. ∙ Druckmann, S. Targeted photostimulation uncovers circuit motifs supporting short-term memory Nat. Neurosci. 2021; 24 :259-265 Crossref Scopus (41) PubMed Google Scholar ). Modular representations may extend beyond single brain regions, where groups of neurons in thalamo-cortical loops maintain a single modular representation ( Guo et al., 2017 27. Guo, Z.V. ∙ Inagaki, H.K. ∙ Daie, K. ... Maintenance of persistent activity in a frontal thalamocortical loop Nature. 2017; 545 :181-186 Crossref Scopus (301) PubMed Google Scholar ). The fact that recording from a few dozen randomly sampled neurons in each hemisphere could reveal distinct interhemispheric interactions suggests that ALM activity encoding choice is low dimensional and that multiple modular representations within a hemisphere are correlated with each other. Future experiments combining two-photon imaging and cellular resolution perturbations hold the promise for fine-scale dissections of modular representations within each hemisphere ( Daie et al., 2021 13. Daie, K. ∙ Svoboda, K. ∙ Druckmann, S. Targeted photostimulation uncovers circuit motifs supporting short-term memory Nat. Neurosci. 2021; 24 :259-265 Crossref Scopus (41) PubMed Google Scholar ).
Our analysis of interhemispheric interactions revealed a state-dependent gating—a hemisphere is little influenced by the other hemisphere (and perhaps by other brain regions [ Finkelstein et al., 2021 17. Finkelstein, A. ∙ Fontolan, L. ∙ Economo, M.N. ... Attractor dynamics gate cortical information flow during decision-making Nat. Neurosci. 2021; 24 :843-850 Crossref Scopus (46) PubMed Google Scholar ; Kopec et al., 2015 41. Kopec, C.D. ∙ Erlich, J.C. ∙ Brunton, B.W. ... Cortical and Subcortical Contributions to Short-Term Memory for Orienting Movements Neuron. 2015; 88 :367-377 Full Text Full Text (PDF) Scopus (72) PubMed Google Scholar ]) when it is in a highly selective state, but when it is in a weakly selective state it allows strong influence from its inputs. This type of modulation makes sense from a normative point of view: if a representation has accurate information, then receiving outside influence could be detrimental, but a representation that has poor information would likely benefit from influence. We found that similar state-dependent gating emerges in robust RNN models trained to solve the task, even though we did not enforce such solutions.
Redundant modular representations may support other cognitive processes, including working memory ( Chafee and Goldman-Rakic, 1998 9. Chafee, M.V. ∙ Goldman-Rakic, P.S. Matching patterns of activity in primate prefrontal area 8a and parietal area 7ip neurons during a spatial working memory task J. Neurophysiol. 1998; 79 :2919-2940 Crossref Scopus (541) PubMed Google Scholar ; Romo et al., 1999 54. Romo, R. ∙ Brody, C.D. ∙ Hernández, A. ... Neuronal correlates of parametric working memory in the prefrontal cortex Nature. 1999; 399 :470-473 Crossref Scopus (641) PubMed Google Scholar ), episodic memory ( Zugaro et al., 2005 71. Zugaro, M.B. ∙ Monconduit, L. ∙ Buzsáki, G. Spike phase precession persists after transient intrahippocampal perturbation Nat. Neurosci. 2005; 8 :67-71 Crossref Scopus (81) PubMed Google Scholar ), and perceptual decision-making ( Brody and Hanks, 2016 5. Brody, C.D. ∙ Hanks, T.D. Neural underpinnings of the evidence accumulator Curr. Opin. Neurobiol. 2016; 37 :149-157 Crossref Scopus (95) PubMed Google Scholar ; Gold and Shadlen, 2001 24. Gold, J.I. ∙ Shadlen, M.N. Neural computations that underlie decisions about sensory stimuli Trends Cogn. Sci. 2001; 5 :10-16 Full Text Full Text (PDF) Scopus (671) PubMed Google Scholar ). Modular organization increases resiliency of networks ( Brummitt et al., 2012 7. Brummitt, C.D. ∙ D’Souza, R.M. ∙ Leicht, E.A. Suppressing cascades of load in interdependent networks Proc. Natl. Acad. Sci. USA. 2012; 109 :E680-E689 Crossref Scopus (439) PubMed Google Scholar ; Variano et al., 2004 66. Variano, E.A. ∙ McCoy, J.H. ∙ Lipson, H. Networks, dynamics, and modularity Phys. Rev. Lett. 2004; 92 :188701 Crossref Scopus (2) PubMed Google Scholar ). Redundant modular representations could suppress effects of perturbation, which suggests a potential explanation for lack of behavioral effects during certain acute experimental manipulations ( Fetsch et al., 2018 16. Fetsch, C.R. ∙ Odean, N.N. ∙ Jeurissen, D. ... Focal optogenetic suppression in macaque area MT biases direction discrimination and decision confidence, but only transiently eLife. 2018; 7 :e36523 Crossref Scopus (34) PubMed Google Scholar ; Kopec et al., 2015 41. Kopec, C.D. ∙ Erlich, J.C. ∙ Brunton, B.W. ... Cortical and Subcortical Contributions to Short-Term Memory for Orienting Movements Neuron. 2015; 88 :367-377 Full Text Full Text (PDF) Scopus (72) PubMed Google Scholar ; Li et al., 2016 44. Li, N. ∙ Daie, K. ∙ Svoboda, K. ... Robust neuronal dynamics in premotor cortex during motor planning Nature. 2016; 532 :459-464 Crossref Scopus (262) PubMed Google Scholar ; Liu and Pack, 2017 46. Liu, L.D. ∙ Pack, C.C. The Contribution of Area MT to Visual Motion Perception Depends on Training Neuron. 2017; 95 :436-446 e433 Full Text Full Text (PDF) Scopus (51) PubMed Google Scholar ). Along similar lines, acute insults such as lesions or strokes often lead to neuron loss with subtle deficits on behavior ( Fanning et al., 2014 15. Fanning, J.P. ∙ Wong, A.A. ∙ Fraser, J.F. The epidemiology of silent brain infarction: a systematic review of population-based cohorts BMC Med. 2014; 12 :119 Crossref Scopus (190) PubMed Google Scholar ; Fisher, 1965 18. Fisher, C.M. Lacunes: Small, Deep Cerebral Infarcts Neurology. 1965; 15 :774-784 Crossref PubMed Google Scholar ; Leary and Saver, 2003 42. Leary, M.C. ∙ Saver, J.L. Annual incidence of first silent stroke in the United States: a preliminary estimate Cerebrovasc. Dis. 2003; 16 :280-285 Crossref Scopus (159) PubMed Google Scholar ). Redundant modular representations distributed across multiple brain regions could allow for resiliency of cognitive functions following certain chronic and acute perturbations to parts of the brain ( Fornito et al., 2015 19. Fornito, A. ∙ Zalesky, A. ∙ Breakspear, M. The connectomics of brain disorders Nat. Rev. Neurosci. 2015; 16 :159-172 Crossref Scopus (1072) PubMed Google Scholar ; Palop et al., 2006 51. Palop, J.J. ∙ Chin, J. ∙ Mucke, L. A network dysfunction perspective on neurodegenerative diseases Nature. 2006; 443 :768-773 Crossref Scopus (526) PubMed Google Scholar ).
How neural circuits implement state-dependent gating remains to be determined. Attractor models could produce dynamics that are little influenced by external input ( Amit and Brunel, 1997 2. Amit, D.J. ∙ Brunel, N. Model of global spontaneous activity and local structured activity during delay periods in the cerebral cortex Cereb. Cortex. 1997; 7 :237-252 Crossref Scopus (794) PubMed Google Scholar ; Barak et al., 2013 3. Barak, O. ∙ Sussillo, D. ∙ Romo, R. ... From fixed points to chaos: three models of delayed discrimination Prog. Neurobiol. 2013; 103 :214-222 Crossref Scopus (109) PubMed Google Scholar ; Brody et al., 2003 6. Brody, C.D. ∙ Romo, R. ∙ Kepecs, A. Basic mechanisms for graded persistent activity: discrete attractors, continuous attractors, and dynamic representations Curr. Opin. Neurobiol. 2003; 13 :204-211 Crossref Scopus (206) PubMed Google Scholar ; Finkelstein et al., 2021 17. Finkelstein, A. ∙ Fontolan, L. ∙ Economo, M.N. ... Attractor dynamics gate cortical information flow during decision-making Nat. Neurosci. 2021; 24 :843-850 Crossref Scopus (46) PubMed Google Scholar ; Hopfield, 1982 33. Hopfield, J.J. Neural networks and physical systems with emergent collective computational abilities Proc. Natl. Acad. Sci. USA. 1982; 79 :2554-2558 Crossref Scopus (13046) PubMed Google Scholar ; Inagaki et al., 2019 34. Inagaki, H.K. ∙ Fontolan, L. ∙ Romani, S. ... Discrete attractor dynamics underlies persistent activity in the frontal cortex Nature. 2019; 566 :212-217 Crossref Scopus (148) PubMed Google Scholar ; Peixoto et al., 2019 53. Peixoto, D. ∙ Verhein, J.R. ∙ Kiani, R. ... Decoding and perturbing decision states in real time bioRxiv. 2019; Crossref Scopus (0) Google Scholar ; Seung, 1996 58. Seung, H.S. How the brain keeps the eyes still Proc. Natl. Acad. Sci. USA. 1996; 93 :13339-13344 Crossref Scopus (377) PubMed Google Scholar ; Shenoy et al., 2013 59. Shenoy, K.V. ∙ Sahani, M. ∙ Churchland, M.M. Cortical control of arm movements: a dynamical systems perspective Annu. Rev. Neurosci. 2013; 36 :337-359 Crossref Scopus (461) PubMed Google Scholar ; Wang, 2001 67. Wang, X.J. Synaptic reverberation underlying mnemonic persistent activity Trends Neurosci. 2001; 24 :455-463 Full Text Full Text (PDF) Scopus (799) PubMed Google Scholar ). Some learned RNNs exploited a gating mechanism where network dynamics in each RNN module self-reinforce activity states encoding specific choices, with no obvious neurons dedicated to suppressing interhemispheric influence. However, other models could also implement gating such as communication by coherence ( Fries, 2005 20. Fries, P. A mechanism for cognitive dynamics: neuronal communication through neuronal coherence Trends Cogn. Sci. 2005; 9 :474-480 Full Text Full Text (PDF) Scopus (2972) PubMed Google Scholar ) or interactions along specific subspaces ( Druckmann and Chklovskii, 2012 14. Druckmann, S. ∙ Chklovskii, D.B. Neuronal circuits underlying persistent representations despite time varying activity Curr. Biol. 2012; 22 :2095-2103 Full Text Full Text (PDF) Scopus (110) PubMed Google Scholar ; Kaufman et al., 2014 37. Kaufman, M.T. ∙ Churchland, M.M. ∙ Ryu, S.I. ... Cortical activity in the null space: permitting preparation without movement Nat. Neurosci. 2014; 17 :440-448 Crossref Scopus (399) PubMed Google Scholar ; Semedo et al., 2019 57. Semedo, J.D. ∙ Zandvakili, A. ∙ Machens, C.K. ... Cortical Areas Interact through a Communication Subspace Neuron. 2019; 102 :249-259 e244 Full Text Full Text (PDF) Scopus (155) PubMed Google Scholar ), which can be extended to include state dependence. Future large-scale recordings from multiple brain regions ( Jun et al., 2017 36. Jun, J.J. ∙ Steinmetz, N.A. ∙ Siegle, J.H. ... Fully integrated silicon probes for high-density recording of neural activity Nature. 2017; 551 :232-236 Crossref Scopus (1128) PubMed Google Scholar ; Sofroniew et al., 2016 60. Sofroniew, N.J. ∙ Flickinger, D. ∙ King, J. ... A large field of view two-photon mesoscope with subcellular resolution for in vivo imaging eLife. 2016; 5 :e14472 Crossref Scopus (383) PubMed Google Scholar ) are required to understand its mechanisms. Finally, we found that modularity varied across mice and sessions. The source of this variability and to what extent it reflects changes in the underlying circuits remain to be explored. Such exploration requires recording from the same neuronal populations across days, e.g., by calcium imaging.

Section: STAR★Methods

REAGENT or RESOURCE SOURCE IDENTIFIER Chemicals, peptides, and recombinant proteins DiI ThermoFisher scientific D282 DiR ThermoFisher scientific D12731 DiO Sigma-Aldrich D4292 Experimental models: Organisms/strains Mouse: VGAT-ChR2-EYFP Jackson Laboratory Jax No. 014548; RRID:IMSR_JAX:014548 Mouse: PV-ires-cre Jackson Laboratory Jax No. 008069; RRID:IMSR_JAX:008069 Mouse: Rosa26-LSL-ReaChR Jackson Laboratory Jax No. 024846; RRID:IMSR_JAX:024846 Software and algorithms MATLAB Mathworks N/A Kilosort2 Pachitariu et al., 2016 50. Pachitariu, M. ∙ Steinmetz, N. ∙ Kadir, S. ... Kilosort: realtime spike-sorting for extracellular electrophysiology with hundreds of channels Adv. Neural Inf. Process. Syst. 2016; 29 :4448-4456 Google Scholar https://www.github.com/MouseLand/Kilosort2 Phy 2.0 beta 1 GUI Rossant et al., 2016 55. Rossant, C. ∙ Kadir, S.N. ∙ Goodman, D.F.M. ... Spike sorting for large, dense electrode arrays Nat. Neurosci. 2016; 19 :634-641 Crossref Scopus (455) PubMed Google Scholar https://github.com/cortex-lab/phy FlyCapture FLIR N/A Python 3.6; Anaconda distribution https://anaconda.com/download N/A Scikit-learn toolbox https://scikit-learn.org N/A PyTorch 1.0 https://pytorch.org N/A Other CMOS camera FLIR CM3-U3-13Y3M Lens Tamron 12VM412ASIR 473 nm laser UltraLasers MBL-FN-473-300mW 593.5 nm laser UltraLasers MGL-N-593.5-200mW Acousto-optical modulator Quanta Tech MTS110-A3-VIS Scanning galvo Thorlabs GVSM002 64-channel silicon probes Cambridge NeuroTech H2 acute probe Intan 64-Channel Amplifier Board Intan Technology RHD2164 Open table in a new tab
Further information and requests for resources and reagents should be directed to and will be fulfilled by the Lead Contact, Nuo Li ( nuol@bcm.edu ).
This study did not generate new unique reagents.
The electrophysiology data and analysis code supporting the current study has not been deposited in a public repository because it is in a non-standard format but will be made available in the near future. Modeling and simulation code can be found at https://github.com/druckmann-lab/Dual_ALM_RNN . All data and analysis code are available from the lead contact upon request.
This study is based on data from 43 mice (age > postnatal day 60, both male and female mice). 11 VGAT-ChR2-EYFP mice (Jackson laboratory, JAX Stock#014548) and 32 PV-IRES-Cre (JAX 008069) ( Hippenmeyer et al., 2005 31. Hippenmeyer, S. ∙ Vrieseling, E. ∙ Sigrist, M. ... A developmental switch in the response of DRG neurons to ETS transcription factor signaling PLoS Biol. 2005; 3 :e159 Crossref Scopus (774) PubMed Google Scholar ) crossed to R26-CAG-LSL-ReaChR-mCitrine mice (JAX 024846) ( Hooks et al., 2015 32. Hooks, B.M. ∙ Lin, J.Y. ∙ Guo, C. ... Dual-channel circuit mapping reveals sensorimotor convergence in the primary motor cortex J. Neurosci. 2015; 35 :4418-4426 Crossref Scopus (59) PubMed Google Scholar ) were used for simultaneous electrophysiology and photoinhibition during behavior.
All procedures were in accordance with protocols approved by the Institutional Animal Care and Use Committees at Baylor College of Medicine. Mice were housed in a 12:12 reverse light:dark cycle and tested during the dark phase. On days not tested, mice received 0.5-1 mL of water. On other days, mice were tested in experimental sessions lasting 1 to 2 h where they received all their water (0.3 to 2 mL). If mice did not maintain a stable body weight, they received supplementary water ( Guo et al., 2014b 26. Guo, Z.V. ∙ Hires, S.A. ∙ Li, N. ... Procedures for behavioral experiments in head-fixed mice PLoS ONE. 2014; 9 :e88678 Crossref Scopus (254) PubMed Google Scholar ). All surgical procedures were carried out aseptically under 1%–2% isoflurane anesthesia. Buprenorphine Sustained Release (1 mg/kg) and Meloxicam Sustained Release (4mg/kg) were used for pre- and post-operative analgesia. After the surgery, mice were allowed to recover for at least three days with free access to water before water restriction.
Mice were prepared for photoinhibition and electrophysiology with a clear-skull cap and a headpost ( Guo et al., 2014a 25. Guo, Z.V. ∙ Li, N. ∙ Huber, D. ... Flow of cortical activity underlying a tactile decision in mice Neuron. 2014; 81 :179-194 Full Text Full Text (PDF) Scopus (427) PubMed Google Scholar ; Guo et al., 2014b 26. Guo, Z.V. ∙ Hires, S.A. ∙ Li, N. ... Procedures for behavioral experiments in head-fixed mice PLoS ONE. 2014; 9 :e88678 Crossref Scopus (254) PubMed Google Scholar ). The scalp and periosteum over the dorsal surface of the skull were removed. A layer of cyanoacrylate adhesive (Krazy glue, Elmer’s Products) was directly applied to the intact skull. A custom made headpost was placed on the skull (approximately over the visual cortex, where a stainless-steel pin was also implanted as a ground reference for electrophysiology) and cemented in place with clear dental acrylic (Lang Dental Jet Repair Acrylic; Part# 1223-clear). A thin layer of clear dental acrylic was applied over the cyanoacrylate adhesive covering the entire exposed skull, followed by a thin layer of clear nail polish (Electron Microscopy Sciences, Part# 72180).
The behavioral task and training have been described ( Guo et al., 2014a 25. Guo, Z.V. ∙ Li, N. ∙ Huber, D. ... Flow of cortical activity underlying a tactile decision in mice Neuron. 2014; 81 :179-194 Full Text Full Text (PDF) Scopus (427) PubMed Google Scholar ; Guo et al., 2014b 26. Guo, Z.V. ∙ Hires, S.A. ∙ Li, N. ... Procedures for behavioral experiments in head-fixed mice PLoS ONE. 2014; 9 :e88678 Crossref Scopus (254) PubMed Google Scholar ). The stimulus was a metal pin (0.9 mm in diameter), presented at one of two possible positions ( Figure 1 A). The two pole positions were 5 mm apart along the anterior-posterior axis and were constant across sessions. The posterior pole position was 5 mm from the whisker pad. A two-spout lickport (4.5 mm between spouts) was used to deliver water rewards and record answer licks.
At the beginning of each trial, the vertical pole moved into reach of the whiskers (0.2 s travel time), where it remained for 1 s, after which it was retracted (retraction time 0.2 s). The sample epoch was defined as the time between the pole movement onset to 0.1 s after the pole retraction onset (sample epoch, 1.3 s, Figure 1 A). Mice touched the object at both pole positions, typically with a different set of whiskers. The delay epoch (duration, 1.7 s) followed the sample epoch. An auditory ‘go’ cue indicated the end of the delay epoch (pure tone, 3.4 kHz, 0.1 s duration). Licking early during the trial was punished by a loud alarm sound (siren buzzer, 0.05 s duration), followed by a brief timeout (1-1.2 s). Licking the correct lickport after the ‘go’ cue led to a liquid reward (2-3 μL). Licking the incorrect lickport triggered a timeout (2-6 s). Trials in which mice did not lick within a 1.5 s window after the ‘go’ cue (‘no lick’) were rare and typically occurred at the end of a session.
Different groups of mice were tested in 4 variants of the task that systematically varied the sensorimotor contingency (the mapping between pole position and directional licking) and the side of tactile stimulus relative to the mouse (stimulating the right or left whisker pad) ( Figure 3 ).
In the standard task (n = 18 mice, 59 sessions for primary experiments with early delay photoinhibition; 4 additional mice were later tested for late delay photoinhibition experiments), the pole stimulated the right whisker pad. Posterior pole position corresponded to “lick right” and anterior pole position corresponded to “lick left.”
In the reversed contingency task (n = 5 mice, 14 sessions), the pole stimulated the right whisker pad. But sensorimotor contingency was reversed where posterior pole position corresponded to “lick left” and anterior pole position corresponded to “lick right.”
In the reversed tactile stimulus task (n = 6 mice, 21 sessions), the pole stimulated the left whisker pad. The sensorimotor contingency was the same as the standard task .
In the fully reversed task (n = 10 mice, 41 sessions), the pole stimulated the left whisker pad and the sensorimotor contingency was also reversed from the standard task .
The standard task and fully reversed task were tested first, and most of the data were collected in these two tasks. The reversed contingency task and reversed tactile stimulus task were tested later to examine the effects of task parameters on interhemispheric organization ( Figure 3 ).
Two CMOS cameras (CM3-U3-13Y3M, FLIR) were used to measure orofacial movements of the mouse under IR illumination (940 nm, Roithner Laser, LED940-66-60). One camera acquired the bottom view of the mouse with a 4–12 mm focal length lens (12VM412ASIR, Tamron) and pixel resolution of 0.065 mm/pixel. The second camera acquired the side view of the mouse with a 4–12 mm focal length lens (12VM412ASIR, Tamron) and pixel resolution of 0.07 mm/pixel. Videos were acquired at 200 Hz framerate using FlyCapture (FLIR).
Light from a 473 nm laser (UltraLasers, MBL-FN-473-300mW) or a 593.5 nm laser (UltraLasers, MGL-N-593.5-200mW) was controlled by an acousto-optical modulator (AOM; Quanta Tech, MTS110-A3-VIS). Photostimulation was performed by directing a focused laser beam over the surface of the brain through a craniotomy (beam diameter: 400 μm at 4 σ). To prevent the mice from distinguishing photostimulation trials from control trials using visual cues, a ‘masking flash’ was delivered using 470 nm or 591 nm LEDs (Luxeon Star) near the eyes of the mice. The masking flash began as the pole started to move and continued through the end of the epoch in which photostimulation could occur.
For photoinhibition of ALM, we photostimulated cortical GABAergic neurons in VGAT-ChR2-EYFP mice or parvalbumin-positive interneurons in PV-IRES-Cre x R26-CAG-LSL-ReaChR-mCitrine mice ( Hooks et al., 2015 32. Hooks, B.M. ∙ Lin, J.Y. ∙ Guo, C. ... Dual-channel circuit mapping reveals sensorimotor convergence in the primary motor cortex J. Neurosci. 2015; 35 :4418-4426 Crossref Scopus (59) PubMed Google Scholar ). The two methods resulted in similar photoinhibition: a single laser spot silenced 90% of spikes in a cortical area of 1 mm radius (at half-max) through all cortical layers ( Li et al., 2019 45. Li, N. ∙ Chen, S. ∙ Guo, Z.V. ... Spatiotemporal constraints on optogenetic inactivation in cortical circuits eLife. 2019; 8 :e48622 Crossref Scopus (101) PubMed Google Scholar ). At 80% activity reduction, photoinhibition with one laser spot covered 58% of ALM in one hemisphere ( Li et al., 2016 44. Li, N. ∙ Daie, K. ∙ Svoboda, K. ... Robust neuronal dynamics in premotor cortex during motor planning Nature. 2016; 532 :459-464 Crossref Scopus (262) PubMed Google Scholar ). This estimate was based on the boundaries of ALM derieved using photoinhibition behavioral data from ( Guo et al., 2014a 25. Guo, Z.V. ∙ Li, N. ∙ Huber, D. ... Flow of cortical activity underlying a tactile decision in mice Neuron. 2014; 81 :179-194 Full Text Full Text (PDF) Scopus (427) PubMed Google Scholar ). ALM was defined as the area where photoinhibition over the entire delay epoch produced significant behavioral effects. ALM boundaries were derived by deconvolving the area producing significant behavioral effects with the point-spread function of the photoinhibition method ( Li et al., 2019 45. Li, N. ∙ Chen, S. ∙ Guo, Z.V. ... Spatiotemporal constraints on optogenetic inactivation in cortical circuits eLife. 2019; 8 :e48622 Crossref Scopus (101) PubMed Google Scholar ; Li et al., 2016 44. Li, N. ∙ Daie, K. ∙ Svoboda, K. ... Robust neuronal dynamics in premotor cortex during motor planning Nature. 2016; 532 :459-464 Crossref Scopus (262) PubMed Google Scholar ). During electrophysiology, photoinhibition was deployed on 40% of the trials to obtain a large number of trials per condition.
We photoinhibited for 0.8 s, including a 200 ms linear ramp during offset to reduce rebound neuronal activity ( Guo et al., 2014a 25. Guo, Z.V. ∙ Li, N. ∙ Huber, D. ... Flow of cortical activity underlying a tactile decision in mice Neuron. 2014; 81 :179-194 Full Text Full Text (PDF) Scopus (427) PubMed Google Scholar ; Li et al., 2019 45. Li, N. ∙ Chen, S. ∙ Guo, Z.V. ... Spatiotemporal constraints on optogenetic inactivation in cortical circuits eLife. 2019; 8 :e48622 Crossref Scopus (101) PubMed Google Scholar ). In most experiments, photoinhibition started at the beginning of the delay epoch and ended 0.9 s before the onset of the ‘go’ cue. Three photoinhibition conditions were tested on randomly interleaved trials: photoinhibition of the left ALM, the right ALM, or both hemispheres. To photoinhibit single ALM hemispheres (e.g., Figure 2 ), we used one laser spot and a 40 Hz photostimulus with a sinusoidal temporal profile (1.5 mW average power). A scanning galvo (GVSM002, Thorlabs) positioned the laser spot on either the left or right ALM (anterior 2.5 mm and lateral 1.5 mm from bregma). To photoinhibit both hemispheres (Figures S2F-K), we used a constant photostimulus and the scanning galvo stepped the laser beam sequentially through 8 photoinhibition sites at the rate of 1 step per 5ms (step time: 0.2 ms; dwell time: 4.8 ms; measured using a photodiode). 8 photoinhibition sites were spaced in 1 mm at anterior 2-3mm and lateral 1-2 mm from bregma, covering ALM and surrounding cortical regions. Peak power was adjusted based on the number of photoinhibition sites to achieve 1.5 mW average power per site. The photoinhibition during scanning was similar to the single laser spot photoinhibition.
In experiments to directly test for state-dependent gating, we unilaterally photoinhibited ALM activity during the late delay epoch ( Figure 5 F-G). This allowed us to estimate the state of ALM hemispheres based on the delay activity prior to photoinhibition and examine their responses to photoinhibition of the contralateral hemisphere. In these sessions, photoinhibition started 0.9 s after the beginning of the delay epoch and ended right before the onset of the ‘go’ cue. Either the left or right ALM were photoinhibited on a subset (50%) of randomly interleaved trials (average power, 0.1-0.5 mW). Since selectivity cannot decrease below 0, we chose to use less power than the standard experiments to avoid driving selectivity to the floor in the weakly selective trials ( Figure 5 F). The fraction of spike rate decrease was < 50% in the photoinhibited hemisphere.
Extracellular spikes were recorded using 64-channel Cambridge NeuroTech silicon probes (H2 acute probe, 25 μm spacing, 2 shanks). The voltage signals were amplified and digitized on an Intan RHD2164 64-Channel Amplifier Board (Intan Technology) at 16 bit, recorded on an Intan RHD2000-Series Amplifier Evaluation System (sampling at 20,000 Hz), and stored for offline analysis.
One day prior to the recording session, two small craniotomies (diameter, < 1 mm) were made over the left and right ALM (2.5 mm anterior, 1.5 mm lateral from bregma) ( Guo et al., 2014a 25. Guo, Z.V. ∙ Li, N. ∙ Huber, D. ... Flow of cortical activity underlying a tactile decision in mice Neuron. 2014; 81 :179-194 Full Text Full Text (PDF) Scopus (427) PubMed Google Scholar ). Two silicon probes were acutely inserted 0.9-1.1 mm below the brain surface prior to the start of each recording session. To minimize brain movement, a drop of silicone gel (3-4680, Dow Corning, Midland, MI) was applied over the craniotomies after the electrodes were in the tissue. The tissue was allowed to settle for several minutes before the recording started. 2 to 8 recordings were made from each craniotomy. The silicon probe was painted with DiI (ThermoFisher scientific, D282), DiR (ThermoFisher scientific, D12731), or DiO (Sigma-Aldrich, D4292) to label the recording tracks. All recording locations within a craniotomy were reconstructed post hoc. Recording depths were inferred from manipulator readings and verified based on histology.
Performance was computed as the fraction of correct choices, excluding early lick trials and no lick trials ( Figures 4-6 and S2, S5). The “lick right” and “lick left” trials were combined to compute performance. Chance performance was 50%. Behavioral effects of photoinhibition were quantified by comparing the performance under photoinhibition with control performance using paired two-tailed t test (Figure S2F).
To quantify the robustness of behavioral performance to unilateral photoinhibition ( Figures 4 and S5), for each session we divided the behavioral performance (fraction correct) in photoinhibition trials by the control trial performance to calculate a relative behavioral performance (photoinhibition/control), or ‘behavioral recovery’. In each session, behavioral recovery was calculated separately for left ALM photoinhibition and right ALM photoinhibition. In Figure 4 I, the behavioral recovery of each unilateral photoinhibition condition was correlated with modularity of the unperturbed hemisphere (each session contributed two data points, left ALM photoinhibition and right ALM photoinhibition).
Previous studies found gamma band increased LFP coherence during communications between brain regions ( Fries, 2005 20. Fries, P. A mechanism for cognitive dynamics: neuronal communication through neuronal coherence Trends Cogn. Sci. 2005; 9 :474-480 Full Text Full Text (PDF) Scopus (2972) PubMed Google Scholar ). We analyzed LFP power spectrum and coherence spectrum between the two ALM hemispheres. The extracellular recording traces were downsampled at 1000 Hz and band-pass filtered (1-100 Hz). Mice contacts with the electrical lickport produced large electrical artifact during licking in the response epoch. We therefore limited the analysis to the sample and delay epochs. Trials in which mice licked early were also excluded. LED masking flash also introduced photoelectric artifact. However, photoelectric artifact was absent in a limited number of sessions. We therefore limited to the analysis to those sessions (n = 7 from 2 mice).
The power spectrum of LFP signals typically falls off proportional to 1/frequency. To reduce the dynamic range and reduce the power leakage from the lower frequencies into the higher frequencies during spectral estimation, we whitened the LFP signals. In the pre-whitening process, a low-order (order = 3) autoregressive (AR) spectrum estimation was used, which could reduce the dynamic range but without fitting specific structural features of the data ( Chen et al., 2017a 10. Chen, G. ∙ Zhang, Y. ∙ Li, X. ... Distinct Inhibitory Circuits Orchestrate Cortical beta and gamma Band Oscillations Neuron. 2017; 96 :1403-1418 e1406 Full Text Full Text (PDF) Scopus (184) PubMed Google Scholar ). We used the Levinson Durbin recursion method to fit the AR model, and the coefficients (Ak) of this process were then used to filter the original time series data (Xt). The residuals: 𝛥 ⁢ 𝑋 ⁢ 𝑡 = 𝑋 ⁢ 𝑡 − ∑ 3 𝑘 = 1 𝑋 ⁢ ( 𝑡 − 𝑘 ) ⁢ 𝐴 ⁢ 𝑘 were subject to the later spectral analysis.
We first normalized the filtered LFP signals (1-100 Hz) by calculating the z-score and performing the pre-whitening as described above. The power spectrum of the LFP was computed by using the multi-taper estimation method in MATLAB with the chronux package ( http://chronux.org ), using 0.8 s data segments (sample and delay epochs) and 3-5 tapers (TW = 3, K = 5). Then, we smoothed the spectrum after removing the 60 Hz line noise. Finally, the power at each frequency was divided by the mean power across all frequency bands (Figure S1I). Power spectrum was average across channels and trials for each session. LFP coherence spectrum (Figure S1I) between left and right ALM hemispheres was calculated using the “coherency” function in the chronux package http://chronux.org .
The extracellular recording traces were band-pass filtered (300-6 kHz). Events that exceeded an amplitude threshold (4 standard deviations of the background) were subjected to spike sorting to extract single units. Spike sorting was either manual ( Guo et al., 2014b 26. Guo, Z.V. ∙ Hires, S.A. ∙ Li, N. ... Procedures for behavioral experiments in head-fixed mice PLoS ONE. 2014; 9 :e88678 Crossref Scopus (254) PubMed Google Scholar ) or using Kilosort2 ( https://www.github.com/MouseLand/Kilosort2 ) ( Pachitariu et al., 2016 50. Pachitariu, M. ∙ Steinmetz, N. ∙ Kadir, S. ... Kilosort: realtime spike-sorting for extracellular electrophysiology with hundreds of channels Adv. Neural Inf. Process. Syst. 2016; 29 :4448-4456 Google Scholar ) followed by manually curated with the Phy 2.0 beta 1 GUI ( https://github.com/cortex-lab/phy ) ( Rossant et al., 2016 55. Rossant, C. ∙ Kadir, S.N. ∙ Goodman, D.F.M. ... Spike sorting for large, dense electrode arrays Nat. Neurosci. 2016; 19 :634-641 Crossref Scopus (455) PubMed Google Scholar ) and manual inspection ( Guo et al., 2014a 25. Guo, Z.V. ∙ Li, N. ∙ Huber, D. ... Flow of cortical activity underlying a tactile decision in mice Neuron. 2014; 81 :179-194 Full Text Full Text (PDF) Scopus (427) PubMed Google Scholar ).
19736 single units were recorded across 135 recording sessions, of which 59 sessions were in the standard task and 41 sessions were in the fully reversed task . Spike widths were computed as the trough-to-peak interval in the mean spike waveform ( Guo et al., 2014a 25. Guo, Z.V. ∙ Li, N. ∙ Huber, D. ... Flow of cortical activity underlying a tactile decision in mice Neuron. 2014; 81 :179-194 Full Text Full Text (PDF) Scopus (427) PubMed Google Scholar ). Units with spike width < 0.35 ms were defined as fast-spiking (FS) neurons (1073/19736) and units with spike widths > 0.45 ms as putative pyramidal neurons (17949/19736). Units with intermediate values (0.35 - 0.45 ms, 714/19736) were excluded. This classification was previously verified by optogenetic tagging of GABAergic neurons ( Guo et al., 2014a 25. Guo, Z.V. ∙ Li, N. ∙ Huber, D. ... Flow of cortical activity underlying a tactile decision in mice Neuron. 2014; 81 :179-194 Full Text Full Text (PDF) Scopus (427) PubMed Google Scholar ). We concentrated our analyses on the putative pyramidal neurons.
Neurons were tested for significant trial-type selectivity during the sample, delay, or response epochs, using the spike counts from the “lick left” and “lick right” trials (Wilcoxon rank sum test, p < 0.05, corrected by Bonferroni-Holm correction for multiple comparisons). Neurons that significantly differentiated trial types during any one of the trial epochs were deemed “selective” (7256/19736). In Figure S1A-C specifically, we used a looser significance criterion (two-tailed t test, p < 0.05, uncorrected for multiple comparison) to enable direct comparisons with previous studies of ALM activity, which used the looser criterion ( Li et al., 2015 43. Li, N. ∙ Chen, T.W. ∙ Guo, Z.V. ... A motor cortex circuit for motor planning and movement Nature. 2015; 519 :51-56 Crossref Scopus (335) PubMed Google Scholar ; Li et al., 2016 44. Li, N. ∙ Daie, K. ∙ Svoboda, K. ... Robust neuronal dynamics in premotor cortex during motor planning Nature. 2016; 532 :459-464 Crossref Scopus (262) PubMed Google Scholar ). This resulted more neurons included in Figure S1A-C (~75% of ALM neurons were deemed selective by this looser criterion).
To compute trial-type selectivity ( Figures 1 , 2 , 4 , and S2-3), we first determined each neuron’s preferred trial type using spike counts from a subset of the control trials (a random split half of the control trials, 30-200 trials, correct trials only), selectivity was calculated as the spike rate difference between preferred over non-preferred trial type on the remaining data (both correct and incorrect trials). Because different splitting of control trials may not always result in consistent preferred trial type, for each neuron the selectivity calculation was performed 30 times (using different splitting of control trials that determined preferred trial type) to obtain an averaged selectivity estimate for each neuron.
Trial types differed in object location (‘stimulus’, anterior versus posterior), lick direction (‘choice’, left versus right), and reward (‘outcome’, rewarded versus unrewarded). We separately computed neuronal selectivity for each variable ( Chen et al., 2017b 11. Chen, T.W. ∙ Li, N. ∙ Daie, K. ... A Map of Anticipatory Activity in Mouse Motor Cortex Neuron. 2017; 94 :866-879 e864 Full Text Full Text (PDF) Scopus (121) PubMed Google Scholar ; Zatka-Haas et al., 2021 70. Zatka-Haas, P. ∙ Steinmetz, N.A. ∙ Carandini, M. ... Sensory coding and causal impact of mouse cortex in a visual decision bioRxiv. 2021; Crossref Scopus (0) Google Scholar ). For each cell, the spike counts within analysis windows were grouped according to trial types (“lick right” correct trials, CR; “lick left” correct trials, CL; “lick right” error trials, ER; “lick left” error trials, EL). The selectivity is calculated from the average spike counts ( ⟨ • ⟩ ) in each group: 𝑆 ⁢ 𝑡 ⁢ 𝑖 ⁢ 𝑚 ⁢ 𝑢 ⁢ 𝑙 ⁢ 𝑢 ⁢ 𝑠 𝑠 ⁢ 𝑒 ⁢ 𝑙 ⁢ 𝑒 ⁢ 𝑐 ⁢ 𝑡 ⁢ 𝑖 ⁢ 𝑣 ⁢ 𝑖 ⁢ 𝑡 ⁢ 𝑦 = ( ⟨ 𝐶 ⁢ 𝑅 ⟩ − ⟨ 𝐸 ⁢ 𝐿 ⟩ ) + ( ⟨ 𝐸 ⁢ 𝑅 ⟩ − ⟨ 𝐶 ⁢ 𝐿 ⟩ ) 2 𝐶 ⁢ ℎ ⁢ 𝑜 ⁢ 𝑖 ⁢ 𝑐 ⁢ 𝑒 𝑠 ⁢ 𝑒 ⁢ 𝑙 ⁢ 𝑒 ⁢ 𝑐 ⁢ 𝑡 ⁢ 𝑖 ⁢ 𝑣 ⁢ 𝑖 ⁢ 𝑡 ⁢ 𝑦 = ( ⟨ 𝐶 ⁢ 𝑅 ⟩ − ⟨ 𝐸 ⁢ 𝑅 ⟩ ) + ( ⟨ 𝐸 ⁢ 𝐿 ⟩ − ⟨ 𝐶 ⁢ 𝐿 ⟩ ) 2 𝑂 ⁢ 𝑢 ⁢ 𝑡 ⁢ 𝑐 ⁢ 𝑜 ⁢ 𝑚 ⁢ 𝑒 𝑠 ⁢ 𝑒 ⁢ 𝑙 ⁢ 𝑒 ⁢ 𝑐 ⁢ 𝑡 ⁢ 𝑖 ⁢ 𝑣 ⁢ 𝑖 ⁢ 𝑡 ⁢ 𝑦 = ( ⟨ 𝐶 ⁢ 𝑅 ⟩ − ⟨ 𝐸 ⁢ 𝑅 ⟩ ) + ( ⟨ 𝐶 ⁢ 𝐿 ⟩ − ⟨ 𝐸 ⁢ 𝐿 ⟩ ) 2
Stimulus selectivity represents the object location-selective response of the posterior trials (CR, ER) relative to the anterior trials (CL, EL). Choice selectivity represents the lick direction-selective response present in trials when the mouse licked right (CR, EL) compared to trials when the mouse licked left (CL, ER). Outcome selectivity represents the response present in the correct trials (CR, CL) relative to the error trials (ER, EL) ( Figures 1 , 2 , and S1). This selectivity calculation was performed in analysis windows of 200ms during different times of the task (in 1 ms steps). For each neuron, its preferred and non-preferred trial type for each variable was determined using spike counts from a subset of the control trials. Selectivity was calculated as the spike rate difference between preferred over non-preferred trial type on the remaining data.
For each neuron, we also quantified the significance of selectivity based on the spike counts of individual trials at each time bins ( Figure 1 C)( Steinmetz et al., 2019 62. Steinmetz, N.A. ∙ Zatka-Haas, P. ∙ Carandini, M. ... Distributed coding of choice, action and engagement across the mouse brain Nature. 2019; 576 :266-273 Crossref Scopus (331) PubMed Google Scholar ; Zatka-Haas et al., 2021 70. Zatka-Haas, P. ∙ Steinmetz, N.A. ∙ Carandini, M. ... Sensory coding and causal impact of mouse cortex in a visual decision bioRxiv. 2021; Crossref Scopus (0) Google Scholar ). Trial types were grouped as the following: stimulus selective, CR compared to EL and ER compared to CL; choice selective, CR compared to ER and EL compared to CL; outcome selective, CR compared to ER and CL compared to EL. For each group, the probability that spike counts in the preferred trial type is larger than the non-preferred trial type was calculated across all possible trial pairs. The statistical significance was calculated from shuffle test, in which the trial types were randomly permuted 1000 times. The p value is the fraction of times in which the probability (preferred > non-preferred trial type) in the shuffling dataset was larger than the actual dataset.
To quantify the modularity of each ALM hemisphere ( Figures 2-4 and S3, S5), we calculated the fraction of trial-type selectivity retained in a hemisphere during photoinhibition of the other hemisphere (the first 0.8 s of the delay epoch). Selectivity during the photoinhibition epoch was divided by the control trial selectivity during the same epoch. Sessions in which recording in one of the hemispheres had poor yield (n < 5 delay selective single units, 6 sessions) or poor control trial selectivity (average selectivity < 0.5 spikes/s during the early delay epoch or < 1 spikes/s during the late delay epoch, 15 sessions) were not included in the analysis. Poor selectivity and poor yield produced noisy estimates of modularity. However, including these sessions did not qualitatively change the results. The modularity values were capped between 0 and 1, where a few sessions that had modularity values below 0 or above 1 were set to 0 and 1 to bound the outlier sessions in the plots ( Figures 2-4 ). All the key results remain the same without this bound.
Modularity of each hemisphere varied across individual sessions ( Figures 2-4 and S3, S5). To examine whether the variability in modularity was due to variable sampling of neurons in silico n probe recordings, we estimated the variability of modularity arising from neurons sampling using bootstrap (Figure S3F). For each round of bootstrap, we generated a resampled dataset in which we resampled (with replacement) the neurons within each session, while keeping the same number of neurons in each session. We then computed the modularity of each session in the resampled dataset. This procedure was repeated 10,000 times. The sampling variability for each session was calculated as the standard deviation in modularity across the 10,000 rounds of bootstrap. Finally, the sampling variability was averaged across sessions. The variability of modularity across sessions was significantly larger than the sampling variability (Figure S3G, p < 0.001). This p value was the probability of observing a smaller across-sessions variability than the average sampling variability in the bootstrap resampled dataset. Using this p value calculation, we performed power analysis on neuron sampling. We repeated the bootstrap procedure while reducing the number of neurons resampled per session. We found that 10 or more delay selective neurons per session had enough statistical power (at a significance criterion of p < 0.01) to detect differences in modularity across sessions. Our actual dataset contained 26 or more delay selective neurons per session from each hemisphere.
To quantify recovery of neuronal selectivity from photoinhibition ( Figures 4 and S5), we calculated trial-type selectivity during the last time bin before the ‘go’ cue (last 200 ms of the delay epoch). For each session, the selectivity in photoinhibition trials were averaged across all delay selective neurons (see criteria above), and divided by the control trial selectivity to quantify the fraction of selectivity recovered. Because the recovery of the left ALM and right ALM after photoinhibition was coordinated (e.g., Figures 4 B-C, both hemispheres always recovered similar fraction of selectivity), for each session we averaged the fraction of selectivity recovered in both hemispheres. We calculated the fraction of selectivity recovered separately for left ALM photoinhibition and right ALM photoinhibition conditions. In Figures 4 and S5, the fraction of selectivity recovered after unilateral photoinhibition was correlated with modularity of the unperturbed hemisphere (each session contributed two data points, left ALM photoinhibition and right ALM photoinhibition).
To examine choice encoding by a population of ALM neurons, we built linear choice decoders that were weighted sums of ALM neuron activity to best predict future lick direction, with separate choice decoders for the left and right ALM. On single trials, each choice decoder summed the underlying neuron activities to signal “lick right” or “lick left” ( Figure 1 D). We restricted the analysis to the recording sessions with > 5 neurons recorded simultaneously in each hemispheres and for > 5 trials per condition (135/135 sessions).
To build the choice decoder for a population of n ALM neurons, we found a n × 1 vector CD in the n dimensional activity space that maximally separates the response vectors in “lick right” trials and “lick left” trials based on the activity during the delay epoch. To estimate CD , we first esimated CD t at different time points during the delay epoch (in 10 ms steps) using part of control trials (correct trials only). Average spike counts were computed in 400-ms windows in 10-ms steps. For each trial type (“lick right” and “lick left”) we computed the average spike counts ̅ 𝒙 𝑙 ⁢ 𝑖 ⁢ 𝑐 ⁢ 𝑘 𝑟 ⁢ 𝑖 ⁢ 𝑔 ⁢ ℎ ⁢ 𝑡 and ̅ 𝒙 𝑙 ⁢ 𝑖 ⁢ 𝑐 ⁢ 𝑘 𝑙 ⁢ 𝑒 ⁢ 𝑓 ⁢ 𝑡 , n × 1 response vectors that described the population response at each time point, t . CD t is the difference in the mean response vectors: 𝑪 ⁢ 𝑫 𝒕 = ̅ 𝒙 𝑙 ⁢ 𝑖 ⁢ 𝑐 ⁢ 𝑘 𝑟 ⁢ 𝑖 ⁢ 𝑔 ⁢ ℎ ⁢ 𝑡 − ̅ 𝒙 𝑙 ⁢ 𝑖 ⁢ 𝑐 ⁢ 𝑘 𝑙 ⁢ 𝑒 ⁢ 𝑓 ⁢ 𝑡
During the delay epoch, the direction of CD t was stable (correlation of CD t ’s between the early delay epoch versus late delay epoch, 0.80 ± 0.01, mean ± SEM). We averaged the CD t ’s from the delay epoch to obtain one CD . This fixed CD was used for activity projections in all relevant analysis.
The projection along CD captured 74.6 ± 1.1% of the population selectivity for “lick left” and “lick right” trials over the sample and delay epoch (root mean square, RMS, of the spike rate difference between “lick right” trials and “lick left” trials), and 26.1 ± 1.4% of the total variance in ALM task-related activity. Activity variance was quantified as the RMS of the baseline subtracted activity over the sample and delay epoch. We also considered other linear decoders, such as linear discriminant analysis (LDA), logistic regression, or support vector machine, and found them to be similar in decoding performance. Decoders that consider within-group covariance (e.g., LDA) did not substantially improve decoding performance likely because the number of trials is relatively small compared to the number of neurons (average 71 neurons in each hemisphere), leading to noisy estimates of the covariance.
Next, we projected ALM activity on the choice decoder CD . For each trial we computed the spike counts for individual neurons, x ( n × 1 response vector), at each time point. The projected trajectories were obtained as 𝑪 ⁢ 𝑫 𝑇 ⁢ 𝒙 ( Figure 1 E). To examine correlated choice encoding between ALM hemispheres ( Figures 1 F-G), for each session we took the single trial trajectory values at the last time bin before the ‘go’ cue (last 400 ms of the delay epoch) and calculated Spearman’s rank correlation between the left ALM trajectory values and right ALM trajectory values. We calculated rank correlation using trials from the same trial type ( Figure 1 G, “lick right” or “lick left” trials) or using both trial types of the session ( Figure 1 G, ‘both’). For shuffled control, we randomized the trial identity of activity data in each hemisphere and calculated Spearman’s rank correlation on the shuffled data.
To average CD trajectories changes across multiple sessions ( Figure 5 F), we first offset and normalized the trajectories for a particular session by subtracting the mean 𝑪 ⁢ 𝑫 𝑇 ⁢ 𝒙 across all trials and time points in that session and then divided by the standard deviation of the 𝑪 ⁢ 𝑫 𝑇 ⁢ 𝒙 . This removed fluctuations of mean activity level from session to session.
To predict upcoming lick direction using the choice decoder CD ( Figure 1 H), we calculated ALM activity projection on the choice decoder, 𝑪 ⁢ 𝑫 𝑇 ⁢ 𝒙 , from the last time bin before the ‘go’ cue (last 400 ms of the delay epoch). For each session we computed a decsion boundary to best separate the “lick right” and “lick left” trials: 𝐷 ⁢ 𝑒 ⁢ 𝑐 ⁢ 𝑖 ⁢ 𝑠 ⁢ 𝑖 ⁢ 𝑜 ⁢ 𝑛 𝑏 ⁢ 𝑜 ⁢ 𝑢 ⁢ 𝑛 ⁢ 𝑑 ⁢ 𝑎 ⁢ 𝑟 ⁢ 𝑦 = ⟨ 𝑪 ⁢ 𝑫 𝑇 ⁢ 𝒙 𝑙 ⁢ 𝑖 ⁢ 𝑐 ⁢ 𝑘 𝑟 ⁢ 𝑖 ⁢ 𝑔 ⁢ ℎ ⁢ 𝑡 ⟩ / 𝜎 2 𝑙 ⁢ 𝑖 ⁢ 𝑐 ⁢ 𝑘 𝑟 ⁢ 𝑖 ⁢ 𝑔 ⁢ ℎ ⁢ 𝑡 + ⟨ 𝑪 ⁢ 𝑫 𝑇 ⁢ 𝒙 𝑙 ⁢ 𝑖 ⁢ 𝑐 ⁢ 𝑘 𝑙 ⁢ 𝑒 ⁢ 𝑓 ⁢ 𝑡 ⟩ / 𝜎 2 𝑙 ⁢ 𝑖 ⁢ 𝑐 ⁢ 𝑘 𝑙 ⁢ 𝑒 ⁢ 𝑓 ⁢ 𝑡 1 / 𝜎 2 𝑙 ⁢ 𝑖 ⁢ 𝑐 ⁢ 𝑘 𝑟 ⁢ 𝑖 ⁢ 𝑔 ⁢ ℎ ⁢ 𝑡 + 1 / 𝜎 2 𝑙 ⁢ 𝑖 ⁢ 𝑐 ⁢ 𝑘 𝑙 ⁢ 𝑒 ⁢ 𝑓 ⁢ 𝑡
σ 2 is the variance of the projection values 𝑪 ⁢ 𝑫 𝑇 ⁢ 𝒙 across multiple “lick right” or “lick left” trials. Both the CD and decision boundary were computed using independent control trials (correct trials only). Separate control trials were used to predict mice’s lick direction ( Figure 1 H, right, both correct and incorrect trials). To read out the choice encoding in one hemisphere from the other hemisphere ( Figure 1 H, left), we calculated the fraction of trials in which both hemispheres predicted the same lick direction.
To infer the strength of interhemispheric influence in control trials, we devised a model of ALM delay activity. The model predicted single-trial activity in a particular time bin from past activity of the same hemisphere and activity in the other hemisphere. To improve signal-to-noise ratio, we used the model to predict the projection of ALM population activity on the choice decoder in each hemisphere. Although the model output was prediction of the activity projection on the choice decoder, the input for the model was not limited to the activity projection on the choice decoder but also included activity projections on the top three principal components of population activity that were orthogonal to the choice decoder (see Modeling training below). The choice decoder and principal components were estimated based on population activity during the delay epoch (see Population choice encoding above). Including more principal components did not significantly improve the prediction performance.
For each hemisphere, our predictive model was defined by the following equation: 𝑋 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑡 + 1 , 0 = ∑ 𝑙 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑝 = 0 ∑ 𝑛 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑖 = 0 𝛼 𝑝 , 𝑖 ⁢ 𝑋 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑡 − 𝑝 , 𝑖 + ∑ 𝑙 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 𝑞 = 1 ∑ 𝑛 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 𝑗 = 0 𝛽 𝑞 , 𝑗 ⁡ ( 𝑧 𝑡 ) ⁢ 𝑋 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 𝑡 − 𝑞 , 𝑗 + 𝑏 ,
where the ‘analyzed hemisphere’ refers to the hemisphere in which the model predicts activity, and the ‘contra hemisphere’ refers to the other hemisphere. 𝑋 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑡 , 0 refers to the activity projection on the choice decoder at time t in the analyzed hemisphere. 𝑋 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑡 , 𝑖 , for 𝑖 = 1 , 2 , 𝑜 ⁢ 𝑟 ⁢ 3 , refers to the activity projection on the i- th principal component, and similarly 𝑋 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 𝑡 , 𝑖 refers to the activity in the contra hemisphere. 𝑙 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 and 𝑙 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 are the number of time steps in past activity that were used to predict current activity. 𝑛 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 and 𝑛 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 are the number of activity components used to predict choice encoding activity. Importantly, 𝛼 𝑝 , 𝑖 and 𝛽 𝑝 , 𝑖 denote the regression coefficients for i -th activity component at time lag 𝑝 . The values of 𝛽 𝑝 , 𝑖 ⁡ ( 𝑧 𝑡 ) depend on a state variable 𝑧 𝑡 (see State-dependent gating below). Finally, 𝑏 is a bias term. We computed firing rates using 400ms wide bins with a 100ms bin stride, i.e., the size of the timestep in the equation above was 100ms. Using different bin width or stride did not qualitatively change our results.
To infer state dependence of interhemispheric influence, we allowed 𝛽 𝑞 , 𝑗 at each time point t to take one of two values depending on the binary state of a variable 𝑧 𝑡 , but without enforcing the values of 𝛽 𝑞 , 𝑗 . The 𝛽 𝑞 , 𝑗 values were obtained by training the model on neural data to best predict ALM activity (see Model training ). In this model setup, 𝛽 𝑞 , 𝑗 could take on any value across states to provide the best prediction of ALM activity. We then examined the 𝛽 𝑞 , 𝑗 values and the interhemispheric influence the model inferred (see Interhemispheric influence) .
The state variable 𝑧 𝑡 corresponded to the strength of choice encoding activity within the analyzed hemisphere. For “lick right” trials, 𝑧 𝑡 was in the “highly selective” state if the activity projection on the choice decoder at time point t was greater than a positive threshold, and otherwise in the “weakly selective” state ( Figures 5 B-C). For “lick left” trials, choice encoding is stronger when the activity projection on the choice decoder takes large negative values. Thus, 𝑧 𝑡 was in the “highly selective” state if the activity projection was smaller than a negative threshold ( Figures 5 B-C). In other words, 𝑧 𝑡 was in the “highly selective” state only if the activity projection was far from the decision boundary that separated “lick left” and “lick right” and also on the correct side of the decision boundary for a given trial type. Our choice of the state variable 𝑧 𝑡 was based on the observation that choice encoding was normally strong during the delay epoch in control trials (the presumed “highly selective” state) and rendered weak in photoinhibition trials (the presumed “weakly selective” state). The threshold for each trial type was the median of the activity projection on the choice decoder during the late delay epoch. The thresholds were estimated using trials that were used to train other model parameters (training data).
The model was trained using 5-fold cross-validated ridge regression, with a regularization strength that achieved the best validation performance. We first trained a within-hemisphere model , which did not include input from the contra hemisphere. We then subtracted the prediction of the within-hemisphere model from ALM activity and predicted the residuals using input from the contra hemisphere. To train the switching linear coefficients 𝛽 𝑞 , 𝑗 ⁡ ( 𝑧 𝑡 ) , we divided training samples into 2 groups based on their values of 𝑧 𝑡 , and performed ridge regression separately for each group.
However, due to strong autocorrelation in single-trial activity (e.g., Figures 1 E and 5 C), the input variables 𝑋 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑡 − 𝑝 , 𝑖 and 𝑋 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 𝑡 − 𝑞 , 𝑗 tended to be highly correlated across time lags, which may render ridge regression less effective. Therefore, to reduce the correlation across the input variables, we made a change of variables such that the resulting input variables were the temporal difference of the original input variables: 𝑋 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑡 − 𝑝 , 𝑖 → 𝑋 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑡 − 𝑝 , 𝑖 − 𝑋 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑡 − ( 𝑝 + 1 ) , 𝑖 for 𝑝 < 𝑙 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 , and 𝑋 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 𝑡 − 𝑞 , 𝑖 → 𝑋 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 𝑡 − 𝑞 , 𝑖 − 𝑋 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 𝑡 − ( 𝑞 + 1 ) , 𝑖 for 𝑞 < 𝑙 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 . For the same reason, we predicted the temporal change in activity 𝑉 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑡 instead of 𝑋 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑡 + 1 , 0 . These steps were taken in order to better predict the part of future activity that cannot be trivially predicted due to autocorrelation with past activity. After the change of variables, the model was described by the following equation: 𝑉 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑡 ≡ 𝑋 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑡 + 1 , 0 − 𝑋 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑡 , 0 = ∑ 𝑙 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑝 = 0 ∑ 𝑛 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑖 = 0 𝛼 𝑝 , 𝑖 ⁢ ̃ 𝑋 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑡 − 𝑝 , 𝑖 + ∑ 𝑙 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 𝑞 = − 1 ∑ 𝑛 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 𝑗 = 0 𝛽 𝑞 , 𝑗 ⁡ ( 𝑧 𝑡 ) ⁢ ̃ 𝑋 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 𝑡 − 𝑞 , 𝑗 + 𝑏 , ̃ 𝑋 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑡 − 𝑝 , 𝑖 = ⎧ { ⎨ { ⎩ 𝑋 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑡 − 𝑝 , 𝑖 − 𝑋 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑡 − ( 𝑝 + 1 ) , 𝑖 𝑝 < 𝑙 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑋 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑡 − 𝑝 , 𝑖 𝑝 = 𝑙 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 ̃ 𝑋 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 𝑡 − 𝑞 , 𝑖 = { 𝑋 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 𝑡 − 𝑞 , 𝑖 − 𝑋 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 𝑡 − ( 𝑞 + 1 ) , 𝑖 𝑞 < 𝑙 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 𝑋 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 𝑡 − 𝑞 , 𝑖 𝑞 = 𝑙 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎
We found that using past activity from multiple time lags in the analyzed hemisphere ( 𝑙 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 = 7 ) , and to a lesser extent, in the contra hemisphere ( 𝑙 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 = 2 ) , improved the prediction performance. We restricted the model analysis to ALM delay activity. To allow for a sufficient number of time lags within the delay epoch, we chose to predict activity ( 𝑉 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑡 ) during the late delay epoch (from −0.9 s to the last time bin before the ‘go’ cue, −0.2 s). To account for the possibility that the timescale of interhemispheric interactions may be faster than the size of the timestep, we also included the contra-hemisphere activity at the same time step as the analyzed-hemisphere activity that we predicted (note that in ∑ 𝑙 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 𝑞 = − 1 ∑ 𝑛 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 𝑗 = 0 𝛽 𝑞 , 𝑗 ⁡ ( 𝑧 𝑡 ) ⁢ ̃ 𝑋 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 𝑡 − 𝑞 , 𝑗 , q starts from −1 instead of 0). This indeed moderately improved the prediction performance. We used the activity projections on the choice decoder and three principal components as input in the contra hemisphere ( 𝑛 𝑐 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑟 ⁢ 𝑎 = 3 ) , while using only the choice decoder activity as input in the analyzed hemisphere ( 𝑛 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 = 0 ) to minimize overfitting. Excluding the three principal components from the contra hemisphere’s input and varying the number of input time lags or activity components used for activity prediction did not qualitatively change the results. To avoid potential confounds due to temporal correlations of activity, training and test samples were taken from separate sets of trials.
To infer the strength of interhemispheric influence, we tested how much model predictions improved if the model included the other hemisphere’s activity as input. To measure the model’s prediction performance, we computed the 5-fold cross-validated R 2 . The predicted and actual activity ( 𝑉 𝑎 ⁢ 𝑛 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑦 ⁢ 𝑧 ⁢ 𝑒 ⁢ 𝑑 𝑡 ) was aggregated across time for each trial type to compute a R 2 . The R 2 values from the two trial types and 5-fold train-test splits were then averaged. Our measure of influence from the contra to analyzed hemisphere was the difference in R 2 (“ΔR 2 ”) between the within-hemisphere model (without input from the contra hemisphere) and the full model (incorporates input from the contra hemisphere). In a few analyzed hemispheres, calculating ΔR 2 resulted in negative values, which likely resulted from overfitting and low signal-to-noise ratios. In those cases, the ΔR 2 was set to 0. All the key results remain the same without this clipping. For comparison of ΔR 2 in the weakly and highly selective states ( Figures 5 E and 6 A), we evaluated ΔR 2 separately for test samples in the two states. To examine whether ΔR 2 captured the influence from the other hemisphere, we shuffled the trial identity of the left and right ALM recording data. ΔR 2 vanished when shuffling trials of the contra hemisphere’s activity (Figure S6B). The potency of state-dependent gating ( Figure 6 B) was defined as the difference of ΔR 2 between the weakly and highly selective states for each analyzed hemisphere and averaged over the two hemispheres. This measured how much interhemispheric influence was modulated by states.
In Figure 5 D, we used the interhemispheric input inferred using the coefficients 𝛽 of the model ( 𝛽 was inferred from control trials) to predict neuronal and behavioral recovery after photoinhibition. The interhemispheric input to the perturbed hemisphere after a photoinhibition ( Figure 5 D) was computed by multiplying the remaining selectivity in the unperturbed hemisphere with the interhemispheric coefficients 𝛽 . The 𝛽 values in the weakly selective state of the model were used, as the analyzed hemisphere was rendered weakly selective by ipsilateral photoinhibition. 𝛽 ’s at different time lags were averaged. The remaining selectivity was the activity difference between the “lick left” and “lick right” trials, averaged over the photoinhibition epoch. The product of activity difference with the interhemispheric coefficient for each activity component was summed over all components to yield the inferred interhemispheric input. The selectivity recovery was the activity difference between “lick left” and “lick right” trials on the choice decoder in the first time bin (400ms) after photoinhibition.
In Figure S6C, we examined the asymmetry of interhemispheric input inferred from control trials. We limited this analysis to the first 0.8 s of the delay epoch. This was matched to the epoch of photoinhibition by which the asymmetry of modularity was measured in the experiment ( Figure 2 ). The interhemispheric input to each hemisphere (analyzed hemisphere) was the product of the interhemispheric coefficients 𝛽 in the model and the control-trial selectivity in the contra hemisphere. The 𝛽 values in the weakly and highly selective states in the model were averaged for this analysis to obtain an average interhemispheric input strength. 𝛽 ’s at different time lags were also averaged. This inferred interhemispheric input was normalized to the control-trial selectivity of the analyzed hemisphere during the same epoch. The normalized interhemispheric input (Figure S6C) quantified the contribution from the other hemisphere relative to the total selectivity in the analyzed hemisphere. The larger the normalized interhemispheric input was to an analyzed hemisphere, the smaller the modularity of the analyzed hemisphere was. In Figure S6C, we found a larger normalized interhemispheric input from the left ALM to right ALM in the standard task, but the opposite in the fully reversed task. This pattern of asymmetry is consistent with the asymmetry of modularity measured from photoinhibition ( Figure 3 ).
In Figure S6D, we compared the magnitude of interhemispheric coefficient 𝛽 in the weakly and highly selective states. Because the interhemispheric coefficient 𝛽 𝑞 , 𝑗 was a vector coefficient that span several activity components, the magnitude of interhemispheric coefficient was calculated as the L1 norm of 𝛽 𝑞 , 𝑗 (the sum of the absolute value of 𝛽 𝑞 , 𝑗 over 𝑞 and 𝑗 ) for each state.
To directly test for state-dependent gating, we unilaterally photoinhibited ALM activity during the late delay epoch ( Figure 5 F-G). This allowed us to estimate the state of ALM hemispheres based on the delay activity prior to photoinhibition and examine their responses to contralateral photoinhibition.
In each trial, we computed the CD projections using spike counts in a 0.5 s window before the onset of photoinhibition. Trials were then classified as “weakly selective” or “highly selective” based on the strength of CD projections. We set a threshold for each trial type (“lick right” and “lick left”) as the median of CD projections during the 0.5 s window before photoinhibition onset (similar to Figure 5 C). The trials with CD projections far away from the decision boundary and exceeding the median threshold were classified as “highly selective.” Trials on the correct side of the decision boundary but below the median threshold were classified as “weakly selective” ( Figure 5 F). A small minority of trials with CD projections on the wrong side of the decision boundary were discarded from the analysis because there was little selectivity to test for the effect of contralateral photoinhibition, though including these trials did not qualitatively change the results.
We quantified the effect of contralateral photoinhibition as the difference in CD projections between photoinhibition and control trials. The change in CD projections was averaged across all “weakly selective” trials (both “lick left” and “lick right” trials) or “highly selective” trials ( Figure 5 G).
We explored conditions in which modular and asymmetric interhemispheric interactions arise through learning by training recurrent neural networks (RNNs) to perform the delayed response task. The RNNs were defined by the equation: 𝜏 ⁢ 𝑑 ⁢ 𝒓 𝑑 ⁢ 𝑡 = − 𝒓 + 𝑓 ⁢ ( 𝑊 𝑟 ⁢ 𝑒 ⁢ 𝑐 ⁢ 𝒓 + 𝑊 𝑖 ⁢ 𝑛 ⁢ 𝒖 + 𝒃 + 𝝃 )
In this equation, 𝜏 is the unit time constant, 𝒓 represents the population activity of 𝑁 units, 𝑓 ⁡ ( ⋅ ) is the unit nonlinearity, 𝒖 is an external input to these units, 𝒃 is the bias or background input, and 𝝃 represents an i.i.d. Gaussian noise to individual units. The 𝑁 units were divided into two modules, which simulated the left and right hemispheres of ALM. 𝑊 𝑟 ⁢ 𝑒 ⁢ 𝑐 is an 𝑁 × 𝑁 matrix representing the recurrent connectivity weights, which include both within-module and between-module weights, and 𝑊 𝑖 ⁢ 𝑛 an 𝑁 × 1 vector representing the input weights.
Mirroring the delayed response task mice performed, the RNNs received a trial type selective input during a sample epoch of 1.3 s, and had to wait for a delay epoch of 1.7 s before reporting their choice through a linear readout in each module ( Figure 7 A).
The trial type input 𝒖 at each time point during the sample epoch was generated by sampling from an i.i.d. Gaussian distribution 𝑁 ⁡ ( 𝜇 , 𝜎 ) with 𝜇 = 0 . 1 5 , 𝜎 = 1 for “lick right” trials and 𝜇 = − 0 . 1 5 , 𝜎 = 1 for “lick left” trials. An i.i.d. Gaussian noise with zero mean and a standard deviation of 0.2 (distinct from 𝝃 delivered to individual units) was then added to the input throughout the sample and delay epochs. Note that even though the distributions of the input for the two trial types significantly overlap at any single time point, integrating the input over time renders the two trial types distinguishable. The values of 𝜇 and 𝜎 for each trial type and the strength of the input noise were chosen to approximately match the task performance of mice.
For results reported in the paper, the RNNs contained 𝑁 = 2 5 6 units with the Tanh nonlinearity and 𝜏 = 5 0 ms. The Gaussian noise 𝜉 had zero mean with a standard deviation of 0.2. But the results were largely insensitive to the number of units, strength of noise, or exact shape of the neuronal nonlinearity, as long as its slope decreases for larger inputs (e.g., as in nonlinear functions of the form 𝑓 ⁡ ( 𝑥 ) ∼ 𝑥 1 / 𝑛 ). The continuous RNN equation above was discretized with the 25ms step size for simulation.
The RNNs were trained by backpropagation through time. We minimized the binary cross entropy loss function between a sigmoid function applied to the linear readout of each module and the binary trial type label using gradient descent. To facilitate the training (in particular to mitigate the vanishing gradient problem), the binary cross entropy loss function was minimized not just at the end of the delay epoch but throughout the delay epoch. In addition, we only trained the recurrent weights 𝑊 𝑟 ⁢ 𝑒 ⁢ 𝑐 and bias 𝒃 while keeping all other weights such as 𝑊 𝑖 ⁢ 𝑛 and the linear readouts frozen. 𝑊 𝑖 ⁢ 𝑛 was randomly initialized with an i.i.d. Gaussian distribution 𝑁 ⁡ ( 0 , 1 ) and the linear readout in each module with 𝑁 ⁡ ( 0 , 1 √ 𝑁 ⁡ / 2 ) (the initialization of 𝑊 𝑟 ⁢ 𝑒 ⁢ 𝑐 is explained below, see Conditions for robust RNNs ). We did not find that the training of 𝑊 𝑖 ⁢ 𝑛 and the linear readouts substantially changed our results. Importantly, no perturbations were applied during training. The RNNs and their training were implemented in Pytorch ( Paszke et al., 2019 52. Paszke, A. ∙ Gross, S. ∙ Massa, F. ... PyTorch: An Imperative Style, High-Performance Deep Learning Library Wallach, H. ∙ Larochelle, H. ∙ Beygelzimer, A. (Editors) Advances in Neural Information Processing Systems 32 Curran Associates, Inc., 2019; 8024-8035 Google Scholar ).
The trained RNNs exhibited qualitatively similar dynamics to the neuronal data ( Figure 7 B). To examine their choice-selective activity, we trained a linear choice decoder for each module in the same manner as for the neuronal data. Specifically, we computed the trial-average difference of population activity between the two trial types (only using correct trials in the training set) and normalized it at each time point during the delay epoch and averaged these directions across the delay epoch. The resulting choice decoders generally did not coincide with the linear readouts, but they had positive inner products. Most of variance in RNN activity was explained by the choice decoders (95.4 ± 1.0% variance explained, n = 30 models).
To probe the modularity and robustness of the trained RNNs to perturbations, we applied perturbations that mimicked the optogenetic photoinhibition of ALM. The activity of all units in the perturbed module was clamped to zero to simulate photoinhibition. The photoinhibition period lasted for 0.8 s after the onset of the delay epoch. Consistent with the neuronal data, the RNNs did not recover their trial-type selectivity after bilateral photoinhibition. However, trained RNNs were robust to unilateral photoinhibition of their activity when three conditions were met ( Figures 7 B and S7A-B): modular initialization, modular training, nonlinearity.
Modular initialization refers to initializing the between-module connections weaker than the within-module connections. Concretely, we randomly initialized the within-module weights with an i.i.d. Gaussian distribution 𝑁 ⁡ ( 0 , 1 √ 𝑁 ) , and the between-module weights with 𝑁 ⁡ ( 0 , 𝑝 √ 𝑁 ) , where 𝑝 < 1 . Modular training refers to training the within-module weights first while keeping the between-module weights frozen. For the results reported in the paper, we kept the between-module weights frozen throughout the training, but we found that training the between-module weights after the within-module weights has been stabilized did not make much difference. Lastly, the condition of nonlinearity requires that the neuronal input-output function be nonlinear, as in the Tanh function. For visualization of the activity projections on the choice decoder in Figure 7 B, we used the RNNs that were modular-trained with the modular-initialization parameter 𝑝 = 0 . 2 and the Tanh nonlinearity. Qualitatively similar results were obtained when using a power-law nonlinearity that does not have a bounded dynamic range like the Tanh nonlinearity.
The various model and training parameters explored are shown in Figure S7B. To evaluate the trained models, we computed a robustness index that measured each model’s modular organization and its robustness to perturbations. Robustness index was defined as (modularity + selectivity recovery)/2 for each module within a model and averaged across modules. The modularity of a module was the fraction of selectivity (i.e., activity difference between trial types on the choice decoder) retained during photoinhibition of the other module, as for the neuronal data. Unless specified otherwise, the selectivity recovery of a module was the fraction of selectivity recovered after photoinhibition of that module up until the end of the delay epoch. The normalized initial interhemispheric connection strength in Figure S7B refers to the modular-initialization parameter 𝑝 . For each value of model and training parameters, 30 randomly initialized RNNs were trained.
We examined whether the robust RNNs gate between-module influences in a state-dependent manner as observed in the neuronal data. Since we knew the precise recurrent weights 𝑊 𝑟 ⁢ 𝑒 ⁢ 𝑐 , we could directly compute how activity in one module is affected by change in activity in the other module. This corresponds to the gradient of activity in one module with respect to activity in the other module, which can be evaluated from the RNN equation. To focus on choice encoding activity, we projected this gradient on the choice decoder in each module. The projected gradient is given by the equation: 𝑔 ⁡ ( 𝑥 , 𝑦 ) = ∂ ∂ 𝑦 ⁢ ( 𝒄 ⁢ 𝒅 𝑇 𝒂 𝒏 𝒂 𝒍 𝒚 𝒛 𝒆 𝒅 ⁢ 𝑓 ⁢ ( 𝑊 𝑟 ⁢ 𝑒 ⁢ 𝑐 ⁢ ( 𝒄 ⁢ 𝒅 𝒂 𝒏 𝒂 𝒍 𝒚 𝒛 𝒆 𝒅 ⁢ 𝑥 + 𝒄 ⁢ 𝒅 𝒄 𝒐 𝒏 𝒕 𝒓 𝒂 ⁢ 𝑦 + ̅ 𝒓 𝒏 𝒐 𝒏 − 𝒄 𝒉 𝒐 𝒊 𝒄 𝒆 ) + 𝒃 ) )
In this equation, 𝒄 ⁢ 𝒅 𝒂 𝒏 𝒂 𝒍 𝒚 𝒛 𝒆 𝒅 and 𝒄 ⁢ 𝒅 𝒄 𝒐 𝒏 𝒕 𝒓 𝒂 refer to the choice decoders in the analyzed and contra modules respectively, 𝑥 and 𝑦 are the activity projections on the choice decoders in the analyzed and contra module respectively, and ̅ 𝒓 𝒏 𝒐 𝒏 − 𝒄 𝒉 𝒐 𝒊 𝒄 𝒆 is the average population activity after projecting out the choice decoders. We did not include the external input in calculating the gradient since it was absent during the delay epoch. The interhemispheric influence, 𝑔 ⁡ ( 𝑥 , 𝑦 ) , was evaluated in Pytorch for a grid of 𝑥 and 𝑦 values and visualized in Figure 7 C.
To compare the interhemispheric influence in highly selective and weakly selective state in the analyzed hemisphere ( Figures 7 C and S7F-G), we calculated 𝑔 ⁡ ( 𝑥 , 𝑦 ) at the average CD projection of correct “lick left” or “lick right” trials in the analyzed hemisphere (see Figure 7 C, highly selective state) or at the decision boundary between “lick left” and “lick right” trials (see Figure 7 C, weakly selective state).
For the experiments described above, the strength of input to each module was equal. We found that trained RNNs developed an asymmetry of between-module influences when the strength of the input to each module was asymmetric during training ( Figure 7 D). To modulate the relative strength of the input delivered to each module, we multiplied the components of 𝑊 𝑖 ⁢ 𝑛 , the input weights to the left and right modules, with asymmetric gain factors, 𝑔 𝐿 and 𝑔 𝑅 : 𝑊 𝑖 ⁢ 𝑛 = ( 𝑊 𝑖 ⁢ 𝑛 𝐿 𝑊 𝑖 ⁢ 𝑛 𝑅 ) ⇒ ( 𝑊 𝑖 ⁢ 𝑛 𝐿 ⁢ 𝑔 𝐿 𝑊 𝑖 ⁢ 𝑛 𝑅 ⁢ 𝑔 𝑅 )
For analysis of the asymmetry of between-module influences ( Figures 7 D-E and S7D-E), the RNNs were always modular-trained with the modular-initialization parameter 𝑝 = 0 . 1 and the Tanh nonlinearity. The input asymmetry ( Figures 7 E and S7D-E) was defined as ( 𝑔 𝑅 − 𝑔 𝐿 ) / ( 𝑔 𝐿 + 𝑔 𝑅 ) , and the RNNs were trained with ( 𝑔 𝐿 , 𝑔 𝑅 ) = ( 1 , 0 ) , ( 1 , 0 . 1 ) , ( 1 , 0 . 2 ) , ( 1 , 0 . 5 ) , ( 1 , 1 ) , ( 0 . 5 , 1 ) , ( 0 . 2 , 1 ) , ( 0 . 1 , 1 ) , ( 0 , 1 ) . 50 randomly initialized RNNs were trained for each value of the input asymmetry. The fraction of correct trials was evaluated for each module separately and then averaged over the two modules (Figures S7D). The modularity of a module ( Figure 7 E) was the fraction of selectivity (i.e., activity difference between trial types on the choice decoder) retained during photoinhibition of the other module. The selectivity recovery of a module (Figure S7E) was the fraction of selectivity recovered after photoinhibition of that module up until the end of the delay epoch.
To examine if the correlated delay activity across the two hemispheres of ALM could be explained by ongoing movements, we trained convolutional neural networks (CNNs) to predict ALM activity from videos of task-performing mice (Figure S2C). Our goal was to build models that related ALM activity to ongoing movements, then subtract this component of ALM activity from each hemisphere and examine if any correlated activity remains in the residual activity. The CNNs were chosen over linear models because of their superior prediction performance.
The CNNs were trained to predict the activity projections on the choice decoder and the top 3 principal components orthogonal to the choice decoder in the left and right ALM. The firing rates were computed using 400ms wide bins with a 100ms bin stride. The inputs to the CNNs were bottom- and side-view videos of mice during the delay epoch (see Videography ). The video frames were temporally downsampled by a factor of 10 (down to 20 Hz) and spatially downsampled by a factor of roughly 3 (down to 130 × 104 pixels for the bottom view; 130 × 86 pixels, side view) to reduce the computational cost and overfitting. The CNNs predicted neural activity at each time point from all video frames within a 400ms time window that was matched to the time bin used to calculate the firing rates. All video frames from the time window were concatenated and fed into the networks. The same CNNs were used for prediction across all time points within the delay epoch.
The CNNs had 6 convolutional layers and 1 fully connected layer shared across sessions (512 units), followed by another fully connected layer specific to each session (128 units). To predict ALM activity projections on the choice decoder and the 3 principal components, 2 additional fully connected layers were used (64 units and 1 final readout unit), and these layers were specific to each session and each activity component. The first seven layers were shared across sessions in order to increase the number of training samples and avoid overfitting. The layers following them were session-specific to account for differences in appearance of mice. The bottom- and side-view video frames were fed into separate 6-layered convolutional networks of identical architecture, whose output activations were concatenated and fed into the session-independent fully connected layer. All convolutional layers had 64 output feature maps and a kernel size of 5 × 5, and a 2 × 2 max pooling was applied after the third and fifth convolutional layers. Units in each layer had a nonlinear activation function (ReLU, rectified linear units ( Nair and Hinton, 2010 48. Nair, V. ∙ Hinton, G. Rectified Linear Units Improve Restricted Boltzmann Machines proceedings of the 27th International Conference on Machine Learning 2010; 807-814 Google Scholar )). Batch normalization was applied after each convolutional layer to facilitate training ( Ioffe and Szegedy, 2015 35. Ioffe, S. ∙ Szegedy, C. Batch Normalization: Accelerating Deep Network Training by Reducing Internal Covariate Shift Proceedings of the 32nd International Conference on Machine Learning. 2015; 37 :448-456 Google Scholar ). To reduce overfitting, dropout was applied before the session-independent fully connected layer and the session-dependent fully connected layer with a drop probability of 0.3 ( Hinton et al., 2012 30. Hinton, G. ∙ Srivastava, N. ∙ Krizhevsky, A. ... Improving neural networks by preventing co-adaptation of feature detectors arXiv. 2012; arXiv:1207.0580 Google Scholar ). The networks were trained by gradient descent to minimize the mean squared error between the predicted and target activity. The CNNs and their training were implemented in Pytorch ( Paszke et al., 2019 52. Paszke, A. ∙ Gross, S. ∙ Massa, F. ... PyTorch: An Imperative Style, High-Performance Deep Learning Library Wallach, H. ∙ Larochelle, H. ∙ Beygelzimer, A. (Editors) Advances in Neural Information Processing Systems 32 Curran Associates, Inc., 2019; 8024-8035 Google Scholar ).
We used the networks to predict activity projections on the choice decoder (CD) and top 3 principal components of ALM activity in each hemisphere. The 4 components explained 40.9 ± 9.4% of the single-trial activity variance during the delay epoch. The CNNs’ prediction performance was evaluated by 5-fold cross-validation (Figure S2D). For each trial type and time point, we computed variance explained ( R 2 ) across trials within each trial type: R 2 = 1 − ∑ 𝑛 𝑡 ⁢ 𝑟 ⁢ 𝑖 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑠 ∑ 𝑖 ( 𝑥 𝑎 ⁢ 𝑐 ⁢ 𝑡 ⁢ 𝑢 ⁢ 𝑎 ⁢ 𝑙 − 𝑥 𝑝 ⁢ 𝑟 ⁢ 𝑒 ⁢ 𝑑 ⁢ 𝑖 ⁢ 𝑐 ⁢ 𝑡 ⁢ 𝑒 ⁢ 𝑑 ) 2 ∑ 𝑛 𝑡 ⁢ 𝑟 ⁢ 𝑖 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝑠 ∑ 𝑖 ( 𝑥 𝑎 ⁢ 𝑐 ⁢ 𝑡 ⁢ 𝑢 ⁢ 𝑎 ⁢ 𝑙 − < 𝑥 𝑎 ⁢ 𝑐 ⁢ 𝑡 ⁢ 𝑢 ⁢ 𝑎 ⁢ 𝑙 > ) 2
where x is the activity projection on the i th activity component (CD or top 3 principal component). The R 2 was averaged across two trial types and all time points. This was done to ensure that R 2 measured how well the networks predicted variability of neural activity across trials, rather than an average change of neural activity across trial types or time.
To examine the extent to which ongoing movement may explain the correlated activity in ALM, we computed the interhemispheric correlation of the residual activity projection on the CD after subtracting the prediction by the CNNs (Figure S2E). The correlation was separately calculated for each trial type and time point on test data aggregated over the 5-fold cross-validation.
To examine whether the reduced interhemispheric correlation in bilateral photoinhibition trials was due to change in ongoing movements, we also predicted ALM activity from videos of mice in photoinhibition trials using CNNs. We used video frames from the late delay epoch, well after photoinhibition. CNNs produced poor predictions of ALM activity from the videos after bilateral photoinhibition (Figure S2J). However, the CNN-predicted ALM activity tended to have a higher interhemispheric correlation than the actual ALM activity (Figure S2K). The results in Figure S2J-K were based on the same CNNs above that were fine-tuned to bilateral photoinhibition trials. Specifically, we combined the videos of control trials and photoinhibition trials to fit the CNNs. In addition, we used a binary mask that excluded the regions where the photoinhibition laser was applied. The binary mask was carefully drawn to cover only the implant region but not part of the mouse’s face or body. The results were qualitatively unchanged when the CNNs were fine-tuned without the binary mask.
The sample sizes were similar to sample sizes used in the field: for behavior, 5 mice or more per condition; for electrophysiology, more than 20 (71 ± 3.6, mean ± SEM) units per brain region and per session. No statistical methods were used to determine sample size. All key results were replicated in multiple mice. Mice were randomly pre-allocated into experimental groups. Unless stated otherwise, the investigators were not blinded to allocation during experiments and outcome assessment. Trial types were randomly determined by a computer program. During spike sorting, experimenters cannot tell the trial type, so experimenters were blind to conditions. Statistical tests and bootstrap are described in detail in sections above. Error bars indicate mean ± SEM unless otherwise noted.

Section: Acknowledgments

We thank K.V. Shenoy, K. Daie, H. Inagaki, S. Ohmae, Z.V. Guo, T. Wang, H. Hou, M. Economo, and S. Romani for comments on the manuscript and Sri Laasya Tipparaju for animal training. This work was funded by the Robert and Janice McNair Foundation (N.L.); Whitehall Foundation (N.L.); Alfred P. Sloan Foundation (N.L.); Searle Scholars Program (N.L.); Pew Scholars Program (N.L.); McKnight Foundation (N.L.); NIH NS112312 (N.L.), NS104781 (N.L. and S.D.), NS113110 (N.L. and S.D.), and EB02871 (S.D.); and Simons Collaboration on the Global Brain (N.L. and S.D.).
G.C., B.K., S.D., and N.L. conceived and designed the experiments. G.C. performed electrophysiology and optogenetic experiments. B.K. and S.D. performed modeling. G.C., B.K., J.L., S.D., and N.L. analyzed data and wrote the paper.
The authors declare no competing interests.
