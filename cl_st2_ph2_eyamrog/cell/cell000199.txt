Title: Distinct Classes of Complex Structural Variation Uncovered across Thousands of Cancer Genome Graphs


Abstract: Summary

Cancer genomes often harbor hundreds of somatic DNA rearrangement junctions, many of which cannot be easily classified into simple (e.g., deletion) or complex (e.g., chromothripsis) structural variant classes. Applying a novel genome graph computational paradigm to analyze the topology of junction copy number (JCN) across 2,778 tumor whole-genome sequences, we uncovered three novel complex rearrangement phenomena: pyrgo, rigma, and tyfonas. Pyrgo are “towers” of low-JCN duplications associated with early-replicating regions, superenhancers, and breast or ovarian cancers. Rigma comprise “chasms” of low-JCN deletions enriched in late-replicating fragile sites and gastrointestinal carcinomas. Tyfonas are “typhoons” of high-JCN junctions and fold-back inversions associated with expressed protein-coding fusions, breakend hypermutation, and acral, but not cutaneous, melanomas. Clustering of tumors according to genome graph-derived features identified subgroups associated with DNA repair defects and poor prognosis.

Section: Introduction

Cancer genomes are shaped by mutational processes that create both simple and complex structural variants (SVs). Whereas simple SVs (e.g., deletions, duplications, translocations, and inversions) arise through the breakage and fusion of one or two genomic locations, complex SVs can cause multiple (more than two) DNA junctions in distinct topologies within the reference genome that yield one or more copies of complex rearranged alleles ( Maciejowski and Imielinski 2017 44. Maciejowski, J. ∙ Imielinski, M. Modeling cancer rearrangement landscapes Curr. Opin. Syst. Biol. 2017; 1 :54-61 Crossref Scopus (12) Google Scholar ). Although several mechanisms have been proposed to explain complex SV patterns, including chromothripsis (CT) ( Stephens et al., 2011 68. Stephens, P.J. ∙ Greenman, C.D. ∙ Fu, B. ... Massive genomic rearrangement acquired in a single catastrophic event during cancer development Cell. 2011; 144 :27-40 Full Text Full Text (PDF) Scopus (1779) PubMed Google Scholar ), chromoplexy ( Baca et al., 2013 3. Baca, S.C. ∙ Prandi, D. ∙ Lawrence, M.S. ... Punctuated evolution of prostate cancer genomes Cell. 2013; 153 :666-677 Full Text Full Text (PDF) Scopus (977) PubMed Google Scholar ), templated insertion chains (TIC) ( Spies et al., 2017 67. Spies, N. ∙ Weng, Z. ∙ Bishara, A. ... Genome-wide reconstruction of complex structural variants using read clouds Nat. Methods. 2017; 14 :915-920 Crossref Scopus (70) PubMed Google Scholar ; Li et al., 2020 42. Li, Y. ∙ Roberts, N.D. ∙ Wala, J.A. ..., PCAWG Structural Variation Working Group, PCAWG Consortium Patterns of somatic structural variation in human cancer genomes Nature. 2020; 578 :112-121 Crossref Scopus (416) PubMed Google Scholar ), and breakage fusion bridge cycles (BFBCs) ( Zakov et al., 2013 74. Zakov, S. ∙ Kinsella, M. ∙ Bafna, V. An algorithmic approach for breakage-fusion-bridge detection in tumor genomes Proc. Natl. Acad. Sci. USA. 2013; 110 :5546-5551 Crossref Scopus (44) PubMed Google Scholar ), the field has not yet converged to a single algorithmic framework to identify the full spectrum of these patterns in a tumor whole-genome sequence. In addition, it is unclear whether some of the clustered rearrangement patterns commonly observed in cancer represent variations on known events (e.g., “amplified” CT) or as-yet-uncharacterized event classes ( ICGC/TCGA Pan-Cancer Analysis of Whole Genomes Consortium 2020 31. ICGC/TCGA Pan-Cancer Analysis of Whole Genomes Consortium Pan-cancer analysis of whole genomes Nature. 2020; 578 :82-93 Crossref Scopus (1559) PubMed Google Scholar ; Li et al., 2020 42. Li, Y. ∙ Roberts, N.D. ∙ Wala, J.A. ..., PCAWG Structural Variation Working Group, PCAWG Consortium Patterns of somatic structural variation in human cancer genomes Nature. 2020; 578 :112-121 Crossref Scopus (416) PubMed Google Scholar ). As a result, the mutational processes driving complex SV evolution are still largely unknown.
The detection of variant junctions (each a pair of oriented genomic locations, or breakends, made adjacent in one of four configurations: deletion-like [DEL-like], duplication-like [DUP-like], inversion-like [INV-like], or translocation-like [TRA-like]; Figure S1 A) in whole-genome sequencing (WGS) is routine. However, the classification of junctions into events (e.g., deletion, duplication, inversion, or translocation) becomes difficult when two or more junctions are near each other. Furthermore, rearrangements and copy-number alterations (CNAs) are usually analyzed and interpreted separately, despite being facets of a single genome structure. As a result, quantitative details of the copy-number (CN) state are only loosely integrated with the junction topology when loci are classified into events.
In WGS, CNAs are detected as change points ( Chiang et al., 2009 12. Chiang, D.Y. ∙ Getz, G. ∙ Jaffe, D.B. ... High-resolution mapping of copy-number alterations with massively parallel sequencing Nat. Methods. 2009; 6 :99-103 Crossref Scopus (421) PubMed Google Scholar ) in sequencing read depth along the genome (e.g., BIC-seq; Xi et al., 2011 72. Xi, R. ∙ Hadjipanayis, A.G. ∙ Luquette, L.J. ... Copy number variation detection in whole-genome sequencing data using the Bayesian information criterion Proc. Natl. Acad. Sci. USA. 2011; 108 :E1128-E1136 Crossref Scopus (179) PubMed Google Scholar ), while rearrangements are nominated through the analysis of junction-spanning read pairs (e.g., SvABA; Wala et al., 2018 70. Wala, J.A. ∙ Bandopadhayay, P. ∙ Greenwald, N.F. ... SvABA: genome-wide detection of structural variants and indels by local assembly Genome Res. 2018; 28 :581-591 Crossref Scopus (202) PubMed Google Scholar ; GRIDSS; Cameron et al., 2017 8. Cameron, D.L. ∙ Schröder, J. ∙ Penington, J.S. ... GRIDSS: sensitive and specific genomic rearrangement detection using positional de Bruijn graph assembly Genome Res. 2017; 27 :2050-2060 Crossref Scopus (197) PubMed Google Scholar ). CNAs and junctions are, however, intrinsically coupled, since every copy of every non-telomeric segment must have a left (toward smaller coordinates) and a right (toward larger coordinates) neighbor, whether that neighbor is already adjacent on the reference (via a reference or REF junction) or introduced through rearrangement (via a variant or ALT junction) ( Medvedev et al., 2010 47. Medvedev, P. ∙ Fiume, M. ∙ Dzamba, M. ... Detecting copy number variation with mated short reads Genome Res. 2010; 20 :1613-1622 Crossref Scopus (132) PubMed Google Scholar ; Greenman et al., 2012 23. Greenman, C.D. ∙ Pleasance, E.D. ∙ Newman, S. ... Estimation of rearrangement phylogeny for cancer genomes Genome Res. 2012; 22 :346-361 Crossref Scopus (93) PubMed Google Scholar ). Furthermore, though CN is a concept primarily applied to describe the dosage of genomic intervals, a junction may also be present in one or more copies per cell and thus be associated with a junction CN (JCN).
Elevated JCN might occur through the focal (e.g., extrachromosomal) amplification or whole-chromosome (or genome) duplication of an already rearranged allele ( Figure 1 A). The inference of JCN in WGS involves the fitting of a genome graph to read depth and junction data through the application of a junction balance constraint, which requires the CN of every genomic interval (i.e., vertex) to be in balance with the JCN of its neighboring junctions (i.e., edges) ( Figures S1 A–C; Medvedev et al., 2010 47. Medvedev, P. ∙ Fiume, M. ∙ Dzamba, M. ... Detecting copy number variation with mated short reads Genome Res. 2010; 20 :1613-1622 Crossref Scopus (132) PubMed Google Scholar ; Greenman et al., 2012 23. Greenman, C.D. ∙ Pleasance, E.D. ∙ Newman, S. ... Estimation of rearrangement phylogeny for cancer genomes Genome Res. 2012; 22 :346-361 Crossref Scopus (93) PubMed Google Scholar ; Oesper et al., 2012 51. Oesper, L. ∙ Ritz, A. ∙ Aerni, S.J. ... Reconstructing cancer genomes from paired-end sequencing data BMC Bioinformatics. 2012; 13 :S10 Crossref Scopus (34) PubMed Google Scholar ; Li et al., 2016 41. Li, Y. ∙ Zhou, S. ∙ Schwartz, D.C. ... Allele-specific quantification of structural variations in cancer genomes Cell Syst. 2016; 3 :21-34 Full Text Full Text (PDF) Scopus (30) PubMed Google Scholar ; Dzamba et al., 2017 17. Dzamba, M. ∙ Ramani, A.K. ∙ Buczkowicz, P. ... Identification of complex genomic rearrangements in cancers using CouGaR Genome Res. 2017; 27 :107-117 Crossref Scopus (20) Google Scholar ; McPherson et al., 2017 46. McPherson, A.W. ∙ Roth, A. ∙ Ha, G. ... ReMixT: clone-specific genomic structure estimation in cancer Genome Biol. 2017; 18 :140 Crossref Scopus (22) PubMed Google Scholar ). We hypothesized that the topology and CN of both vertices and edges on junction-balanced genome graphs might reveal novel classes of complex SV events and mutational processes.

Section: Results

The inference of junction-balanced genome graphs is a computationally challenging combinatorial optimization problem that others have approached using probabilistic graphical models (PGMs) and mixed-integer programming (MIP) ( Medvedev et al., 2010 47. Medvedev, P. ∙ Fiume, M. ∙ Dzamba, M. ... Detecting copy number variation with mated short reads Genome Res. 2010; 20 :1613-1622 Crossref Scopus (132) PubMed Google Scholar ; Greenman et al., 2012 23. Greenman, C.D. ∙ Pleasance, E.D. ∙ Newman, S. ... Estimation of rearrangement phylogeny for cancer genomes Genome Res. 2012; 22 :346-361 Crossref Scopus (93) PubMed Google Scholar ; Oesper et al., 2012 51. Oesper, L. ∙ Ritz, A. ∙ Aerni, S.J. ... Reconstructing cancer genomes from paired-end sequencing data BMC Bioinformatics. 2012; 13 :S10 Crossref Scopus (34) PubMed Google Scholar ; Li et al., 2016 41. Li, Y. ∙ Zhou, S. ∙ Schwartz, D.C. ... Allele-specific quantification of structural variations in cancer genomes Cell Syst. 2016; 3 :21-34 Full Text Full Text (PDF) Scopus (30) PubMed Google Scholar ; Dzamba et al., 2017 17. Dzamba, M. ∙ Ramani, A.K. ∙ Buczkowicz, P. ... Identification of complex genomic rearrangements in cancers using CouGaR Genome Res. 2017; 27 :107-117 Crossref Scopus (20) Google Scholar ; McPherson et al., 2017 46. McPherson, A.W. ∙ Roth, A. ∙ Ha, G. ... ReMixT: clone-specific genomic structure estimation in cancer Genome Biol. 2017; 18 :140 Crossref Scopus (22) PubMed Google Scholar ). A serious impediment to applying these approaches to the study of complex SVs is their inability to produce CN profiles of comparable quality to non-graph-based CNA callers (e.g., CONSERTING; Chen et al., 2015 10. Chen, X. ∙ Gupta, P. ∙ Wang, J. ... CONSERTING: integrating copy-number analysis with structural-variation detection Nat. Methods. 2015; 12 :527-530 Crossref Scopus (52) PubMed Google Scholar ; BIC-seq; Xi et al., 2011 72. Xi, R. ∙ Hadjipanayis, A.G. ∙ Luquette, L.J. ... Copy number variation detection in whole-genome sequencing data using the Bayesian information criterion Proc. Natl. Acad. Sci. USA. 2011; 108 :E1128-E1136 Crossref Scopus (179) PubMed Google Scholar ) while also inferring JCN across a wide range of tumor purities.
We developed an algorithm, junction balance analysis (JaBbA), to infer junction-balanced genome graphs with high fidelity. Analogous to previous approaches, we define a (directed) genome graph of vertices representing strands of genomic segments and edges representing a pair of 3′ and 5′ DNA ends that are adjacent in the reference genome (REF edge) or connected through rearrangement (ALT edge). A junction-balanced genome graph assigns every vertex and edge in the graph an integer CN while enforcing the constraint that the dosage of every interval (vertex) is equal to the sum of the JCN of the incoming (or similarly, outgoing) junctions ( Figure S1 B). The MIP optimization solved by JaBbA minimizes the residual between observed read depth and inferred interval dosage through joint assignment of CN to intervals and junctions ( Figures 1 B and S1 C; STAR Methods ).
JaBbA differs primarily from previous genome graph methods in its robust modeling of WGS read-depth noise and explicit accounting of false-negative junctions, also called loose ends (see STAR Methods ). In our benchmarking experiments, JaBbA-inferred JCN with consistently higher fidelity than published genome graph-based methods, such as ReMixT ( McPherson et al., 2017 46. McPherson, A.W. ∙ Roth, A. ∙ Ha, G. ... ReMixT: clone-specific genomic structure estimation in cancer Genome Biol. 2017; 18 :140 Crossref Scopus (22) PubMed Google Scholar ), Weaver ( Li et al., 2016 41. Li, Y. ∙ Zhou, S. ∙ Schwartz, D.C. ... Allele-specific quantification of structural variations in cancer genomes Cell Syst. 2016; 3 :21-34 Full Text Full Text (PDF) Scopus (30) PubMed Google Scholar ), and PREGO ( Oesper et al., 2012 51. Oesper, L. ∙ Ritz, A. ∙ Aerni, S.J. ... Reconstructing cancer genomes from paired-end sequencing data BMC Bioinformatics. 2012; 13 :S10 Crossref Scopus (34) PubMed Google Scholar ), across a wide range of tumor purities ( Figures S1 D and S1E). In addition, JaBbA qualitatively outperformed genome graph-based methods and even classic (i.e., non-graph-based) CNA callers, such as BIC-seq ( Xi et al., 2011 72. Xi, R. ∙ Hadjipanayis, A.G. ∙ Luquette, L.J. ... Copy number variation detection in whole-genome sequencing data using the Bayesian information criterion Proc. Natl. Acad. Sci. USA. 2011; 108 :E1128-E1136 Crossref Scopus (179) PubMed Google Scholar ) and CONSERTING ( Chen et al., 2015 10. Chen, X. ∙ Gupta, P. ∙ Wang, J. ... CONSERTING: integrating copy-number analysis with structural-variation detection Nat. Methods. 2015; 12 :527-530 Crossref Scopus (52) PubMed Google Scholar ), in estimating interval CN and change-point locations across a wide range of tumor purities ( Figures S1 F–S1I). These results show that JaBbA is the first genome graph SV caller to accurately infer the topology of JCN while approaching (or exceeding) the fidelity of classic CNA callers.
We also validated JaBbA’s estimates of JCN from short-read WGS with 10X Chromium linked-read WGS, which provides a more direct readout of JCN with its high number of long junction-spanning fragments. In the breast cancer cell line HCC1954, JaBbA-derived JCN estimates closely correlated with the coverage of junction-spanning linked-read barcodes ( R 2 = 0.91; Figure 1 C). This included examples of low-JCN (e.g., JCN = 1) junctions connecting both low- and high-CN intervals, as well as high-JCN (JCN = 10) junctions ( Figure 1 D). These results show that JCN is a property that can be robustly inferred from short-read WGS and is independent from (interval) CN.
To investigate the topology of JCN across cancers, we assembled a dataset comprising 2,813 short-read WGS tumor or cell line samples spanning 31 primary tumor types ( Tables S1 , S2 , and S3 ), including WGS for 539 previously unpublished cases ( Table S2 ). In total, our analysis included 1,648 WGS samples not included in the Pan-Cancer Analysis of Whole Genomes (PCAWG) effort ( ICGC/TCGA Pan-Cancer Analysis of Whole Genomes Consortium, 2020 31. ICGC/TCGA Pan-Cancer Analysis of Whole Genomes Consortium Pan-cancer analysis of whole genomes Nature. 2020; 578 :82-93 Crossref Scopus (1559) PubMed Google Scholar ). Application of harmonized pipelines followed by JaBbA ( Figure 1 B) yielded 2,778 high-quality genome graphs ( Figure 1 E; see STAR Methods for sample characteristics and exclusion criteria).
Analyzing junction-balanced genome graph topology, we identified subgraphs associated with previously identified complex rearrangement patterns such as CT, chromoplexy, and TICs ( Figure 1 B, right panel), implementing criteria described in previous publications within our framework (see STAR Methods ). Consistent with our 10X Chromium WGS benchmarks (see above) ( Figure 1 C), we observed wide variation in inferred JCN across our datasets, which correlated with observed read-depth changes at breakends ( Figure 1 F). While the vast majority of junctions demonstrated low-JCN (JCN ≤ 3), we observed a long tail of junctions with elevated (JCN > 3) and high JCN (JCN > 7) ( Figure 1 G).
To distinguish between complex SV patterns associated with low-JCN versus high-JCN junctions, we identified junction clusters based on their overlapping footprints on the reference and labeled each cluster as high/low JCN on the basis of its highest copy junction (high JCN thresholded at > 7). Considering clusters harboring three or more junctions, we found low-JCN clusters were significantly more likely to be dominated (>90% representation of that type) by DEL-like (p < 2.2 × 10 −16 , z-test, logistic regression) or DUP-like junctions (p < 2.2 × 10 −16 ) ( Figure S2 A).
To rigorously nominate clusters of low-copy DUP-like and DEL-like junctions within each tumor sample, we identified genomic tiles (1 Mbp width, 500 kbp stride) enriched in low-JCN of a given type (e.g., DEL-like) relative to a calibrated gamma-Poisson background model (see STAR Methods ). In each analysis, non-outlier tiles harbored apparent simple deletions or duplications ( Figures 2 A and 2B). In contrast, outlier bins in the DUP-like model resembled “towers” of low-JCN DUP-like junctions ( Figure 2 A, top right) that we named “pyrgo” (πυργοζ, Greek meaning tower). Outlier loci in the DEL-like models comprised subgraphs of interval CN “chasms” flanked by low-JCN DEL-like junctions whose interval CN often reached 0 ( Figure 2 B, top left). We named these patterns “rigma” ( ρ ⁢ 𝜂 ⁢ 𝛾 ⁢ μ ⁢ α , Greek meaning rift).
We found a significantly increased burden of pyrgo in endometrial, ovarian, breast, and esophageal adenocarcinoma (ESAD) (Bonferroni p < 0.05, Fisher’s exact test, Figure 2 C), while an excess of rigma was found in Barrett’s esophagus (BE) cases and ESAD (Bonferroni p < 0.05, Figure 2 D). Compared to simple duplications, pyrgo were significantly enriched in early-replicating regions (p < 2.2 × 10 −16 , odds ratio [OR] = 1.36, z-test, ordinal logistic regression) and superenhancers as defined by Hnisz et al. (2013) 28. Hnisz, D. ∙ Abraham, B.J. ∙ Lee, T.I. ... Super-enhancers in the control of cell identity and disease Cell. 2013; 155 :934-947 Full Text Full Text (PDF) Scopus (2425) PubMed Google Scholar (p < 2.2 × 10 −16 , OR = 8.09, z-test, logistic regression) ( Figure 2 E). In contrast, rigma were significantly enriched in late-replicating regions (p < 2.2 × 10 −16 , OR = 1.5, ordered logistic regression), fragile sites (p < 2.2 × 10 −16 , OR = 2.45, z-test, logistic regression), and long genes (p < 2.2 × 10 −16 , risk ratio [ RR ] = 1.31, z-test, log-linear regression) relative to simple deletions ( Figure 2 F). These genomic distribution patterns indicate that rigma and pyrgo are driven by distinct mutational processes and/or forces of somatic selection from those driving simple deletions and duplications.
To nominate loci that were recurrently targeted by pyrgo and rigma across independent patients, we employed fishHook ( Imielinski et al., 2017 33. Imielinski, M. ∙ Guo, G. ∙ Meyerson, M. Insertions and Deletions Target Lineage-Defining Genes in Human Cancers Cell. 2017; 168 :460-472.e14 Full Text Full Text (PDF) Scopus (83) PubMed Google Scholar ) while correcting for genomic covariates (replication timing, gene width, and superenhancer status). Applying fishHook to find recurrent pyrgo hotspots across 8,642 nonoverlapping previously annotated superenhancer regions ( Hnisz et al., 2013 28. Hnisz, D. ∙ Abraham, B.J. ∙ Lee, T.I. ... Super-enhancers in the control of cell identity and disease Cell. 2013; 155 :934-947 Full Text Full Text (PDF) Scopus (2425) PubMed Google Scholar ) (see STAR Methods ), we found 16 loci were significantly mutated above background (false discovery rate [FDR] < 0.25) in the setting of a calibrated model fit (λ = 1.03, Figure S2 B).
This included a superenhancer associated with the oncogene MYC , targeted by pyrgo in 14 cases spanning six cancer types, including seven ESADs ( Figure S2 C). Additional recurrent targets of pyrgo included manually annotated Sanger Cancer Gene Census (CGC) genes ( Sondka et al., 2018 66. Sondka, Z. ∙ Bamford, S. ∙ Cole, C.G. ... The COSMIC Cancer Gene Census: describing genetic dysfunction across all human cancers Nat. Rev. Cancer. 2018; 18 :696-705 Crossref Scopus (818) PubMed Google Scholar ) associated with published GISTIC amplification peaks ( Figure S2 B; Zack et al., 2013 73. Zack, T.I. ∙ Schumacher, S.E. ∙ Carter, S.L. ... Pan-cancer patterns of somatic copy number alteration Nat. Genet. 2013; 45 :1134-1140 Crossref Scopus (1308) PubMed Google Scholar ), with the MYC gene body being the most enriched. Interestingly, pyrgo enrichment around superenhancers was found even outside of pyrgo hotspots ( Figure S2 D, p < 2.2 × 10 −16 , OR = 1.5, z-test, Bayesian logistic regression). We also note that the minority (33%) of pyrgo intersected CGC genes.
Applying fishHook to analyze rigma recurrence across 18,794 unique protein-coding genes, we found 17 genes significantly mutated above background (FDR < 0.25, λ = 1.03), even after correcting for replication timing, gene width, and fragile site status ( Figure S2 E). Among the top loci surviving false discovery correction, we found previous hotspots of genomic fragile sites ( FHIT , WWOX , and MACROD2 ) ( Zack et al., 2013 73. Zack, T.I. ∙ Schumacher, S.E. ∙ Carter, S.L. ... Pan-cancer patterns of somatic copy number alteration Nat. Genet. 2013; 45 :1134-1140 Crossref Scopus (1308) PubMed Google Scholar ; Bignell et al., 2010 6. Bignell, G.R. ∙ Greenman, C.D. ∙ Davies, H. ... Signatures of mutation and selection in the cancer genome Nature. 2010; 463 :893-898 Crossref Scopus (563) PubMed Google Scholar ; Beroukhim et al., 2010 5. Beroukhim, R. ∙ Mermel, C.H. ∙ Porter, D. ... The landscape of somatic copy-number alteration across human cancers Nature. 2010; 463 :899-905 Crossref Scopus (2940) PubMed Google Scholar ; Iliopoulos et al., 2006 32. Iliopoulos, D. ∙ Guler, G. ∙ Han, S.-Y. ... Roles of FHIT and WWOX fragile genes in cancer Cancer Lett. 2006; 232 :27-36 Crossref Scopus (71) PubMed Google Scholar ; Fungtammasan et al., 2012 20. Fungtammasan, A. ∙ Walsh, E. ∙ Chiaromonte, F. ... A genome-wide analysis of common fragile sites: what features determine chromosomal instability in the human genome? Genome Res. 2012; 22 :993-1005 Crossref Scopus (112) PubMed Google Scholar ; Cheng et al., 2017 11. Cheng, J. ∙ Demeulemeester, J. ∙ Wedge, D.C. ... Pan-cancer analysis of homozygous deletions in primary tumours uncovers rare tumour suppressors Nat. Commun. 2017; 8 :1221 Crossref Scopus (65) PubMed Google Scholar ) and bona fide tumor suppressors (e.g., CDKN2A ; Figures S2 E and S2F). Nevertheless, only 12% of rigma outside of known fragile sites were associated with a known cancer gene. FHIT rigma loci in ESAD and BE demonstrated a visually recurrent topology, often targeting the central exon in the gene ( Figure S2 G).
We investigated whether rigma were distinct from CT, another clustered rearrangement pattern associated with DNA loss ( Stephens et al., 2011 68. Stephens, P.J. ∙ Greenman, C.D. ∙ Fu, B. ... Massive genomic rearrangement acquired in a single catastrophic event during cancer development Cell. 2011; 144 :27-40 Full Text Full Text (PDF) Scopus (1779) PubMed Google Scholar ). Compared to rigma, CT events were one to two orders of magnitude larger in size (CT median size, 45.07 Mbp; rigma median size, 0.53 Mbp) ( Figure 3 A, upper panel; p < 2.2 × 10 −16 , Wilcoxon rank-sum test). Analyzing the allelic structure that is latent in the JaBbA graphs, we searched each CT- or rigma-associated subgraph for a single path or allele that held the most ALT junctions in cis (see STAR Methods ). We found that CT subgraphs usually yielded alleles that placed a higher proportion of the event-associated junctions in cis relative to rigma ( Figure 3 A, lower panel, p < 2.2 × 10 −16 , Wilcoxon rank-sum test). These results indicate that rigma-associated DEL-like junctions are more likely to occur in trans .
We then asked whether rigma junctions were likely to reside in the same clone or as single DEL-like junctions in separate competing clones. We generated simulations in which one aneuploid clone harboring a five-junction rigma (“rigma clone”) in FHIT was mixed with random proportions of five near-identical clones, each harboring a single DEL-like junction (taken from another FHIT rigma). Applying JaBbA across 250 simulations with varying rigma clone fractions, we only detected a rigma when the rigma clone reached 50% or greater cancer cell fraction ( Figures S3 A and S3B). Interestingly, we found similar results for analogous clone-mixing experiments for pyrgo ( Figures S3 C and S3D), indicating that pyrgo junctions also likely occur in the same cell. Taken together, these results indicate that JaBbA-derived SV patterns belong to the same dominant or ancestral cancer clone and that rigma junctions were likely to reside in the same clone but on different alleles.
To validate the latter, we generated 10X Chromium WGS for a rigma-harboring Cancer Cell Line Encyclopedia (CCLE) cell line in our cohort (NCI-H838). Integration of long-range contiguity data in the linked-read barcodes enabled unambiguous deconvolution of alleles in the JaBbA genome graph (see STAR Methods ). Our allelic reconstruction supported the existence of three linear alleles in trans orientation ( Figure 3 B; see STAR Methods ), each with a CN of 1. Of the four DEL-like junctions associated with this rigma, all but one pair were in trans .
Given the enrichment of rigma in BE and ESAD, we probed whether these events occurred early or late in esophageal cancer evolution. Analyzing 340 multi-regionally and longitudinally sampled biopsy specimens taken from 80 BE cases, we found that rigma were significantly more likely to be found in two or more biopsy specimens relative to simple deletions (p < 2.2 × 10 −16 , OR = 6.69, Fisher’s exact test) ( Figure 3 C). Reconstructing the allelic evolution in an early rigma case, we found evidence for successive accumulation of DEL-like junctions on alleles that had already harbored a previous deletion ( Figure 3 D). These results suggest that rigma represent a gradual SV mutational process that targets late-replicating fragile sites and occurs early in BE/ESAD evolution.
We then sought to investigate the rearrangement patterns associated with high-JCN junctions (JCN > 7) in our genome graphs. A priori , a junction at such an extreme of JCN may evolve through a double minute, BFBC, or an as-yet-undescribed mechanism for duplicating already rearranged DNA. To characterize classes of amplification events associated with these high-JCN junctions, we first identified 12,588 subgraphs harboring an interval CN of at least twice ploidy among the 2,487 unique genome graphs (by patient) ( Figure 4 A) and then identified among these amplicons (amplified clusters within a genome) those that harbor at least one junction with JCN > 7. We annotated the resulting 1,703 high-JCN amplicons according to several features: (1) the maximum JCN normalized by the maximal interval CN; (2) the summed JCN associated with fold-back inversion junctions (INV-like junctions that terminate and begin at nearly the same location in the genome) relative to the maximal interval CN; and (3) the number of junctions with elevated JCN (JCN > 3) (see STAR Methods ).
Clustering and classification of amplicons ( Figure 4 B) on the basis of these three features yielded three stable clusters ( Figures S4 A and S4B) (see STAR Methods ). Upon visual inspection, the first group, harboring low fold-back JCN but high maximal JCN, contained amplicons comprising a single high-JCN junction forming a high-CN circular path in the graph ( Figure 4 C) as well as more complex cyclic patterns spanning multiple discontiguous loci, consistent with a double minute. The second group, demonstrating high fold-back JCN (>0.5), a low burden of elevated JCN junctions (<26), and a “stair step” pattern of copy gains, was consistent with a BFBC ( Figure 4 D) ( Zakov et al., 2013 74. Zakov, S. ∙ Kinsella, M. ∙ Bafna, V. An algorithmic approach for breakage-fusion-bridge detection in tumor genomes Proc. Natl. Acad. Sci. USA. 2013; 110 :5546-5551 Crossref Scopus (44) PubMed Google Scholar ). The third group contained both high fold-back JCN (≥0.50) and a significant burden of elevated JCN junctions (≥26). Upon visual inspection, these amplicons comprised dense webs of elevated JCN junctions across subgraphs comprising > 100 Mbp of genomic material and often reaching CNs >50 ( Figure S4 C). We dubbed these extremely large amplicons, which did not fit in previously defined categories, “tyfonas” ( τ ´ 𝜐 ϕωναζ , Greek meaning typhoon) ( Figure 4 E).
Comparing amplicon features, we found that tyfonas had significantly larger genomic mass (summed interval width weighted by CN), maximum interval CN, junction burden, and JCN entropy (based on the histogram of JCN in the amplicon) than either double minutes or BFBCs (p < 2.2 × 10 −16 , Wilcoxon rank-sum test) ( Figure S4 C). All three amplicon classes frequently intersected CGC cancer genes residing within GISTIC pan-cancer amplification peaks ( Figure S4 D). EGFR was the most frequent target of double minutes. BFBCs were most frequently implicated in ERBB2 , CCND1 , and CCNE1 amplification. Tyfonas were associated with MDM2 and CDK4 . While double minutes were enriched in glioblastoma and small cell lung cancer, BFBCs were enriched in esophageal squamous cell cancer, lung squamous cell cancer, and head and neck squamous cell cancer (FDR < 0.25, Fisher’s exact test, Figure 4 F). In contrast, tyfonas events were enriched in sarcoma, breast cancer, and melanoma (FDR < 0.25).
Analyzing tumor subtypes, we found tyfonas were common in dedifferentiated liposarcomas (80%) and acral melanomas (40%) but rarely seen (<2%) in fibrosarcomas and cutaneous melanomas ( Figure 4 G). The specificity of tyfonas for these tumor types was much higher than for liposarcoma-like or amplified CT, which are recently proposed PCAWG categories that also showed substantial overlap with BFBC and double minutes ( Figures S4 E–S4K) ( ICGC/TCGA Pan-Cancer Analysis of Whole Genomes Consortium, 2020 31. ICGC/TCGA Pan-Cancer Analysis of Whole Genomes Consortium Pan-cancer analysis of whole genomes Nature. 2020; 578 :82-93 Crossref Scopus (1559) PubMed Google Scholar ). 80% of dedifferentiated liposarcomas harbored a tyfonas on chromosome 12q, suggesting that tyfonas represent the genomic footprint of supernumerary ring chromosomes in this tumor type ( Reimann and Fletcher, 2008 58. Reimann, J.D.R. ∙ Fletcher, C.D.M. Soft-tissue sarcomas Mendelsohn, J. ∙ Howley, P.M. ∙ Israel, M.A. ... (Editors) The Molecular Basis of Cancer (Third Edition) W.B. Saunders, 2008; 471-477 Crossref Scopus (3) Google Scholar ). Given the enrichment of tyfonas events in acral melanoma, an immunotherapy-responsive melanoma with a low SNV burden ( Shoushtari et al., 2016 65. Shoushtari, A.N. ∙ Munhoz, R.R. ∙ Kuk, D. ... The efficacy of anti-PD-1 agents in acral and mucosal melanoma Cancer. 2016; 122 :3354-3362 Crossref Scopus (228) PubMed Google Scholar ), we hypothesized that tyfonas events may provide an alternate source of neoantigens through the generation of expressed protein-coding fusions. Analyzing the subset of our samples with RNA-seq data ( Dehghannasiri et al., 2019 14. Dehghannasiri, R. ∙ Freeman, D.E. ∙ Jordanski, M. ... Improved detection of gene fusions by applying statistical methods reveals oncogenic RNA cancer drivers Proc. Natl. Acad. Sci. USA. 2019; 116 :15524-15533 Crossref Scopus (25) Google Scholar ), we found that tyfonas were significantly enriched with expressed fusion transcripts relative to double minutes, BFBCs, and even CT ( Figure 4 H, left panel), even after accounting for the larger genomic footprint of tyfonas ( Figure 4 H, right panel).
To further distinguish tyfonas from other complex SV types, we analyzed patterns of somatic SNVs around breakends. As expected, a breakend-centered coordinate system ( Figure 5 A; see STAR Methods ) revealed a robust peak of hypermutation within the first 1 kbp of breakends on the positive side of the axis. Comparing the intensity of these patterns between amplicon types revealed an enrichment of breakend hypermutation around tyfonas relative to BFBC, double minutes, and baseline (i.e., those not associated with a high-JCN amplicon) junctions, even after correcting for CN as a covariate (p < 2.2 × 10 −16 , RR = 1.64, z-test, gamma-Poisson regression; Figure S5 ).
Breakend hypermutation has previously been attributed to the activity of APOBEC cytidine deaminases ( Roberts et al., 2013 60. Roberts, S.A. ∙ Lawrence, M.S. ∙ Klimczak, L.J. ... An APOBEC cytidine deaminase mutagenesis pattern is widespread in human cancers Nat. Genet. 2013; 45 :970-976 Crossref Scopus (890) PubMed Google Scholar ) and associated with COSMIC single base substitution (SBS) signatures 2 and 13 ( Alexandrov et al., 2020 1. Alexandrov, L.B. ∙ Kim, J. ∙ Haradhvala, N.J. ..., PCAWG Mutational Signatures Working Group, PCAWG Consortium The repertoire of mutational signatures in human cancer Nature. 2020; 578 :94-101 Crossref Scopus (1687) PubMed Google Scholar ). However, we observed breakend hypermutation both within and outside of SBS 2/13 ( Figure 5 B). Surprisingly, we found no significant differences in SBS-2/13-driven breakend hypermutation between tyfonas, BFBCs, double minutes, and baseline junctions ( Figure 5 C, top row). In contrast, we found that tyfonas were enriched in non-SBS 2/13 breakend hypermutation relative to baseline (p < 2.2 × 10 −16 , RR = 1.60), BFBCs (p = 9.94 × 10 –6 , RR = 1.33), and double minutes (p = 7.97 × 10 –6 , RR = 1.40; Figure 5 C, bottom row). We obtained similar results with alternate APOBEC definitions (TpC contexts and GC-strand coordinated “kataegis” clusters). These results indicate that tyfonas breakends are preferentially exposed to a mutational process that does not satisfy current definitions of APOBEC mutagenesis.
To more broadly probe the long-range structure of tyfonas amplicons, we selected a tyfonas-harboring small cell lung cancer cell line (NCI-H526) from the Cancer Cell Line Encyclopedia (CCLE) ( Ghandi et al., 2019 22. Ghandi, M. ∙ Huang, F.W. ∙ Jané-Valbuena, J. ... Next-generation characterization of the Cancer Cell Line Encyclopedia Nature. 2019; 569 :503-508 Crossref Scopus (1676) PubMed Google Scholar ) for further profiling with short-read WGS, Bionano optical mapping, Hi-C, and fluorescence in situ hybridization (FISH) ( Figure 6 A). The WGS- and BioNano-derived JaBbA graph ( Figure 6 B; see STAR Methods ) resolved all but four of the tyfonas-associated loose ends in the original WGS reconstruction, an improvement attributable to the additional sensitivity of optical mapping in repetitive regions ( Figure 6 A). The reconstructed NCI-H526 tyfonas co-amplified MYCN (chromosome 2) to 68 and MYB (chromosome 6) to 47 intact copies, consistent with the marked overexpression of both genes (>99th percentile) relative to >1,000 other cancer cell lines in the CCLE RNA-sequencing dataset ( Figure 6 C).
We performed metaphase FISH using two sets of bacterial artificial chromosome/clone (BAC) probes targeting one of the most amplified portions of the tyfonas locus on chromosome 2p ( Figures 6 D and S6 B). We observed two homogeneously staining NCI-H526 foci of highly amplified probe signal, each with equal intensity, located on two linear chromosomal fragments that were discontiguous with the chromosome 2 centromere. To further derive the long-range architecture of the tyfonas locus, we generated Hi-C of NCI-H526. Hi-C 3D contacts identified a set of 5-Mbp bins on chromosome 1q as the genome-wide most proximal regions to the highly amplified tyfonas “seed region” on chromosome 2 ( Figure S6 C). These bins were contiguous along a >40-Mbp piece of chromosome 1q ( Figure S6 D), nominating this region as the most likely chromosomal integration site. These patterns were visually apparent in the NCI-H526 Hi-C contact map as foci of interchromosomal pixels, absent from the diploid cell line GM12878, connecting highly amplified tyfonas intervals on chromosomes 2, 6, 13, and 15 to a broad region of chromosome 1q ( Figure 6 B).
Taken together, these results indicate that the amplified segments of the NCI-H526 tyfonas were arranged in cis in a linear allele that was integrated into chromosome 1q prior to a chromosomal duplication. To resolve this linear structure, we inferred a haplotype with multiplicity two that maximally accounted for all the copies of intervals and junctions in the tyfonas ( Figure 6 E; see STAR Methods ). This reconstructed allele threaded back and forth between MYB and MYCN , integrating many copies of fold-back inversion junctions in cis .
Tallying normalized junction counts across 13 event categories and 2,487 patients, we found 14 stable clusters using standard model selection metrics ( Figures 7 A, S7 A, and S7B; Table S3 ). Most clusters were dominated by one to three event types (e.g., CT, BR [BFBC, rigma], or DDT [deletion, duplication, TIC]), with the exception of two (QUIET [few events] and SPRS [sparse, miscellaneous events]).
Consistent with previous reports, the CT cluster was significantly enriched in prostate adenocarcinoma (PRAD, p = 2.05 × 10 –5 , OR = 1.99, single-sided z-test, Bayesian logistic regression; Kovtun et al., 2015 37. Kovtun, I.V. ∙ Murphy, S.J. ∙ Johnson, S.H. ... Chromosomal catastrophe is a frequent event in clinically insignificant prostate cancer Oncotarget. 2015; 6 :29087-29096 Crossref Scopus (17) Google Scholar ) and glioblastoma multiforme (GBM; p = 5.00 × 10 –8 , OR = 2.61; Furgason et al., 2015 21. Furgason, J.M. ∙ Koncar, R.F. ∙ Michelhaugh, S.K. ... Whole genome sequence analysis links chromothripsis to EGFR, MDM2, MDM4, and CDK4 amplification in glioblastoma Oncoscience. 2015; 2 :618-628 Crossref Scopus (40) PubMed Google Scholar ) ( Figure 7 B). Similarly, the CP (chromoplexy) cluster was significantly enriched in PRAD (p = 2.32 × 10 –10 , OR = 3.18, Baca et al., 2013 3. Baca, S.C. ∙ Prandi, D. ∙ Lawrence, M.S. ... Punctuated evolution of prostate cancer genomes Cell. 2013; 153 :666-677 Full Text Full Text (PDF) Scopus (977) PubMed Google Scholar ). DDT tumors (defined by high burdens of deletions, duplications, and TICs) were enriched in triple-negative breast cancer (TNBC) (p < 2.2 × 10 −16 , OR = 8.80), ovarian cancers (p = 7.03 × 10 –16 , OR = 6.89), and more broadly sex-hormone-driven tumors (p = 3.18 × 10 –14 , OR = 19.0).
Inspection of the heatmap in Figure 7 A showed that the classes of complex SV introduced in this study (pyrgo, rigma, and tyfonas) largely clustered independently from known complex SV types (double minute, BFBC, CT, and chromoplexy). Among these, the BR (BFBC, rigma) cluster was primarily (60%) composed of ESAD cases (p < 2.2 × 10 −16 , OR = 6.08) and enriched in gastrointestinal (GI) tumors (e.g., esophageal, colorectal, and gastric adenocarcinoma) (p < 2.2 × 10 −16 , OR = 4.56) ( Figure 7 B). The TYF (tyfonas-dominant) cluster was enriched in both luminal breast cancer (p = 4.87 × 10 –8 , OR = 3.25), HER2 + breast cancer (p < 2.64 × 10 –9 , OR = 4.96), dedifferentiated liposarcoma (p < 2.2 × 10 −16 , OR = 24.5), and acral melanoma (p < 1.84 × 10 –15 , OR = 7.40). In contrast, cutaneous melanomas were enriched in the CT cluster. Additional associations are shown in Figure S7 C and Table S4 .
We associated somatic or constitutional genotypes in CGC genes with cluster membership, after correcting for tumor subtype as a covariate. More than 20% of cases in the DDT cluster harbored constitutional (p = 1.60 × 10 –4 , OR = 3.81) loss-of-function lesions in BRCA1 ( Figure 7 C). BR-cluster tumors were also significantly enriched in somatic TP53 mutations (p < 4.71 × 10 –7 , OR = 2.06). Additional somatic genotype associations ( Figure S7 D) included an enrichment of SMC4 (p = 2.33 × 10 –3 , OR = 3.11) and RAD21 (p = 1.96 × 10 –3 , OR = 3.27) mutations in the INVD (inverted-duplication-dominant) cluster, ARID1A (p = 1.21 × 10 –3 , OR = 1.86) mutations in the TIC (TIC-dominant) cluster, and KMT2C (p = 2.89 × 10 –3 , OR = 1.95) mutations in the TRA (translocation-dominant) cluster.
Kaplan-Meier analysis revealed poor survival among novel SV-class-dominant clusters (BR, PYR, and TYF) ( Figure 7 D; FDR < 0.1, log-rank test) as well as several clusters dominated by previously described SV classes (CP, CT, and INVD) ( Figure S7 E). These effects persisted after correcting for clinical and molecular covariates in a Cox regression analysis, with BR (p = 1.17 × 10 –2 , hazard ratio [ HR ] = 1.72, likelihood ratio test, Cox regression), PYR (p = 6.13 × 10 –3 , HR = 2.01), TYF (p = 5.37 × 10 –3 , HR = 2.12), CP (p = 1.76 × 10 –3 ; HR = 1.91), CT (p = 6.69 × 10 –4 ; HR = 1.83), and INVD (p = 8.79 × 10 –4 ; HR = 2.06) clusters each demonstrating reduced survival relative to the QUIET cluster ( Figures 7 E and S7 F).

Section: Discussion

Our comprehensive analysis of 2,778 genome graphs establishes JCN topology as a key signal for the classification of complex SVs in human cancer. The regional, genotypic, and tumor type distribution of SV classes nominated in this study (pyrgo, rigma, and tyfonas) are distinct from previously identified complex rearrangement patterns (CT, chromoplexy, and BFBC), suggesting that they represent novel mutational processes and/or foci of somatic selection. We anticipate that these findings, combined with JaBbA’s superior performance relative to previous CNA algorithms, will bring the genome graph paradigm to the mainstream of cancer genome analysis.
Our data show that rigma likely arise from early and ongoing accumulation of DEL-like junctions at large and late-replicating genes. Though rigma are overrepresented among previously annotated fragile sites defined by cell culture experiments ( Schwartz et al., 2006 62. Schwartz, M. ∙ Zlotorynski, E. ∙ Kerem, B. The molecular basis of common and rare fragile sites Cancer Lett. 2006; 232 :13-26 Crossref Scopus (124) PubMed Google Scholar ; Fungtammasan et al., 2012 20. Fungtammasan, A. ∙ Walsh, E. ∙ Chiaromonte, F. ... A genome-wide analysis of common fragile sites: what features determine chromosomal instability in the human genome? Genome Res. 2012; 22 :993-1005 Crossref Scopus (112) PubMed Google Scholar ; Ohta et al., 1996 52. Ohta, M. ∙ Inoue, H. ∙ Cotticelli, M.G. ... The FHIT gene, spanning the chromosome 3p14.2 fragile site and renal carcinoma-associated t(3;8) breakpoint, is abnormal in digestive tract cancers Cell. 1996; 84 :587-597 Full Text Full Text (PDF) Scopus (1050) PubMed Google Scholar ; Ma et al., 2012 43. Ma, K. ∙ Qiu, L. ∙ Mrasek, K. ... Common fragile sites: genomic hotspots of DNA damage and carcinogenesis Int. J. Mol. Sci. 2012; 13 :11974-11999 Crossref Scopus (51) PubMed Google Scholar ), the majority of rigma actually fall outside of these loci. An intriguing possibility is that rigma identified in our study represent previously unannotated in vivo genomic fragile sites. If so, then future studies examining somatic rigma patterns as lineage-specific readouts of human genome fragility may shed insight into the biology of aging and developmental disease (e.g., autism and neurodegenerative conditions).
Previous studies have linked fragile sites to replication-transcription collisions in transcriptionally active genes ( Helmrich et al., 2011 27. Helmrich, A. ∙ Ballarino, M. ∙ Tora, L. Collisions between replication and transcription complexes cause common fragile site instability at the longest human genes Mol. Cell. 2011; 44 :966-977 Full Text Full Text (PDF) Scopus (414) PubMed Google Scholar ; Wilson et al., 2015 71. Wilson, T.E. ∙ Arlt, M.F. ∙ Park, S.H. ... Large transcription units unify copy number variants and common fragile sites arising under replication stress Genome Res. 2015; 25 :189-200 Crossref Scopus (128) PubMed Google Scholar ; Blin et al., 2019 7. Blin, M. ∙ Le Tallec, B. ∙ Nähse, V. ... Transcription-dependent regulation of replication dynamics modulates genome stability Nat. Struct. Mol. Biol. 2019; 26 :58-66 Crossref Scopus (52) PubMed Google Scholar ). The significant recurrence of rigma at FHIT and other fragile site–associated genes (e.g., WWOX and MACROD2 ) even after correcting for covariates suggests that replication timing and gene size do not fully account for their accumulation in hotspots. The preference of rigma for ESAD (and, more broadly, GI adenocarcinomas) suggests that somatic rigma patterns in GI cancers may reflect epigenetic states of cell types in the healthy GI epithelium, which may be revealed through further study via single-cell approaches or cell sorting and chromatin profiling.
While a subset of pyrgo hotspots (e.g., MYC superenhancers) may be functional and under positive somatic selection, the association of pyrgo with superenhancers is more likely due to a neutral mutational process that predisposes enhancers to (nested) duplications. Recent work suggests that enhancers may form cooperative multivalent chromatin structures ( Hnisz et al., 2017 29. Hnisz, D. ∙ Shrinivas, K. ∙ Young, R.A. ... A phase separation model for transcriptional control Cell. 2017; 169 :13-23 Full Text Full Text (PDF) Scopus (1045) PubMed Google Scholar ), some of which may be prone to characteristic breakage and repair patterns ( Canela et al., 2017 9. Canela, A. ∙ Maman, Y. ∙ Jung, S. ... Genome organization drives chromosome fragility Cell. 2017; 170 :507-521.e18 Full Text Full Text (PDF) Scopus (252) PubMed Google Scholar ). Further studies combining WGS and chromatin profiling in the same tumor sample will be required to assess the functional role of pyrgo formation in the evolution of cancer chromatin. More broadly, the explicit consideration of rigma and pyrgo patterns in future statistical background models of SV recurrence will be required to accurately nominate cancer driver loci in large cancer WGS datasets.
Though tyfonas likely represent the footprint of supernumerary rings in dedifferentiated liposarcomas, their prevalence in tumor types (e.g., acral melanomas and breast cancers) not commonly associated with supernumerary rings suggests that the cytogenetic footprint of this event may be more diverse. If our Hi-C, optical mapping, and FISH-based model of tyfonas ( Figure 6 E) generalizes, a key question is how these chromosomally integrated loci acquire such a wide breadth of JCN in cis . We speculate that this allelic configuration may require a transient extrachromosomal phase, enabling the progressive self-assembly of many linear fragments ligating and duplicating in parallel across successive cell cycles. These asymmetrically segregating shards may preferentially ligate with their sister shard in end-to-end orientation after each S phase, which may give rise to the tyfonas-associated fold-back inversion pattern.
The enrichment of breakend hypermutation across multiple non-APOBEC-associated SNV contexts in tyfonas suggests that these junctions may arise in a specific mutagenic cellular environment. Although we cannot rule out the role of APOBEC enzymes in generating these SNV patterns (e.g., within a non-canonical context), they may also arise through error-prone Pol-α fill-in or alternative non-homologous end joining (alt-NHEJ) repair, both of which are active at unprotected DNA ends and generate mutations across a wide spectrum of trinucleotide contexts ( Sfeir and de Lange, 2012 64. Sfeir, A. ∙ de Lange, T. Removal of shelterin reveals the telomere end-protection problem Science. 2012; 336 :593-597 Crossref Scopus (446) PubMed Google Scholar ; Mirman et al., 2018 48. Mirman, Z. ∙ Lottersberger, F. ∙ Takai, H. ... 53BP1-RIF1-shieldin counteracts DSB resection through CST- and Polα-dependent fill-in Nature. 2018; 560 :112-116 Crossref Scopus (275) PubMed Google Scholar ). We anticipate that future investigations in model systems will resolve some of these exciting mechanistic questions regarding tyfonas genesis.
Our study provides a template for integrating short-read WGS with long-range genome profiling to study patterns of somatic junction phase and allelic multiplicity in complex loci. Future studies that utilize long-range whole-genome profiles (10X Chromium WGS, Pacific Biosciences, Oxford Nanopore Technologies, Hi-C, and Bionano; Sedlazeck et al., 2018 63. Sedlazeck, F.J. ∙ Lee, H. ∙ Darby, C.A. ... Piercing the dark matter: bioinformatics of long-range sequencing and mapping Nat. Rev. Genet. 2018; 19 :329-346 Crossref Scopus (298) PubMed Google Scholar ) to phase highly rearranged somatic alleles may provide a more granular classification and mechanistic insight into complex SV mutational processes. Larger short-read meta-analyses spanning >10,000 cancer genome graphs, which may be imminently possible through the combination of our approach and dataset with PCAWG (1,493 additional tumors) ( ICGC/TCGA Pan-Cancer Analysis of Whole Genomes Consortium, 2020 31. ICGC/TCGA Pan-Cancer Analysis of Whole Genomes Consortium Pan-cancer analysis of whole genomes Nature. 2020; 578 :82-93 Crossref Scopus (1559) PubMed Google Scholar ), Hartwig Medical Foundation (>4,000 cases; Priestley et al., 2019 55. Priestley, P. ∙ Baber, J. ∙ Lolkema, M. ... Pan-cancer whole genome analyses of metastatic solid tumors bioRxiv. 2019; Crossref Google Scholar ), and emerging WGS precision medicine efforts will help link novel features of genome graph topology with clinical variables, including therapeutic response. This includes future investigations linking the presence of tyfonas to the efficacy of immune checkpoint inhibition in acral melanoma or other tumor types in which these events are found (e.g., small cell lung cancer).

Section: STAR★Methods

REAGENT or RESOURCE SOURCE IDENTIFIER Deposited Data gGnome.js browser to visualize JaBbA genome graphs This paper http://mskilab.com/gGraph/ WGS data from TCGA The Cancer Genome Atlas (TCGA) dbGaP: phs000178.v11.p8 Breast cancer WGS data from ICGC Nik-Zainal et al., 2016 50. Nik-Zainal, S. ∙ Davies, H. ∙ Staaf, J. ... Landscape of somatic mutations in 560 breast cancer whole-genome sequences Nature. 2016; 534 :47-54 Crossref Scopus (1492) PubMed Google Scholar EGA: EGAS00001001178 Melanoma WGS data from ICGC Hayward et al., 2017 26. Hayward, N.K. ∙ Wilmott, J.S. ∙ Waddell, N. ... Whole-genome landscapes of major melanoma subtypes Nature. 2017; 545 :175-180 Crossref Scopus (951) PubMed Google Scholar EGA: EGAS00001001552 Lung adenocarcinoma WGS data from ICGC Lee et al., 2019 39. Lee, J.J.-K. ∙ Park, S. ∙ Park, H. ... Tracing oncogene rearrangements in the mutational history of lung adenocarcinoma Cell. 2019; 177 :1842-1857.e21 Full Text Full Text (PDF) Scopus (133) PubMed Google Scholar EGA: EGAS00001002801 Esophageal adenocarcinoma data from ICGC Frankell et al., 2019 19. Frankell, A.M. ∙ Jammula, S. ∙ Li, X. ..., Oesophageal Cancer Clinical and Molecular Stratification (OCCAMS) Consortium The landscape of selection in 551 esophageal adenocarcinomas defines genomic biomarkers for the clinic Nat. Genet. 2019; 51 :506-516 Crossref Scopus (141) PubMed Google Scholar EGA: EGAD00001004417 Malignant lymphomas from ICGC International Cancer Genome Consortium (ICGC) EGA: EGAD00001002123 Prostate adenocarcinoma WGS data Baca et al., 2013 3. Baca, S.C. ∙ Prandi, D. ∙ Lawrence, M.S. ... Punctuated evolution of prostate cancer genomes Cell. 2013; 153 :666-677 Full Text Full Text (PDF) Scopus (977) PubMed Google Scholar dbGaP: phs000447.v1.p1 WGS data from the Cancer Cell Line Encyclopedia (CCLE) Cancer Cell Line Encyclopedia (CCLE) https://portals.broadinstitute.org/ccle ; available upon request to CCLE data proprietors WGS data from the Weill Cornell Englander Institute for Precision Medicine (EIPM) This paper Data available upon request to authors WGS data from the Cancer Alliance at the New York Genome Center This paper EGA: EGAS00001004013 WGS data from a multi-sampled cohort collected at the Fred Hutchinson Cancer Research Center This paper dbGaP: phs001912.v1.p1 (embargo until September 30, 2020) WGS data of HCC143(BL) and HCC1954(BL) for benchmarking and parameter tuning TCGA mutation/variation calling benchmarking dataset GDC https://gdc.cancer.gov/resources-tcga-users/tcga-mutation-calling-benchmark-4-files 10X linked-read sequencing data for HCC1954 and HCC1954BL 10X Genomics https://support.10xgenomics.com/genome-exome/datasets 10X linked-read sequencing data for NCI-H838 This paper NCBI BioProject: PRJNA623129 Hi-C sequencing data for NCI-H526 This paper NCBI BioProject: PRJNA623129 Processed GM12878 Hi-C sequencing data Rao et al., 2014 56. Rao, S.S. ∙ Huntley, M.H. ∙ Durand, N.C. ... A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping Cell. 2014; 159 :1665-1680 Full Text Full Text (PDF) Scopus (4556) PubMed Google Scholar ; Gene Expression Omnibus (GEO) GEO: GSE63525 ; GSE63525_GM12878_insitu_DpnII_combined.hic Gold-standard copy number segmentation for HCC1954 from array CGH data Cancer Cell Line Encyclopedia (CCLE) https://data.broadinstitute.org/ccle_legacy_data/dna_copy_number/CCLE_copynumber_2013-12-03.seg.txt Pan-cancer associated, amplified cancer drivers Zack et al., 2013 73. Zack, T.I. ∙ Schumacher, S.E. ∙ Carter, S.L. ... Pan-cancer patterns of somatic copy number alteration Nat. Genet. 2013; 45 :1134-1140 Crossref Scopus (1308) PubMed Google Scholar Available from published materials COSMIC Cancer Gene Census Wellcome Sanger Institute https://cancer.sanger.ac.uk/cosmic/download under “Cancer Gene Census” COSMIC Mutational Signatures (Ver 3) Wellcome Sanger Institute https://www.synapse.org/#!Synapse:syn12009743 Human reference genome, hg19 Genome Analysis Toolkit (GATK) Resource Bundle for hg19 from Broad Institute ftp://gsapubftp-anonymous@ftp.broadinstitute.org/bundle/ TCGA RNA-Seq Expressed Gene Fusions Dehghannasiri et al., 2019 14. Dehghannasiri, R. ∙ Freeman, D.E. ∙ Jordanski, M. ... Improved detection of gene fusions by applying statistical methods reveals oncogenic RNA cancer drivers Proc. Natl. Acad. Sci. USA. 2019; 116 :15524-15533 Crossref Scopus (25) Google Scholar https://www.pnas.org/content/pnas/suppl/2019/07/12/1900391116.DCSupplemental/pnas.1900391116.sd01.xlsx Cancer Cell Line Encyclopedia Mutation Data Barretina et al., 2012 4. Barretina, J. ∙ Caponigro, G. ∙ Stransky, N. ... The Cancer Cell Line Encyclopedia enables predictive modelling of anticancer drug sensitivity Nature. 2012; 483 :603-607 Crossref Scopus (5483) PubMed Google Scholar https://depmap.org/portal/download/api/download/external?file_name=ccle%2FCCLE_DepMap_18q3_maf_20180718.txt GENCODE v19 gene annotations The GENCODE Project https://www.gencodegenes.org/human/release_19.html Replication timing annotation Koren et al., 2014 36. Koren, A. ∙ Handsaker, R.E. ∙ Kamitaki, N. ... Genetic variation in human DNA replication timing Cell. 2014; 159 :1015-1026 Full Text Full Text (PDF) Scopus (112) PubMed Google Scholar http://mccarrolllab.org/wp-content/uploads/2015/03/Koren-et-al-Table-S2.zip Super-enhancer annotations Hnisz et al., 2013 28. Hnisz, D. ∙ Abraham, B.J. ∙ Lee, T.I. ... Super-enhancers in the control of cell identity and disease Cell. 2013; 155 :934-947 Full Text Full Text (PDF) Scopus (2425) PubMed Google Scholar Available from published materials Common fragile site annotations Kumar et al., 2019 38. Kumar, R. ∙ Nagpal, G. ∙ Kumar, V. ... HumCFS: a database of fragile sites in human chromosomes BMC Genomics. 2019; 19 :985 Crossref Scopus (47) Google Scholar https://webs.iiitd.edu.in/raghava/humcfs/ Chromothripsis calls from PCAWG consortium marker paper ICGC/TCGA Pan-Cancer Analysis of Whole Genomes Consortium, 2020 31. ICGC/TCGA Pan-Cancer Analysis of Whole Genomes Consortium Pan-cancer analysis of whole genomes Nature. 2020; 578 :82-93 Crossref Scopus (1559) PubMed Google Scholar https://dcc.icgc.org/releases/PCAWG/clustered_mutational_processes/; synapse id: syn12978907 Survival data for 729 ICGC cases ICGC https://dcc.icgc.org Survival data for 935 TCGA cases cBioPortal https://www.cbioportal.org/ Experimental Models: Cell Lines HCC1143 ATCC Cat# CRL-2321; RRID:CVCL_1245 HCC1143BL ATCC Cat# CRL-2362; RRID:CVCL_1246 NCI-H526 ATCC Cat# CRL-5811; RRID:CVCL_1569 NCI-H838 ATCC Cat# CRL-5844; RRID:CVCL_1594 ANA This paper Available upon approved request to authors Oligonucleotides Chromosome 2 Control Probe Empire Genomics Cat# CHR02-10-GR Recombinant DNA BAC Clone, RP11-463P22 BACPAC Resources Center https://bacpacresources.org/ BAC Clone, RP11-541K19 BACPAC Resources Center https://bacpacresources.org/ Software and Algorithms BWA mem and aln aligner Li and Durbin, 2009 40. Li, H. ∙ Durbin, R. Fast and accurate short read alignment with Burrows-Wheeler transform Bioinformatics. 2009; 25 :1754-1760 Crossref Scopus (31660) PubMed Google Scholar https://github.com/lh3/bwa ; RRID: SCR_010910 Picard Tools Broad Institute https://broadinstitute.github.io/picard/index.html ; RRID: SCR_006525 Genome Analysis Toolkit (GATK) Broad Institute https://gatk.broadinstitute.org ; RRID: SCR_001876 Bionano Solve, version 3.4 for SV optical mapping Bionano Genomics https://bionanogenomics.com/downloads/bionano-solve/ RefAligner, version 9248 Bionano Genomics https://bionanogenomics.com/downloads/bionano-solve/ Strelka2 SNV and Indel caller Kim et al., 2018 34. Kim, S. ∙ Scheffler, K. ∙ Halpern, A.L. ... Strelka2: fast and accurate calling of germline and somatic variants Nat. Methods. 2018; 15 :591-594 Crossref Scopus (696) PubMed Google Scholar https://github.com/Illumina/strelka SvABA SV caller Wala et al., 2018 70. Wala, J.A. ∙ Bandopadhayay, P. ∙ Greenwald, N.F. ... SvABA: genome-wide detection of structural variants and indels by local assembly Genome Res. 2018; 28 :581-591 Crossref Scopus (202) PubMed Google Scholar https://github.com/walaj/svaba R-3.5.1 The R Project https://www.r-project.org/ ; RRID: SCR_001905 fragCounter R package (build 575af99) Imielinski lab https://github.com/mskilab/fragcounter JaBbA (Junction Balance Analysis) R package (build d7f4bff) Imielinski lab https://github.com/mskilab/JaBbA gGnome R package (build c998026) Imielinski lab https://github.com/mskilab/gGnome GxG R package (build 4494adf) Imielinski lab https://github.com/mskilab/gxg fishHook R package (build 874f52f) Imielinski et al., 2017 33. Imielinski, M. ∙ Guo, G. ∙ Meyerson, M. Insertions and Deletions Target Lineage-Defining Genes in Human Cancers Cell. 2017; 168 :460-472.e14 Full Text Full Text (PDF) Scopus (83) PubMed Google Scholar https://github.com/mskilab/fishHook gUtils R package (build 449ab2a) Imielinski lab https://github.com/mskilab/gUtils gTrack R package (build 947c35c) Imielinski lab https://github.com/mskilab/gTrack Open table in a new tab
Further information and requests for resources, reagents, software/code, and data availability should be directed to the Lead Contact, Marcin Imielinski ( mski@mskilab.org ).
This study did not generate new unique reagents.
10X linked-read sequencing data is available from 10X Genomics by download (for HCC1954 and HCC1954BL, used in benchmarking, https://support.10xgenomics.com/genome-exome/datasets ). The accession number for the 10X data for NCI-H838 and Hi-C data for NCI-H526 used for validation studies reported in this paper is NCBI BioProject: PRJNA623129. The accession number for the WGS data from the Cancer Alliance at the New York Genome Center reported in this paper is EGA: EGAS00001004013. The accession number for the WGS data from the Seattle Barrett’s Esophagus Program (Fred Hutchinson Cancer Research Center) is dbGaP: phs001912.v1.p1
All custom R software used in this study (JaBbA, gGnome, fishHook, and other R packages to facilitate genomic data processing) is publicly available in our laboratory GitHub repository: https://github.com/mskilab . Briefly, JaBbA (available through https://github.com/mskilab/JaBbA ) was used to infer genome graphs. gGnome ( https://github.com/mskilab/gGnome ) was used for downstream manipulation of genome graphs as well as for detection of rearrangement events on the basis of genome graph features. fishHook ( https://github.com/mskilab/fishHook ) was used to apply a gamma-Poisson (or negative binomial) regression to detect statistical enrichment of events across genomic territory (hotspots), and to assess for significantly associated variables that explain event occurrence ( Imielinski et al., 2017 33. Imielinski, M. ∙ Guo, G. ∙ Meyerson, M. Insertions and Deletions Target Lineage-Defining Genes in Human Cancers Cell. 2017; 168 :460-472.e14 Full Text Full Text (PDF) Scopus (83) PubMed Google Scholar ). Other custom tools included: gUtils ( https://github.com/mskilab/gUtils ) for specialized analysis of genomic intervals; gTrack ( https://github.com/mskilab/gTrack ) for generating static visualization of genomic tracks; GxG ( https://github.com/mskilab/GxG ) for matrix-like, pairwise analysis of genomic territories in Hi-C and 10X linked-read barcode coverage; and skitools ( https://github.com/mskilab/skitools ) for miscellaneous R processing and visualization tools.
All analyses were performed using R (3.5.1) with Bioconductor (3.8, https://bioconductor.org/news/bioc_3_8_release/ ). Specific R/Bioconductor packages include: GenomicRanges for manipulation of genomic intervals, ComplexHeatmap for heatmap data, dplyr and data.table for tabular operations. JaBbA employs the IBM CPLEX v12.6.2 MIQP optimizer, which is available under academic licensing ( https://www.ibm.com/analytics/cplex-optimizer ). For Cox regression analysis, we used survival, and survminer packages. All graphs with the exception of track data, Kaplan-Meier curves, Cox hazard ratio plots, Q-Q plots, genome graph vertex illustrations, and heatmaps were plotted using ggplot2. Track data were plotted using gTrack. Decision trees were trained using rpart. Reordering of hierarchical cluster dendrograms was done using package vegan. The heatmaps are drawn with ComplexHeatmap package. Circos plots are produced with circlize package. 2-D layouts of genome graph illustrations were plotted using the R API of igraph. All other dependencies within these R packages are available from https://cran.r-project.org/ or Bioconductor R repositories https://bioconductor.org/packages/3.8/BiocViews.html#___Software .
The gGnome.js portal ( http://mskilab.com/gGraph/ ) is available to visualize the JaBbA genome graphs described in this study. Metadata related to the genome graphs (including SV data) is downloadable through this portal as JSON files. The source code to generate the gGnome.js interactive plots is available, also in our GitHub through https://github.com/mskilab/gGnome.js .
Cancer genome sequencing data was obtained from cases as part of The Cancer Genome Atlas (TCGA) Research Network consortium through the Genomic Data Commons ( https://portal.gdc.cancer.gov/legacy-archive ). We obtained 1,017 cases with appropriate dbGaP permissions (accession: phs000178.v11.p8) (see section Pan-cancer for more details regarding study inclusion criteria).
Additional WGS data was obtained for 876 cases from the International Cancer Genome Consortium from multiple studies publicly available through European Genome-Phenome Archive (EGA; https://ega-archive.org ). These cohorts include: 122 breast cancers published in Nik-Zainal et al. (2016) 50. Nik-Zainal, S. ∙ Davies, H. ∙ Staaf, J. ... Landscape of somatic mutations in 560 breast cancer whole-genome sequences Nature. 2016; 534 :47-54 Crossref Scopus (1492) PubMed Google Scholar (EGA: EGAS00001001178), 183 melanomas published in Hayward et al. (2017) 26. Hayward, N.K. ∙ Wilmott, J.S. ∙ Waddell, N. ... Whole-genome landscapes of major melanoma subtypes Nature. 2017; 545 :175-180 Crossref Scopus (951) PubMed Google Scholar (EGA: EGAS00001001552), 49 lung adenocarcinomas published in Lee et al. (2019) 39. Lee, J.J.-K. ∙ Park, S. ∙ Park, H. ... Tracing oncogene rearrangements in the mutational history of lung adenocarcinoma Cell. 2019; 177 :1842-1857.e21 Full Text Full Text (PDF) Scopus (133) PubMed Google Scholar (EGA: EGAS00001002801), 422 esophageal adenocarcinomas published in Frankell et al. (2019) 19. Frankell, A.M. ∙ Jammula, S. ∙ Li, X. ..., Oesophageal Cancer Clinical and Molecular Stratification (OCCAMS) Consortium The landscape of selection in 551 esophageal adenocarcinomas defines genomic biomarkers for the clinic Nat. Genet. 2019; 51 :506-516 Crossref Scopus (141) PubMed Google Scholar (EGA: EGAD00001004417), and 100 malignant lymphomas (EGA: EGAD00001002123).
Also, 55 prostate cancers previously published were obtained via dbGaP with accession, phs000447.v1.p1 ( Baca et al., 2013 3. Baca, S.C. ∙ Prandi, D. ∙ Lawrence, M.S. ... Punctuated evolution of prostate cancer genomes Cell. 2013; 153 :666-677 Full Text Full Text (PDF) Scopus (977) PubMed Google Scholar ).
Cell line data was also included in the cohort used in this study. WGS data for 326 cancer cell lines was obtained from the Cancer Cell Line Encyclopedia (CCLE) ( https://portals.broadinstitute.org/ccle ) ( Barretina et al., 2012 4. Barretina, J. ∙ Caponigro, G. ∙ Stransky, N. ... The Cancer Cell Line Encyclopedia enables predictive modelling of anticancer drug sensitivity Nature. 2012; 483 :603-607 Crossref Scopus (5483) PubMed Google Scholar ; Ghandi et al., 2019 22. Ghandi, M. ∙ Huang, F.W. ∙ Jané-Valbuena, J. ... Next-generation characterization of the Cancer Cell Line Encyclopedia Nature. 2019; 569 :503-508 Crossref Scopus (1676) PubMed Google Scholar ), with permissions granted by the proprietors of this dataset.
Whole genome sequencing was generated from additional sources as part of several New York City-based institutional clinical and research efforts at the Weill Cornell Englander Institute for Precision Medicine (EIPM) and at the New York Genome Center (NYGC) in collaboration with IBM.
In the EIPM study, tumor and matched normal (blood or normal adjacent) from 66 consented EIPM study participants spanning 12 tumor types were collected as part of a precision WGS oncology pilot study at Weill Cornell Medicine. 83 total tumor/normal pairs of samples were whole genome sequenced. This study was approved by a Weill Cornell Medicine Institutional Review Board.
In the Cancer Alliance (CA) study, clinically annotated frozen tumor and matched normal (blood, adjacent) samples were collected from 116 consented participants with pathologically verified diagnoses spanning 18 primary tumor types as part of a collaboration spanning nine academic medical institutions in the New York City area, including Memorial Sloan Kettering Cancer Center, New York University, Stony Brook University Hospital, Lenox Hill, Northwell Health, Columbia University, Montefiore, Cornell, and led by the New York Genome Center. Tumor and normal paired samples were submitted for precision oncology evaluation, including whole exome and whole genome sequencing and interpretation, at the New York Genome Center. This study was approved by a central institutional review board (IRB), Biomedical Research Alliance of New York, and by local IRBs, including Stony Brook University and Northwell Health.
Finally, as part of an ongoing study in collaboration with the Fred Hutchinson Cancer Research Center (Paulson et al., manuscript in preparation), a cohort of 80 cases of Barrett’s esophagus was included in this study. For each case, 4 endoscopic biopsies were collected across 2 time points and at each time point, an upper and lower location demarcated by distance from the esophagogastric junction. 40 of these cases progressed to esophageal adenocarcinoma in which the second time point corresponded to diagnosis of cancer. The second time point for the 40 non-progressor cases was a standard followup time point. Plus, 10 of the non-progressor cases were followed up at a third time point each with two extra spatially segregated biopsies. In total, this study yielded 340 BE samples. The study was approved by the Fred Hutchinson Cancer Research Center Institutional Review Office.
Additional cell lines were obtained for validation and benchmarking studies. Cell lines HCC1143 (CRL-2321), HCC1143BL (CRL-2362), NCI-H526 (CRL-5811), and NCI-H838 (CRL-5844) (available through ATCC, Manassas, VA) were cultured in ATCC-formulated RPMI-1640 Medium (ATCC 30-2001) with a final concentration of 10% fetal bovine serum (ATCC 30-2020). In addition, we obtained ANA cells through EBV-transformation of peripheral blood mononuclear cells. ANA cells were maintained using a subculture ratio of 1:4 every three days in RPMI-1640 (ATCC 30-2001) supplemented with 10% FBS and 1% penicillin/streptomycin.
Out of the total 2,813 WGS of tumor/normal pairs and cell lines covering 31 primary tumor types ( Table S1 ), 2,274 were obtained from The Cancer Genome Atlas (TCGA), the International Cancer Genome Consortium (ICGC), the Cancer Cell Line Encyclopedia (CCLE), or other previously published data (described below). In sum, 4,208 BAMs were downloaded from the respective institutional or publicly available repositories. Criteria for inclusion into this study were as follows: i) BAMs from only non-low pass WGS, ii) BAMs must be aligned to GRCh37/hg19, and iii) both tumor and normal non-low pass WGS must exist per pair except for cell lines. Previously published WGS cohorts included in this study were: 183 ICGC melanoma cases ( Hayward et al., 2017 26. Hayward, N.K. ∙ Wilmott, J.S. ∙ Waddell, N. ... Whole-genome landscapes of major melanoma subtypes Nature. 2017; 545 :175-180 Crossref Scopus (951) PubMed Google Scholar ), 49 ICGC lung adenocarcinomas ( Lee et al., 2019 39. Lee, J.J.-K. ∙ Park, S. ∙ Park, H. ... Tracing oncogene rearrangements in the mutational history of lung adenocarcinoma Cell. 2019; 177 :1842-1857.e21 Full Text Full Text (PDF) Scopus (133) PubMed Google Scholar ), 122 ICGC breast cancers ( Nik-Zainal et al., 2016 50. Nik-Zainal, S. ∙ Davies, H. ∙ Staaf, J. ... Landscape of somatic mutations in 560 breast cancer whole-genome sequences Nature. 2016; 534 :47-54 Crossref Scopus (1492) PubMed Google Scholar ), and 422 ICGC esophageal adenocarcinomas ( Frankell et al., 2019 19. Frankell, A.M. ∙ Jammula, S. ∙ Li, X. ..., Oesophageal Cancer Clinical and Molecular Stratification (OCCAMS) Consortium The landscape of selection in 551 esophageal adenocarcinomas defines genomic biomarkers for the clinic Nat. Genet. 2019; 51 :506-516 Crossref Scopus (141) PubMed Google Scholar ), 55 prostate cancers ( Baca et al., 2013 3. Baca, S.C. ∙ Prandi, D. ∙ Lawrence, M.S. ... Punctuated evolution of prostate cancer genomes Cell. 2013; 153 :666-677 Full Text Full Text (PDF) Scopus (977) PubMed Google Scholar ), and also 326 unpaired CCLE cell lines ( Barretina et al., 2012 4. Barretina, J. ∙ Caponigro, G. ∙ Stransky, N. ... The Cancer Cell Line Encyclopedia enables predictive modelling of anticancer drug sensitivity Nature. 2012; 483 :603-607 Crossref Scopus (5483) PubMed Google Scholar ; Ghandi et al., 2019 22. Ghandi, M. ∙ Huang, F.W. ∙ Jané-Valbuena, J. ... Next-generation characterization of the Cancer Cell Line Encyclopedia Nature. 2019; 569 :503-508 Crossref Scopus (1676) PubMed Google Scholar ). Raw sequencing data was obtained either from public repositories with the proper permissions granted through dbGaP (for TCGA WGS BAMs) or through the relevant Data Access Committees (for ICGC WGS BAMs). TCGA WGS BAMs were downloaded from the Genomic Data Commons (GDC; https://portal.gdc.cancer.gov/legacy-archive ). All ICGC BAMs were downloaded from the European Genome-Phenome Archive (EGA; https://ega-archive.org ). The additional 49 lung adenocarcinoma cases ( Lee et al., 2019 39. Lee, J.J.-K. ∙ Park, S. ∙ Park, H. ... Tracing oncogene rearrangements in the mutational history of lung adenocarcinoma Cell. 2019; 177 :1842-1857.e21 Full Text Full Text (PDF) Scopus (133) PubMed Google Scholar ) and 55 prostate cancers ( Baca et al., 2013 3. Baca, S.C. ∙ Prandi, D. ∙ Lawrence, M.S. ... Punctuated evolution of prostate cancer genomes Cell. 2013; 153 :666-677 Full Text Full Text (PDF) Scopus (977) PubMed Google Scholar ) were obtained through data access agreements with the relevant institutions involved.
Standard WGS data from four additional cell lines, G15512.HCC1954 (58X), G15512.HCC1954BL (71X), G15511.HCC1143 (50X), G15511.HCC1143BL (60X) were also downloaded from the Genomic Data Commons (GDC) in BAM format, as a part of the TCGA mutation/variation calling benchmarking dataset. The uuid for the file retrieval were 6d8044f73f63487c9191adfeed4e74d3 , 34c9ff85c2f845dcb4aafba05748e355 , ad3d4757f35840a39d92742463a95e88 , and f0eaa94bf62249b98eace 4eac6762598 , respectively. For haplotype reconstruction, we also generated 10X linked-read sequencing data for these cell lines (see below for protocol) (10X Genomics, Pleasonton, CA).
All collected standard short-read WGS reads were aligned using the Burrows-Wheeler Aligner ( Li and Durbin (2009) 40. Li, H. ∙ Durbin, R. Fast and accurate short read alignment with Burrows-Wheeler transform Bioinformatics. 2009; 25 :1754-1760 Crossref Scopus (31660) PubMed Google Scholar ) (via bwa mem or bwa aln settings) to the GRCh37/hg19 reference. Harmonized analytic pipelines (e.g., mutation calling, structural variant calling, and graph genome modeling) were then applied to these data (described in detail below).
We collected 801 samples, including 539 tumor samples, from 262 patients across three study cohorts: the IBM-NYGC Cancer Alliance (CA), Weill Cornell Englander Institute for Precision Medicine (EIPM), and the Seattle Barrett’s Esophagus project (BE). Sample characteristics of these cohorts are summarized in ( Table S2 ).
Library preparation and whole genome sequencing for all sequenced cohorts (CA, EIPM, BE) was performed at the New York Genome Center (NYGC) (New York, NY) to a target 80X tumor and 40X normal coverage. For the CA and EIPM studies and HCC1143/HCC1143BL cell lines, short-read genomic DNA library preparation was performed with the KAPA Library preparation kit in accordance with manufacturer’s protocols (Kapa Biosystems, Wilmington, MA). In the BE study, genomic DNA was extracted from 420 biopsies (comprising 340 Barrett’s esophagus and 80 normal samples) and 7 additional gastric normal samples that were not included in this study. 415 out of 427 libraries were prepared the TruSeq DNA PCR-free Library Prep Kit (Illumina, San Diego, CA). For the remaining 12 libraries, the TruSeq DNA Nano Library Prep Kit (Illumina) was used. All processing adhered to manufacturer’s protocols. Quality control was assayed for the final libraries with the Agilent 2100 Bioanalyzer by using the DNA 1000 chip (Agilent Technologies, Santa Clara, CA). QC determined that libraries contained an average peak height (fragment size) of ≥ 400 base pairs. Libraries were sequenced on HiSeq X machines (Illumina) to generate paired-end 2x150 base pair reads. Reads were aligned to the GRCh37/hg19 reference using Burrows-Wheeler aligner software ( Li and Durbin (2009) 40. Li, H. ∙ Durbin, R. Fast and accurate short read alignment with Burrows-Wheeler transform Bioinformatics. 2009; 25 :1754-1760 Crossref Scopus (31660) PubMed Google Scholar , bwa aln, v.0.7.8). Best practices for post-alignment data processing were followed through use of Picard ( https://broadinstitute.github.io/picard/ ) tools to mark duplicates, the GATK (v.2.7.4) ( https://gatk.broadinstitute.org/hc/en-us ) IndelRealigner module, and GATK base quality recalibration.
Cell line NCI-H838 was subjected to 10X Chromium linked-read whole genome sequencing. 10X linked-read sequencing BAMs aligned to assembly GRCh37 for HCC1954, HCC1954BL cell lines were obtained from 10X Genomics.
High molecular weight (HMW) genomic DNA (gDNA) was extracted using a QIAGEN MagAttract HMW DNA Kit (QIAGEN, Germany) according to the suggested protocol. Approximately 2 million fresh cells were lysed, HMW gDNA was captured by magnetic particles (QIAGEN MagAttract Suspension G), and then the magnetic particles with HMW gDNA was washed in wash buffer and eluted in EB Buffer (10 mM Tris-HCl, pH 8.5). The HMW gDNA had a mode length of 50 kbp and max length 200 kbp, as estimated on a separate 75V pulse-field gel electrophoresis (BluePippin 5-430kbp protocol).
10X sequencing library preparation was performed using a Chromium Genome Library Kit v2 (Lot 152527, 10X Genomics) following the Chromium Genome Reagent Kits v2 User Guide. 1 ng of extracted HMW gDNA was used to prepare a 150 bp paired-end library, with an average fragment length of 625 bp (ranging from 300 to 2000 bp, measured with the Bioanalyzer High Sensitivity DNA Kit, Agilent). The prepared library was sequenced on an Illumina NovaSeq 6000 Sequencing System with S4 flow cells, to an average read depth of about 33X, resulting in approximately 173X physical coverage for NCI-H838. All the 10X linked reads were aligned with Long Ranger (v2.1.3, 10X Genomics).
Cell line NCI-H526 was harvested with 5-10 million cells, and crosslinked following the protocol of the Arima-HiC Kit (Arima Genomics, San Diego). Briefly, cells were crosslinked by formaldehyde and quenched by glycine. After 1 million of the crosslinked cells were lysed, the nuclei were digested using multiple restriction enzymes (targeting GATC and GANTC motifs). The 5′ overhangs were then filled in and the digested ends were labeled with a biotinylated nucleotide. Next, spatially proximal digested ends of DNA were ligated and reversed. Subsequently, the proximal-ligated DNA then was purified with SPRISelect magnetic beads (Beckman Coulter, Indianapolis) and sheared with a Covaris E220 (Covaris, Woburm) sonicator to an average size of 300 bp. The proximal biotinylated DNA fragments were enriched using streptavidin beads. Finally, the Hi-C library was prepared using the proximal biotinylated DNA fragments by end-repair, dA-tailing, and ligation (NEB, Ipswich) with a KAPA Dual-Indexed Adaptor Kit (Sigma, St. Louis), followed by PCR amplification and purification. Concentration of the Hi-C library was then measured by a Qubit 4.0 Fluorometer (Thermo Fisher Scientific, Waltham). Quality controls for the libraries were performed with a 2100 bioanalyzer (Agilent Technologies, Santa Clara) and the KAPA Library Quantification Kit (Sigma, St. Louis). The Hi-C libraries were sequenced on a NovaSeq 6000 System (Illumina, San Diego) to obtain 150 bp paired-end reads. Reads were aligned single-end to the GRCh37/hg19 reference following the same alignment and post-alignment processing pipeline as for the whole genome sequencing reads, described above.
Ultra high molecular weight DNA extraction was performed on cell line NCI-H526 using a Bionano SP Blood & Cell DNA Isolation Kit catalog #80030, Bionano Genomics, San Diego), according to the Bionano Prep SP Frozen Cell Pellet DNA Isolation Protocol (document #30268, revision B). 1.5 million frozen cells in cryopreservation medium were thawed in a 37°C water bath, centrifuged for 2 minutes at 2000xg, washed, and re-suspended in DNA Stabilizing Buffer, made with 2% v/v DNA Stabilizer (PN 20397, Bionano Genomics) in Cell Buffer (PN 20374, Bionano Genomics). Cells were treated with proteinase K (#158920, QIAGEN, Germany) and RNase A (#158924, QIAGEN) in the presence of detergents and salts. DNA was bound to a silica disk, washed, eluted, and homogenized via 1 hour of end-over-end rotation at 15 rpm. The ultra-high molecular weight DNA was allowed to rest overnight at room temperature before fluorescent labeling.
Ultra-high molecular weight DNA was fluorescently labeled at the motif CTTAAG with the enzyme DLE-1 and counter-stained using a Bionano Prep DNA Labeling Kit – DLS (catalog #8005, Bionano Genomics, San Diego) according to the Bionano Prep Direct Label and Stain (DLS) Protocol (document #30206, revision F). DNA imaging and generation of single-molecule reads was performed on a second Generation Saphyr System with Saphyr chips (#60325 and #20366, Bionano Genomics) running Instrument Control Software version 4.7.18339.1. At least 400X coverage was generated.
Below, we formally define a reference genome, genome graph, and junction-balanced genome graph (JBGG). We show how we construct genome graphs from junctions and breakends obtained through the analysis of cancer whole genome sequences (WGS). We then define the JaBbA algorithm to infer JBGGs by fitting integer vertex and edge weights to high-density WGS read depth data through the solution of a mixed integer quadratic program (MIQP).
Let the reference genome 𝒞 comprise c pairs of strings, labeled 𝐶 𝑖 and 𝐶 − 𝑖 , 𝑖 ∈ 1 , … , 𝑐 . Each string pair 𝑖 ∈ 1 , … , 𝑐 is called a chromosome , and each string in that pair is called a strand . We use 𝐶 𝑖 and 𝐶 − 𝑖 to refer to “positive” and “negative” strands of chromosome i , each having length 𝐿 𝑖 ∈ ℕ . We use brackets to refer to substrings on these strands e.g., 𝐶 − 𝑖 ⁡ [ 𝑞 , 𝑟 ] refers to the substring beginning at position q and ending at position r (inclusive) where 1 ≤ 𝑞 ≤ 𝑟 ≤ 𝐿 𝑖 . We also use 𝐶 𝑖 𝑞 as a shorthand for 𝐶 𝑖 ⁡ [ 𝑞 , 𝑞 ] . Every position 𝐶 𝑖 𝑞 has a “reverse complement” (RC) position 𝐶 − 𝑖 𝑞 . Similarly, every substring 𝐶 𝑖 ⁡ [ 𝑞 , 𝑟 ] has an RC substring 𝐶 − 𝑖 ⁡ [ 𝑞 , 𝑟 ] .
To describe a rearranged and copy number altered reference genome, we partition 𝒞 according to a collection of breakends ℬ . We also define a set of junctions 𝒜 representing alternative adjacencies between a set of the breakends in ℬ . Each 𝐵 𝑖 ∈ ℬ , 𝑖 ∈ 1 , … , 𝑐 is an ordered and unique sequence of integer coordinates 𝐵 𝑖 = ( 𝐵 𝑖 𝑘 ) , 1 ≤ 𝐵 𝑖 𝑘 ≤ 𝐿 𝑖 on chromosome i , where 𝐵 𝑖 1 = 1 and 𝐵 𝑖 | 𝐵 𝑖 | = 𝐿 𝑖 . Each junction 𝐴 ∈ 𝒜 is a tuple ( 𝑖 1 , 𝑟 1 , 𝑖 2 , 𝑟 2 ) , 𝑟 1 ∈ 𝐵 | 𝑖 1 | , 𝑟 2 ∈ 𝐵 | 𝑖 2 | , | 𝑖 1 | , | 𝑖 2 | ∈ 1 , … , 𝑐 representing a (3′-5′ phosphodiester) bond between the position 𝑟 1 + ( − 𝑠 ⁢ 𝑔 ⁢ 𝑛 ⁡ ( 𝑖 1 ) + 1 2 ) on chromosome / strand 𝐶 𝑖 1 and position 𝑟 2 + ( 𝑠 ⁢ 𝑔 ⁢ 𝑛 ⁡ ( 𝑖 2 ) + 1 2 ) on chromosome / strand 𝐶 𝑖 2 . For every adjacency 𝐴 = ( 𝑖 1 , 𝑟 1 , 𝑖 2 , 𝑟 2 ) ∈ 𝒜 we require 𝒜 to contain the reverse complement adjacency ̅ 𝐴 = ( − 𝑖 2 , 𝑟 2 , − 𝑖 1 , 𝑟 1 ) . The adjacencies in 𝒜 are “alternative” relative to a set of “reference adjacencies” ℛ implied by 𝐵 𝑖 , comprising tuples ( 𝑖 , 𝐵 𝑖 𝑘 , 𝑖 , 𝐵 𝑖 𝑘 + 1 ) and ( − 𝑖 , 𝐵 𝑖 𝑘 + 1 , − 𝑖 , 𝐵 𝑖 𝑘 ) for each breakend 𝐵 𝑖 𝑘 , 𝑘 ∈ 1 , … , ∣ 𝐵 𝑖 ∣ − 1 in each chromosome 𝑖 ∈ 1 , … , 𝑐 .
A genome graph is a directed graph 𝐺 = ( 𝑉 , 𝐸 , 𝜓 , 𝜑 ) whose vertices 𝑣 ∈ 𝑉 represent strands of DNA sequences, and whose edges 𝑒 = ( 𝑣 1 , 𝑣 2 ) ∈ 𝐸 ⁡ ( 𝐺 ) represent genomic adjacencies (i.e., 3-5′ phosphodiester bonds) joining two DNA sequences, where 𝑣 1 , 𝑣 2 ∈ 𝑉 ⁡ ( 𝐺 ) ( Figure S1 B). The mapping 𝜓 : 𝑉 ⁡ ( 𝐺 ) ∪ 𝐸 ⁡ ( 𝐺 ) → {‘ I ’, ‘ L ’, ‘ T ’, ‘ R ’, ‘ A ’} is a partition of vertices and edges into key “classes,” which we refer to with subscripts, e.g., 𝑉 𝐼 ⁡ ( 𝐺 ) represents the set of vertices v for which 𝜓 ⁡ ( 𝑣 ) = ′ 𝐼 ′ . A second mapping 𝜑 ⁡ ( 𝑣 ) = ( 𝑖 , 𝑞 , 𝑟 ) maps vertices 𝑣 ∈ 𝑉 𝐼 in G to tuples of integer coordinates representing substrings 𝐶 𝑖 ⁡ [ 𝑞 , 𝑟 ] of reference genome sequence 𝒞 . For shorthand, we use 𝑉 = 𝑉 ⁡ ( 𝐺 ) and 𝐸 = 𝐸 ⁡ ( 𝑉 ⁡ ( 𝐺 ) ) when the context is obvious. We also use 𝐸 ⁡ ( 𝑣 ) ⊆ 𝐸 ⁡ ( 𝑉 ) to refer to the edges associated with a single vertex v , and refer to the incoming (“5′”) and outgoing (“3′”) edges of a vertex v as 𝐸 − ⁡ ( 𝑣 ) , 𝐸 + ⁡ ( 𝑣 ) ⊆ 𝐸 ⁡ ( 𝑣 ) , respectively.
The set V is partitioned to “internal” vertices 𝑉 𝐼 and sequence “ends” 𝑉 𝑁 , where 𝑉 = 𝑉 𝐼 ∪ 𝑉 𝑁 . The ends in 𝑉 𝑁 = 𝑉 𝑇 ∪ 𝑉 𝐿 further comprise reference ends 𝑉 𝑇 and “loose” ends 𝑉 𝐿 . The set of edges E is partitioned into reference edges 𝐸 𝑅 , alternate edges 𝐸 𝐴 , and loose end edges 𝐸 𝐿 connecting internal and loose end vertices, where 𝐸 = 𝐸 𝑅 ∪ 𝐸 𝐴 ∪ 𝐸 𝐿 . 𝐸 𝑅 also contains reference edges connecting (telomeric) internal vertices 𝑉 𝐼 with their reference-adjacent ends 𝑉 𝑇 . We apply subscript notation to refer to incoming and outgoing edges of vertices, e.g., 𝐸 − 𝐿 ⁡ ( 𝑣 ) = 𝐸 𝐿 ∩ 𝐸 − ⁡ ( 𝑣 ) and 𝐸 + 𝐿 ⁡ ( 𝑣 ) = 𝐸 𝐿 ∩ 𝐸 + ⁡ ( 𝑣 ) to denote the (single) loose end edge that is upstream and downstream of a vertex v , respectively.
We define a mapping 𝜅 : { 𝑉 𝐼 ∪ 𝐸 } → ℕ of non-negative integer copy number (CN) to vertices and edges of G , where 𝜅 ⁡ ( 𝑣 ) , 𝑣 ∈ 𝑉 𝐼 and 𝜅 ⁡ ( 𝑒 ) , 𝑒 ∈ 𝐸 represent the CN of vertex v and edge e , respectively. The principle of junction balance constrains the CN of every vertex to be equal to the sum of its incoming edges and the sum of its outgoing edges. Formally, the junction balance constraint is stated as follows: 𝜅 ⁡ ( 𝑣 ) = ∑ 𝑒 ∈ 𝐸 − ⁡ ( 𝑣 ) 𝜅 ⁡ ( 𝑒 ) = ∑ 𝑒 ∈ 𝐸 + ⁡ ( 𝑣 ) 𝜅 ⁡ ( 𝑒 ) (Equation 1) In addition we require the CN κ to obey skew-symmetry , which means that every vertex must have the same copy number as its RC. 𝜅 ⁡ ( 𝑣 ) = 𝜅 ⁡ ( ¯ 𝑣 ) , ∀ 𝑣 ∈ 𝑉 𝜅 ⁡ ( 𝑒 ) = 𝜅 ⁡ ( ¯ 𝑒 ) , ∀ 𝑒 ∈ 𝐸 (Equation 2) We call the combination ( 𝐺 , 𝜅 ) for which κ satisfies Equations 1 and 2 a junction-balanced genome graph (JBGG).
We infer JBGGs from a genome graph G and binned, normalized, and purity / ploidy-transformed read depth data 𝑥 ∈ ℝ 𝑛 across n genomic bins (see below for read depth transformation details) through the solution of a mixed integer quadratic program (MIQP), which assigns an integer CN 𝜅 : 𝑉 𝐼 ∪ 𝐸 → ℕ to the vertices and edges of G . The genome graph G is generated, as above, from a set of breakends ℬ 𝑠 ⁢ 𝑒 ⁢ 𝑔 obtained from a preliminary segmentation of genome-wide read depth (i.e., via segmentation software such as CBS) and a set of junctions 𝒜 (i.e., from a junction caller such as SvABA or DELLY).
Each vertex 𝑣 ∈ 𝑉 𝐼 ⁡ ( 𝐺 ) is associated with a partition of bins 𝐽 ⁡ ( 𝑣 ) ⊆ { 1 , … , 𝑛 } (based on genomic coordinate overlap) and a mean bin value 𝜌 ⁡ ( 𝑣 ) = ( 1 | 𝐽 ⁡ ( 𝑣 ) | ) ⁢ ∑ 𝑗 ∈ 𝐽 ⁡ ( 𝑣 ) 𝑥 𝑗 . We model each bin subset 𝑥 𝐽 ⁡ ( 𝑣 ) as an i.i.d. sample from a Gaussian distribution with standard deviation 𝜎 ⁡ ( 𝑣 ) and mean 𝜅 ⁡ ( 𝑣 ) . The log likelihood is 𝑙 ⁢ 𝑜 ⁢ 𝑔 ⁢ 𝑃 ⁡ ( 𝑥 𝐽 ⁡ ( 𝑣 ) ∣ 𝜅 ⁡ ( 𝑣 ) , 𝜎 2 ⁡ ( 𝑣 ) ) = ∑ 𝑗 ∈ 𝐽 ⁡ ( 𝑣 ) 𝑙 ⁢ 𝑜 ⁢ 𝑔 ⁢ 𝒩 ⁡ ( 𝑥 𝑗 ∣ 𝜅 ⁡ ( 𝑣 ) , 𝜎 2 ⁡ ( 𝑣 ) ) = − 𝒱 ⁡ ( 𝑣 , 𝜅 , 𝑥 , 𝐽 ) + 𝐶 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑠 ⁢ 𝑡 ⁡ ( 𝜅 ) (Equation 3) where 𝒩 ⁡ ( 𝜇 , 𝜎 2 ) is the Gaussian probability density function with mean μ and variance 𝜎 2 and 𝒱 ⁡ ( 𝑣 , 𝜅 , 𝑥 , 𝐽 ) = ( | 𝐽 ⁡ ( 𝑣 ) | 2 ⁢ 𝜎 2 ⁡ ( 𝑣 ) ) ⁢ ( 𝜌 ⁡ ( 𝑣 ) − 𝜅 ⁡ ( 𝑣 ) ) 2 is the read depth residual of vertex v . The variance 𝜎 2 ⁡ ( 𝑣 ) is a κ-independent parameter that models read depth noise and is computed directly from the data. The simplest noise model is a constant, where this parameter is set to the genome-wide sample variance of the read depth around each vertex mean: 𝜎 2 ⁡ ( 𝑣 ) = ̂ 𝜎 2 = ( 1 𝑛 − 1 ) ⁢ ∑ 𝑣 ∈ 𝑉 𝐼 ∑ 𝑗 ∈ 𝐽 ⁡ ( 𝑣 ) ( 𝑥 𝑗 − 𝜌 ⁡ ( 𝑣 ) ) 2 . In practice, we apply a vertex-specific variance estimate 𝜎 2 ⁡ ( 𝑣 ) to account for heteroscedasticity in the read depth data (see “JaBbA model fitting” section below).
Given this model, the joint log-likelihood of the read depth data x across the graph given copy number assignment κ is 𝑙 ⁢ 𝑜 ⁢ 𝑔 ⁢ 𝑃 ⁡ ( 𝑥 | 𝜅 ) = − ∑ 𝑣 ∈ 𝑉 𝐼 𝒱 ⁡ ( 𝑣 , 𝜅 , 𝑥 , 𝐽 ) + 𝐶 ⁢ 𝑜 ⁢ 𝑛 ⁢ 𝑠 ⁢ 𝑡 ⁡ ( 𝜅 ) (Equation 4) We also refer to 𝑉 ⁡ ( 𝐺 , 𝜅 , 𝑥 , 𝐽 ) = ∑ 𝑣 ∈ 𝑉 𝐼 𝑉 ⁡ ( 𝑣 , 𝜅 ⁡ ( 𝑣 ) , 𝑥 , 𝐽 ) as the read depth residual of the JBGG ( 𝐺 , 𝜅 ) relative to data x . The satisfaction of junction balance and skew-symmetry constraints in Equations 1 and 2 may place nonzero copy number at one or more loose end edges. Each loose end in the input graph represents a slack variable that allows the junction balance constraint to be relaxed at specific internal vertices, allowing the data to be fit even when junctions are missing from the input (e.g., due to low mappability, sequencing depth, or purity). Only loose ends that are given nonzero CN, are considered to be “used” in the final graph. To penalize solutions that require the use of many loose ends, we add an exponential prior with decay parameter λ on the loose end CN in ( 𝐺 , 𝜅 ) , which makes models with many missing junctions unlikely. This prior has log likelihood 𝑙 ⁢ 𝑜 ⁢ 𝑔 ⁢ 𝑃 ⁡ ( 𝜅 | ⁢ 𝐺 , 𝜆 ) = − | 𝑉 𝐼 | ⁢ 𝑙 ⁢ 𝑜 ⁢ 𝑔 𝜆 − 𝜆 ⁢ ℛ ⁡ ( 𝐺 , 𝜅 ) (Equation 5) where ℛ ⁡ ( 𝐺 , 𝜅 ) = ∑ 𝑣 ∈ 𝑉 𝐼 ℛ ⁡ ( 𝑣 , 𝜅 ) = ∑ 𝑣 ∈ 𝑉 𝐼 𝜅 ⁡ ( 𝐸 − 𝐿 ⁡ ( 𝑣 ) ) + 𝜅 ⁡ ( 𝐸 + 𝐿 ⁡ ( 𝑣 ) ) (Equation 6) is a complexity penalty . Adding the log likelihood in Equation 4 to the prior in Equation 5 yields a penalized log likelihood for the data with regularization parameter λ. Under this model, the maximum a posteriori probability (MAP) estimate of κ will minimize the function 𝑓 ⁡ ( 𝐺 , 𝜅 , 𝑥 , 𝐽 , 𝜆 ) = 𝒱 ⁡ ( 𝐺 , 𝜅 , 𝑥 , 𝐽 ) + 𝜆 ⁢ ℛ ⁡ ( 𝐺 , 𝜅 ) (Equation 7) which combines the quadratic read depth residual 𝒱 and ℓ 1 -norm complexity penalty ℛ into a single quadratic objective. In practice, we apply models that penalize the number of loose ends with nonzero copy number, i.e., applying an ℓ 0 -norm penalty ℛ ⁡ ( 𝜅 ) = ∑ 𝑣 ∈ 𝑉 𝐼 [ 𝜅 ⁡ ( 𝐸 − 𝐿 ⁡ ( 𝑣 ) ) > 0 ] + [ ( 𝜅 ⁡ ( 𝐸 + 𝐿 ⁡ ( 𝑣 ) ) > 0 ] ) . We use f to define a MIQP, which we solve to infer a MAP estimate for κ given data x and genome graph G : m i n i m i z e 𝜅 : 𝑉 𝐼 ∪ 𝐸 → ℕ 𝑓 ⁡ ( 𝐺 , 𝜅 , 𝑥 , 𝐽 , 𝜆 ) s u b j e c t t o κ ⁡ ( 𝑣 ) = 𝜅 ⁡ ( ¯ 𝑣 ) , ∀ 𝑣 ∈ 𝑉 𝐼 𝜅 ⁡ ( 𝑒 ) = 𝜅 ⁡ ( ¯ 𝑒 ) , ∀ 𝑒 ∈ 𝐸 𝜅 ⁡ ( 𝑣 ) = ∑ 𝑒 ∈ 𝐸 − ⁡ ( 𝑣 ) 𝜅 ⁡ ( 𝑒 ) = ∑ 𝑒 ∈ 𝐸 + ⁡ ( 𝑣 ) 𝜅 ⁡ ( 𝑒 ) , ∀ 𝑣 ∈ 𝑉 𝐼 (Equation 8) The resulting MAP estimate ̂ 𝜅 defines the JBGG ( 𝐺 , ̂ 𝜅 ) which is outputted and returned to the user.
Junction Balance Analysis (JaBbA; https://github.com/mskilab/JaBbA ) is an R package freely available under the MIT license. The required inputs to JaBbA are binned (e.g., 200bp) and normalized read depth data y , purity α, ploidy τ, a set of junctions 𝒜 (see mathematical formulation above), and a hyperparameter λ. The key output is a gGraph object representing a junction-balanced genome graph (i.e., solution to Equation 8 ) which can be queried and analyzed using downstream algorithms, e.g., SV event classification algorithms in the gGnome package ( https://github.com/mskilab/gGnome , see “Structural variant event classification” section below). The workflow of JaBbA is composed of four phases: read depth preprocessing, graph building, JaBbA model fitting, and postprocessing.
Raw input read depth data are generated for tumor and matched normal (i.e., constitutional) samples by tallying the count of midpoints of well aligned (MAPQ > 0) proper read pairs in a vector 𝑧 ∈ ℤ 𝑛 + (e.g., 𝑛 ≈ 15 million for 200 bp bins across hg19). These are further GC-corrected and mappability normalized through an iterative LOESS fitting procedure similar to Ha et al. (2012) 24. Ha, G. ∙ Roth, A. ∙ Lai, D. ... Integrative analysis of genome-wide loss of heterozygosity and monoallelic expression at nucleotide resolution reveals disrupted pathways in triple-negative breast cancer Genome Res. 2012; 22 :1995-2007 Crossref Scopus (182) PubMed Google Scholar and implemented in the fragCounter R package ( https://github.com/mskilab/fragCounter ). Briefly, a local estimated scatterplot smoothing (LOESS) function 𝑓 𝐺 ⁢ 𝐶 is fitted (R stats package “loess” function) to a random (100,000) subsample of bins to predict read depth as a function of GC content. Each bin’s read depth 𝑧 𝑗 , 𝑗 ∈ { 1 , … 𝑛 } is then divided by its fitted value 𝑓 𝐺 ⁢ 𝐶 ⁡ ( 𝑧 𝑗 ) to yield the normalized value 𝑧 𝐺 ⁢ 𝐶 𝑗 . A similar LOESS-based procedure is then applied to correct each GC-corrected read depth 𝑧 𝐺 ⁢ 𝐶 𝑗 with respect to its 100-mer mappability score to yield the GC and mappability corrected read depth 𝑧 𝐺 ⁢ 𝐶 ⁢ 𝑀 𝑗 . This procedure is applied separately for tumor and matched normal (if applicable).
The ratio of the GC and mappability corrected read depth profiles for the tumor 𝑧 𝑇 and normal 𝑧 𝑁 is then used to derive the normalized read depth profile 𝑦 ∈ ℝ 𝑛 + where 𝑦 𝑗 = ( 𝑧 𝑇 𝑗 ⁢ 𝑚 𝑁 𝑗 𝑧 𝑁 𝑗 ) , 𝑗 ∈ { 1 , … 𝑛 } and 𝑚 𝑁 𝑗 is the chromosomal-wide median in the normal read depth data for the chromosome containing bin j . Correction of the tumor / normal ratio by 𝑚 𝑁 𝑗 maintains a linear relationship between read depth and locus abundance in the original sample. Without this final step, bins from the X and Y chromosomes in a diploid male tumor will show the same read depth as the autosomes. Samples without a matched normal (e.g., cell lines) are divided by a “universal” (i.e., average) normal averaged across 943 GC and mappability corrected TCGA normal read depth profiles and then chromosome balanced.
We note that the read depth normalizations, described above, are formally performed upstream of the JaBbA pipeline (e.g., via fragCounter, R / Bioconductor). The goal of these normalizations is to reduce biases, with the goal of rendering the binned read depth 𝑦 𝑗 proportional (±noise) to the abundance of locus j in the tumor sample (which may include admixed normal cells). The final (purity / ploidy) transformation, included formally as part of the JaBbA pipeline, renders the transformed read depth 𝑥 𝑗 approximately equal (±noise) to its clonal integer CN 𝜅 ⁡ ( 𝑗 ) in the tumor (given an accurate purity / ploidy estimate). Formally, given a tumor sample with purity 𝛼 ∈ [ 0 , 1 ] and ploidy 𝜏 ∈ ℝ + , the read depth 𝑦 𝑗 , tumor CN 𝜅 ⁡ ( 𝑗 ) , and constitutional CN 𝜅 𝑁 ⁡ ( 𝑗 ) in bin 𝑗 will obey: 𝑦 𝑗 ∑ 𝑛 ̂ 𝑗 = 1 𝑦 ̂ 𝑗 ≈ 𝛼 ⁢ 𝜅 ⁡ ( 𝑗 ) + ( 1 − 𝛼 ) ⁢ 𝜅 𝑁 ⁡ ( 𝑗 ) ∑ 𝑛 ̂ 𝑗 = 1 𝛼 ⁢ 𝜅 ⁡ ( ̂ 𝑗 ) + ( 1 − 𝛼 ) ⁢ 𝜅 𝑁 ⁡ ( ̂ 𝑗 ) (Equation 9) Given ¯ 𝑦 = ( 1 𝑛 ) ⁢ ∑ 𝑛 ̂ 𝑗 = 1 𝑦 ⁢ ̂ 𝑗 , 𝜏 ≈ ( 1 𝑛 ) ⁢ ∑ 𝑛 ̂ 𝑗 = 1 𝜅 ⁡ ( ̂ 𝑗 ) , and a near diploid constitutional sample (i.e., in which ( 1 𝑛 ) ⁢ ∑ 𝑛 ̂ 𝑗 = 1 𝜅 𝑁 ⁡ ( ̂ 𝑗 ) ≈ 2 ), 𝑦 𝑗 ≈ 𝛼 ⁢ 𝜅 ⁡ ( 𝑗 ) + ( 1 − 𝛼 ) ⁢ 𝜅 𝑁 ⁡ ( 𝑗 ) 𝛼 ⁢ 𝜏 + 2 ⁢ ( 1 − 𝛼 ) ⁢ ¯ 𝑦 (Equation 10) Defining 𝛽 = ¯ 𝑦 ⁢ 𝛼 𝛼 ⁢ 𝜏 + 2 ⁢ ( 1 − 𝛼 ) 𝛾 = 2 ⁢ ¯ 𝑦 ⁢ ( 1 − 𝛼 ) 𝛼 ⁢ 𝜏 + 2 ⁢ ( 1 − 𝛼 ) (Equation 11) yields the following equation: 𝜅 ⁡ ( 𝑗 ) ≈ 𝑥 𝑗 = 2 ⁢ 𝑦 𝑗 − 𝜅 𝑁 ⁡ ( 𝑗 ) ⁢ 𝛾 2 ⁢ 𝛽 (Equation 12) Given known constitutional copy number (in practice, 𝜅 𝑁 ⁡ ( 𝑗 ) = 2 for all bins with the exception of X and Y chromosome in males, where 𝜅 𝑁 ⁡ ( 𝑗 ) = 1 ), the right hand side of Equation 12 is computed directly from the (GC and mappability corrected, tumor / normal ratio transformed) read depth data, purity, and ploidy and represents the binned read depth input x to JaBbA.
To build the genome graph G , the binned read depth x is segmented (e.g., using CBS) to yield the breakends ℬ . These breakends are combined via Algorithm S1 with the junctions 𝒜 to yield G . Briefly, this procedure 1) divides the reference genome into internal vertices 𝑣 𝐼 ∈ 𝑉 𝐼 each of which will be assumed to have a coherent CN, and 2) establishes edges 𝑒 ∈ 𝐸 = 𝐸 𝑅 ∪ 𝐸 𝐴 ∪ 𝐸 𝐿 that each represents an adjacency consistent with the reference genome (REF edge, 𝐸 𝑅 ), created by an rearrangement junction (ALT edge, 𝐸 𝐴 ), or an unmatched breakend (loose end, 𝐸 𝐿 ). The ends of the vertices are the union of junction breakends 𝑔 ⁢ 𝑒 ⁢ 𝑡 ⁢ 𝐵 ⁢ 𝑟 ⁢ 𝑒 ⁢ 𝑎 ⁢ 𝑘 ⁢ 𝑃 ⁢ 𝑜 ⁢ 𝑖 ⁢ 𝑛 ⁢ 𝑡 ⁢ 𝑠 ⁡ ( 𝒜 ) and a primary segmentation of the genome ℬ 𝑠 ⁢ 𝑒 ⁢ 𝑔 using the Circular Binary Segmentation algorithm ( Olshen et al., 2004 53. Olshen, A.B. ∙ Venkatraman, E.S. ∙ Lucito, R. ... Circular binary segmentation for the analysis of array-based DNA copy number data Biostatistics. 2004; 5 :557-572 Crossref Scopus (1693) PubMed Google Scholar ) (CBS), or from user input. The mapping 𝐽 ⁡ ( 𝑣 ) (see above) is constructed to associate internal vertices 𝑣 ∈ 𝑉 𝐼 ⁡ ( 𝐺 ) with partitions of bin indices.
Given a genome graph G , read depth data 𝑥 ∈ ℝ 𝑛 , and bin partition 𝐽 ⁡ ( 𝑣 ) ⊆ { 1 , … , 𝑛 } , 𝑣 ∈ 𝑉 𝐼 ⁡ ( 𝐺 ) , we infer a junction balanced genome graph ( 𝐺 , 𝜅 ) using the procedure outlined above (“Inferring junction-balanced genome graphs” section) with the following modifications: Instead of the arithmetic mean 𝜌 ⁡ ( 𝑣 ) , we use the sample geometric mean 𝜌 ⁡ ( 𝑣 ) = 𝑒 ⁢ 𝑥 ⁢ 𝑝 ⁡ ( 1 | 𝐽 ⁡ ( 𝑣 ) | ⁢ ∑ 𝑗 ∈ 𝐽 ⁡ ( 𝑣 ) 𝑙 ⁢ 𝑛 ⁡ ( 𝑥 𝑗 ) ) , which is more robust to outliers. To model heteroscedasticity in read depth, we compute a vertex specific variance function 𝜎 2 ⁡ ( 𝑣 ) . Specifically, we use LOESS to fit a smooth non-linear function f that links copy number to variance by fitting the sample mean 𝜌 ⁡ ( 𝑣 ) and sample variance ̂ 𝜎 2 ⁡ ( 𝑣 ) = 1 | 𝐽 ⁡ ( 𝑣 ) | − 1 ⁢ ∑ 𝑥 ∈ 𝐽 ⁡ ( 𝑣 ) ( 𝑥 𝑗 − 𝜌 ⁡ ( 𝑣 ) ) 2 across all 𝑣 ∈ 𝑉 𝐼 . This function is then used to determine the segment-specific variance term as 𝜎 2 ⁡ ( 𝑣 ) = 𝑓 ⁡ ( 𝜌 ⁡ ( 𝑣 ) ) . These 𝜎 2 ⁡ ( 𝑣 ) values are then used to populate the read depth residual sum of squares 𝒱 ⁡ ( 𝑣 , 𝜅 , 𝑥 , 𝐽 ) portion of the objective function in Equation 3 . Combining with the user-defined loose end penalty hyperparameter λ (default 100, tuned for 200 bp binned tumor / normal pairs, see below Hyperparameter tuning ), the MIQP problem ( Equation 8 ) is solved on the genome graph using an ℓ 0 complexity penalty. The solver is CPLEX (v12.6.2, IBM).
To increase sensitivity for missed junctions, the JaBbA pipeline employs several iterations of MIQP inference when two tiers of junctions (high and low confidence) are provided. Briefly, we fit a model using only high-confidence (e.g., FILTER = PASS in the unfiltered SvABA output VCF) junctions as input. In subsequent iterations, we fit a modified model that includes additional low-confidence junctions (e.g., those with low read support) that occur near (< 1 kbp) a loose end in the previous iteration. This procedure is run for a maximum of four iterations, or until no additional low confidence junctions near loose ends from the previous iteration have been found. Such a procedure particularly improves junction sensitivity in the setting of low purity and / or read depth.
After model fitting with CPLEX, we simplify the resulting JBGG by merging neighboring vertices of the same total CN that are connected only through REF edges. If ALT and REF read counts at constitutional heterozygous SNP sites are provided as (optional) input to JaBbA, we also infer the tumor allelic CN 𝜅 ℎ ⁡ ( 𝑣 ) and 𝜅 𝑙 ⁡ ( 𝑣 ) corresponding to the “high” ( h ) and “low” ( l ) allele, where 𝜅 ℎ ⁡ ( 𝑣 ) + 𝜅 𝑙 ⁡ ( 𝑣 ) = 𝜅 ⁡ ( 𝑣 ) and 𝜅 𝑙 ⁡ ( 𝑣 ) ≤ 𝜅 ℎ ⁡ ( 𝑣 ) , for each internal vertex 𝑣 ∈ 𝑉 𝐼 that overlaps a heterozygous SNP. Only biallelic heterozygous SNPs with two constitutional states, i.e., ALT and REF are considered.
Briefly, we model the “low” count at each heterozygous SNP (“low” can be REF or ALT, depending on which allele has fewer reads) overlapping v as a Poisson distribution with mean 𝛽 ⁢ 𝜅 𝑙 ⁡ ( 𝑣 ) + 1 2 ⁢ 𝜅 𝑙 ⁢ 𝑁 ⁡ ( 𝑣 ) ⁢ 𝛾 . Here, 𝜅 𝑙 ⁢ 𝑁 ⁡ ( 𝑣 ) is the constitutional allelic CN of the lower CN allele at each vertex v (e.g., 0 for X and Y chromosome in males, 1 elsewhere in the genome), and β and γ are defined as for (non-allelic) read depth ( Equation 11 ) with the following adjustments: genome-wide average ¯ 𝑦 is the mean allele-specific read count across all heterozygous SNPs, and τ is the mean non-allelic CN across heterozygous sites only. An analogous Poisson model is defined for the “high” allele (i.e., REF or ALT, depending which has more reads) at each heterozygous SNP associated with v . A joint Poisson log likelihood for the allelic CN of a given vertex v , 𝜅 ℎ ⁡ ( 𝑣 ) and 𝜅 𝑙 ⁡ ( 𝑣 ) , is then computed by summing all log likelihoods across both high and low alleles of all heterozygous SNPs mapped to v . The maximum likelihood configuration for 𝜅 ℎ ⁡ ( 𝑣 ) and 𝜅 𝑙 ⁡ ( 𝑣 ) is chosen and reported. The process is repeated across all internal vertices 𝑣 ∈ 𝑉 𝐼 ⁡ ( 𝐺 ) with at least one heterozygous SNP. The final output is then saved into a gGraph object that can be manipulated, visualized, and analyzed with the gGnome R package ( https://github.com/mskilab/gGnome ) and gGnome.js browser ( https://github.com/mskilab/gGnome.js ).
The only hyperparameter in JaBbA is the weight λ on the complexity penalty in Equation 3 . When λ is set to a low number (e.g., 0), JaBbA will generate a hypersegmented profile that follows the read depth closely and (potentially) generates many loose ends. When λ is set to a high number (e.g., 1 0 5 ), JaBbA will minimize the number of loose ends at the expense of deviating from the read depth data. In practice, we tuned λ across a set of values spanning several orders of magnitude { 5 0 , 1 0 0 , 2 0 0 , 5 0 0 , 1 0 0 0 } across a purity ladder ( 𝛼 ∈ { 0 . 5 , 0 . 6 , 0 . 7 , 0 . 8 , 0 . 9 , 1 . 0 } ) of in silico tumor and normal admixtures of the cancer cell line HCC1143 and matched normal HCC1143BL. We chose 100 as the most optimal value for 200bp bins, based on the F1 score of incorporated junctions and visual correspondence of fitted graphs to the data, though the performance was stable across at least an order of magnitude of the parameter sweep (data not shown). We note that the optimal value of λ may vary for alternate read depth bin sizes as well as lower or higher WGS read depths (or read lengths, insert sizes) that may reduce or increase the sensitivity of junction detection (and increase or reduce the optimal λ penalty, respectively).
JaBbA differs primarily from previous genome graph methods in its robust modeling of WGS read depth noise and missing (i.e., false negative) junctions within a MIP framework (see STAR Methods for details). First, while previous approaches (PREGO ( Oesper et al., 2012 51. Oesper, L. ∙ Ritz, A. ∙ Aerni, S.J. ... Reconstructing cancer genomes from paired-end sequencing data BMC Bioinformatics. 2012; 13 :S10 Crossref Scopus (34) PubMed Google Scholar ), CouGaR ( Dzamba et al., 2017 17. Dzamba, M. ∙ Ramani, A.K. ∙ Buczkowicz, P. ... Identification of complex genomic rearrangements in cancers using CouGaR Genome Res. 2017; 27 :107-117 Crossref Scopus (20) Google Scholar ), ReMixT ( McPherson et al., 2017 46. McPherson, A.W. ∙ Roth, A. ∙ Ha, G. ... ReMixT: clone-specific genomic structure estimation in cancer Genome Biol. 2017; 18 :140 Crossref Scopus (22) PubMed Google Scholar ), and Weaver ( Li et al., 2016 41. Li, Y. ∙ Zhou, S. ∙ Schwartz, D.C. ... Allele-specific quantification of structural variations in cancer genomes Cell Syst. 2016; 3 :21-34 Full Text Full Text (PDF) Scopus (30) PubMed Google Scholar )) directly model read counts as a Poisson (or gamma-Poisson) random variable, JaBbA gleans non-linear mean-variance relationships empirically from high-resolution fixed bin (200 bp) read depth data. This allows JaBbA to utilize transformed and normalized read depth data (e.g., via GC and mappability correction, tumor / normal ratio, purity and ploidy transformation). Such data violates Poisson assumptions (e.g., integer variable, linear or constant relationship between mean and variance) but more faithfully reflects CN in stromally admixed and aneuploid tumor genomes.
Second, JaBbA is robust to missing junctions by allowing (but penalizing) the use of loose ends in its reconstructions. Loose ends arise when a CN change is unaccompanied by a nearby junction. Such an event is a common occurrence in WGS data (e.g., due to low coverage, algorithmic filters, rearrangements in repetitive regions, etc.). Methods that do not explicitly model loose ends (e.g., PREGO, Weaver) suffer from either under- (PREGO) or over-segmentation (Weaver). Finally, by posing its inference as a MIP, JaBbA avoids analytic limitations inherent to PGM inference (ReMixT, Weaver), including the inability to identify global (expectation maximization, ReMixT) or local (loopy belief propagation, Weaver) optima or model very high-level CN states (ReMixT). In contrast, JaBbA’s MIP-based framework allows for the discovery of globally optimal model fits while allowing for an unrestricted range of CN states.
To identify simple and complex structural variant events in the genome graph output of JaBbA, we implemented a set of classifiers. These are implemented in the “events” function in the gGnome package (freely available from: https://github.com/mskilab/gGnome ), which calls the classifier functions below. Procedures followed to discover each event type are described below.
Rigma candidates were nominated as clusters of at least 2 overlapping DEL-like junctions with JCN less than ploidy and sizes between 10 kbp and 10 Mbp. fishHook was used as a Poisson model on a per sample basis to statistically nominate regions of the genome enriched with DEL-like junctions using sliding windows of 1 Mbp (500 kbp stride) while correcting for the occurrence of other junction types. From the model, regions with a significant enrichment of 𝐹 ⁢ 𝐷 ⁢ 𝑅 < 0 . 5 were chosen. Any significant regions that were adjacent were collapsed into contiguous regions. Candidate deletion clusters that fall within these statistically enriched collapsed regions were then marked as rigma events. The remaining isolated low-JCN deletions were called simple deletions. This caller is implemented as the “del” function of gGnome.
The procedure to identify pyrgo and simple duplications was analogous to the rigma identification above, but with the use of DUP-like junctions instead of DEL-like junctions. The same filters were applied as above. For candidate duplication clusters that pass these filters, fishHook was again used to statistically nominate genomic regions enriched for duplications while correcting for the occurrence of non-duplication junctions. Candidate duplication clusters that fall within the statistically enriched windows were then marked as a pyrgo. Collapsing was performed as for rigma. Remaining isolated low-JCN duplications were called simple duplications. This caller is implemented as the “dup” function of gGnome.
To nominate amplicons (amplified clusters), weakly connected components were identified among vertices with copy number above 2 × ploidy in JaBbA graphs. The resulting 12,588 subgraphs were further subsetted to only those with maximum JCN > 7 , leaving 1,703 such high level amplicons with at least one high copy junction. Four curated features were then used to annotate each of these amplicons, 1) maximum segmental/interval copy number 2) the sum of all fold back inversion JCN divided by maximal interval copy number, 3) the ratio between maximum JCN and maximum interval copy number, and 4) the number of junctions with elevated JCN (thresholded on JCN > 3 ). To separate these amplicons, hierarchical clustering with Euclidean distance and complete linkage was performed on the basis of these features.
To assess the most optimal number of amplicon clusters, k clusters from 2 to 15 were tested via a bootstrapping procedure. Briefly, for each k , the amplicons were clustered across 100 bootstraps in which 75% of the data was sampled and assessed using function “clusterboot” from the clusterboot R package. For each bootstrap and setting of k , k clusters were computed and a Jaccard similarity index was computed between every observed cluster and its most similar cluster in the sample. The stability of each observed cluster associated with a given k was computed as the average Jaccard similarity index across all bootstraps for that observed cluster. The cluster stability of the solution with parameter k was then computed as the average stability of all observed clusters associated with k .
Using the elbow method, 𝑘 = 4 was identified as the parameter setting with the maximal cluster stability. Furthermore, within each original cluster for a given k , a mean Jaccard score was computed to assess the level of evidence for a cluster. Clusters with mean score > 0.75 were considered stable, meaning there was sufficient evidence in the data to support the cluster as a true pattern, while those with mean score < 0.6 were likely artifactual.
Clustering was performed by building an unsupervised classifier that combines hierarchical clustering with a decision tree. Specifically, a decision tree was trained using recursive partitioning (function “rpart” in the eponymous R package) from the hierarchical clustering result based on the above features. The decision tree arrived at a fold back JCN ≥ 0.5 to distinguish tyfonas/BFBC amplicons from the double minute/Other amplicon categories. Out of the amplicons with fold-back JCN ≥ 0.5, amplicons with total number of junctions with high JCN (# ≥ 26) were called tyfonas and the rest were called BFBCs. Within amplicons containing fold-back JCN < 0.5, those amplicons with ≥ 31 high copy junctions distinguished otherwise unspecified amplicons (“Other”) from regular double minutes, respectively. This algorithm was then used to nominate the tyfonas, double minutes, BFBCs, and the unspecified amplicons (“Other”) among high level amplicons. These decision tree-based calls were then used for the subsequent analyses on these amplification events (see below). Although 4 was the optimal number of clusters, only three of the clusters (tyfonas-, double minute-, and BFBC-labeled amplicon clusters) showed a mean Jaccard score of > 0.75, with a fourth cluster scoring 0.67. Due to the inconclusiveness of this fourth cluster within the amplicon data, this pattern was excluded from further analyses. This caller is implemented as the “amp” function of gGnome.
Subgraphs that best fit the features of chromothripsis patterning described in Korbel and Campbell (2013) 35. Korbel, J.O. ∙ Campbell, P.J. Criteria for inference of chromothripsis in cancer genomes Cell. 2013; 152 :1226-1236 Full Text Full Text (PDF) Scopus (386) PubMed Google Scholar were identified. Candidate clusters (i.e., weakly connected components) of genomic intervals overlapping the footprints of at least three ALT junctions were nominated. These were further filtered to those clusters whose segmental copy numbers occupied a narrow range of states. Specifically, each interval within every footprint of a candidate cluster was subject to three criteria: 1) occupancy of at most 3 different copy states (for a diploid genome, adjusted up proportionally to the ploidy of the genome), 2) composition of at least 8 segments, and 3) having an interval copy number at the width-weighted 99 th percentile that did not exceed 4 (for a diploid genome, or adjusted to the ploidy of the genome). Clusters that survived this three-step filter were required to contain junctions with a near-uniform mixture of basic configurations ( 𝜒 2 test, p-value > 0 . 0 0 1 ). Out of the final remaining clusters, several further criteria were required to yield the final chromothripsis calls as follows: each cluster must have 1) at least 7 internal junctions, 2) no fewer than two sub-100kbp footprints and no more than four ≥ 100 kbp segments within the cluster, and 3) on average at least 3 junctions with inter-breakend spans that overlap one another. This caller is implemented as the “chromothripsis” function of gGnome.
Chromoplexy as first described in Baca et al. (2013) 3. Baca, S.C. ∙ Prandi, D. ∙ Lawrence, M.S. ... Punctuated evolution of prostate cancer genomes Cell. 2013; 153 :666-677 Full Text Full Text (PDF) Scopus (977) PubMed Google Scholar can be identified by a series of reciprocal (or nearly-reciprocal, with small deletion bridges between adjacent breakends) long-range junctions (span more than 10 Mbp on the reference). Accordingly, chromoplexy was identified from a pool of low-JCN ( ≤ 3 ) edge clusters in which junction breakends are no further than 10 kbp away from the next junction breakend. Edge clusters that contained at least 3 long-range junctions, and whose footprints occupied at least 3 discontiguous genomic territories separated by > 10 Mbp on the reference were called as chomoplexy events. This caller is implemented as the “chromoplexy” function of gGnome.
We nominated templated insertion chain (TIC) events that result from short insertions involving more than 1 junction, usually with a gain of copy of all loci within the event, or linking disparate loci through shorter segmental “hops” within the genome ( Li et al., 2020 42. Li, Y. ∙ Roberts, N.D. ∙ Wala, J.A. ..., PCAWG Structural Variation Working Group, PCAWG Consortium Patterns of somatic structural variation in human cancer genomes Nature. 2020; 578 :112-121 Crossref Scopus (416) PubMed Google Scholar ). To capture this pattern, the following procedure was used: Breakends identified across the whole genome were ordered along reference coordinates, and pairs of breakends that fall within an interval of ≤ 500 kbp and ≥ 50 kbp of each other were kept as candidates. These candidate breakend pairs comprise a “ + ”breakend followed by a “ − ” breakend in the direction of increasing reference coordinates, with each breakend originating from a different junction. A new graph was constructed with vertices comprising each junction and edges comprising adjacencies linked by candidate breakend pairs. All walks through the graph that traverse through at least 2 vertices/junctions were obtained. ALT junctions within each walk traversed on this graph were then labeled as a unique TIC event. This caller is implemented as the “tic” function of gGnome.
Inversions, inverted duplications, and translocations were also called as part of the compendium of SV event types in this study. Inversions and inverted duplications were both defined as pairs of overlapping, oppositely oriented, INV-like junctions of the same JCN as well as equal left and right vertex CN, with no third junction or a loose end interfering. We defined translocations as single or reciprocal pairs of TRA-like junctions connecting two different reference chromosomes that are not connected by any other junctions. This caller is implemented as the “simple” function of gGnome.
To visualize the genome graphs we developed gGnome.js (source code at https://github.com/mskilab/gGnome.js ), a Javascript-based genome browser that renders junction-balanced genome graphs and allows for interactive multi-scale browsing across discontiguous genomic intervals accompanied by various genomic annotations. The flexibility of arbitrary window browsing provided crucial confirmation of complex rearrangement events. The annotations of events were indexed within the browser and can be searched and presented. The gGnome interface enables visualizing any genome graph, either with CN as inferred by other graph callers, or even without CN in the case of plain genome graphs. An integrated tag filter helps narrow down desired samples by metadata including but not limited to primary cancer types, data source projects, mutation status of genes.
Annotations corresponding to segment-level and also junction-level information were included in the browser. Metadata for segments includes, but is not limited to, total copy number, allele-specific copy number (for samples and intervals in which heterozygous SNP information is available, i.e., cases with both tumor and normal pairs), and correspondence to event type if the segment was identified as part of an event. Edge metadata includes information output by the SV caller used in this study, SvABA, including number of reads supporting the SV and junction topology.
Harmonized pipelines for junction detection, high-density read depth estimation, purity / ploidy inference, somatic SNV / indel calling, and loss of function mutation calling were applied to the full dataset of 2,813 WGS cases as described below. Several standard analyses for mutational interpretation, signature inference, and APOBEC analyses were performed.
High- and low-confidence somatic junction calls for tumor / normal pairs were obtained using SvABA ( Wala et al., 2018 70. Wala, J.A. ∙ Bandopadhayay, P. ∙ Greenwald, N.F. ... SvABA: genome-wide detection of structural variants and indels by local assembly Genome Res. 2018; 28 :581-591 Crossref Scopus (202) PubMed Google Scholar ), based on the optimal settings for input into JaBbA (see above). For samples (e.g., CCLE cell lines) that lacked a paired normal sample, we used HCC1143BL WGS as the normal / constitutional reference sample. To futher eliminate constitutional junctions, we used SvABA to obtain normal / constitutional junction calls for 1,017 TCGA tumor/normal pairs and construct a panel of normals (PON). All somatic junction candidates within 1 kbp of a PON junction (determined by overlap at both breakends) were flagged as constitutional and removed. The remaining SvABA calls were treated as “high-confidence” calls if they passed SvABA internal filters. The remaining calls were treated as “low-confidence” (see “JaBbA model fitting” section above).
Coverage profiles were derived using fragCounter ( https://github.com/mskilab/fragCounter ), which counts the midpoints of proper pairs in 200 bp bins tiling hg19 using samtools (v1.9) and corrects the binned read counts by LOESS (function “loess” within R base package) (see “read depth preprocessing” section for mathematical details). We then segmented tumor / normal ratios using Circular Binary Segmentation ( Olshen et al., 2004 53. Olshen, A.B. ∙ Venkatraman, E.S. ∙ Lucito, R. ... Circular binary segmentation for the analysis of array-based DNA copy number data Biostatistics. 2004; 5 :557-572 Crossref Scopus (1693) PubMed Google Scholar ) (“segment” function in DNAcopy R package). For samples lacking a matched normal (i.e., CCLE cell lines), a composite of the 1,017 TCGA normal coverage profiles was used, comprising the average of the 200 bp bins across all autosomal chromosome coordinates.
From the 2,813 WGS sequenced samples, we excluded 34 samples for which JaBbA optimization did not converge and one sample which exceeded RAM requirements during SV classification. Among 69 graphs which did not converge on first pass ( < 16G RAM, < 24 hours compute time), 35 successfully completed with increased memory and runtime ( < 500G RAM, > 24 hours of compute time). One of these 35 failed SV classification due to the number of incorporated junctions exceeding RAM requirements. Upon inspection, graphs that failed to converge at the JaBbA were associated with noisy read depth data and many segments ( > 130,000 internal vertices).
For all cases with both a tumor and normal WGS profile, read counts supporting germline heterozygous SNP alleles were obtained by intersecting SNV sites present in both tumor and normal with SNPs from HapMap 3.3. Purity and ploidy estimates were obtained for all samples through Sequenza ( Favero et al., 2015 18. Favero, F. ∙ Joshi, T. ∙ Marquard, A.M. ... Sequenza: allele-specific copy number and mutation profiles from tumor sequencing data Ann. Oncol. 2015; 26 :64-70 Full Text Full Text (PDF) Scopus (471) PubMed Google Scholar ), TITAN ( Ha et al., 2014 25. Ha, G. ∙ Roth, A. ∙ Khattra, J. ... TITAN: inference of copy number architectures in clonal cell populations from tumor whole-genome sequence data Genome Res. 2014; 24 :1881-1893 Crossref Scopus (238) PubMed Google Scholar ), Ppurple ( https://github.com/mskilab/Ppurple ), or a custom least-squares grid search ppgrid (available through JaBbA). Consensus purity and ploidy was determined by curation from the panel of the three calls across all tumor normal pairs. ppgrid, which does not require germline SNP sites, was used for CCLE cell lines to obtain purity and ploidy estimates since germline SNP sites were unavailable.
To obtain somatic SNV/indel calls Strelka2 ( Kim et al., 2018 34. Kim, S. ∙ Scheffler, K. ∙ Halpern, A.L. ... Strelka2: fast and accurate calling of germline and somatic variants Nat. Methods. 2018; 15 :591-594 Crossref Scopus (696) PubMed Google Scholar ) was run under paired (i.e., tumor / normal) mode with default parameters using hg19-based references. Somatic SNVs and indels were obtained only for those cases where tumor and normal BAMs were available (2481 out of 2813 cases). In addition to the recommended filters, a universal mask ( https://github.com/lh3/CHM-eval ) was used to remove common artifacts in low-mappability regions, described in Mallick et al. (2016) 45. Mallick, S. ∙ Li, H. ∙ Lipson, M. ... The Simons Genome Diversity Project: 300 genomes from 142 diverse populations Nature. 2016; 538 :201-206 Crossref Scopus (837) PubMed Google Scholar . After these initial filters, only sites determined to pass Strelka2′s quality filter (i.e., sites where the “FILTER” field was marked as “PASS”) were considered, yielding a high quality set of somatic SNV calls. Variant annotations were obtained for SNV/indel using SnpEff with the GRCh37.75 database.
For constitutional SNV/indel calls Strelka2 ( Kim et al., 2018 34. Kim, S. ∙ Scheffler, K. ∙ Halpern, A.L. ... Strelka2: fast and accurate calling of germline and somatic variants Nat. Methods. 2018; 15 :591-594 Crossref Scopus (696) PubMed Google Scholar ) was run as above, except in normal-only mode. Germline SNVs and indels were obtained only for non-cell line samples within the study. The universal mask was also used for germline SNV/indel calls. Additional filters restricted the germline variants used to those which met the following criteria: i) sites that do not overlap with common variants i.e., those variants that matched coordinates and ALT alleles with sites from the normal ExAC population that have a minor allele frequency of > 1% ( ftp://ftp.broadinstitute.org/pub/ExAC_release/release0.3.1/subsets/ ), ii) high quality sites as determined by Strelka2′s quality thresholds (i.e., sites in which the “FILTER” field was marked as “PASS”), and iii) sites that overlapped and matched ALT alleles with known pathogenic variants from ClinVar annotations (ftp.ncbi.nlm.nih.gov:/pub/clinvar/vcf_GRCh37). Variant annotations were obtained for this final, high quality set of germline SNVs/indels using SnpEff as above. For constitutional heterozygous SNP calls (see “Postprocessing” section above), we used HapMap 3.3 defined on hg19 ( https://www.sanger.ac.uk/resources/downloads/human/hapmap3.html ). We assessed tumor and normal SNP counts using Rsamtools (R / Bioconductor) and nominated constitutional heterozygote sites as any site with > 0 . 2 and < 0 . 8 ALT variant allele fraction in the normal sample.
Alteration status of genes was obtained across the cohort. Homozygous deletions, heterozygous deletions, and amplifications were detected from absolute copy number calls available from the JaBbA graphs. Filtered SNV/indel annotations falling within protein coding regions, were considered only if they constituted somatic missense or truncating events, germline pathogenic variants, or germline truncating variants. To obtain loss-of-heterozygosity calls allele-specific copy number was called in cases with both tumor and normal samples. With genome-wide germline heterozygosity coverage for these samples, allele-specific copy number was measured using JaBbA using the “jabba.alleles” function within the JaBbA R package. For CCLE, our calls only included the publicly available mutational drivers.
To obtain contributions of the 67 COSMIC single base substitution (SBS) signatures (release 3, https://cancer.sanger.ac.uk/cosmic/signatures/SBS/ or https://www.synapse.org/#!Synapse:syn12009743 ) ( Alexandrov et al., 2020 1. Alexandrov, L.B. ∙ Kim, J. ∙ Haradhvala, N.J. ..., PCAWG Mutational Signatures Working Group, PCAWG Consortium The repertoire of mutational signatures in human cancer Nature. 2020; 578 :94-101 Crossref Scopus (1687) PubMed Google Scholar ) within all tumor/normal pairs, deconstructSigs was employed using the high-quality somatic SNV calls as input ( Rosenthal et al., 2016 61. Rosenthal, R. ∙ McGranahan, N. ∙ Herrero, J. ... DeconstructSigs: delineating mutational processes in single tumors distinguishes DNA repair deficiencies and patterns of carcinoma evolution Genome Biol. 2016; 17 :31 Crossref Scopus (738) PubMed Google Scholar ). Only SNVs falling within well-mappable sites (eligible) in the human genome were considered, i.e., those that occur outside of the universal mask regions described above. Genome-wide signature weights were corrected using the ratio of trinucleotide frequencies in the hg19 genome over the ratio of the trinucleotide frequencies in the eligible regions. The re-weighted 67 COSMIC signatures were refitted to the cohort to obtain signature contributions. The most likely SNV signature was determined for each somatic SNV call within a sample by using the vector of fitted signature contributions as the prior multiplied by the vector of signature weights possible for a given trinucleotide context. To obtain the likelihood of a variant arising from each of the 67 signatures given the signature contribution, each trinucleotide context weight was then normalized by the sum of the product of the signature contributions and trinucleotide signature weights.
APOBEC mutations were defined using COSMIC SBS2 and SBS13, GC-strand coordinated SNV clusters ( Roberts et al., 2013 60. Roberts, S.A. ∙ Lawrence, M.S. ∙ Klimczak, L.J. ... An APOBEC cytidine deaminase mutagenesis pattern is widespread in human cancers Nat. Genet. 2013; 45 :970-976 Crossref Scopus (890) PubMed Google Scholar ), or as TpC mutated contexts ( Roberts et al., 2012 59. Roberts, S.A. ∙ Sterling, J. ∙ Thompson, C. ... Clustered mutations in yeast and in human cancers can arise from damaged long single-strand DNA regions Mol. Cell. 2012; 46 :424-435 Full Text Full Text (PDF) Scopus (325) PubMed Google Scholar ). Unless noted, the APOBEC SNV definition used was any SNV with a maximum posterier probability to be assigned to COSMIC SBS2 or SBS13. Otherwise, GC-strand coordinated SNVs were determined by fitting the distance between SNVs on the reference (distance defined per sample) to an exponential model (“glm” function from the stats package within R with argument “family = Gamma” and with a shape parameter of 1 to score distance between breakends). The model was fit using all inter-SNV distances to get a dataset-wide average rate. p values were derived by comparing the observed inter-SNV distances to the expected using the fitted parameters based on the exponential generalized linear model. All SNVs with an FDR < 0 . 1 0 were considered clustered. Clusters were then identified by labeling consecutive runs of clusters on the reference. Consecutive runs with only G or with only C mutated were labeled as GC-strand coordinated.
Simulated sequencing of rearranged tumor samples for benchmarking were first constructed as haplotype-specific genomic sequences in .fasta format, then read sampling, alignment, and finally mixed with normal reads to a series of purity levels. In the first step we generated a set of de novo , forward simulated, rearranged cancer genomic sequences from an initial set of input junctions. The simulation iterates through simulated cell cycles to gradually incorporate the input junctions into the derived genome from previous steps until exhausting the input junction set, while keeping track of the actual rearranged haplotypes. As a result, it generates a coherent sequence of the rearranged genome guided by the haplotypes encoded in the reference genomic ranges. We then simulated sequencing reads from this FASTA file with ART read simulator ( Huang et al., 2012 30. Huang, W. ∙ Li, L. ∙ Myers, J.R. ... ART: a next-generation sequencing read simulator Bioinformatics. 2012; 28 :593-594 Crossref Scopus (902) PubMed Google Scholar ) to an average depth of 40X and aligned them to the reference genome hg19 to obtain the simulated BAMs. Trivially, the reference genome itself is also subjected to the same in silico sequencing to provide as normal controls. We did 40 distinct simulations with different random subsets of somatic junctions (from 5 to 333 total) identified in the HCC1143 breast cancer cell line.
In addition to these de novo simulated BAMs, we also obtained WGS for HCC1954 breast cancer cell line and HCC1954BL the corresponding normal fibroblast cell line. To simulate stromal admixture, we combined tumor and normal simulated (or HCC1954) BAM files, then downsampled, and mixed tumor and normal reads across ten tumor DNA proportions from 0.1 to 1.0. We created four technical replicates for each of these ten purity levels, which yielded 40 pairs of tumor and normal BAM files for the 40 distinct simulated genomes and HCC1954, respectively.
Intra-tumor structural variant heterogeneity was simulated by choosing two intersecting “donor” rigma (or pyrgo) events, and a “recipient” graph from another case lacking any structural variants at this rigma (or pyrgo) locus of interest. We then generated a series of “transplanted” graphs by embedding the DEL-like (or DUP-like, in case of pyrgo) junctions into the donor graph. We then created six graphs: one graph, called the rigma (or pyrgo) clone harboring all the junctions of a rigma (or pyrgo) simultaneously, the other five graphs each harboring one of the DEL-like junctions in the second rigma (or pyrgo). Each of these graphs represented a clone that was divergent at the locus of interest, but was otherwise identical.
We then generated 250 synthetic admixtures that were (1) stromally admixed to 80% tumor cells (2) associated with one rigma (or pyrgo) clone at cancer cell fractions f of 0%, 25%, 50%, 75%, and 100%. (3) associated with 50 random configurations of the five other DEL-like (or DUP-like) clones in proportions chosen from a Dirichlet distribution. For each admixture, a binned genome-wide coverage profile was calculated by sampling from a negative binomial distribution with a λ parameter weighted by the fractionally admixed copy numbers of each bin across the 5 input clones, and then normalized to genome-wide mean of 1. Similarly, the set of junctions provided to each admixture run was determined by sampling each junction with a probability corresponding to its clone fraction. For each admixture, the genome-wide coverage profile and junction set was input into JaBbA to infer a genome graph. Purity/ploidy estimates were obtained by the ppgrid least-squares grid search method as described above. Standard procedures to detect rigma, pyrgo, simple deletion, and simple duplications, (see above methods for details) were run. The rigma (or pyrgo) detection rate was calculated as the fraction of (50) admixtures for that setting of f in which a rigma (or pyrgo) was detected.
In the simplest terms, reconstructing genome graphs consists of two tasks: estimating junction copy numbers and DNA segment copy numbers. A junction is said to be incorporated in the genome graph if it is assigned non-zero copy number. Thus, a genome graph reconstruction method’s performance can be evaluated from these two main aspects, 1) incorporating correct junctions and estimating the correct JCNs, and 2) faithfully segmenting the genome and estimating their CNs. We compared JaBbA’s performance in both aspects against three other genome graph reconstruction methods, PREGO ( Oesper et al., 2012 51. Oesper, L. ∙ Ritz, A. ∙ Aerni, S.J. ... Reconstructing cancer genomes from paired-end sequencing data BMC Bioinformatics. 2012; 13 :S10 Crossref Scopus (34) PubMed Google Scholar ), ReMixT ( McPherson et al., 2017 46. McPherson, A.W. ∙ Roth, A. ∙ Ha, G. ... ReMixT: clone-specific genomic structure estimation in cancer Genome Biol. 2017; 18 :140 Crossref Scopus (22) PubMed Google Scholar ), Weaver ( Li et al., 2016 41. Li, Y. ∙ Zhou, S. ∙ Schwartz, D.C. ... Allele-specific quantification of structural variations in cancer genomes Cell Syst. 2016; 3 :21-34 Full Text Full Text (PDF) Scopus (30) PubMed Google Scholar ) ( Figures S1 D–S1H), and specifically in segmental CN estimation with two extra somatic CNA callers that do not infer genome graphs, BIC-Seq ( Xi et al., 2011 72. Xi, R. ∙ Hadjipanayis, A.G. ∙ Luquette, L.J. ... Copy number variation detection in whole-genome sequencing data using the Bayesian information criterion Proc. Natl. Acad. Sci. USA. 2011; 108 :E1128-E1136 Crossref Scopus (179) PubMed Google Scholar ) and CONSERTING ( Chen et al., 2015 10. Chen, X. ∙ Gupta, P. ∙ Wang, J. ... CONSERTING: integrating copy-number analysis with structural-variation detection Nat. Methods. 2015; 12 :527-530 Crossref Scopus (52) PubMed Google Scholar ) ( Figures S1 G and S1H). Another genome graph reconstruction method, CouGaR, is limited to amplified regions, so we only applied it to one replicate of the HCC1954 to demonstrate its difference from the other methods at a putative BFBC locus ( Figure S1 I).
The input junctions to all genome graph reconstruction methods were their respective default recommendations, namely SvABA unfiltered candidates for JaBbA; internal junction callers for Weaver, CouGaR; and the union of 3 junction calls, SvABA filtered ( Wala et al., 2018 70. Wala, J.A. ∙ Bandopadhayay, P. ∙ Greenwald, N.F. ... SvABA: genome-wide detection of structural variants and indels by local assembly Genome Res. 2018; 28 :581-591 Crossref Scopus (202) PubMed Google Scholar ), Delly ( Rausch et al., 2012 57. Rausch, T. ∙ Zichner, T. ∙ Schlattl, A. ... DELLY: structural variant discovery by integrated paired-end and split-read analysis Bioinformatics. 2012; 28 :i333-i339 Crossref Scopus (1364) PubMed Google Scholar ), Novobreak ( Chong et al., 2017 13. Chong, Z. ∙ Ruan, J. ∙ Gao, M. ... novoBreak: local assembly for breakpoint detection in cancer genomes Nat. Methods. 2017; 14 :65-67 Crossref Scopus (67) PubMed Google Scholar ), for PREGO, ReMixT, and CONSERTING as they make no default recommendations. As a note, we saw very similar performance with JaBbA using standard settings (SvABA unfiltered junctions) and the union junction set (data not shown).
To evaluate junction incorporation and JCN estimation, the incorporated junctions were approximately matched to gold standard junctions, e.g., both breakends were within 1 kbp from the corresponding gold standard junctions with the same orientations. True positives were the number of matches, false positives were incorporated junctions without a match, and false negatives were gold standard junctions without a match. An F1 score of the incorporated junctions, the harmonic mean of precision and recall, was then computed for each benchmarking sample ( Figure S1 E). Gold standard junctions for HCC1954 were defined as the consensus set inferred from the original high depth data (junctions identified by at least two callers out of SvABA, Delly, Novobreak).
Inferred JCNs of the graph reconstruction were compared to the matching gold standard junctions, if any, from the simulated dataset. The proportion of correctly fitted JCNs out of all incorporated junctions times recall of incorporation represented the accuracy or completeness of JCN estimation ( Figure S1 D).
When evaluating CNA inference performance, two metrics were considered. One was the correct placement of CN change points. Analogous to matching junction breakends, we considered an inferred CN change-point to match a gold standard if their distance was within 1 kbp and they have the same direction of CN change, e.g., increasing or decreasing CN from the side with smaller coordinates to the larger. To prevent spurious matching between inferred and gold standard CN change points, occurring in cases with excessive hypersegmentation, gold standard CN change points were only matched to the nearest identically oriented inferred CN change point. Based on the matching, F1 scores were computed and shown in Figure S1 F. For HCC1954, the gold standard CN change-points were defined as the consensus junction breakends.
The other set of metrics reflects the concordance between the inferred CN profile with the gold standard. For each segment in the gold standard, the overlapping inferred segments were identified. The inferred CN for that gold standard segment was then defined as the overlap width-weighted average of inferred CN. Subsequently, the root mean squared error (RMSE) √ ∑ ( ̂ 𝑥 − 𝑥 𝑔 ⁢ 𝑜 ⁢ 𝑙 ⁢ 𝑑 ⁢ 𝑠 ⁢ 𝑡 ⁢ 𝑎 ⁢ 𝑛 ⁢ 𝑑 ⁢ 𝑎 ⁢ 𝑟 ⁢ 𝑑 ) 2 𝑛 was computed across all gold standard segments for each sample ( Figure S1 G). The gold standard for HCC1954 CN profile was derived from published microarray-based segmentation downloaded from the CCLE data portal. High-depth WGS coverage data was mapped onto these segments and transformed into copy number space using the known ploidy of 4.5 and purity of 0.99. To compactly show the relationship between inferred CN and gold standard from all runs, we drew scatterplots across all gold standard segments in all successful runs for each method, and the Pearson ρ of each method was calculated from all data points pooled together ( Figure S1 H).
To show that the JaBbA-inferred junction copy numbers are accurate in real samples, we used 10X linked-read sequencing (10X) of the breast cancer cell line HCC1954 as an orthogonal experimental validation. All junctions connecting segments of at least 20 kbp with JCN ≤ 3 0 were included, except for ALT junctions with breakends separated by less than 100 kbp, and REF junctions with a breakend that also harbored a loose end of > 3 0 copies. The number of unique barcodes mapped within 20 kbp from both cis sides of the breakends of each ALT junction was plotted as a red dot in Figure 1 C. Same applied to the breakends of REF junctions (blue dots). Finally, both were compared to the fitted ratio between barcode coverage and DNA integer CN at randomly sampled unrearranged loci (gray line).
The tyfonas event in cell line NCI-H526 was validated using two-color DNA fluorescence in situ hybridization (FISH). FISH probes were designed against loci of interest using BAC clones ( https://bacpacresources.org ) and Empire Genomics (Buffalo, NY, USA) control probes. Several probe designs were used and designated as specific combinations. Combination one included RP11-463P22 (directly labeled red) and Empire Genomics chromosome 2 control probe (green). Combination two consisted of RP11-541K19 (directly labeled red) and Empire Genomics chromosome 2 control probe (green). The H526, HCC1143BL, and ANA cell lines were treated with Colcemid (0.1 g/ml) for 1 hour to obtain a metaphase preparation. Cells were then fixed in methanol/acetic acid (3:1). Fixed cells were then allowed to dry for 1 week on a microscope slide. Prepped slides were placed in a denaturation solution (70% formamide/2x SSC) for 5 minutes at 73°C proceeded by ethanol dehydration. Directly labeled probes were placed onto the slides and cells on the slide were then denatured for 3 minutes at 73°C proceeded by hybridization at 37°C for 72 hours. After hybridization, slides were first washed in 0.4x SSC/0.3% NP-40 at 73°C followed by a second wash in 2x SSC/0.1% NP-40 at 23°C. Metaphase cells were then stained with DAPI before visualization. Prior to use, all BAC clones were validated on metaphase spreads using the diploid ANA and HCC1143BL cell line. The nuclei and metaphase spreads were observed using a fluorescence microscope (Olympus BX51; Olympus Optical, Tokyo, Japan) and Cytovision software was used for imaging.
Clusters of low-JCN junctions were defined as groups of at least 3 junctions with JCN ≤ 3 whose intervals all cross either between the breakends (for intrachromosomal junctions) or within a 100 kbp window from interchromosomal breakends. The density of low-JCN DEL-like or DUP-like junctions was computed across the genomes within our cohort using a gamma-Poisson model (R package fishHook, https://github.com/mskilab/fishHook , ( Imielinski et al., 2017 33. Imielinski, M. ∙ Guo, G. ∙ Meyerson, M. Insertions and Deletions Target Lineage-Defining Genes in Human Cancers Cell. 2017; 168 :460-472.e14 Full Text Full Text (PDF) Scopus (83) PubMed Google Scholar )) to identify loci that are significantly enriched with the desired genomic event (e.g., density of DEL-like junctions) while correcting for covariates (the presence of other, e.g., non DEL-like, junctions).
Specifically, across 1 Mbp genomic tiles (500 kbp stride) the number of low-JCN deletions or duplications was counted within each sample and then tiles were selected that have higher density of events than expected under the model taking into account all tiles across all samples and the local density of non DEL-like or non DUP-like junctions, respectively. P-values were obtained for every tile × sample combination by comparing the observed density of each tile-sample pair against the expected value of the gamma-Poisson model. Tiles that were density outliers by an FDR < 0 . 1 0 were considered density outliers. Based on this model fitting, pyrgo and rigma events were identified on JaBbA graphs (see above for precise procedures).
Several sources of genomic covariates were used to determine topographic correlations with event (rigma, pyrgo, simple deletion, simple duplication) density. Smoothed replication timing data from lymphoblastoid cell lines ( Koren et al., 2014 36. Koren, A. ∙ Handsaker, R.E. ∙ Kamitaki, N. ... Genetic variation in human DNA replication timing Cell. 2014; 159 :1015-1026 Full Text Full Text (PDF) Scopus (112) PubMed Google Scholar ) was used as the reference to determine early, middle, and late replicating regions in the genome. For superenhancer analysis, we considered the union of coordinates from all cell lines with superenhancer peaks described in Hnisz et al. (2013) 28. Hnisz, D. ∙ Abraham, B.J. ∙ Lee, T.I. ... Super-enhancers in the control of cell identity and disease Cell. 2013; 155 :934-947 Full Text Full Text (PDF) Scopus (2425) PubMed Google Scholar . Human fragile sites were obtained from the HumCFS compendium of common fragile sites in humans ( Kumar et al., 2019 38. Kumar, R. ∙ Nagpal, G. ∙ Kumar, V. ... HumCFS: a database of fragile sites in human chromosomes BMC Genomics. 2019; 19 :985 Crossref Scopus (47) Google Scholar ). Out of 124 fragile site regions from this resource, 34 of them were > 10 Mbp in size. Exclusion of these large regions left 90 finely mapped common fragile sites. These 90 were then used in subsequent analyses involving fragile sites. Both gene annotations from GENCODE v29 and common fragile site regions originally mapped to the hg38 reference were lifted to hg19 coordinates.
To assess the timing of rigma and deletions, analysis was restricted to the 340 samples from 80 cases for which we had multiple biopsies (i.e., the Barrett’s esophagus cohort). All genomic footprints of rigma and simple deletion events were analyzed for overlap with other events across samples for each case. Deletions or rigma which were found within a 500 bp window in at least one of the other samples for an individual case were designated as early.
To compare chromothripsis and rigma events, we assessed two different measures, namely the genomic footprint occupied by each event type, and the number of junctions that could maximally be placed in cis . This measure was obtained by seeking the longest possible (traversing through the most junctions) allelic haplotypes through the JaBbA graphs (as defined below), at the loci containing these the events. Junctions that occurred on one haplotype in a given locus were considered in cis whereas those occurring across different haplotypes were in trans .
Within a locus of interest, 10X linked-read sequencing was used to reconstruct the set of local allelic haplotypes that best represents the linked-read sequencing data while conforming to the copy number constraints of the local graph. Potential haplotypes H are enumerated by identifying all traversals through the local subgraph G from source to sink vertices. An allelic haplotype ℎ ∈ 𝐻 is a walk through subgraph G containing a sequence of vertices 𝑉 ⁡ ( ℎ ) ⊆ 𝑉 ⁡ ( 𝐺 ) and edges 𝐸 ⁡ ( ℎ ) ⊆ 𝐸 ⁡ ( 𝐺 ) . For every linked read p from a linked-read dataset 𝒫 and every haplotype ℎ ∈ 𝐻 , the function 𝑂 ⁡ ( 𝑝 , ℎ ) → { 0 , 1 } indicates whether the linked read p supports the haplotype h . A linked read p (a set of aligned reads from the 10X linked-read sequencing library that share a barcode) supports a given allelic haplotype h (thus, 𝑂 ⁡ ( 𝑝 , ℎ ) = 1 ) if it meets all of the following conditions: (1) all of the individual reads from the linked read with alignments within the window of the locus must align to vertices included in the allelic haplotype 𝑣 ∈ 𝑉 ⁡ ( ℎ ) ; (2) the vertices 𝑣 ∈ 𝑉 ⁡ ( ℎ ) with linked-read coverage must be consecutive within the walk h ; and (3) if h contains any ALT junction 𝑒 = ( 𝑣 1 , 𝑣 2 ) ∈ 𝐸 𝐴 , the linked read must have alignments to both 𝑣 1 and 𝑣 2 (i.e., junction-supporting reads) for at least one junction in the allelic haplotype. A mixed integer program (MIP) assigns a copy number to each allelic haplotype subject to the constraints of vertex and edge copy numbers. The objective function minimizes the number of unique haplotypes ℎ ∈ 𝐻 assigned a non-zero copy number while maximizing the number of linked reads with support for at least one ℎ ∈ 𝐻 assigned a non-zero copy number. The MIP is defined as follows: m i n i m i z e 𝜅 : 𝐻 → ℕ ∑ ℎ ∈ 𝐻 [ ⟦ 𝜅 ⁡ ( ℎ ) > 0 ⟧ ] − ∑ 𝑝 ∈ 𝒫 ∑ ℎ ∈ 𝐻 ⟦ [ 𝜅 ⁡ ( ℎ ) > 0 ] ⟧ ⁢ 𝑂 ⁡ ( 𝑝 , ℎ ) s u b j e c t t o 𝜅 ⁡ ( 𝑣 ) = ∑ ℎ ∈ 𝐻 𝜅 ⁡ ( ℎ ) ⁢ 𝛿 ⁡ ( 𝑣 , ℎ ) , ∀ 𝑣 ∈ 𝑉 𝐼 𝜅 ⁡ ( 𝑒 ) = ∑ ℎ ∈ 𝐻 𝜅 ⁡ ( ℎ ) ⁢ 𝛿 ⁡ ( 𝑒 , ℎ ) , ∀ 𝑒 ∈ 𝐸 (Equation 13) where the definition of κ, defined previously as a mapping 𝜅 : { 𝑉 𝐼 ∪ 𝐸 } → ℕ of non-negative integer copy number to vertices and edges of G , has been expanded to 𝜅 : { 𝑉 𝐼 ∪ 𝐸 ∪ 𝐻 } → ℕ , where 𝜅 ⁡ ( ℎ ) , ℎ ∈ 𝐻 represents the non-negative integer copy number of a given allelic haplotype h , and 𝛿 ⁡ ( 𝑣 , ℎ ) and 𝛿 ⁡ ( 𝑒 , ℎ ) represent the copy number within a single copy of h of vertex v and edge e respectively.
To characterize the cis -allelic structure associated with select complex event patterns (i.e., rigma and chromothripsis) without explicitly inferring allelic phases, an optimization approach searched through all possible allelic states to identify the configuration that placed the most ALT junctions in cis . This “max cis analysis” was applied to each local genome subgraph defined around a given event. The weight w of a single flow 𝑓 ⊆ 𝐸 ⁡ ( 𝐺 ) through the graph from a source vertex to a sink vertex is defined as 𝑤 ⁡ ( 𝑓 ) = ∑ 𝑒 ∈ 𝑓 [ ⟦ 𝑒 ∈ 𝐸 𝐴 ⟧ ] , such that 𝑤 ⁡ ( 𝑓 ) is equal to the number of ALT junctions in f (square bracket is indicator function). The flow that incorporates the maximum possible number of ALT junctions is found by solving a MIP with the following objective function: m a x i m i z e 𝑓 ⊆ 𝐸 ⁡ ( 𝐺 ) 𝑤 ⁡ ( 𝑓 ) s u b j e c t t o ∑ 𝑒 ∈ 𝑓 ∑ 𝑣 ∈ 𝑉 𝐼 𝑑 ⁡ ( 𝑣 , 𝑒 ) = 0 ∑ 𝑒 ∈ 𝑓 [ ⟦ 𝑑 ⁡ ( 𝑣 , 𝑒 ) < 0 ⟧ ] = ∑ 𝑒 ∈ 𝑓 [ ⟦ 𝑑 ⁡ ( 𝑣 , 𝑒 ) > 0 ] ⟧ ≤ 1 , ∀ 𝑣 ∈ 𝑉 𝐼 (Equation 14) where d is defined for a vertex v and edge e pair 𝑣 , 𝑒 as 𝑑 ⁡ ( 𝑣 , 𝑒 ) = ⎧ { ⎨ { ⎩ − 1 , i f 𝑒 ∈ 𝐸 − ⁡ ( 𝑣 ) 1 , i f 𝑒 ∈ 𝐸 + ⁡ ( 𝑣 ) 0 , o t h e r w i s e (Equation 15) Given a solution f , which may contain a single linear allele (i.e., path) but also additional (disjoint) cycles, we identify a linear allele 𝑓 𝑙 ⊂ 𝑓 via a depth first search beginning with the (unique) vertex 𝑣 ∈ 𝑉 ⁡ ( 𝑓 ) that does not have an incoming edge in f . Because any focal duplication event (e.g., via a DUP-like, fold back inversion junction) will create cycles in the graph, it is also necessary to consider cyclic alleles as part of a potential max cis allele. Edges contributing to these cyclic alleles will not be included in 𝑓 𝑙 (nor necessarily in f ).
Subgraphs comprising these circular alleles are detectable as strongly connected components (SCC’s) in the graph, each which could be potentially unraveled along a walk that traverses every node and edge of that SCC at least once and places the edges of that SCC in cis . That SCC may also be embedded into any linear allele that it intersects to create a longer linear walk with an embedded subwalk corresponding to a traversal of that SCC. To account for the effect of cycles on max cis allele lengths, we compute the edges 𝑓 𝑠 ⊂ 𝐸 ⁡ ( 𝐺 ) of the largest SCC of G and 𝑓 𝑔 ⊂ 𝐸 ⁡ ( 𝐺 ) as the set of all edges of all SCC's of G that share at least one vertex with the linear allele 𝑓 𝑙 .
We then define the maximum fraction of ALT junctions in cis as 𝑚 ⁢ 𝑎 ⁢ 𝑥 ⁡ ( { 𝑤 ⁡ ( 𝑓 𝑙 ∪ 𝑓 𝑔 ) , 𝑤 ⁡ ( 𝑓 𝑠 ) } ) 𝑤 ⁡ ( 𝐸 ⁡ ( 𝐺 ) ) (Equation 16)
For the scope of amplification drivers, we selected Cancer Gene Census genes that intersect with the pan-cancer GISTIC amplification peaks in Zack et al. (2013) 73. Zack, T.I. ∙ Schumacher, S.E. ∙ Carter, S.L. ... Pan-cancer patterns of somatic copy number alteration Nat. Genet. 2013; 45 :1134-1140 Crossref Scopus (1308) PubMed Google Scholar . Any overlap between the genomic footprint of a double minute, BFBC, or tyfonas event with an amplified driver gene (thresholded as having a segmental CN > twice ploidy) was used to calculate the frequency of each event-gene combination.
We obtained expressed protein-coding gene fusion calls from a published TCGA RNA-seq analysis ( Dehghannasiri et al., 2019 14. Dehghannasiri, R. ∙ Freeman, D.E. ∙ Jordanski, M. ... Improved detection of gene fusions by applying statistical methods reveals oncogenic RNA cancer drivers Proc. Natl. Acad. Sci. USA. 2019; 116 :15524-15533 Crossref Scopus (25) Google Scholar ). Coordinate overlaps between expressed ( > 1 0 supporting RNA-seq reads) protein-coding gene fusion calls and SV event footprints from JaBbA graphs were tallied across 870 intersecting tumors. The number and genomic density of unique, expressed fusion products attributed to each event type were plotted in Figure 4 H. Enrichment between tyfonas and other SV event categories (double minutes, BFBC, chromothripsis, other) was assessed using the Wilcoxon rank-sum test.
To analyze breakend hypermutation, all SV breakends were collapsed onto a new breakend coordinate system spanning the interval [ − 5 0 0 0 , 5 0 0 0 ] around the breakend site. Positive coordinates correspond to regions incorporated in a junction (referred to as cis ) and negative coordinates correspond to the region not incorporated in the rearrangement (referred to as trans ). Note for all breakend hypermutation-related analyses ( Figures 5 and S5 ) this use of cis / trans is related but distinct from the cis and trans nomenclature used to describe haplotypes and junctions occurring on the same underlying genomic molecule. For breakend hypermutation, cis and trans describes the positive and negative sides (respectively) of the breakend coordinate system.
Mutation density patterns were then analyzed in this breakend coordinate system. To minimize the effect of variant calling artifacts on these maps, SNVs within 10bp of a junction were removed and only the nearest breakend was paired to an SNV. The relative density of SNVs at every base pair on the new coordinate system was calculated by dividing the total number of SNVs at every site by the average number of SNVs from −5 to 0 kbp (i.e., trans SNVs within 5kbp of the breakend). To correct for the effect of copy number on the relative density, the densities at each base pair were divided by the average interval copy number of the segments corresponding to the cis and trans sides of the breakend-centric axes.
We analyzed APOBEC mutations as described above (“APOBEC mutations” section) using one of three alternate criteria: COSMIC v3 SBS2 and SBS13, GC-strand coordinated clusters, or C mutations in occurring within the TpC context). For SBS2 / SBS13 analysis, we used maximal likelihood assignments of each SNV to each SBS, as described above (“SNV signatures” section).
Chromothripsis events classified by PCAWG were downloaded from https://dcc.icgc.org/releases/PCAWG/clustered_mutational_processes/ under synapse id: syn12978907 ( ICGC/TCGA Pan-Cancer Analysis of Whole Genomes Consortium, 2020 31. ICGC/TCGA Pan-Cancer Analysis of Whole Genomes Consortium Pan-cancer analysis of whole genomes Nature. 2020; 578 :82-93 Crossref Scopus (1559) PubMed Google Scholar ). While the original calls classified multiple types of chromothripsis, for purposes of comparison within this study, these were simplified into 3 main types as identifiable from the metadata available: non-amplified chromothripsis, amplified chromothripsis, and liposarcoma-like chromothripsis, which was a subset of amplified chromothripsis. Out of 2,583 cases within the marker paper, 1,063 were found to overlap with cases within the cohort of this study, consisting of TCGA, and other ICGC datasets downloaded independently. Using only intersecting cases, comparison of presence of events within cases by tumor types was carried out with the tumor type annotations used for this study (labeled as WCM/NYGC to distinguish from PCAWG for related analyses in Figure S4 ). Jaccard similarity scores were computed from the overlaps of PCAWG-defined chromothripsis types with each class of amplicon type and chromothripsis defined by our study (WCM/NYGC).
The rare variant pipeline (Bionano Solve version 3.4) was used on the NCI-H526 fluorescent labeled molecule images to optically map and detect junctions. The junction-calling pipeline consists of three major steps: initial molecule alignment and clustering of junctions, consensus generation by molecule extension refinement, and final junction calling.
Using RefAligner (version 9248, Nguyen, 2010 49. Nguyen, J.V. Genomic Mapping: A Statistical and Algorithmic Analysis of the Optical Mapping System University of Southern California, 2010 Google Scholar , Anantharaman and Mishra, 2001 2. Anantharaman, T. ∙ Mishra, B. False positives in genomic map assembly and sequence validation International Workshop on Algorithms in Bioinformatics Springer, 2001; 27-40 Crossref Scopus (17) Google Scholar , Valouev et al., 2006 69. Valouev, A. ∙ Schwartz, D.C. ∙ Zhou, S. ... An algorithm for assembly of ordered restriction maps from single DNA molecules Proc. Natl. Acad. Sci. USA. 2006; 103 :15770-15775 Crossref Scopus (67) PubMed Google Scholar ), molecules in an input BNX file are aligned directly to the reference hg19 (-T 1E-7, -A 5, -L 40, -S 0.1 -sv 3 -MultiMatches 5). Significant internal alignment gaps (-outlier 1E-2) and end alignment gaps (-endoutlier 1.1E-2) may indicate the presence of junctions in the sample. To identify low allelic frequency junctions, the pipeline requires only a default minimum of three molecules calling the same junction. Molecules are determined to confirm the same insertion ( > 5 kbp in size), deletion ( > 5 kbp), duplication ( > 25 kbp) or inversion ( > 50 kbp) if the inferred variant positions overlap and their inferred variant sizes are similar (default of 20% size similarity). To confirm the same translocation, the inferred translocations must be in the same orientation and their breakends in close proximity (within a distance of 35 kbp).
A consensus is built using clusters of molecules that identified the same junction. The purpose of the consensus step is to verify that those junction-supporting molecules truly agree and can form a consensus that represents the variant allele. In this step, the loci on the reference assembly 150 kbp flanking the inferred junction are extracted, and the molecules that supported the junctions are aligned to each of the two junction-flanking reference fragments. The pipeline attempts to reconstruct the junction allele by using the molecules to extend into the junction region (-T 1E-7 -A 5 -L 40.0 -S 0.1 -extend 2 -maxExtend 250.0). If the molecules come from the same variant, they would have similar label patterns and form a consensus map that represents the variant allele. Note that for each junction, the same extension procedure is performed twice: one extension from the fragment left of the junction and one extension from the right.
Finally, the new local consensus maps are realigned to the reference to check if the same initial junction calls are made (-T 1E-7 -A 5 -L 40 -S 0.1 -sv 3 -MultiMatches 5 -svAlignConfByInterval 0.7). The pipeline will only report junctions that are confirmed in the final junction calling step. Note that potentially two consensus maps could form for each junction, but only one is kept in the end.
The complex structure of the tyfonas event in the NCI-H526 cell line was further resolved using Bionano optical mapping. The JaBbA pipeline as described above was rerun, with the following customized inputs: input junctions 𝒜 were the union of junction calls by SvABA which had been assigned non-zero CN in the original genome graph and junction calls identified by the Bionano Solve rare variant pipeline. To increase the fidelity of copy number reconstruction, read depth data was de-noised using dryclean ( Deshpande et al., 2019 15. Deshpande, A. ∙ Walradt, T. ∙ Hu, Y. ... Robust foreground detection in somatic copy number data bioRxiv. 2019; Crossref Google Scholar ).
Every BAM alignment from the NCI-H526 Hi-C dataset was assigned to a 100 kbp tile of the hg19 reference genome. The number of shared read pair names between every pair of bins genome-wide was calculated. Every bin was also assigned a width-weighted mean copy number from the genome graph. Interchromosomal contacts were normalized proportionally to the product of copy numbers of the interacting bins. Publicly available Hi-C data for normal cell line GM12878 were downloaded from GEO under accession number GEO:GSE63525 (GSE63525 _GM12878 _insitu _DpnII _combined.hic) ( Rao et al., 2014 56. Rao, S.S. ∙ Huntley, M.H. ∙ Durand, N.C. ... A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping Cell. 2014; 159 :1665-1680 Full Text Full Text (PDF) Scopus (4556) PubMed Google Scholar ). Values from this contact matrix were accessed using straw with no normalization ( Durand et al., 2016 16. Durand, N.C. ∙ Robinson, J.T. ∙ Shamim, M.S. ... Juicebox provides a visualization system for Hi-C contact maps with unlimited zoom Cell Syst. 2016; 3 :99-101 Full Text Full Text (PDF) Scopus (898) PubMed Google Scholar ). Heatmaps were plotted at 100 kbp resolution. Values in the heatmaps are scaled to represent the number of contacts per 1 billion reads in the respective sample dataset.
To compare the expression levels of genes MYB and MYCN in NCI-H526 to other CCLE tumor cell lines, RNA-seq data were downloaded from the CCLE download page (CCLE _RNA-seq _081117.rpkm.gct; https://portals.broadinstitute.org/ccle/users/sign_in ). The RPKM values for all 1,019 cell lines in this dataset were log2 transformed.
To reconcile our genomic reconstruction with the FISH findings of two amplified tyfonas probe foci in the NCI-H526 metaphase, we sought a maximal allele (maximal number of ALT junctions) that could be threaded through the tyfonas locus (i.e., tyfonas-associated subgraph G ) twice. To reconstruct such an allele, we added a constraint to the MIP posed in Equation 14 requiring at least twice the copy numbers of all edges associated with a max cis allele f to be present in the graph.
The modified MIP is as follows: m a x i m i z e 𝑓 ⊆ 𝐸 ⁡ ( 𝐺 ) 𝑤 ⁡ ( 𝑓 ) s u b j e c t t o ∑ 𝑒 ∈ 𝑓 ∑ 𝑣 ∈ 𝑉 𝐼 𝑑 ⁡ ( 𝑣 , 𝑒 ) = 0 | 𝑑 ⁡ ( 𝑣 , 𝑒 ) | + | 𝑑 ⁡ ( ¯ 𝑣 , 𝑒 ) | ≤ 𝜅 ⁡ ( 𝑒 ) 2 , ∀ 𝑣 ∈ 𝑉 𝐼 , ∀ 𝑒 ∈ 𝑓 ∑ 𝑒 ∈ 𝑓 [ 𝑑 ⁡ ( 𝑣 , 𝑒 ) < 0 ] = ∑ 𝑒 ∈ 𝑓 [ 𝑑 ⁡ ( 𝑣 , 𝑒 ) > 0 ] ≤ 1 , ∀ 𝑣 ∈ 𝑉 𝐼 (Equation 17) As in the max cis analysis, the solution f to this objective function is the composite of (1) a linear walk that that maximally incorporates ALT edges and (2) additional cycles that are disjoint from this linear allele. To recover a linear walk t (alternating sequence of nodes and edges) from f , we applied a depth first search beginning at the sole source vertex of f (i.e., the only vertex in 𝑉 ⁡ ( 𝑓 ) lacking an incoming edge among f ). We then “peeled” this allele from the copy number solution κ (i.e., decremented κ by two for each vertex and edge in t ).
To obtain additional cycles, we began with this peeled κ and applied additional iterations of a “peel” procedure ( Algorithm S2 ) by repeatedly solving Equation 14 , enumerating walks and cycles, and further decrementing values of κ until no further copies were remaining in the graph (i.e., 𝜅 ⁡ ( 𝑥 ) = 0 , ∀ 𝑥 ∈ 𝐸 ⁡ ( 𝐺 ) ∪ 𝑉 ⁡ ( 𝐺 ) ).
In this algorithm, we refer to 𝑓 = 𝑜 ⁢ 𝑝 ⁢ 𝑡 ⁢ 𝑖 ⁢ 𝑚 ⁢ 𝑎 ⁢ 𝑙 ⁢ 𝐹 ⁢ 𝑙 ⁢ 𝑜 ⁢ 𝑤 ⁡ ( 𝐺 , 𝑤 , 𝜅 ) as the solution to the problem Equation 14 yielding an optimal flow f through graph G with copy state κ. We then apply a depth first traversal 𝐻 = 𝐷 ⁢ 𝐹 ⁢ 𝑆 ⁡ ( 𝑓 ) across the edges in f beginning at “source” nodes (i.e., those lacking an input junction in f ) to yield a set of walks H (sequences of nodes and edges). We then search for cyclic walks ℎ ∈ 𝐻 for which there exists an edge in f connecting the last vertex in h to the first. We append these to a multiset C .
After extracting the multiset of cyclic alleles C we incorporate these into the linear walk t to yield an augmented allele ̂ 𝑡 using Algorithm S3 . Since each cycle 𝑐 ∈ 𝐶 has multiplicity 𝜈 𝐶 ⁡ ( 𝑐 ) in C , we incorporate each cycle ( 𝜈 𝐶 ⁡ ( 𝑐 ) / 2 ) times into the linear walk ̂ 𝑡 . As a result, we know the graph will accommodate two copies of ̂ 𝑡 , in accordance with the FISH observation of two distinct tyfonas foci in the NCI-H526 genome.
The total count of junctions attributed to each of the 13 described event types (3 novel events, 5 known complex events, and 5 simple events-see above for calling procedures) was used as features to hierarchically cluster the cohort. For patients with more than one sample, we randomly chose a representative sample, yielding 2,487 total samples ( Table S3 ). Event burdens were normalized by computing a negative-binomial- (or gamma-Poisson-) distributed z-score (implemented in the edgeR R package) across all samples. The μ and size parameters of each event burden distribution were estimated using maximum-likelihood (implemented in the fitdistplus R package). Hierarchical clustering upon the sample-by-normalized count matrix was performed using Euclidean distance and the “Ward.D2” agglomeration method. The best number of clusters k is determined by inspecting the max value and trends of point bi-serial and Silhouette metrics corresponding to 𝑘 ∈ [ 3 , 2 4 ] .
To find associated sample features with clusters, we collected four groups of features: tumor types and histological or anatomical sites, somatic loss-of-function (LOF) mutational status of tumor suppressor genes (TSG), somatic missense mutational status of oncogenes, germline LOF of TSGs associated with familial syndromes, and germline missense mutational status of oncogenes associated with familial syndromes. For tumor type-related features, we used the primary tumor type values from Table S1 and expanded five general types (BRCA, MELA, MALY, SARC, and HNSC) into clinically meaningful subtypes where the annotations are available Table S3 . Plus, we also tested the overall groups of sex hormone-related cancers (BRCA, OV, UCEC, PRAD), cancers of the gastrointestinal tract (GI tract, BE, ESAD, ESSC, STAD, COAD, SIAD), ESADs and the BE patients eventually developed cancer versus other BE (column name “prog _esad”), and subtypes of carcinoma (adenocarcinoma, squamous cell carcinoma, other). All these categorical features were converted to binary (i.e., one-hot encoded) and only features with more than 15 counts of either outcome were tested. These sample features are available in Table S3 .
The TSGs tested comprised the intersection between those in the COSMIC Cancer Gene Census (CGC, Sondka et al., 2018 66. Sondka, Z. ∙ Bamford, S. ∙ Cole, C.G. ... The COSMIC Cancer Gene Census: describing genetic dysfunction across all human cancers Nat. Rev. Cancer. 2018; 18 :696-705 Crossref Scopus (818) PubMed Google Scholar ) version 86 and the DNA damage response genes annotated in Pearl et al. (2015) 54. Pearl, L.H. ∙ Schierz, A.C. ∙ Ward, S.E. ... Therapeutic opportunities within the DNA damage response Nat. Rev. Cancer. 2015; 15 :166-180 Crossref Scopus (395) PubMed Google Scholar , while the oncogene set is from CGC alone. Finally, TSGs associated with familial syndromes were obtained from CGC as well. Genes mutated in < 1% of the cohort were ignored. Final lists of genes that were nominated significant and mutational status within those genes per sample are found in Table S3 .
Overall survival data was obtained for 1,767 cases in our cohort from cBioPortal ( https://www.cbioportal.org/ ) for 935 TCGA cases and from the ICGC Data Portal ( https://dcc.icgc.org ) for 729 ICGC cases, and also from 103 NYGC Cancer Alliance cases. Kaplan-Meier analysis was performed, with the sample clusters stratified above compared to the Quiet cluster using the survival and survminer R packages. Additionally, survival was compared between each of these cluster groups to the survival of those within the Quiet cluster by performing Cox regression to correct for covariates that could impact survival due to the heterogeneity of features within each cluster. The following variables were included in the model: age at diagnosis, sex, tumor type, status of TP53 loss of function, metastatic status, tumor mutational burden, and rearrangement burden. Age, tumor mutational burden, and rearrangement burden were encoded as binary covariates, by stratifying the data points corresponding to the variables into 2 quantiled groups each: below the upper 3 rd quartile (75 th percentile), and above the upper 3 rd quartile.
Statistical tests are described in figure legends. Further details of these tests are described below.
Generalized linear modeling within R (version 3.5.1) was used for significance testing where noted. For binary outcomes, standard logistic regression or, wherever noted, a Bayesian implementation of logistic regression (available through the arm package within R, function “bayesglm”, with argument family = “binomial” was used. Ordinal logistic regression in Figure 2 (available from R package MASS, function “polr”) was used as well for testing replication timing as an ordered response variable. For count data, gamma-Poisson regression (MASS package, function “glm.nb”) was used. For all generalized linear models, Z-tests were used to determine significance of parameters. Gamma-Poisson statistical modeling procedure (fishHook) to nominate pyrgo and rigma is described above (also, see Imielinski et al., 2017 33. Imielinski, M. ∙ Guo, G. ∙ Meyerson, M. Insertions and Deletions Target Lineage-Defining Genes in Human Cancers Cell. 2017; 168 :460-472.e14 Full Text Full Text (PDF) Scopus (83) PubMed Google Scholar ). Where stated, Fisher’s exact test was performed using function “fisher.test” within R. Also, wherever stated, Wilcoxon rank-sum test was used for non-parametric testing between two groups using function “wilcox.test”, within R.
FDR or Bonferroni correction was performed where noted to nominate statistically significant associations (“p.adjust” within R). Bonferroni cutoffs of < 0 . 0 5 and FDR cutoffs of < 0 . 1 0 were applied for each correction method where group comparisons were performed. All p-values except for those in Q-Q plots are reported with a lower limit of 2.2 × 1 0 − 1 6 .
In breakend hypermutation analyses, a gamma-Poisson regression model was employed with SNV counts in the cis territory within the on-peak region [0-1000] bp on breakend-centric axes or trans territory of every breakend between [-5000,0) as the response. For dependent variables, a binary variable indicating whether SNV counts occur in cis territory was included to estimate the enrichment of cis -occurring over trans -occurring SNVs with an offset term included to correct for the width of the cis and trans territories tested. Within the model, an interaction term was included between the variable of whether the territory corresponds to a breakend of a double minute, BFBC, tyfonas, or other event type, and the cis/trans categorical variable. This interaction term can be interpreted as the additional effect that an event produces with respect to the cis/trans enrichment (i.e., the change in breakend hypermutation that an event produces). Finally, a covariate of the log-transformed segmental copy number corresponding to the cis side or on the trans side of the breakend was included to correct for the effect of copy number on SNV density, as it is expected for amplified regions to have higher SNV density due to increased mutational opportunity.
To test enrichment of features of the samples (mutational status, tumor types) in each SV event cluster, both Bayesian logistic regression and Fisher’s exact test were applied as mentioned above, setting (one-hot encoded) cluster membership as the response variable (a sample being in or out of a cluster) and the (binary) sample feature as the explanatory variable. When testing for associations between cluster membership and mutational status of a gene, tumor type was employed as a covariate. After model fitting, a one sided z-test was applied to the explanatory variable test for positive enrichment. We selected features that passed FDR < 0 . 1 0 for both Fisher’s exact tests and logistic regression. The multiple hypothesis correction is carried out within each group of hypotheses, namely tumor types (including related anatomical and histological groups), somatic or germline loss-of-function of tumor suppressor genes, and somatic missense mutation in oncogenes. Only strong positive associations were reported with 𝑂 ⁢ 𝑅 > 1 . 5 as estimated by the Bayesian logistic regression.

Section: Acknowledgments

M.I. thanks Dan Landau for bio-hermeneutic support; Elli Papaemmanuil for consultation in Eλληνικα; Matthew Meyerson, Scott Carter, and Cheng-Zhong Zhang for discussions early in the development of JaBbA; and Ron Zeira and Tomasz Imielinski for feedback on the JaBbA mathematical formulation. The authors thank Christopher Black and the NYGC ResComp team for high-performance computing support and Bionano genomics for assistance with optical mapping. M.I., X.Y, J.M.B., A.D., J.R., H.T., E.A., and Z.G. were supported by M.I.’s Burroughs Wellcome Fund Career Award for Medical Scientists, Doris Duke Clinical Foundation Clinical Scientist Development Award, Starr Cancer Consortium Award, National Institutes of Health (NIH) grant U24-CA15020, and Weill Cornell Medicine Department of Pathology and Laboratory Medicine startup funds. M.I., J.M., T.D.L., X.Y., and J.B. were supported by a Melanoma Research Alliance Team Science Award. K.H. was supported by a NIH/NCI F31 graduate research fellowship (F31-CA232465). M.D. was supported by an NIH F32 training grant given to the Tri-Institutional Computational Biology and Medicine PhD Program. R.B. received funding from the Fund for Innovation in Cancer Informatics. B.J.R., T.P., X.L., P.G., C.S., K.O., M.K., and L.S. are supported by NIH funding (P01-CA9195). The IBM-NYGC Cancer Alliance project was supported in part by a grant from the IBM corporation (IBM Watson Health) to the New York Genome Center, New York Genome Center philanthropic funds, and Rockefeller University grant UL1 TR000043 from the National Center for Advancing Translational Sciences (NCATS), and the NIH Clinical and Translational Science Award (CTSA) program. T.G.P., P.C.G., K.M.O., C.A.S., B.J.R., and X.L. were supported by NIH grants P01 CA91955 and P30 CA015704. M.K.K. and L.P.S. were supported by NIH grant P01 CA91955. Bud Mishra was supported by National Science Foundation grants CCF-0836649 and CCF-0926166 and a National Cancer Institute Physical Sciences-Oncology Center grant U54 CA193313-01. Graphical abstract was created with art from BioRender.com under academic license terms.
Conceptualization, X.Y., K.H., J.B., J.W., R.B, T.D.L., J.M, J.S., N. Riaz, J.S.R.-F., S.P., and M.I.; Data Curation, X.Y., K.H., J.B, A.D., J.R., M.D, H.T., Z.G., M. Sigouros, K.E., K.O.W., K.A., M. Shah, A.K.E, V.F., M.O.F., M.G., F.H., J.M., N. Robine, K.M.O., C.A.S., M.K.K, L.P.S., P.C.G., T.G.P., X.L., D.W., A.S., J.M.M., and M.I.; Formal Analysis, J.B., K.H., X.Y, A.D., and M.I.; Funding Acquisition, R.D., P.G., B.R., O.E., and M.I.; Investigation, X.Y., J.B., K.H., A.D., and M.I.; Methodology, X.Y., J.B., K.H., A.D., D.K., E.R., B.M., and M.I.; Project Administration, M.I.; Resources, O.E., R.D., M.G., F.H., T.D.L, M.Z., N.R., T.P., P.G., R.S., X.L., B.R., and M.I.; Software, X.Y., J.B., C.X., and M.I.; Supervision, M.I.; Validation, X.Y., J.B., K.H., A.D., and M.I.; Visualization, X.Y., J.B., K.H., C.X., and M.I.; Writing – Original Draft, M.I.; Writing – Review & Editing, all authors.
J.S.R.-F. reports receiving personal/consultancy fees from VolitionRx, Paige.AI, Goldman Sachs, REPARE Therapeutics, GRAIL, Ventana Medical Systems, Roche, Genentech, and InviCRO outside of the scope of the submitted work.

Section: Supplemental Information (4)

Download all PDF (109.10 KB) Table S1. Pan-Cancer WGS Cohort Summary, Related to Figure 1 Summary (table in pdf format) of the number of samples from each tumor type and the number of cell line samples of a tumor type. PDF (104.08 KB) Table S2. Sources of Pan-Cancer WGS Datasets Used in This Study, Related to Figure 1 Summary (table in pdf format) of the number of samples from each dataset, the completeness of the pipelines, and the citation if the dataset is published before. Spreadsheet (3.95 MB) Table S3. Sample-Specific Features, Related to Figures 1 and 7 A comma separated value format text file of all the sample specific features of the pan-cancer cohort used in this study. The unique identifier for each sample and patient is stored in the sample id and participant id columns, respectively. The columns whose names start with an event type represent the number of events ( count ), the total junctions attributed to that event type ( burden ), and the normalized z-score among the cohort used in the clustering ( z-score ). The membership to one of the 14 clusters (Figure 7A) is listed under cluster column. It also records the gene mutation status, tumor types and subtypes, SNV density and signatures, as well as overall survival (OS) data. Spreadsheet (31.00 KB) Table S4. Significant Sample Features Associated with Clusters, Related to Figures 7 and S7 A Microsoft Excel spreadsheet of all sample level features significantly associated with clusters.
