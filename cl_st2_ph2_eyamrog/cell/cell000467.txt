Title: Natural sensory context drives diverse brain-wide activity during C. elegans mating


Abstract: Summary

Natural goal-directed behaviors often involve complex sequences of many stimulus-triggered components. Understanding how brain circuits organize such behaviors requires mapping the interactions between an animal, its environment, and its nervous system. Here, we use brain-wide neuronal imaging to study the full performance of mating by the C. elegans male. We show that as mating unfolds in a sequence of component behaviors, the brain operates similarly between instances of each component but distinctly between different components. When the full sensory and behavioral context is taken into account, unique roles emerge for each neuron. Functional correlations between neurons are not fixed but change with behavioral dynamics. From individual neurons to circuits, our study shows how diverse brain-wide dynamics emerge from the integration of sensory perception and motor actions in their natural context.

Section: Introduction

Natural behaviors involve strong interactions between animals and their surroundings. When an animal is isolated from its natural context, brain dynamics do not display their full range of mechanisms ( Getting, 1989 15. Getting, P.A. Emerging principles governing the operation of neural networks Annu. Rev. Neurosci. 1989; 12 :185-204 Crossref Scopus (483) PubMed Google Scholar ; Krakauer et al., 2017 25. Krakauer, J.W. ∙ Ghazanfar, A.A. ∙ Gomez-Marin, A. ... Neuroscience needs behavior: correcting a reductionist bias Neuron. 2017; 93 :480-490 Full Text Full Text (PDF) Scopus (735) PubMed Google Scholar ). Recent brain-wide studies in immobilized C. elegans and other animals have uncovered strong activity correlations among large neuron populations ( Kato et al., 2015 22. Kato, S. ∙ Kaplan, H.S. ∙ Schrödel, T. ... Global brain dynamics embed the motor command sequence of Caenorhabditis elegans Cell. 2015; 163 :656-669 Full Text Full Text (PDF) Scopus (287) PubMed Google Scholar ; Stringer et al., 2019 51. Stringer, C. ∙ Pachitariu, M. ∙ Steinmetz, N. ... Spontaneous behaviors drive multidimensional, brainwide activity Science. 2019; 364 :255 Crossref Scopus (644) PubMed Google Scholar ). However, circuit activity is more complex when animals freely behave. Studies in mice have uncovered changing functional correlations between brain areas when the animal engages in different behaviors ( Markowitz et al., 2018 32. Markowitz, J.E. ∙ Gillis, W.F. ∙ Beron, C.C. ... The striatum organizes 3D behavior via moment-to-moment action selection Cell. 2018; 174 :44-58.e17 Full Text Full Text (PDF) Scopus (193) PubMed Google Scholar ). Freely moving C. elegans hermaphrodites exhibit less correlated brain activity than immobilized worms ( Scholz et al., 2018 44. Scholz, M. ∙ Linder, A.N. ∙ Randi, F. ... Predicting natural behavior from whole-brain neural dynamics bioRxiv. 2018; Crossref Scopus (32) Google Scholar ). In the mouse, increasing task complexity and the sensory richness will progressively decorrelate neurons and brain regions ( Pinto et al., 2019 39. Pinto, L. ∙ Rajan, K. ∙ DePasquale, B. ... Task-dependent changes in the large-scale dynamics and necessity of cortical regions Neuron. 2019; 104 :810-824.e9 Full Text Full Text (PDF) Scopus (119) PubMed Google Scholar ). Task-dependent functional reorganization of neuronal circuits has been observed in invertebrate, vertebrate, and artificial systems ( Getting, 1989 15. Getting, P.A. Emerging principles governing the operation of neural networks Annu. Rev. Neurosci. 1989; 12 :185-204 Crossref Scopus (483) PubMed Google Scholar ; Briggman and Kristan, 2008 6. Briggman, K.L. ∙ Kristan, Jr., W.B. Multifunctional pattern-generating circuits Annu. Rev. Neurosci. 2008; 31 :271-294 Crossref Scopus (200) PubMed Google Scholar ; Schilbach et al., 2013 41. Schilbach, L. ∙ Timmermans, B. ∙ Reddy, V. ... Toward a second-person neuroscience Behav. Brain Sci. 2013; 36 :393-414 Crossref Scopus (1020) PubMed Google Scholar ; Candadai et al., 2019 7. Candadai, M. ∙ Setzler, M. ∙ Izquierdo, E.J. ... Embodied dyadic interaction increases complexity of neural dynamics: A minimal agent-based simulation model Front. Psychol. 2019; 10 :540 Crossref Scopus (14) PubMed Google Scholar ). Here, we use the mating behavior of the male C. elegans to ask how an entire natural behavior is embedded in brain structure and function.
Mating behavior is highly interactive and involves variable sequences of recurrent behavioral components or motifs that carry the animal toward its goal. The male C. elegans uses a dedicated circuit in his tail—a posterior brain with over 100 sensory neurons, interneurons, and motor neurons—to drive these motifs ( Sulston et al., 1980 53. Sulston, J.E. ∙ Albertson, D.G. ∙ Thomson, J.N. The Caenorhabditis elegans male: postembryonic development of nongonadal structures Dev. Biol. 1980; 78 :542-576 Crossref Scopus (435) PubMed Google Scholar ; Jarrell et al., 2012 19. Jarrell, T.A. ∙ Wang, Y. ∙ Bloniarz, A.E. ... The connectome of a decision-making neural network Science. 2012; 337 :437-444 Crossref Scopus (321) PubMed Google Scholar ; Cook et al., 2019 10. Cook, S.J. ∙ Jarrell, T.A. ∙ Brittin, C.A. ... Whole-animal connectomes of both Caenorhabditis elegans sexes Nature. 2019; 571 :63-71 Crossref Scopus (386) PubMed Google Scholar ) ( Figures 1 A and 1B). He searches for a hermaphrodite by detecting pheromones. When he contacts a hermaphrodite, he presses the sensilla of his tail against her body, and scans to locate the vulva. During scanning, he frequently changes his movement direction, executes sharp turns to move around her head or tail, and slows at the vulva. At the vulva, he attempts to insert his mating spicules. Successful insertion triggers sperm transfer. Copulation is followed by rest ( Liu and Sternberg, 1995 31. Liu, K.S. ∙ Sternberg, P.W. Sensory regulation of male mating behavior in Caenorhabditis elegans Neuron. 1995; 14 :79-89 Abstract Full Text (PDF) Scopus (263) PubMed Google Scholar ; Simon and Sternberg, 2002 49. Simon, J.M. ∙ Sternberg, P.W. Evidence of a mate-finding cue in the hermaphrodite nematode Caenorhabditis elegans Proc. Natl. Acad. Sci. USA. 2002; 99 :1598-1603 Crossref Scopus (90) PubMed Google Scholar ; Leighton et al., 2014 29. Leighton, D.H. ∙ Choe, A. ∙ Wu, S.Y. ... Communication between oocytes and somatic cells regulates volatile pheromone production in Caenorhabditis elegans Proc. Natl. Acad. Sci. USA. 2014; 111 :17905-17910 Crossref Scopus (35) PubMed Google Scholar ; LeBoeuf et al., 2014 28. LeBoeuf, B. ∙ Correa, P. ∙ Jee, C. ... Caenorhabditis elegans male sensory-motor neurons and dopaminergic support cells couple ejaculation and post-ejaculatory behaviors eLife. 2014; 3 :e02938 Crossref Google Scholar ). All behavioral motifs only occur when freely moving males interact with a hermaphrodite.
We recorded the activity of nearly every neuron in the posterior brain of freely moving male C. elegans throughout mating. Brain-wide imaging revealed functional relationships among all neurons at every step. When brain-wide dynamics are considered in the context of an entire natural behavior, nearly every neuron exhibits a unique activity pattern. Each of the many different behavioral motifs has a specific and consistent circuit representation. As behavior unfolds, functional correlations between neurons in the brain are not fixed, but depend on context and change with the dynamic interactions between the animal, the nervous system, and the environment. For one wiring diagram to support many correlation patterns, the relationship between the connectome and activity cannot be one-to-one. By combining functional imaging, behavioral analysis, and single-neuron manipulations, we identify circuit-level mechanisms for several ethologically relevant computations. We show how brain-wide dynamics are shaped by the flow of sensory inputs and motor actions across the full performance of a natural behavior.

Section: Results

To record the activity of the male’s entire posterior brain, we used a spinning-disc confocal microscope customized for multicolor, multi-neuronal imaging ( Venkatachalam et al., 2016 56. Venkatachalam, V. ∙ Ji, N. ∙ Wang, X. ... Pan-neuronal imaging in roaming Caenorhabditis elegans Proc. Natl. Acad. Sci. US A. 2016; 113 :E1082-8 Crossref Scopus (131) PubMed Google Scholar ). We used strains with panneuronal expression of both nuclear-localized calcium indicator (GCaMP6s) and red fluorescent protein (mNeptune) imaged at 10 vol/s with single-cell resolution ( Figure 1 C; Video S1 ). Panneuronal activity was continuously imaged through every step: initial search, contact, scanning, vulva detection, copulation, and rest.
eyJraWQiOiI4ZjUxYWNhY2IzYjhiNjNlNzFlYmIzYWFmYTU5NmZmYyIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiIyYjc4MjE3NjY5MTM4NzFjZGY1YWQ5ZTEzMGIxOTIyNyIsImtpZCI6IjhmNTFhY2FjYjNiOGI2M2U3MWViYjNhYWZhNTk2ZmZjIiwiZXhwIjoxNzQ5NjEzMTMyfQ.dwYt4MYNeeta0gqUInXMfAgVX8yaWCPhpR39t4D3IAivkCza7avg_lj2KDK38hY78HIRhrjEMqpAcW0JJ0GhSfSjdZib-u5FQdloG6KM3BWf_hk8nGcVMaEMGhA_6gqxhjokO2GrrLbXdzKHB30KbhbM4RJchToFns5zaRVhVpTVLht6jaRkHjDYHnBD3vt_ARVhYOEXFnrOWnR-FI94wzsc2co7SF1LR2KFyBdioON9ViK4f5tdspb4tnYOkq3vds2x2iMCDD4EOSarZpVe66qCN_tzx3KcTUFWsS9Y63Ycdbkgdr-Bw3GMyfRYOeiSMozsv0RHRC39mPReOQUW7Q Video (50.23 MB) Video S1. Brain-wide imaging throughout mating, related to Figure 1
For comprehensive analysis, we selected datasets of continuous 5–10 min recordings from eight animals with the broadest range of behavioral dynamics ( Table S1 ). Most neurons were recorded in multiple datasets. Each neuron was identified by its relative position, morphology, and expression of cell-specific fluorescent markers ( Figure S1 A; Table S2 ). The selected datasets contained the activities of 76 identifiable neurons. Nearly all pairs of left-right symmetric neurons were highly correlated. Grouping left-right pairs as one neuron type, we recorded 57 neuron types ( Figures S1 B–S1D). We also acquired datasets focused on specific neuron types or behavioral motifs.
We extracted a set of continuous behavioral features concurrent with circuit activity—velocity, sliding relative to the hermaphrodite, tail curvature, spicule position, and tail position—as well as discrete behavioral motifs ( Figures 1 D–1F).
Does brain-wide activity map to behavioral dynamics in the same way from animal to animal? If so, it should be possible to build a computational model that predicts one animal’s behavior from the brain-wide activity of others. Because we could identify the same neurons in every dataset, we were able to build models that account for the individual contributions of each neuron and test whether models built using one set of animals could predict the behavior of another.
We built brain-to-behavior models using sparse linear regression with short-term memory applied to the concatenated activity of 52 neurons that we recorded in nearly every experiment and a set of continuous behavioral features ( Figures 2 A and 2B). In each iteration, we used seven of our eight comprehensive datasets for concatenation and model training. We evaluated the model from each iteration by its accuracy in predicting behavioral dynamics from brain-wide activity for the held-out dataset ( Figures 2 A–2C). We calculated prediction accuracy across eight iterations and compared it to model accuracy tested on datasets with shuffled neuronal ids. Sparse linear regression models tested on the held-out datasets predicted most behavioral features more accurately than models tested on datasets with shuffled ids ( Figures 2 D and 2E; Table S3 ). Thus, most behavioral features are represented in the collective activity of the neurons consistently across animals.
How is the representation of behavioral features distributed across neurons? In all cases, we found that excluding single neurons from the datasets before training had only a small effect on prediction accuracy ( Figure 2 F; Table S4 ). Models trained using the activities of single neurons performed worse than models trained using all neurons for all behavioral features except spicules position ( Figure 2 F). Sparse linear regression ranks neurons by their relative contribution to each behavioral feature ( Figure 2 D). For most behavioral features, fewer than 7 top-ranking neurons were sufficient to achieve 95% of the full model performance ( Figure 2 F; Table S4 ). For tail curvature, more than 25 neurons were needed, suggesting its distributed representation in brain-wide activity.
To investigate how continuous behavioral features are represented across circuit layers, we assessed models trained separately on sensory, inter-, and motor neurons ( Table S2 ). Velocity and tail curvature (features associated with motor output) were best predicted by motor neurons ( Figure 2 E). Models trained using sensory neurons were the least accurate at predicting velocity and tail curvature and were significantly less accurate than models trained on all neurons ( t [13.98] = 2.55, p = 0.023 and t [11.55] = 3.85, p = 0.0025, respectively). In contrast, for the features associated with male-hermaphrodite interactions (e.g., relative sliding velocity) nearly full prediction accuracy was achieved with only sensory neurons ( Figure 2 E).
To better understand how neurons interact during behavior ( Figure 3 A), we computed neuron-neuron and neuron-behavior correlations for all pairs of neuronal activities and continuous behavioral features. To test if neuron-neuron correlations were consistent across datasets, we selected correlation matrices for the eight comprehensive datasets and calculated pairwise Euclidean distances between them. These distances were significantly less than the distances between matrices with shuffled ids ( t [35] = − 36.09, p < 0.0001). The same was true for neuron-behavior correlations ( t [27] = − 47.26, p < 0.0001). Thus, neuron-neuron and neuron-behavior correlations are largely consistent across animals.
To identify groups of functionally related neurons, we assembled a consensus correlation matrix incorporating data from all experiments. We grouped neurons with similar activities using hierarchical clustering ( Figure 3 B). Certain clusters reflected commonly recognized behavioral motifs such as searching, scanning, turning, vulva detection, and copulation. Each cluster indicated a group of principal neurons for each motif. Some neurons were strongly correlated with other neurons in more than one cluster ( Figure S2 A), suggesting that single neurons participate in multiple behavioral motifs. To frame the data for comparison with synaptic connectivity (see below) while allowing each neuron to belong to more than one functional group or community, we used link clustering, an edge-based community detecting algorithm ( Ahn et al., 2010 2. Ahn, Y.Y. ∙ Bagrow, J.P. ∙ Lehmann, S. Link communities reveal multiscale complexity in networks Nature. 2010; 466 :761-764 Crossref Scopus (1523) PubMed Google Scholar ; Kalinka and Tomancak, 2011 21. Kalinka, A.T. ∙ Tomancak, P. linkcomm: an R package for the generation, visualization, and analysis of link communities in networks of arbitrary size and type Bioinformatics. 2011; 27 :2011-2012 Crossref Scopus (99) PubMed Google Scholar ). Link clustering partitioned the mating circuit into overlapping communities that were largely consistent with hierarchical clustering ( Figures 3 B, 3C, and S2 B). One community was associated with excretory pore detection, a previously undescribed behavioral motif during mating.
We compared the contributions of neurons by aligning their activities to the onset of discrete motifs such as hermaphrodite contact and turning. Many neurons were consistently activated or inhibited by a different combination of behavioral motifs ( Figure 3 D).
When considered relative to the full set of behavioral motifs, 79% of neurons exhibited unique activity patterns ( Figures 3 D and S3 ).
When we compared the activities of each group of neurons triggered by each behavioral motif, we often observed diverse temporal dynamics ( Figures 3 E–3J). In many cases, we observed highly consistent sequences of half-peak activities among neurons from the start of a motif ( Figure 3 K), suggesting different and stepwise functional contributions for each neuron. Considering the temporally resolved activity of each neuron relative to all steps of mating behavior, virtually every neuron in the circuit is functionally unique.
Not only do different and partly overlapping combinations of neurons contribute to different behavioral motifs; the correlations exhibited by these neurons can be different for different motifs. For example, the HOA and HOB hook sensory neurons have been viewed as contributing similarly to detecting and stopping at the vulva. We confirmed that both HOA and HOB are co-active during vulva detection, but we discovered that HOA activity increases and HOB activity decreases during copulation ( Figures 3 D and 3G and 3I). Thus, motif-specific correlations diversify brain-wide activity during mating.
To compare circuit-wide functional correlations across motifs, we partitioned each dataset into four states: searching, courtship, copulation, and post-copulatory rest. We calculated a separate correlation matrix for each state for each dataset ( Figure S4 ). Neuron-neuron correlations as well as neuron-behavior correlations were more similar comparing the same states exhibited by different animals than comparing different states exhibited by the same animal ( Figure 3 L). The Euclidean distances between neuron-neuron correlation matrices corresponding to courtship and copulation were significantly smaller than those between randomly selected matrices ( t [35.06] = − 7.66, p < 0.0001 and t [20.05] = − 3.73, p = 0.003, respectively). The Euclidean distances between neuron-behavior correlation matrices for searching, courtship, and resting were also significantly smaller than those between randomly selected matrices ( t [27.01] = − 2.65, p = 0.018; t [35.01] = − 11.39, p < 0.0001; and t [20.01] = − 3.44, p = 0.005, respectively). In contrast, distances between matrices grouped by individual were not significantly different from randomly selected matrices ( Table S5 ). Motif-specific brain-wide activity patterns were also observed at the onset of discrete behavioral motifs across different individuals ( Figure S5 ). The brain operates similarly between instances of the same component behavior but distinctly between different component behaviors.
One wiring diagram of the male has been reconstructed by electron microscopy ( Jarrell et al., 2012 19. Jarrell, T.A. ∙ Wang, Y. ∙ Bloniarz, A.E. ... The connectome of a decision-making neural network Science. 2012; 337 :437-444 Crossref Scopus (321) PubMed Google Scholar ; Cook et al., 2019 10. Cook, S.J. ∙ Jarrell, T.A. ∙ Brittin, C.A. ... Whole-animal connectomes of both Caenorhabditis elegans sexes Nature. 2019; 571 :63-71 Crossref Scopus (386) PubMed Google Scholar ). If the same wiring diagram supports context-dependent brain-wide activity patterns, functional correlations cannot be fully predicted by synaptic connectivity, or vice-versa. Activity correlations across all pairs of neurons varied from negative to strongly positive with a mean of 0.11 ± 0.22 ( Figure 3 B). Among pairs of neurons with positive correlations above the mean (>0.11), 19% are connected by synapses. This probability is marginally higher than the 15% probability that two randomly sampled neurons are connected by synapses ( Figure 4 A).
Among neuron pairs with stronger positive functional correlations (>0.3, >0.5, and >0.7), larger fractions were connected by synapses (26%, 40%, and 63%, respectively). When we considered more strongly correlated pairs, we observed larger fractions of connections with only electrical synapses or with both chemical and electrical synapses (Pearson correlation between the functional correlation threshold and the fraction of neurons connected by electrical synapses r = 0.93, p = 0.0017). In contrast, the fraction of connections with only chemical synapses did not increase ( r = 0.05, p = 0.91). For neurons connected by synapses, we quantified the dependence of pairwise correlations on the number of electrical or chemical synapses. Functional correlations increased with the number of electrical synapses (partial correlation r = 0.33, p = 0.0007) and weakly increased with the number of chemical synapses (partial correlation r = 0.13, p = 0.014) ( Figures 4 B and 4C). We also tested how much functional correlation between neurons can be predicted by common synaptic input. Correlation between neurons that had a common presynaptic partner was significantly higher compared to shuffled data (Pearson correlation r = 0.43, p < 0.0001 and r = 0.41, p < 0.0001 for electrical and chemical synapses respectively). Thus, functional correlations between individual neurons are prevalent among neurons without direct synaptic connectivity. Functional correlations are significantly predicted by common synaptic input. Among synaptically connected neurons, functional correlations are better predicted by the number of shared electrical synapses than chemical synapses.
Functional correlations partition the mating circuit into overlapping communities for different behavioral motifs ( Figures 3 C and 4 D). For each pair of functional communities, we calculated the density of synaptic connections within each community (in-group connectivity) and between the two communities (out-group connectivity). An interaction between two communities is assortative when in-group connectivity for each community is stronger than the out-group connectivity between them ( Betzel et al., 2018 5. Betzel, R.F. ∙ Bertolero, M.A. ∙ Bassett, D.S. Non-assortative community structure in resting and task-evoked functional brain networks bioRxiv. 2018; Crossref Scopus (0) Google Scholar ). For electrical synapses, the majority of all pairwise interactions between functional communities were assortative (77%–86% across different partitioning schemes). For chemical synapses, 31%–54% of all pairwise interactions were assortative ( Figure 4 E; Table S6 ). In contrast, disassortative interactions, when out-group connectivity between communities is stronger than each in-group connectivity, were significantly less common than chance in all but one partitioning scheme for electrical synapses (3%–10%) and most partitioning schemes for chemical synapses (9%–18%) ( Figure 4 E; Table S6 ). Compared to electrical synapses, chemical synapses showed a larger fraction of core-periphery interaction motifs. Core-periphery interactions occur when one community (the core) has stronger in-group than out-group connectivity whereas the other community (the periphery) is strongly connected to the core but its in-group connectivity is weak. In summary, both electrical and chemical connectivity play substantial roles in internal signaling within functional communities. Chemical synapses play the larger role in signaling between functional communities.
The mechanisms that diversify brain-wide activity patterns and confer unique functional properties to each neuron are driven by stimulus, feedback, and motor patterns that only occur during natural behavior. Here, we explore several of these mechanisms by dissecting circuits for distinct motifs of mating.
Most functional communities within the mating circuit are associated with scanning to locate the vulva. During scanning, the male recognizes the hermaphrodite, distinguishes different locations, and keeps track of his own movements.
Scanning begins with the initiation of backward movement when the tail contacts a hermaphrodite. Earlier studies identified neurons required for scanning including ray sensory neurons ( Figure 1 B) and the PVY interneuron that receives synapses from the rays ( Liu and Sternberg, 1995 31. Liu, K.S. ∙ Sternberg, P.W. Sensory regulation of male mating behavior in Caenorhabditis elegans Neuron. 1995; 14 :79-89 Abstract Full Text (PDF) Scopus (263) PubMed Google Scholar ; Sherlekar et al., 2013 48. Sherlekar, A.L. ∙ Janssen, A. ∙ Siehr, M.S. ... The C. elegans male exercises directional control during mating through cholinergic regulation of sex-shared command interneurons PLoS ONE. 2013; 8 :e60597 Crossref Scopus (33) PubMed Google Scholar ; Koo et al., 2011 24. Koo, P.K. ∙ Bian, X. ∙ Sherlekar, A.L. ... The robustness of Caenorhabditis elegans male mating behavior depends on the distributed properties of ray sensory neurons and their output through core and male-specific targets J. Neurosci. 2011; 31 :7497-7510 Crossref Scopus (34) PubMed Google Scholar ). Brain-wide imaging revealed many more neurons involved in scanning: 30% of the mating circuit from sensory neurons (R1AL/R, R2A, R4A, R6A, R9B, and PCA) to interneurons (PVY, PDB, EF1-EF3, and CP9) to motor neurons (AS10, AS11, VA10-VA12, and DA7) ( Figures 3 B and 3E).
Some of the first neurons to be activated upon contact are the R2A and R6A sensory ray neurons and their postsynaptic partner CP9 ( Figures 3 E and 3K). Soon afterward, the EF1-3 GABAergic interneurons are activated. EF1-3 share electrical synapses with R2A and R6A, and their activities are strongly positively correlated with both R2A and R6A activities and with backward scanning ( Figure 3 D). EF1-3 are presynaptic to AVB, a premotor interneuron in the head that drives forward locomotion ( Chalfie et al., 1985 9. Chalfie, M. ∙ Sulston, J.E. ∙ White, J.G. ... The neural circuit for touch sensitivity in Caenorhabditis elegans J. Neurosci. 1985; 5 :956-964 Crossref PubMed Google Scholar ). Activating R2A, R6A, and EF1-3 might thus lead to GABAergic inhibition of AVB, thereby inhibiting the circuit for forward locomotion during backward scanning.
The PVY interneuron also becomes active with hermaphrodite contact, but its response to contact is delayed compared to other neurons ( Figure 3 K). This activity pattern and the fact that PVY is specifically active during backward movement ( Figure 3 D) support previous findings that PVY promotes backward movement through cholinergic excitation of AVA—a premotor interneuron in the head that drives backward locomotion ( Sherlekar et al., 2013 48. Sherlekar, A.L. ∙ Janssen, A. ∙ Siehr, M.S. ... The C. elegans male exercises directional control during mating through cholinergic regulation of sex-shared command interneurons PLoS ONE. 2013; 8 :e60597 Crossref Scopus (33) PubMed Google Scholar ). AVA is pre-synaptic to the A-type motor neurons that drive backward locomotion ( Sherlekar et al., 2013 48. Sherlekar, A.L. ∙ Janssen, A. ∙ Siehr, M.S. ... The C. elegans male exercises directional control during mating through cholinergic regulation of sex-shared command interneurons PLoS ONE. 2013; 8 :e60597 Crossref Scopus (33) PubMed Google Scholar ; Kawano et al., 2011 23. Kawano, T. ∙ Po, M.D. ∙ Gao, S. ... An imbalancing act: gap junctions reduce the backward motor circuit activity to bias C. elegans for forward locomotion Neuron. 2011; 72 :572-586 Full Text Full Text (PDF) Scopus (172) PubMed Google Scholar ; Zhen and Samuel, 2015 61. Zhen, M. ∙ Samuel, A.D. C. elegans locomotion: small circuits, complex functions Curr. Opin. Neurobiol. 2015; 33 :117-126 Crossref Scopus (124) PubMed Google Scholar ). Indeed, the A-type motor neurons in the tail (VA10–VA12, DA7) become active with backward scanning. However, VA10–VA12 tend to reach their peak activity early, before the onset of backward movement. This activity pattern is consistent with VA10–VA12 roles in ventral bending of the tail upon contact, a maneuver that precedes scanning initiation. Two other motor neurons postsynaptic to AVA—AS10 and AS11—also become active during backward scanning. Thus, hermaphrodite recognition initiates backward movement through a synaptically connected chain of neurons.
The PCA postcloacal sensilla neuron is active during scanning. Close examination of neuron-behavior correlations revealed a role in sensory feedback: PCA activity is correlated with the relative sliding between the male and hermaphrodite ( r = 0.44 ± 0.21), and PCA specifically becomes active at the onset of backward sliding ( t [9] = 8.45, p < 0.0001) ( Figure 3 D).
Like A-type sensory ray neurons, PCA has striated rootlets associated with mechanosensation ( Sulston et al., 1980 53. Sulston, J.E. ∙ Albertson, D.G. ∙ Thomson, J.N. The Caenorhabditis elegans male: postembryonic development of nongonadal structures Dev. Biol. 1980; 78 :542-576 Crossref Scopus (435) PubMed Google Scholar ; Doroquez et al., 2014 12. Doroquez, D.B. ∙ Berciu, C. ∙ Anderson, J.R. ... A high-resolution morphological and ultrastructural map of anterior sensory cilia and glia in Caenorhabditis elegans eLife. 2014; 3 :e01948 Crossref Scopus (133) PubMed Google Scholar ; Styczynska-Soczka and Jarman, 2015 52. Styczynska-Soczka, K. ∙ Jarman, A.P. The Drosophila homologue of Rootletin is required for mechanosensory function and ciliary rootlet formation in chordotonal sensory neurons Cilia. 2015; 4 :9 Crossref Scopus (23) PubMed Google Scholar ). Unlike the ray sensory neurons, the synaptic outputs of PCA are to neurons for behavioral motifs other than scanning ( Jarrell et al., 2012 19. Jarrell, T.A. ∙ Wang, Y. ∙ Bloniarz, A.E. ... The connectome of a decision-making neural network Science. 2012; 337 :437-444 Crossref Scopus (321) PubMed Google Scholar ). Multiple synaptic targets of PCA are involved in vulva detection. PCA is correlated with other neurons involved in scanning but its functional role is to monitor backward sliding to provide feedback to neurons in other motifs.
Scanning involves long backward movements interrupted by short forward movements. At the onset of forward movements, A-type motor neurons that drive backward movement are inactivated and B-type motor neurons that drive forward movement are activated ( Figure 3 D). Forward movement during scanning appears to be a form of course correction and is often initiated when the male overshoots the vulva or the ends of the hermaphrodite.
The mating circuit monitors relative forward sliding between the male and hermaphrodite by mechanosensory feedback using the PHC sensory neuron, the apparent sensory counterpart of PCA. Like PCA, PHC has striated rootlets for mechanosensation ( Sulston et al., 1980 53. Sulston, J.E. ∙ Albertson, D.G. ∙ Thomson, J.N. The Caenorhabditis elegans male: postembryonic development of nongonadal structures Dev. Biol. 1980; 78 :542-576 Crossref Scopus (435) PubMed Google Scholar ). Both neurons can predict relative sliding between the male and the hermaphrodite ( Figure 2 D; Table S4 ). Whereas PCA is positively correlated with backward sliding relative to the hermaphrodite, PHC is negatively correlated with backward sliding relative to the hermaphrodite ( r = − 0.29 ± 0.09). PHC activates at the onset of forward sliding ( t [10] = 9.4, p < 0.0001) ( Figure 3 D).
PHC has sex-specific connectivity ( Jarrell et al., 2012 19. Jarrell, T.A. ∙ Wang, Y. ∙ Bloniarz, A.E. ... The connectome of a decision-making neural network Science. 2012; 337 :437-444 Crossref Scopus (321) PubMed Google Scholar ; Serrano-Saiz et al., 2017a 46. Serrano-Saiz, E. ∙ Oren-Suissa, M. ∙ Bayer, E.A. ... Sexually dimorphic differentiation of a c. elegans hub neuron is cell autonomously controlled by a conserved transcription factor Curr. Biol. 2017; 27 :199-209 Full Text Full Text (PDF) Scopus (48) PubMed Google Scholar ). In the male, one of the main synaptic targets of PHC is the PVY interneuron that drives backward movement through AVA. PHC is anticorrelated with PVY ( r = − 0.29 ± 0.18) ( Figure 3 B). Thus, a feedback signal from PHC that detects forward sliding may be used to sustain forward sliding by inhibiting PVY. PHC also makes synapses to neurons involved in vulva detection. Thus, both PCA and PHC provide feedback about sliding to modulate other behavioral motifs.
When the tail reaches either end of the hermaphrodite, the male turns around her body with a sharp ventral tail bend to maintain contact ( Figure 5 A). After successful turns, the male continues scanning on her other side. When unsuccessful, the tail loses contact and the male switches to forward swimming to regain contact.
Several neurons become active during turns including the R4A sensory neuron, the PVV interneuron, the DX1–DX3 inter/motor neurons, and the DD6 motor neuron ( Figures 3 B, 3C, 3F, 5 B and 5C). PVV activates before other neurons and is active during both successful and unsuccessful turns, suggesting a role in turn initiation ( Figure 3 K). Other neurons, like R4A and DD6, are only active with successful turns ( Figure 3 D), suggesting roles in turn completion.
PVV ablation severely disrupted turning behavior. Without PVV, males were usually unable to turn around the hermaphrodite and often lost contact ( t [16.43] = 14.44, p < 0.001) ( Figure 5 D). PVV receives inputs from ray sensory neurons and has direct synaptic output to the ventral cord motor neurons and ventral body wall muscles ( Jarrell et al., 2012 19. Jarrell, T.A. ∙ Wang, Y. ∙ Bloniarz, A.E. ... The connectome of a decision-making neural network Science. 2012; 337 :437-444 Crossref Scopus (321) PubMed Google Scholar ). PVV acts as a trigger for turning behavior by collecting sensory cues associated with the tapering ends of the hermaphrodite and directly signaling to neurons and muscles for ventral bending.
The R4A sensory neuron and DD6 motor neuron reach their peak activity when the male reaches the other side of the hermaphrodite. R4A directly innervates PVV and ventral body wall muscles. DD6 is a GABAergic motor neuron that relaxes dorsal body wall muscles ( Zhen and Samuel, 2015 61. Zhen, M. ∙ Samuel, A.D. C. elegans locomotion: small circuits, complex functions Curr. Opin. Neurobiol. 2015; 33 :117-126 Crossref Scopus (124) PubMed Google Scholar ). Thus, R4A and DD6 may prolong ventral bending, allowing the male to reach the other side of the hermaphrodite.
The tail often makes a sharp dorsal bend when it reaches the vulva to transition to copulation ( Whittaker and Sternberg, 2009 59. Whittaker, A.J. ∙ Sternberg, P.W. Coordination of opposing sex-specific and core muscle groups regulates male tail posture during Caenorhabditis elegans male mating behavior BMC Biol. 2009; 7 :33 Crossref Scopus (13) PubMed Google Scholar ) ( Figure 5 A). Several neurons are associated with dorsal bending, including sensory neurons involved in vulva detection, the PDB inter/motor neuron, and the AS11 and DA7 motor neurons ( Figure 3 B).
PDB receives inputs from multiple neurons, including CP7-9, HOA, EF1-3, and ray neurons, and is thus sensitive to different context-dependent signals for regulating tail posture. PDB-ablated males showed no difference from normal males in dorsal bending during searching and resting. However, PDB-ablated males showed less dorsal bending during scanning and vulva detection ( t [13.94] = 2.18, p = 0.046 and t [13.98] = 4.14, p = 0.001) ( Figure 5 E). PDB may directly evoke dorsal bending through its synaptic innervation of dorsal body wall muscles, as well as by activating AS11 (that synapses onto dorsal muscles) and VD13 (that relaxes ventral muscles) ( Zhen and Samuel, 2015 61. Zhen, M. ∙ Samuel, A.D. C. elegans locomotion: small circuits, complex functions Curr. Opin. Neurobiol. 2015; 33 :117-126 Crossref Scopus (124) PubMed Google Scholar ) ( Figure 5 B).
The AS11 motor neuron is positively correlated with backward scanning, consistent with its receiving 30% of its synaptic input from the AVA premotor interneuron. AS11 is thus positively correlated with A-type motor neurons for backward movement including VA11 that activates ventral muscles ( Figures 3 B, 3D, 5 B, and 5F). Although both AS11 and VA11 are correlated with backward movement, they have contrasting relationships to tail curvature. AS11 is positively correlated with dorsal bending whereas VA11 is negatively correlated with dorsal bending ( r = 0.12 ± 0.15 and r = − 0.13 ± 0.15). In PDB-ablated males, AS11 and VA11 became more correlated with each other and less correlated with curvature ( Figure 5 F). AS11 receives 15% of its synapses from PDB. Because PDB is correlated with dorsal curvature ( r = 0.29 ± 0.19) ( Figure 5 F) but not velocity ( r = − 0.03 ± 0.23), PDB appears to contribute to the curvature-dependent portion of AS11 activity but not its direction-dependent portion. PDB has a similar effect on the VD13 motor neuron, which relaxes ventral muscles. During scanning, VD13 is correlated with PDB and with curvature. PDB ablation lessens the correlation between VD13 and curvature ( Figure 5 F).
Both PDB and PVV provide mechanisms for context-dependent posture control. These interneurons collect sensory input that provide spatial cues about the vulva and hermaphrodite ends and target motor neurons and musculature to control dorsal and ventral bending for different purposes.
When the tail reaches the hermaphrodite’s excretory pore while scanning, the PHA and PHB phasmid sensory neurons become active ( Figure 5 G). The phasmid neurons have sex-specific synaptic connectivity ( White et al., 1986 58. White, J.G. ∙ Southgate, E. ∙ Thomson, J.N. ... The structure of the nervous system of the nematode Caenorhabditis elegans Philos. Trans. R. Soc. Lond. B Biol. Sci. 1986; 314 :1-340 Crossref PubMed Google Scholar ; Jarrell et al., 2012 19. Jarrell, T.A. ∙ Wang, Y. ∙ Bloniarz, A.E. ... The connectome of a decision-making neural network Science. 2012; 337 :437-444 Crossref Scopus (321) PubMed Google Scholar ). The hermaphrodite uses her phasmid neurons for chemotactic responses ( Hilliard et al., 2002 18. Hilliard, M.A. ∙ Bargmann, C.I. ∙ Bazzicalupo, P. C. elegans responds to chemical repellents by integrating sensory inputs from the head and the tail Curr. Biol. 2002; 12 :730-734 Full Text Full Text (PDF) Scopus (216) PubMed Google Scholar ). The male might use his phasmid neurons to detect excretory pore secretions to prevent mistaking the pore for the vulva ( Noble et al., 2015 36. Noble, L.M. ∙ Chang, A.S. ∙ McNelis, D. ... Natural variation in plep-1 causes male-male copulatory behavior in C. elegans Curr. Biol. 2015; 25 :2730-2737 Full Text Full Text (PDF) Scopus (25) PubMed Google Scholar ) or as a spatial cue to guide him to the vulva.
The excretory pore is anterior to the vulva. If the excretory pore is a guidance cue, its detection should affect movement decisions. Because the vulva is the dominant feature that affects movement decisions on the ventral side of the hermaphrodite, we examined male behavior with mutant hermaphrodites lacking a vulva ( let-23 mutants). During scanning with vulvaless hermaphrodites, males pause during 36% of scans on the anterior ventral side but only 8% of scans on the anterior dorsal side ( t [28.26] = 3.67, p < 0.001) ( Figure 5 H). Pauses near the excretory pore are sometimes followed by forward slides that return the tail to where the vulva should be. Thus, the excretory pore provides a guidance cue for course correction when the male overshoots the vulva.
Mutant ceh-14 males have defects in phasmid neuron development ( Serrano-Saiz et al., 2013 45. Serrano-Saiz, E. ∙ Poole, R.J. ∙ Felton, T. ... Modular control of glutamatergic neuronal identity in C. elegans by distinct homeodomain proteins Cell. 2013; 155 :659-673 Full Text Full Text (PDF) Scopus (188) PubMed Google Scholar ; Kagoshima et al., 2013 20. Kagoshima, H. ∙ Cassata, G. ∙ Tong, Y.G. ... The LIM homeobox gene ceh-14 is required for phasmid function and neurite outgrowth Dev. Biol. 2013; 380 :314-323 Crossref Scopus (12) PubMed Google Scholar ). These males do not respond to the excretory pore ( Figure 5 H). The phasmid neurons thus likely contribute to triggering pauses. The PGA interneuron is also active when the tail is near the excretory pore ( Figures 3 B and 3C). However, the wiring diagram does not have direct synaptic connections from the phasmid neurons to PGA.
When the male reaches the vulva, he stops scanning and transitions to vulva recognition. During vulva recognition, the male reduces his movement relative to the hermaphrodite while pushing his spicules toward the vulva. Breaching the vulva leads to copulation. The male is often unable to insert his spicules and loses contact with the vulva. When this happens, he restarts scanning until the next vulva recognition.
The PCB and PCC postcloacal sensilla neurons and the HOA and HOB hook neurons are strongly associated with vulva detection ( Figures 3 B–3D). These neurons were previously shown to help stop at the vulva ( Liu and Sternberg, 1995 31. Liu, K.S. ∙ Sternberg, P.W. Sensory regulation of male mating behavior in Caenorhabditis elegans Neuron. 1995; 14 :79-89 Abstract Full Text (PDF) Scopus (263) PubMed Google Scholar ). Brain-wide imaging revealed many additional neurons for vulva recognition including the R2B sensory neuron, the PVZ, PVX, and EF1-3 interneurons, the PDB inter/motor neuron, and the VD13 motor neuron ( Figures 3 B–3D, 3G, and 5 I). As discussed above, PDB and VD13 drive dorsal bending near the vulva. When the tail is aligned with the vulva for copulation, the second ray pair is closest to the vulva suggesting that R2B might be specialized for vulva recognition. Indeed, R2B ablation reduced the likelihood and duration of stopping at the vulva ( t [24.29] = 2.54, p = 0.02, t [21.61] = 2.2, p = 0.04) ( Figure 5 J).
Previous studies suggested that HOA contributes to both scanning and vulva recognition but in different ways. Near the vulva, HOA promotes stopping and spicule insertion. Away from the vulva, HOA is thought to suppress other vulva-sensing neurons because its ablation causes the male to spuriously pause anywhere on the hermaphrodite and initiate spicule thrusts ( Liu and Sternberg, 1995 31. Liu, K.S. ∙ Sternberg, P.W. Sensory regulation of male mating behavior in Caenorhabditis elegans Neuron. 1995; 14 :79-89 Abstract Full Text (PDF) Scopus (263) PubMed Google Scholar ; Correa et al., 2015 11. Correa, P.A. ∙ Gruninger, T. ∙ García, L.R. DOP-2 D2-like receptor regulates UNC-7 innexins to attenuate recurrent sensory motor neurons during C. elegans copulation J. Neurosci. 2015; 35 :9990-10004 Crossref Scopus (17) PubMed Google Scholar ). To better understand HOA’s contribution, we combined cell-specific neuron ablation with brain-wide imaging.
In control animals, a group of vulva-detecting neurons—PCB, PCC, HOB, and R2B—are specifically active when the tail is at the vulva ( Figures 6 A, 6B, and S6 ). In HOA-ablated males, these neurons showed bursts of activity away from the vulva ( Figures 6 C and S6 ). These bursts of spurious activity coincided with pauses and spicule thrusts away from the vulva which interfered with scanning. When HOA-ablated animals did reach the vulva, they were unable to maintain contact. This supports the idea that during scanning HOA is needed to inhibit other vulva-detecting neurons. During vulva recognition, HOA is needed to maintain contact and initiate copulation.
HOA makes both electrical and chemical synapses to the PCB vulva-detecting neuron ( Figure 6 A). Thus, both hyperpolarization or depolarization of HOA may propagate to PCB and hence to other vulva-detecting neurons. Glutamatergic inhibition from PCA has been shown to hyperpolarize HOA ( Correa et al., 2015 11. Correa, P.A. ∙ Gruninger, T. ∙ García, L.R. DOP-2 D2-like receptor regulates UNC-7 innexins to attenuate recurrent sensory motor neurons during C. elegans copulation J. Neurosci. 2015; 35 :9990-10004 Crossref Scopus (17) PubMed Google Scholar ). We found that PCA is active during backward scanning away from the vulva (see above). PCA may thus hyperpolarize HOA during backward scanning. To test whether PCA is part of a context-dependent switch that regulates HOA, we examined PCA-ablated animals. Like HOA-ablated animals, PCA-ablated animals exhibited spurious activity in the neurons for vulva-recognition ( Figures 6 D and S6 ). This spurious activity was more common with HOA-ablation than with PCA-ablation, suggesting that other neurons might also inhibit HOA during scanning. The PHC sensory neuron has the second strongest synaptic input to HOA ( Figure 6 A). Like PCA, PHC is glutamatergic but is active during forward movement. We conclude that HOA changes its effect on synaptic partners in a context-dependent manner. Near the vulva, HOA is activated by vulva detection, and further activates other vulva-detecting neurons. During scanning, PCA provides glutamatergic inhibition to HOA, which leads to hyperpolarization of other vulva-detecting neurons through electrical synapses.
After HOA ablation, the vulva-detecting sensory neurons—PCB, PCC, HOB, and R2B—showed bursts of activity during scanning. Because this activity occurs away from the vulva, it might be triggered by the hermaphrodite cuticle itself. One possibility is that the cuticle fully activates one or more of the vulva-detecting neurons away from the vulva. Alternatively, the cuticle might not fully activate one neuron, but, when some neurons become activated at a low level, recurrent excitation amplifies sub-threshold signals into a burst. The wiring diagram reveals many synapses between vulva-detecting neurons that might allow recurrent excitation ( Figure 6 A).
We released the vulva-detecting circuit from inhibition away from the vulva by ablating HOA. If recurrent excitation plays a role, removing additional neurons should reduce the spurious activation of others. Additionally ablating either PCB or PCC reduced spurious activation of the rest of the vulva-detecting circuit ( Figures 6 E, 6F, and S6 )—remaining sensory neurons were less activated by the cuticle but were activated by the vulva. However, additionally ablating HOB did not suppress the spurious activity of remaining neurons ( Figures 6 G and S6 ). PCB and PCC appear to contribute to recurrent excitation, but not HOB.
Recurrent excitation and signal amplification may facilitate the all-or-none switch of circuit activity from scanning to vulva recognition. To confine its activity to the vulva, the vulva-detecting circuit must be under context-dependent inhibition. Integrated mechanisms for recurrent excitation and context-dependent inhibition enable sensitive and robust switching between temporally adjacent behaviors.
Breaching the vulva leads to copulation. Copulation involves spicule insertion, sperm release, and withdrawal. Previous experiments showed that several sensory and motor neurons contribute to these different steps ( Liu and Sternberg, 1995 31. Liu, K.S. ∙ Sternberg, P.W. Sensory regulation of male mating behavior in Caenorhabditis elegans Neuron. 1995; 14 :79-89 Abstract Full Text (PDF) Scopus (263) PubMed Google Scholar ; LeBoeuf et al., 2014 28. LeBoeuf, B. ∙ Correa, P. ∙ Jee, C. ... Caenorhabditis elegans male sensory-motor neurons and dopaminergic support cells couple ejaculation and post-ejaculatory behaviors eLife. 2014; 3 :e02938 Crossref Google Scholar ; LeBoeuf and Garcia, 2017 27. LeBoeuf, B. ∙ Garcia, L.R. Caenorhabditis elegans male copulation circuitry incorporates sex-shared defecation components to promote intromission and sperm transfer G3 (Bethesda). 2017; 7 :647-662 Crossref Scopus (17) PubMed Google Scholar ; Hart and Hobert, 2018 17. Hart, M.P. ∙ Hobert, O. Neurexin controls plasticity of a mature, sexually dimorphic neuron Nature. 2018; 553 :165-170 Crossref Scopus (58) PubMed Google Scholar ). We directly visualized the temporal sequence in neuronal activity during copulation ( Figures 3 H–3K).
The first neurons involved in copulation, the SPD sensory neuron, SPC sensory/motor neuron, and DVB inter/motor neuron, are activated with spicule insertion ( Figures 3 H and 3J and 3K). Both SPC and DVB innervate the spicule protractor muscles and drive spicule insertion ( Liu and Sternberg, 1995 31. Liu, K.S. ∙ Sternberg, P.W. Sensory regulation of male mating behavior in Caenorhabditis elegans Neuron. 1995; 14 :79-89 Abstract Full Text (PDF) Scopus (263) PubMed Google Scholar ; LeBoeuf and Garcia, 2017 27. LeBoeuf, B. ∙ Garcia, L.R. Caenorhabditis elegans male copulation circuitry incorporates sex-shared defecation components to promote intromission and sperm transfer G3 (Bethesda). 2017; 7 :647-662 Crossref Scopus (17) PubMed Google Scholar ). SPV, a sensory neuron with endings at the spicule tips, becomes active 1.1 ± 1.7 s following spicule insertion. The timing of SPV activation is consistent with its proposed roles in detecting the internal environment of the uterus and controlling the timing of sperm release. SPV ablation leads to premature sperm release ( Liu and Sternberg, 1995 31. Liu, K.S. ∙ Sternberg, P.W. Sensory regulation of male mating behavior in Caenorhabditis elegans Neuron. 1995; 14 :79-89 Abstract Full Text (PDF) Scopus (263) PubMed Google Scholar ; LeBoeuf et al., 2014 28. LeBoeuf, B. ∙ Correa, P. ∙ Jee, C. ... Caenorhabditis elegans male sensory-motor neurons and dopaminergic support cells couple ejaculation and post-ejaculatory behaviors eLife. 2014; 3 :e02938 Crossref Google Scholar ).
HOA is active during vulva detection, but exhibits peak activity 1.8 ± 2.4 s after spicule insertion ( Figure 3 K). The PVZ interneuron has similar activity to HOA but with slower dynamics, active during vulva detection and peaking after 6.9 ± 4.8 spicule insertion. The wiring diagram predicts multiple synapses between HOA and PVZ. 2.3 ± 1.7 s after spicule insertion, calcium transients occur in multiple intestinal cells including Int9R (in contrast, LeBoeuf and Garcia [2017] 27. LeBoeuf, B. ∙ Garcia, L.R. Caenorhabditis elegans male copulation circuitry incorporates sex-shared defecation components to promote intromission and sperm transfer G3 (Bethesda). 2017; 7 :647-662 Crossref Scopus (17) PubMed Google Scholar observed no activation of the intestine). Anterograde calcium transients in intestine are known to initiate defecation ( Teramoto and Iwasaki, 2006 55. Teramoto, T. ∙ Iwasaki, K. Intestinal calcium waves coordinate a behavioral motor program in C. elegans Cell Calcium. 2006; 40 :319-327 Crossref Scopus (49) PubMed Google Scholar ). In the male, defecation and ejaculation have shared components and circuitry ( LeBoeuf and Garcia, 2017 27. LeBoeuf, B. ∙ Garcia, L.R. Caenorhabditis elegans male copulation circuitry incorporates sex-shared defecation components to promote intromission and sperm transfer G3 (Bethesda). 2017; 7 :647-662 Crossref Scopus (17) PubMed Google Scholar ; Hart and Hobert, 2018 17. Hart, M.P. ∙ Hobert, O. Neurexin controls plasticity of a mature, sexually dimorphic neuron Nature. 2018; 553 :165-170 Crossref Scopus (58) PubMed Google Scholar ). Intestinal calcium transients might have roles in initiating both motor sequences in the male. The PCA postcloacal sensilla neuron becomes active following these intestinal calcium transients (3.6 ± 1 s after spicule insertion). PCA might be involved in the movements of the gubernaculum, as it directly innervates the gubernaculum erector and retractor muscles ( LeBoeuf et al., 2014 28. LeBoeuf, B. ∙ Correa, P. ∙ Jee, C. ... Caenorhabditis elegans male sensory-motor neurons and dopaminergic support cells couple ejaculation and post-ejaculatory behaviors eLife. 2014; 3 :e02938 Crossref Google Scholar ; Jarrell et al., 2012 19. Jarrell, T.A. ∙ Wang, Y. ∙ Bloniarz, A.E. ... The connectome of a decision-making neural network Science. 2012; 337 :437-444 Crossref Scopus (321) PubMed Google Scholar ).
The activities of the CA8 and CA9 inter/motor neurons increase 32 ± 14 s after spicule insertion, peak roughly when the male detaches from the vulva, and decrease with spicule retraction ( Figure 3 J). This activity pattern is consistent with the proposed role of CA neurons in sperm transfer ( Schindelman et al., 2006 43. Schindelman, G. ∙ Whittaker, A.J. ∙ Thum, J.Y. ... Initiation of male sperm-transfer behavior in Caenorhabditis elegans requires input from the ventral nerve cord BMC Biol. 2006; 4 :26 Crossref Scopus (28) PubMed Google Scholar ).
Four vulva-detecting sensory neurons—PCB, PCC, HOB, and R2B—decrease their activity upon sperm release even when in contact with the vulva ( Figure 3 I). As the male transitions to ejaculation, several neurons that are involved in an earlier step in the temporal sequence are deactivated by the circuit. These vulva-detecting neurons might interfere with later steps in copulation requiring their deactivation.
After copulation, the male rests for several minutes when his motor activity is suppressed ( LeBoeuf et al., 2014 28. LeBoeuf, B. ∙ Correa, P. ∙ Jee, C. ... Caenorhabditis elegans male sensory-motor neurons and dopaminergic support cells couple ejaculation and post-ejaculatory behaviors eLife. 2014; 3 :e02938 Crossref Google Scholar ). Resting coincides with decreased global activity of the mating circuit ( Figure S7 A). However, a few neurons have increased activity during resting. The PVZ and CA8-9 interneurons, which become active later during copulation, remain active until spicule retraction. Only DVB, which becomes active when copulation begins, sustains activity throughout rest ( Figure 3 J).
After rest, the male searches for another partner. Most neurons associated with searching are in the head ( Srinivasan et al., 2008 50. Srinivasan, J. ∙ Kaplan, F. ∙ Ajredini, R. ... A blend of small molecules regulates both mating and development in Caenorhabditis elegans Nature. 2008; 454 :1115-1118 Crossref Scopus (281) PubMed Google Scholar ; LeBoeuf et al., 2014 28. LeBoeuf, B. ∙ Correa, P. ∙ Jee, C. ... Caenorhabditis elegans male sensory-motor neurons and dopaminergic support cells couple ejaculation and post-ejaculatory behaviors eLife. 2014; 3 :e02938 Crossref Google Scholar ; Narayan et al., 2016 34. Narayan, A. ∙ Venkatachalam, V. ∙ Durak, O. ... Contrasting responses within a single neuron class enable sex-specific attraction in Caenorhabditis elegans Proc. Natl. Acad. Sci. USA. 2016; 113 :E1392-E1401 Crossref Scopus (36) PubMed Google Scholar ). We discovered that several neurons in the posterior brain are also associated with searching ( Figures 3 B and 3C). Interestingly, the PLM mechanosensory neuron is more active during searching than during hermaphrodite contact. PLM is required to initiate forward movement in an escape response when either males or hermaphrodites are touched at the posterior ( Chalfie and Sulston, 1981 8. Chalfie, M. ∙ Sulston, J. Developmental genetics of the mechanosensory neurons of Caenorhabditis elegans Dev. Biol. 1981; 82 :358-370 Crossref Scopus (526) PubMed Google Scholar ). We found that PLM activity drops sharply when courtship begins. PLM activity does not immediately rise when the male loses contact. PLM may be suppressed when the male contacts a hermaphrodite, allowing mating to be sustained by inactivating the circuit for escape response.

Section: Discussion

Natural multi-step behaviors challenge the brain to perform diverse tasks across the range of what the brain evolved to do ( Krakauer et al., 2017 25. Krakauer, J.W. ∙ Ghazanfar, A.A. ∙ Gomez-Marin, A. ... Neuroscience needs behavior: correcting a reductionist bias Neuron. 2017; 93 :480-490 Full Text Full Text (PDF) Scopus (735) PubMed Google Scholar ; Gomez-Marin et al., 2014 16. Gomez-Marin, A. ∙ Paton, J.J. ∙ Kampff, A.R. ... Big behavioral data: psychology, ethology and the foundations of neuroscience Nat. Neurosci. 2014; 17 :1455-1462 Crossref Scopus (172) PubMed Google Scholar ). Here, we analyze how an entire brain in the male C. elegans drives the full performance of mating behavior.
When considering the full behavior, we find little redundancy in the activities of different neurons. Nearly every neuron exhibits different correlations with respect to the rest of the circuit and to behavioral dynamics ( Figure 3 D). Some neurons are specialized for single behavioral motifs. Others participate in multiple motifs. Each motif engages a unique set of neurons. Different motifs often engage overlapping sets of neurons. During the execution of each motif, neurons may be activated in sequence, revealing stepwise functional contributions as behavior unfolds ( Figure 3 K).
Functional correlations between neurons in the brain are not fixed, but change with behavioral context ( Figure 3 L; Table S5 ). These correlations are produced by the dynamic interactions between the animal, the nervous system, and the environment. A mechanism that produces context-dependent functional correlations is the stimulus-evoked recruitment of sensorimotor pathways.
The hermaphrodite presents different stimulus patterns to the male with different parts of her body and at different mating steps. These stimulus patterns create context-dependent correlations among the sensory neurons of the brain. The diversity of these correlations underlies the diversity of sensorimotor responses in an entire behavior ( Figure 7 ). In recent studies of C. elegans that focused on a small space of fictive or real motor output, brain-wide dynamics exhibited low diversity ( Venkatachalam et al., 2016 56. Venkatachalam, V. ∙ Ji, N. ∙ Wang, X. ... Pan-neuronal imaging in roaming Caenorhabditis elegans Proc. Natl. Acad. Sci. US A. 2016; 113 :E1082-8 Crossref Scopus (131) PubMed Google Scholar ; Kato et al., 2015 22. Kato, S. ∙ Kaplan, H.S. ∙ Schrödel, T. ... Global brain dynamics embed the motor command sequence of Caenorhabditis elegans Cell. 2015; 163 :656-669 Full Text Full Text (PDF) Scopus (287) PubMed Google Scholar ; Nguyen et al., 2016 35. Nguyen, J.P. ∙ Shipley, F.B. ∙ Linder, A.N. ... Whole-brain calcium imaging with cellular resolution in freely behaving Caenorhabditis elegans Proc. Natl. Acad. Sci. USA. 2016; 113 :E1074-E1081 Crossref Scopus (231) PubMed Google Scholar ; Linderman et al., 2019 30. Linderman, S.W. ∙ Nichols, A.L. ∙ Blei, D.M. ... Hierarchical recurrent state space models reveal discrete and continuous dynamics of neural activity in C. elegans bioRxiv. 2019; Crossref Scopus (0) Google Scholar ). Across the entirety of mating behavior, however, the brain orchestrates multiple behavioral motifs. Each motif involves different brain dynamics even when employing the same motor neurons and muscle cells. For example, during mating, tail posture is controlled in different ways in different contexts ( Figures 5 A–5F). This is accomplished by motif-specific computations by partly overlapping circuits that converge on a common set of motor neurons and musculature. These observations also point to the uncertain equivalency between “behavioral primitives.” Similar motor actions can be instantiated by different sensory-motor pathways.
The relationship between the connectome and brain-wide activity is not one-to-one. Throughout the brain, neurons synapse onto both neurons that participate in the same behavioral motif and neurons that participate in other motifs ( Figure 4 E). Some of the significance of in-group and out-group connectivity is revealed by temporally adjacent motifs like scanning and vulva-detection. In-group connectivity among vulva-detecting neurons provides recurrent excitation that amplifies circuit activity during copulation attempts ( Figure 6 ). Signal amplification within the vulva-detecting circuit presumably enhances its all-or-none sensitivity, but then requires context-dependent inhibition to prevent spurious activation. Context-dependent inhibition is provided by out-group connectivity from the scanning circuit. Circuits for different steps of behavior are not isolated, but continuously interact to stabilize individual behaviors or mediate transitions between behaviors.
Diverse brain-wide dynamics emerge from the complex interactions between a male and his mating partner. The mating circuit recognizes different sets of sensory inputs that only arise in their natural context. These inputs are manifested in brain-wide functional correlations, starting from the diverse properties of sensory neurons. Diverse sensory patterns act on the wiring diagram to recruit different sensorimotor pathways and different communities of neurons for different steps of behavior. Behavioral dynamics must be integrated with neuronal dynamics and wiring to understand how the brain does what it evolved to do.
Due to technological limitations, it was impossible to image both head and tail ganglia simultaneously. The present study focuses on the posterior brain of the C. elegans male, which drives sensory, motor, and decision-making steps during mating. New microscopy techniques in combination with genetically encoded fluorescent markers will further extend neurons available for study. Tracking neurons in a deforming brain represents a challenge. The relatively low throughput of the method limited the ability to resolve aspects of the brain dynamics that require observing tens and hundreds of individuals, such as variable and history-dependent execution of behavioral motifs. Improved methods for automated neuronal tracking will accelerate data collection required for such studies.

Section: STAR★Methods

REAGENT or RESOURCE SOURCE IDENTIFIER Bacterial and virus strains E. coli Caenorhabditis Genetics Center (CDC) WormBase: OP50; WormBase:WBStrain00041969 Experimental models: Organisms/strains aeaIs010 [Prgef-1::GCaMP6s:: 3xNLS + lin-15(+)] This study ADS1002 otIs377 [myo-3p::mCherry]; let-23(sy1) II; unc-64(e246) III This study ADS1003 uuEx18 [dcr-1(wild-type) + dpy-30:: mCherry]; lin-15 (n765ts) X This study ADS1006 otIs377 [myo-3p::mCherry]; unc-31(e169) IV This study ADS1013 uuEx18 [dcr-1(wild-type) + dpy-30:: mCherry] Caenorhabditis Genetics Center (CDC) BB92 dpy-5(e907) I; sIs12409 [rCes T23F11.5::GFP + pCeh361] CGC BC12695 inIs179 [ida-1p::GFP] II; him-8(e1489) IV CGC BL5717 unc-31 (e169) IV CGC CB169 unc-64 (e246) III CGC CB246 him-5 (e1490) V CGC CB4088 juIs76 [unc-25p::GFP + lin-15(+)] II CGC CZ13799 lin-15B&lin-15A (n765) X; rtEx247 [nlp-14p::GFP + lin-15(+)] CGC HA353 vsIs177 [ocr-2p::GCaMP5::ocr-2 3′UTR + ocr-2p::mCherry::ocr-2 3′UTR + lin-15(+)] lite-1(ce314) lin-15AB(n765) X CGC LX1986 vsIs48 [unc-17::GFP] CGC LX929 nIs133 [pkd-2::GFP] I; ceh-30 (n3714) X CGC MT11318 wildtype CGC N2 dpy-20(e1282) IV; pkIs583 [gpa-6::GFP + dpy-20(+)] CGC NL1603 ceh-43(tm480) III; him-5 (e1490) V; bxIs19 [trp-4p::GFP]; norEx41 [ceh-43 fosmid + dat-1::mCherry] CGC OH10235 otIs377 [myo-3p::mCherry]; otEx4945 [hsp16-2p::hlh-1::2xFLAG + rol-6(su1006)] CGC OH11119 otIs452[eat-4p9::GFP + pha-1(+)] Oren-Suissa et al., 2016 37. Oren-Suissa, M. ∙ Bayer, E.A. ∙ Hobert, O. Sex-specific pruning of neuronal synapses in Caenorhabditis elegans Nature. 2016; 533 :206-211 Crossref Scopus (85) PubMed Google Scholar OH11992 him-5(e1490) V; otIs576 [unc-17(fosmid)::GFP + lin-44::YFP] CGC OH13083 him-5 (e1490) otIs564 [unc-47(fosmid)::SL2::H2B:: mChopti + pha-1(+)] V CGC OH13105 pha-1(e2123) III; him-5(e1490) V; otIs518 [eat-4(fosmid)::SL2:: mCherry::H2B + pha-1(+)] CGC OH13645 pha-1 (e2123) III; him-5 (e1490) V; otIs544 [cho-1(fosmid)::SL2:: mCherry::H2B + pha-1(+)] CGC OH13646 pha-1(e2123) III; him-5 (e1490) V; otIs625 [cat-1(fosmid)::SL2:: mCherry::H2B + pha-1(+)] CGC OH15039 him-5(e1490) V; otIs541 [lim-6(intron4)::wCherry] CGC OH15097 pha-1(e2123) III; otEx233 [dop-1(prom1)::GFP + pha-1(+)] CGC OH2411 otIs33[kal-1::GFP] IV CGC OH904 let-23 (sy1) II; him-5 (e1490) V CGC PS21 lin-15 (n765ts) lite-1 (ce314) X; zfEx436 [mec-4::mCherry::SL2::GCaMP6s] Mark Alkema QW1068 zfEx898[Psto-3::wrmScarlet + lin-15(+)]; lin-15 (n765ts) X Susoy et al., 2019 54. Susoy, V. ∙ Joyce, W. ∙ Rahi, S. sto-3 is expressed in r4bl/r and r8bl/r, male-specific ray neurons in C. elegans MicroPubl. Biol. 2019; 2019 10.17912/micropub.biology.000091 PubMed Google Scholar QW1876 pha-1 (e2123) III; mdEx865 [unc-17p::NLS::mCherry + pha-1(+)] CGC RM3325 hpIs474[glr-1::NLS::wCherry + lin-15(+)] Mei Zhen ZM8516 hpIs675 [Prgef-1::GCaMP6s::3xNLS::mNeptune + lin-15(+)] lin-15(n765) X This study ZM9624 Software and algorithms Fiji Schindelin et al., 2012 42. Schindelin, J. ∙ Arganda-Carreras, I. ∙ Frise, E. ... Fiji: an open-source platform for biological-image analysis Nat. Methods. 2012; 9 :676-682 Crossref Scopus (38230) PubMed Google Scholar https://imagej.net/software/fiji MaMuT 0.27 Wolff et al., 2018 60. Wolff, C. ∙ Tinevez, J.Y. ∙ Pietzsch, T. ... Multi-view light-sheet imaging and tracking with the MaMuT software reveals the cell lineage of a direct developing arthropod limb eLife. 2018; 7 :e34410 Crossref Scopus (102) PubMed Google Scholar https://imagej.net/plugins/mamut/ Linkcomm 1.0 Kalinka and Tomancak, 2011 21. Kalinka, A.T. ∙ Tomancak, P. linkcomm: an R package for the generation, visualization, and analysis of link communities in networks of arbitrary size and type Bioinformatics. 2011; 27 :2011-2012 Crossref Scopus (99) PubMed Google Scholar https://cran.r-project.org/web/packages/linkcomm/ caret 6.0 Kuhn et al., 2020 26. Kuhn, M. ∙ Wing, J. ∙ Weston, S. ... Package “caret.” 2020 https://github.com/topepo/caret/ Google Scholar https://cran.r-project.org/web/packages/caret/ glmnet 2.0 Friedman et al., 2020 14. Friedman, J. ∙ Hastie, T. ∙ Tibshirani, R. ... Package “glmnet.” 2020 https://cran.r-project.org/web/packages/glmnet/index.html Google Scholar https://cran.r-project.org/web/packages/glmnet/ WSBM Aicher et al., 2015 3. Aicher, C. ∙ Jacobs, A.Z. ∙ Clauset, A. Learning latent block structure in weighted networks J. Complex Netw. 2015; 3 :221-248 Crossref Scopus (183) Google Scholar https://aaronclauset.github.io/wsbm/ Web-based data browser with brain volumes, activity traces, and behavioral features This study http://mating-data.worm.world/index.html Other C. elegans male connectome Jarrell et al., 2012 19. Jarrell, T.A. ∙ Wang, Y. ∙ Bloniarz, A.E. ... The connectome of a decision-making neural network Science. 2012; 337 :437-444 Crossref Scopus (321) PubMed Google Scholar ; Cook et al., 2019 10. Cook, S.J. ∙ Jarrell, T.A. ∙ Brittin, C.A. ... Whole-animal connectomes of both Caenorhabditis elegans sexes Nature. 2019; 571 :63-71 Crossref Scopus (386) PubMed Google Scholar https://wormwiring.org/ Neuronal activity traces and concurrent behavioral features This Study https://doi.org/10.17632/922xsfxh2g.1 Open table in a new tab
Further information and requests for resources and reagents should be directed to the lead contact, Aravinthan D.T. Samuel ( samuel@physics.harvard.edu ).
Panneuronal imaging strains created for this study ZM9624 and ADS1002 are deposited with the Caenorhabditis Genetics Center as of day of publication and are available from the AS, MZ, and VV labs.
All C. elegans strains were grown at 23°C on nematode growth medium (NGM) plates seeded with E. coli OP50. All strains were allowed to recover from starvation and freezing for at least two generations before experiments.
A C. elegans imaging strain ZM9624 was designed to co-express GCaMP6s and mNeptune in all neuronal nu-
clei. For this, lin-15(n765) hermaphrodites were co-injected with lin-15 rescuing plasmid and pJH3971(Prgef-1::GCaMP6s::3xNLS::mNeptune). A transgenic line (hpEx3880) with consistent expression of GCaMP6s and mNeptune was selected for the UV-mediated transgene integration. The integrated line was outcrossed four times with N2.
ADS1002 was created by co-injecting lin-15(n765) with lin-15 rescuing plasmid and pJH34038 (Prgef-1::GCaMP6s::3xNLS) . A stable transgenic line (hpEx3931) was generated and outcrossed three times with N2.
We sought to capture multiple motifs of mating behavior within each recording session. The number and order of behavioral motifs varied from trial to trial. For comprehensive analyses, we selected eight datasets capturing a wide range of motifs. Additionally, we collected 14 datasets focusing on specific neurons and behavioral motifs and 23 datasets using ablated males (see below). It was impossible to image both the head and tail simultaneously. In this study, we focused on the neurons in the tail, most of which are male-specific and form a posterior brain that drives mating ( Sulston et al., 1980 53. Sulston, J.E. ∙ Albertson, D.G. ∙ Thomson, J.N. The Caenorhabditis elegans male: postembryonic development of nongonadal structures Dev. Biol. 1980; 78 :542-576 Crossref Scopus (435) PubMed Google Scholar ; Jarrell et al., 2012 19. Jarrell, T.A. ∙ Wang, Y. ∙ Bloniarz, A.E. ... The connectome of a decision-making neural network Science. 2012; 337 :437-444 Crossref Scopus (321) PubMed Google Scholar ; Cook et al., 2019 10. Cook, S.J. ∙ Jarrell, T.A. ∙ Brittin, C.A. ... Whole-animal connectomes of both Caenorhabditis elegans sexes Nature. 2019; 571 :63-71 Crossref Scopus (386) PubMed Google Scholar ).
Virgin L4 males were selected and kept on a separate plate for 24 to 40 hours before imaging. This allowed GCaMP6s and mNeptune to accumulate in the neurons of the tail, many of which are born during the L4 stage ( Sulston et al., 1980 53. Sulston, J.E. ∙ Albertson, D.G. ∙ Thomson, J.N. The Caenorhabditis elegans male: postembryonic development of nongonadal structures Dev. Biol. 1980; 78 :542-576 Crossref Scopus (435) PubMed Google Scholar ). For the imaging experiments, a single adult male was placed on an NGM agar plate with 2-5 hermaphrodites and a small amount of OP50. We used hermaphrodites that expressed red fluorescent markers in either their muscles or epidermis for tracking ( Table S1 ). The assay plate was covered with a coverslip for oil immersion. Animals could swim freely under the coverslip.
Imaging was performed using a custom spinning-disc confocal microscope described in Venkatachalam et al. (2016) 56. Venkatachalam, V. ∙ Ji, N. ∙ Wang, X. ... Pan-neuronal imaging in roaming Caenorhabditis elegans Proc. Natl. Acad. Sci. US A. 2016; 113 :E1082-8 Crossref Scopus (131) PubMed Google Scholar , with some modifications ( Venkatachalam et al., 2016 56. Venkatachalam, V. ∙ Ji, N. ∙ Wang, X. ... Pan-neuronal imaging in roaming Caenorhabditis elegans Proc. Natl. Acad. Sci. US A. 2016; 113 :E1082-8 Crossref Scopus (131) PubMed Google Scholar ). Briefly, the emitted light from the samples was split into the red and green channels and images were captured using two Andor Zyla 4.2 sCMOS cameras. Each camera recorded 256 × 512 pixel area of interest at 200 Hz and with the system pixel size of 0.45 μm. Volumetric imaging was done using a 40x, 1.30 NA Nikon Plan Fluor objective mounted on a piezoelectric stage. We sampled 10 brain volumes per second, each volume consisting of 20 optical sections approximately 1.75 μm apart. The tail of the freely-swimming male was tracked continuously by adjusting the microscope stage position with a stage controller.
Neurons were identified based on a combination of features, including their position, morphology, and expression of specific fluorescent markers. Table S2 lists key criteria for assigning ids to each identified neuron. Anatomical drawings in Sulston et al. (1980) 53. Sulston, J.E. ∙ Albertson, D.G. ∙ Thomson, J.N. The Caenorhabditis elegans male: postembryonic development of nongonadal structures Dev. Biol. 1980; 78 :542-576 Crossref Scopus (435) PubMed Google Scholar were a primary reference for the neurons’ relative positions and morphology ( Sulston et al., 1980 53. Sulston, J.E. ∙ Albertson, D.G. ∙ Thomson, J.N. The Caenorhabditis elegans male: postembryonic development of nongonadal structures Dev. Biol. 1980; 78 :542-576 Crossref Scopus (435) PubMed Google Scholar ). Neuronal positions were additionally cross-checked with the annotated electron microscopy data for the N2Y male shared by Scott Emmons. Among other sources, we used fluorescent microphotographs in Serrano-Saiz et al. (2017b) 47. Serrano-Saiz, E. ∙ Pereira, L. ∙ Gendrel, M. ... A neurotransmitter atlas of the Caenorhabditis elegans male nervous system reveals sexually dimorphic neurotransmitter usage Genetics. 2017; 206 :1251-1269 Crossref Scopus (36) PubMed Google Scholar which provided a comprehensive account of the expression patterns of multiple sparse markers ( Serrano-Saiz et al., 2017b 47. Serrano-Saiz, E. ∙ Pereira, L. ∙ Gendrel, M. ... A neurotransmitter atlas of the Caenorhabditis elegans male nervous system reveals sexually dimorphic neurotransmitter usage Genetics. 2017; 206 :1251-1269 Crossref Scopus (36) PubMed Google Scholar ). To test if the same neurons could be reliably identified in different individuals and to confirm neuronal ids, we crossed existing well-characterized marker strains ( Table S2 ) with panneuronal ADS1002 or ZM9624. Cross-examination of the expression patterns with multiple marker strains identified clusters of neurons where neuronal positions and morphology were conserved enough to enable unambiguous identification in the absence of genetically encoded markers ( Figure S1 A). This approach worked well for the regions with stereotyped cell positions such as preanal ganglion (PAG) and cloacal ganglion (CG) and parts of the ventral nerve cord (VNC). Positions of some neurons in the dorsal root ganglion (DRG) and lumbar ganglion (LG) are known to be variable ( Sulston et al., 1980 53. Sulston, J.E. ∙ Albertson, D.G. ∙ Thomson, J.N. The Caenorhabditis elegans male: postembryonic development of nongonadal structures Dev. Biol. 1980; 78 :542-576 Crossref Scopus (435) PubMed Google Scholar ). To confirm identities of neurons in these ganglia we performed panneuronal imaging using sparsely labeled strains, and tested if neuron-specific activity patterns matched. In total, we were able to identify 76 neurons across all datasets. Recorded brain volumes, neuronal ids, activity traces, continuous behavioral features, and ethograms are available via an interactive web-based browser at http://mating-data.worm.world/index.html .
All ablations were performed in young adult males, 1-4 hours after they completed their final molt. Ablations were done using a MicroPoint pulsed laser system (Andor) mounted on a Nikon microscope equipped with Nomarski optics and a 100x 0.95 NA Nikon Plan Apo objective. Males were placed on a 10% agar pad and immobilized with 0.01 μm latex beads (Polysciences, Inc). Target neurons were identified based on the expression of fluorescent markers. The neuronal nuclei were targeted until a visible damage appeared. Mock ablations were performed by placing males on a slide with latex beads for 5-10 minutes. Males were left to recover overnight, and behavioral assays and imaging experiments were performed on the next day.
Behavioral arenas were 6 cm NGM agar plates seeded with a thin layer of E. coli OP50 forming a spot approximately 0.5 cm in diameter. One to three young adult hermaphrodites and one male were placed onto each assay plate. Behavior of the male was recorded at 5 frames per second for 30 to 60 minutes using a Grasshopper3 camera and Spinnaker software (Point Grey). Treatment and control trials were recorded on the same day. The recordings were analyzed blindly in MaMuT. Two-sided t tests were used to compare group means.
For the PVV ablations, we tabulated successful turns and failed turning attempts. A turn was considered failed when the turn initiation was followed by either a permanent or temporary loss of contact.
To quantify pausing at the excretory pore, we performed mating assays with vulvaless let-23 hermaphrodites. We recorded when the male stopped backward scanning for more than 0.2 s on the anterior ventral side opposite the terminal bulb of the pharynx. This location corresponds to the excretory pore opening. For comparison, we tabulated pausing on the anterior dorsal side. Pausing was recorded during backward scanning toward the tip of the hermaphrodite’s head ( Figure S7 B).
For the R2B ablations, we tested if vulva detection and retention were compromised. We calculated the fraction of successful vulva detection events. Vulva detection was considered successful if the male paused scanning at the vulva for more than 0.2 s. We also calculated the average vulva retention time. Assays with more than five vulva detection events were included; vulva contacts during copulation were excluded.
Statistical details can be found in this section. Results of statistical tests are reported in the text, main and supplemental figures, and tables, and Data S1 , as noted.
Neuronal activity traces were extracted from raw image volumes following image pre-processing and registration. All red channel volumes were registered to the green channel through rigid transformation. A difference of Gaussian filter was applied to both channels to suppress the background noise. The datasets were subsampled to include every other volume. The volumes were converted into 5D big-data-viewer arrays and used for neuronal segmentation and tracking with MaMuT 0.27, a Fiji plugin ( Wolff et al., 2018 60. Wolff, C. ∙ Tinevez, J.Y. ∙ Pietzsch, T. ... Multi-view light-sheet imaging and tracking with the MaMuT software reveals the cell lineage of a direct developing arthropod limb eLife. 2018; 7 :e34410 Crossref Scopus (102) PubMed Google Scholar ; Schindelin et al., 2012 42. Schindelin, J. ∙ Arganda-Carreras, I. ∙ Frise, E. ... Fiji: an open-source platform for biological-image analysis Nat. Methods. 2012; 9 :676-682 Crossref Scopus (38230) PubMed Google Scholar ). Segmentation and tracking were done manually, with some help of the MaMuT’s automated tracking and a custom neuron tracking tool. We tracked all visible neurons for six out of eight main datasets. For the sevenths and eighth datasets, we tracked all identifiable neuron types (see below). For the 14 additional and 23 ablation datasets, only neurons of interest were tracked. Fluorescence intensities ( F (red) and F (green) ) were extracted by computing mean pixel values for the 2.25 × 2.25 × 3.5 μm volumes surrounding the center of each nucleus in the green and red channels. Savitzky-Golay filtering (polynomial order of 1 and frame length 13) was applied to intensity traces from each channel for noise-reduction ( Orfanidis, 1995 38. Orfanidis, S.J. Introduction to Signal Processing Prentice-Hall, Inc., 1995 Google Scholar ). We computed neuronal activity as the ratio F (green) /F (red) to minimize the effects of correlated noise and motion artifacts. To mitigate remaining motion artifacts, a singular value decomposition was applied to the main datasets retaining 2/3 of components.
We parameterized several continuous features of male behavior. These included swimming velocity and speed, sliding velocity and speed (tail velocity and speed relative to the hermaphrodite body when in contact), tail curvature, distance of the male tail to the head and tail of the hermaphrodite and to the vulva, and spicule protraction. To parameterize velocity, we computed the centroid of the tail from coordinates of three tail neurons (AS11, PLM, EF1). Centroid positions were extracted for each volume and converted into velocity of the worm in the egocentric coordinates. Negative velocity values correspond to swimming forward, and positive values to swimming backward. Tail curvature was estimated using the angle between two rays diverging from the center of PVY and intersecting centers of AS11 and PLM ( Figure S7 C). When the tail is relaxed, the angle formed by the rays is nearly straight. Spicule protraction was estimated indirectly by measuring the distance between spicule neurons SPD and SPC, which move with the spicules, and PCB. As the spicules become protracted, the distance between the spicule neurons and PCB sharply decreases.
To map the position of the tail to the hermaphrodite, we extracted maximum intensity projections (MIPs) of the volumes in which large parts of the hermaphrodite were visible. The images were tiled to cover the entire body and aligned with rigid rotations and translations to produce a straightened representation of the hermaphrodite ( Figure S7 D). For each data volume, we mapped the position of the tail to the straightened hermaphrodite by matching uniquely identifiable MIP features. Finally, we estimated the best fit for an ellipse of aspect ratio 10 given the x and y coordinates of the tail position on the hermaphrodite, generating a representation of the tail trajectory on an idealized elliptical hermaphrodite ( Figure S7 D). Using this map, we calculated the male’s scanning velocity and speed and its distance to the vulva and to the head and tail of the hermaphrodite.
The distance of the tail to the vulva is the arc length of the shortest path between the tail and the vulva along a section of the ellipse representing the hermaphrodite. The distance of the tail to the hermaphrodite tips is the arc length of the shortest path between the male tail and either the head or the tail of the hermaphrodite along a section of the ellipse.
Left-right symmetric pairs of sensory neurons showed positively correlated activity ( r = 0.73 ± 0.19) ( Figure S1 C), with one exception – R1A. We considered each left-right correlated pair to represent a distinct neuronal type and compiled datasets to include the activity traces of 57 neuron types and one non-neuronal cell (int9R). We used 58 activity traces and eight continuous behavioral parameters for cross-correlation analyses. Pairwise cross-correlations between time series were calculated for each dataset, with the lag parameter set to 5 (corresponding to one second). For each pairwise comparison, we calculated mean cross-correlations at each time lag, and the highest absolute mean cross correlation value was included in the consensus cross-correlation matrix. This consensus correlation matrix was used to calculate pairwise Euclidian distances for hierarchical clustering with the Ward’s minimum variance method ( Ward, 1963 57. Ward, Jr., J.H. Hierarchical grouping to optimize an objective function J. Am. Stat. Assoc. 1963; 58 :236-244 Crossref Scopus (14681) Google Scholar ).
To test if neuron-neuron correlations were consistent across datasets, we selected correlation matrices for the eight comprehensive datasets and calculated pairwise Euclidean distances between them. The observed distances were compared to distances between 10,000 correlation matrices with shuffled neuronal identities ( Data S1 ).
We recorded discrete behavioral motifs. We manually tabulated the times of ventral contact of the male tail with the hermaphrodite, loss of contact with the hermaphrodite, contact with her vulva, turning onset (successful and unsuccessful, see above), and sperm release. To determine empirical uncertainties in our ability to timestamp these behavioral motifs, we independently tabulated all motifs twice for each comprehensive dataset. We calculated the difference between the two recorded timestamps for each individual behavioral motif. For each behavior, the median difference between the timestamps was 0.2 s or less ( Figure S7 E). For each event instance, we used the median timestamps for the consequent analyses. Additionally, swimming velocity and relative sliding velocity (continuous behavioral features) were used to timestamp transitions between forward and backward swimming and forward and backward sliding relative to the hermaphrodite.
We tested how neurons of the mating circuit responded to the start of specific behavioral motifs ( Figures 3 D and S3 ; Data S1 ). Motifs included were: ventral contact with the hermaphrodite (both the initial contact and any contact preceded by more than 6 s of separation); hermaphrodite loss lasting for more than 6 s; turning; failed turning attempts; vulva contact, sperm release (as identified by increased calcium signals in the intestinal cells); switching from forward to backward swimming (tabulated for the entire behavior, and separately for searching, and courtship); switching from backward to forward swimming (tabulated for the entire behavior, and separately for searching, and courtship). Switching from forward to backward sliding (movement of the tail relative to the hermaphrodite); switching from backward to forward sliding. Neuronal signals were extracted for a window spanning 6 s before and after the motif onset, and dataset-averaged response curves were calculated for each neuron and motif. We then calculated cross-correlations between these response curves and binarized behavioral event traces, with the lag parameter set to 5. The lag with the maximum absolute mean correlation was selected. One-sample t test was used to test if the correlation estimate between the neurons’ response traces at that lag and behaviors was greater than zero ( Figure S3 A). Neuron responses were categorized into significantly increasing, decreasing, and showing no changes. The fraction of neurons with unique activity patterns was calculated using different significance thresholds ( Figure S3 B). p-value s were adjusted using the Benjamini and Hochberg method to control for the false discovery rate (FDR) ( Benjamini and Hochberg, 1995 4. Benjamini, Y. ∙ Hochberg, Y. Controlling the false discovery rate: a practical and powerful approach to multiple testing J. R. Statist. Soc. B. 1995; 57 :289-300 Crossref Google Scholar ). Figure 3 D shows neurons with significant changes in activity with the FDR adjusted significance cut-off set at 0.05.
We tested if the neurons were activated in a sequence which was consistent across multiple instances of the same behavioral motif. We extracted neuronal activity traces for a widow spanning 6 s before and 15 s after the onset of a behavioral motif. For every motif onset, we selected traces showing event-triggered activation and we calculated the time for each neuron to reach its half-peak activity ( Data S1 ). To test if neuron A is consistently activated before neuron B , we generated a rank list for the pair by ranking the neurons by their half-peak times. We then calculated the rank product for neuron A as the geometric mean of its ranks: 𝑅 ⁢ 𝑃 𝐴 = ( ∏ 𝑘 𝑖 = 1 𝑟 𝐴 , 𝑖 ) 1 / 𝑘 , where k is the number of replicates. To test for significance, we generated 10,000 permutations of the rank list and calculated their rank products. We counted the number of times the rank products from these permuted rank lists were smaller or equal than the observed rank product for neuron A . This gave us the probability of neuron A reaching its half-peak activity before neuron B purely by chance.
To predict behavior from neuronal activity traces, we used linear regression with elasticnet regularization ( Friedman et al., 2010 13. Friedman, J. ∙ Hastie, T. ∙ Tibshirani, R. Regularization paths for generalized linear models via coordinate descent J. Stat. Softw. 2010; 33 :1-22 Crossref Scopus (10866) PubMed Google Scholar ). The procedure was adapted from Scholz et al. (2018) 44. Scholz, M. ∙ Linder, A.N. ∙ Randi, F. ... Predicting natural behavior from whole-brain neural dynamics bioRxiv. 2018; Crossref Scopus (32) Google Scholar with modifications ( Scholz et al., 2018 44. Scholz, M. ∙ Linder, A.N. ∙ Randi, F. ... Predicting natural behavior from whole-brain neural dynamics bioRxiv. 2018; Crossref Scopus (32) Google Scholar ). We sought predictions across different individuals. Activity traces of all neurons were centered and scaled to have a zero sample mean and unit sample variance, and concatenated for all datasets. We also concatenated time series of all behavioral features. Traces of several neurons were absent from some datasets. Missing traces were imputed if they were missing from no more than two datasets. Activity traces missing from more than two datasets were excluded. To instantiate short-term memory, we used time-lags in the neuronal activity traces. Three time lags were used ( t = 0, t = 0.6, and t = 1.2 s), that maximized the accuracy of predictions.
We partitioned concatenated time series into training and testing sets. For each modeling iteration, we selected seven datasets for training and one for testing the resulting model’s out-of-sample prediction accuracy. The analysis was repeated to include all possible combinations of training and testing data. Model training and evaluation was performed using the R package ‘Caret’ version 6.0-84 ( Kuhn et al., 2020 26. Kuhn, M. ∙ Wing, J. ∙ Weston, S. ... Package “caret.” 2020 https://github.com/topepo/caret/ Google Scholar ) and ‘glmnet’ version 2.0-18 ( Friedman et al., 2010 13. Friedman, J. ∙ Hastie, T. ∙ Tibshirani, R. Regularization paths for generalized linear models via coordinate descent J. Stat. Softw. 2010; 33 :1-22 Crossref Scopus (10866) PubMed Google Scholar , 2020 14. Friedman, J. ∙ Hastie, T. ∙ Tibshirani, R. ... Package “glmnet.” 2020 https://cran.r-project.org/web/packages/glmnet/index.html Google Scholar ). The algorithm fits a generalized linear model via penalized maximum likelihood. Tuning parameters included the penalty term λ, controlling the penalty strength, and the elastic-net mixing parameter α (where α = 0 is a purely ridge penalty and α = 1 is a purely lasso penalty). We tuned the model’s parameters by searching 11 α values ( α ∈ [0,1]) and 101 logarithmically-spaced λ values ( λ ∈ [10 − 5 ,10 1 ]). The best tuning parameters were selected based on the root mean square error and 5-fold cross-validation. The model’s prediction accuracy was estimated by calculating the R 2 between out-of-sample predictions and target variables. The mean R 2 values across eight iterations were used to access our ability to predict target behavioral features.
To further asses the accuracy of predictions we performed analyses where neuronal identities were shuffled for the held-out sets prior model testing. The accuracy of the models tested on the data with shuffled ids were compared to that of models with preserved neuronal identities.
To better understand contributions of individual neurons to specific behavioral features, we ranked neurons by their weight ( Table S4 ), which was calculated for all testing-training iterations i and time lags t : 𝑊 𝑖 ⁢ 𝑡 = 1 𝑁 𝑖 ⁢ 𝑁 𝑡 ⁢ ∑ 𝑖 , 𝑡 𝑤 𝑖 ⁢ 𝑡 , where N i is the number of model training-testing iterations, N t is the number of time lags used, and w it is the absolute value of the coefficients from the trained model.
To investigate how the representation of continuous behavioral features is distributed in the circuit we trained and evaluated additional models where we used (1) single neurons (including their time lags), (2) all neurons except one, (3) sequentially added neurons in the order of their rank, and (4) sequentially removed neurons in the order of their rank. To better understand how behavioral features are represented in different circuit levels, we built and evaluated models using subsets of sensory, inter-, and motor neurons (based on https://www.wormatlas.org/ , Table S2 ). We note that the circuit included similar numbers of sensory, inter-, and motor neurons (22, 15, and 25 respectively). Finally, we trained and evaluated models including 13 overlapping subsets of functionally-linked neurons derived by link-clustering ( Figures 3 C and S2 B; Data S1 ). Model performance was compared via t test to models trained on the full set of neurons and tested using held-out datasets with shuffled neuronal ids. This procedure was repeated 1000 times.
To compare correlation structure across behavioral states, we calculated neuron-neuron correlation matrices for each individual and mating state (searching, courtship, copulation, and resting) ( Figure S4 ; Data S1 ). For each behavioral state we calculated Euclidean distances between neuron-neuron correlation matrices corresponding to the same behavioral state. We compared these distances to distances between randomly selected matrices (i.e., matrices corresponding to any individual and state) using a t test. We also compared distances between neuron-neuron correlations grouped by dataset to distances between randomly selected matrices. Only groups with more than 2 matrices were included. These analyses were repeated using the correlation distance as a distance measure ( Table S5 ). This procedure was also used to compare correlations between neurons and continuous behavioral features (velocity, curvature, and spicules position) across behavioral states and datasets ( Table S5 ).
To project neuron-neuron and neuron-behavior correlation matrices in a 2-dimentional space ( Figure 3 L), we calculated the Euclidian distances between all pairs of correlation matrices and applied non-metric multidimensional scaling using Sammon’s non-linear mapping ( Sammon, 1969 40. Sammon, J.W. A nonlinear mapping for data structure analysis IEEE Trans. Comput. 1969; 100 :401-409 Crossref Scopus (2787) Google Scholar ).
As a measure of functional weight, we used consensus cross-correlations ( Figure 3 B). Both members of a left-right neuron pair were included in the analyses, and their activity was assumed to be perfectly correlated, except in the case of R1AL/R. As a measure of synaptic connectivity, we used the number of synapses between neurons from https://wormwiring.org / ( Jarrell et al., 2012 19. Jarrell, T.A. ∙ Wang, Y. ∙ Bloniarz, A.E. ... The connectome of a decision-making neural network Science. 2012; 337 :437-444 Crossref Scopus (321) PubMed Google Scholar ; Cook et al., 2019 10. Cook, S.J. ∙ Jarrell, T.A. ∙ Brittin, C.A. ... Whole-animal connectomes of both Caenorhabditis elegans sexes Nature. 2019; 571 :63-71 Crossref Scopus (386) PubMed Google Scholar ). Identifying connections between neurons, particularly gap junctions, can involve a degree of subjectivity ( Mulcahy et al., 2018 33. Mulcahy, B. ∙ Witvliet, D. ∙ Holmyard, D. ... A pipeline for volume electron microscopy of the Caenorhabditis elegans nervous system Front. Neural Circuits. 2018; 12 :94 Crossref Scopus (26) PubMed Google Scholar ), so we additionally validated gap junctions of the male tail by screening EM photographs of all annotated gap junctions in the N2Y male. We assigned a confidence score from 1 to 5 to each gap junction.
Synapses with confidence scores 3 and higher were used to compile a validated gap junction connectivity matrix. To minimize the effects of observational noise, we also symmetrized the connectivity for all neurons that are bilaterally symmetrical, except R1A. Only connections involving more than one synapse were used for all analyses.
To test if the results were sensitive to a particular choice of the connectivity hyperparameters, the analyses were performed using eight variants of connectivity matrices. These matrices were generated using (i) synapse number or weight as a measure of connectivity ( Jarrell et al., 2012 19. Jarrell, T.A. ∙ Wang, Y. ∙ Bloniarz, A.E. ... The connectome of a decision-making neural network Science. 2012; 337 :437-444 Crossref Scopus (321) PubMed Google Scholar ), (ii) validated or original gap junctions, (iii) symmetrized or original connectivity. The results of these analyses are summarized in Data S1 .
To test for the dependence of neuron-neuron correlations on synaptic connectivity, we calculated Pearson and partial correlation coefficients between the neuron-neuron correlations ( Figure 3 B) and the number of shared electrical and chemical synapses. We used the absolute value of neuron-neuron correlations for the chemical synapses. We tested for significance using 10,000 correlation matrices with shuffled neuronal ids.
To test if functional correlations can be predicted by common synaptic input, we calculated mean correlations between neurons that share a presynaptic partner. To reduce effects of observational and developmental noise, we only considered postsynaptic partners connected by more than one synapse. We also restricted our analysis to postsynaptic cells that receive at least 10% of their total synaptic input from a given presynaptic neuron. To test if the mean correlation between neurons that had a common presynaptic partner was significantly higher than by chance we used 10,000 permutations of the functional correlation matrix where neuronal ids were shuffled. Comparisons were performed using a shuffling procedure that preserved left-right functional symmetries. Absolute correlation values were used for the chemical synapses to account for different synaptic signs ( Data S1 ).
Community interaction motifs were identified as described in Betzel et al. (2018 5. Betzel, R.F. ∙ Bertolero, M.A. ∙ Bassett, D.S. Non-assortative community structure in resting and task-evoked functional brain networks bioRxiv. 2018; Crossref Scopus (0) Google Scholar ). For each pair of functional communities we calculated the density of synaptic connections within each community ( ingroup connectivity ) and between the two communities ( out-group connectivity ): 𝑑 𝑟 ⁢ 𝑟 = 1 𝑁 𝑟 ⁢ 𝑁 𝑟 ⁢ ∑ 𝑖 ∈ 𝑟 , 𝑗 ∈ 𝑟 𝐶 𝑖 ⁢ 𝑗 , 𝑑 𝑠 ⁢ 𝑠 = 1 𝑁 𝑠 ⁢ 𝑁 𝑠 ⁢ ∑ 𝑖 ∈ 𝑠 , 𝑗 ∈ 𝑠 𝐶 𝑖 ⁢ 𝑗 , 𝑑 𝑟 ⁢ 𝑠 = 1 𝑁 𝑟 ⁢ 𝑁 𝑠 ⁢ ∑ 𝑖 ∈ 𝑟 , 𝑗 ∈ 𝑠 𝐶 𝑖 ⁢ 𝑗 , where N r and N s are the number of neurons that belong to each community and C ij is the connectivity strength between two neurons measured either as synaptic count or size (see above). We then assigned one of the three community interaction types: assortative (when the in-group connectivity for each community is stronger than the out-group connectivity between them), disassortative (when the out-group connectivity between communities is stronger than each in-group connectivity) and core-periphery (when the in-group connectivity for only one of the two communities is stronger than the out-group connectivity between them): 𝑀 𝑟 ⁢ 𝑠 = ⎧ { ⎨ { ⎩ 𝑀 𝑎 , 𝑖 ⁢ 𝑓 ⁢ m i n ⁡ ( 𝑑 𝑟 ⁢ 𝑟 , 𝑑 𝑠 ⁢ 𝑠 ) > 𝑑 𝑟 ⁢ 𝑠 𝑀 𝑐 ⁢ 𝑝 , 𝑖 ⁢ 𝑓 ⁢ 𝑑 𝑟 ⁢ 𝑟 > 𝑑 𝑠 ⁢ 𝑠 > 𝑑 𝑟 ⁢ 𝑠 𝑀 𝑐 ⁢ 𝑝 , 𝑖 ⁢ 𝑓 ⁢ 𝑑 𝑠 ⁢ 𝑠 > 𝑑 𝑟 ⁢ 𝑠 > 𝑑 𝑟 ⁢ 𝑟 𝑀 𝑑 , 𝑖 ⁢ 𝑓 ⁢ 𝑑 𝑟 ⁢ 𝑠 > m a x ⁡ ( 𝑑 𝑟 ⁢ 𝑟 , 𝑑 𝑠 ⁢ 𝑠 ) . The community interaction motifs were calculated using multiple partitioning schemes obtained with link clustering and weighted stochastic block modeling (WSBM) (see below). All analyses were performed on eight different variants of the synaptic connectivity matrix ( Data S1 ).
We used link clustering to extract overlapping community structure ( Ahn et al., 2010 2. Ahn, Y.Y. ∙ Bagrow, J.P. ∙ Lehmann, S. Link communities reveal multiscale complexity in networks Nature. 2010; 466 :761-764 Crossref Scopus (1523) PubMed Google Scholar ). Link clustering was performed on functional correlations using an R package ‘linkcomm’ version 1.0-11 ( Kalinka and Tomancak, 2011 21. Kalinka, A.T. ∙ Tomancak, P. linkcomm: an R package for the generation, visualization, and analysis of link communities in networks of arbitrary size and type Bioinformatics. 2011; 27 :2011-2012 Crossref Scopus (99) PubMed Google Scholar ). Briefly, the similarity between links e ik and e jk that share a node k was calculated via the Jaccard coefficient: 𝑆 ⁡ ( 𝑒 𝑖 ⁢ 𝑘 , 𝑒 𝑗 ⁢ 𝑘 ) = | 𝑛 + ( 𝑖 ) ∩ 𝑛 + ( 𝑗 ) | | 𝑛 + ( 𝑖 ) ∪ 𝑛 + ( 𝑗 ) | , where n +( i ) is the first-order neighborhood of node i , including self. The pairwise similarity matrix was used to hierarchically cluster the links with single-linkage clustering, and the resulting dendrogram was cut at a point that maximizes the link density within the clusters ( Ahn et al., 2010 2. Ahn, Y.Y. ∙ Bagrow, J.P. ∙ Lehmann, S. Link communities reveal multiscale complexity in networks Nature. 2010; 466 :761-764 Crossref Scopus (1523) PubMed Google Scholar ; Kalinka and Tomancak, 2011 21. Kalinka, A.T. ∙ Tomancak, P. linkcomm: an R package for the generation, visualization, and analysis of link communities in networks of arbitrary size and type Bioinformatics. 2011; 27 :2011-2012 Crossref Scopus (99) PubMed Google Scholar ). To calculate link similarities, correlations higher than 0.3 were selected from the consensus cross-correlation matrix ( Figure 3 B); left-right pairs of laterally symmetrical neurons were included. Only non-trivial community clusters with more than two edges were included. To explore community structure at different hierarchical levels, identified link communities were clustered themselves with the Ward’s minimum variance method ( Ward, 1963 57. Ward, Jr., J.H. Hierarchical grouping to optimize an objective function J. Am. Stat. Assoc. 1963; 58 :236-244 Crossref Scopus (14681) Google Scholar ). For this, community similarity was calculated using the Jaccard coefficient and the number of shared nodes between communities i and j : 𝑆 ⁡ ( 𝑖 , 𝑗 ) = | 𝑛 𝑖 ∩ 𝑛 𝑗 | | 𝑛 𝑖 ∪ 𝑛 𝑗 | . The resulting dendrogram was cut at different points with the cut-off parameter ranging from 0.5 to 1 and the step size of 0.05. This resulted in ten partitioning schemes with 7 to 19 overlapping communities. The network could not be partitioned into fewer than 7 overlapping communities without some communities being nested. For visualization, the network layout was generated using lgl, a force-based layout for large graphs ( Adai et al., 2004 1. Adai, A.T. ∙ Date, S.V. ∙ Wieland, S. ... LGL: creating a map of protein function with an algorithm for visualizing very large biological networks J. Mol. Biol. 2004; 340 :179-190 Crossref Scopus (178) PubMed Google Scholar ). Synaptic connectivity density between and within communities was computed using the number or size of chemical and electrical synaptic connections (see above) ( Data S1 ).
To confirm results obtained with link clustering we additionally partitioned the mating circuit into hierarchically clustered functional communities with weighted stochastic block model (WSBM) ( Aicher et al., 2015 3. Aicher, C. ∙ Jacobs, A.Z. ∙ Clauset, A. Learning latent block structure in weighted networks J. Complex Netw. 2015; 3 :221-248 Crossref Scopus (183) Google Scholar ). WSBM was fitted with the number of communities varied from 2 to 20 and 1000 random initializations. This resulted in 19 different partitioning schemes. For each partitioning scheme, groups containing more than 2 neurons were selected, and the community interaction motifs (assortative, disassortative, core-periphery) were assigned as described above ( Data S1 ).
Interactive web-based browser with brain volumes, neuronal ids, activity traces, and behavioral features: http://mating-data.worm.world/index.html .

Section: Acknowledgments

We thank Alkmini Chalofti and Noah Milstein for help with neuronal tracking, Albert Lin for creating hpEx3931, Oliver Hobert for sharing strains, and Scott Emmons for sharing EM photographs of the male nervous system. We thank Scott Linderman, Paul Sternberg, Kenneth Blum, and members of the Samuel lab for their comments on the manuscript. Some strains were provided by the CGC, which is funded by NIH Office of Research Infrastructure Programs (P40 OD010440). This work was supported by NSF (IOS-1452593), NIH (R01 NS082525, R01 NS113119, and UF1 NS111697), Canadian Institutes of Health Research (Foundation Scheme 154274), Natural Sciences and Engineering Research Council of Canada (RGPIN-2017-06738), and the Burroughs Wellcome Fund.
V.S., V.V., M.Z., and A.D.T.S. conceived the project. V.V. and B.J.G. built the microscopy setup. V.S. and V.V. performed the experiments. W.H., M.W., and M.Z. created essential reagents. V.S., V.V., D.W., J.E.W., and C.F.P. collected the data. V.S., V.V., and D.W. analyzed the data. V.S. and A.D.T.S. wrote the manuscript with guidance from V.V., M.Z., and D.W.
The authors declare no competing interests.

Section: Supplemental information (2)

Download all PDF (184.11 KB) Document S1. Tables S1–S6 PDF (14.66 MB) Data S1. Extended figures and tables, related to Figures 2, 3, 4, 5, and 6
