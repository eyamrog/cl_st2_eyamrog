Title: A transcriptional rheostat couples past activity to future sensory responses


Abstract: Summary

Animals traversing different environments encounter both stable background stimuli and novel cues, which are thought to be detected by primary sensory neurons and then distinguished by downstream brain circuits. Here, we show that each of the ∼1,000 olfactory sensory neuron (OSN) subtypes in the mouse harbors a distinct transcriptome whose content is precisely determined by interactions between its odorant receptor and the environment. This transcriptional variation is systematically organized to support sensory adaptation: expression levels of more than 70 genes relevant to transforming odors into spikes continuously vary across OSN subtypes, dynamically adjust to new environments over hours, and accurately predict acute OSN-specific odor responses. The sensory periphery therefore separates salient signals from predictable background via a transcriptional rheostat whose moment-to-moment state reflects the past and constrains the future; these findings suggest a general model in which structured transcriptional variation within a cell type reflects individual experience.

Section: Introduction

Sensory adaptation allows neurons and networks to minimize responses to background stimuli, thereby building more efficient neural codes that emphasize surprising or novel information ( Attneave, 1954 3. Attneave, F. Some informational aspects of visual perception Psychol. Rev. 1954; 61 :183-193 Crossref Scopus (1752) PubMed Google Scholar ; Barlow, 1961 5. Barlow, H. Possible principles underlying the transformation of sensory messages Rosenblith, W.A. (Editor) Sensory Communication MIT press, 1961; 217-234 Google Scholar ; Benda, 2021 6. Benda, J. Neural adaptation Curr. Biol. 2021; 31 :R110-R116 Full Text Full Text (PDF) Scopus (0) PubMed Google Scholar ; Weber et al., 2019 106. Weber, A.I. ∙ Krishnamurthy, K. ∙ Fairhall, A.L. Coding principles in adaptation Annu. Rev. Vis. Sci. 2019; 5 :427-449 Crossref Scopus (18) PubMed Google Scholar ). Rapid (milliseconds to seconds) sensory adaptation via post-translational mechanisms occurs in most sensory neurons, and it plays an important role in shaping peripheral responses to highly dynamic stimuli ( Kostal et al., 2008 51. Kostal, L. ∙ Lansky, P. ∙ Rospars, J.-P. Efficient olfactory coding in the pheromone receptor neuron of a moth PLoS Comput. Biol. 2008; 4 :e1000053 Crossref Scopus (29) PubMed Google Scholar ; Martelli and Storace, 2021 62. Martelli, C. ∙ Storace, D.A. Stimulus driven functional transformations in the early olfactory system Front. Cell. Neurosci. 2021; 15 :684742 Crossref Scopus (0) PubMed Google Scholar ; Moore, 1994 69. Moore, P.A. A model of the role of adaptation and disadaptation in olfactory receptor neurons: Implications for the coding of temporal and intensity patterns in odor signals Chem. Senses. 1994; 19 :71-86 Crossref Scopus (42) PubMed Google Scholar ). However, it is not clear how sensory neurons adapt at the longer timescales over which animals traverse different environments—and therefore encounter different background stimuli—as is common during a typical circadian cycle.
Activity-dependent transcription evolves over minutes to hours and therefore in principle could support longer-term adaptation ( Yap and Greenberg, 2018 118. Yap, E.-L. ∙ Greenberg, M.E. Activity-regulated transcription: Bridging the gap between neural activity and behavior Neuron. 2018; 100 :330-348 Full Text Full Text (PDF) Scopus (137) PubMed Google Scholar ). For example, mature brain neurons are thought to use the regulated transcription of synaptic proteins and ion channels to homeostatically maintain their firing rates within a narrow target range ( Davis, 2006 21. Davis, G.W. Homeostatic control of neural activity: From phenomenology to molecular design Annu. Rev. Neurosci. 2006; 29 :307-323 Crossref Scopus (400) PubMed Google Scholar , 2013 22. Davis, G.W. Homeostatic signaling and the stabilization of neural function Neuron. 2013; 80 :718-728 Full Text Full Text (PDF) Scopus (165) PubMed Google Scholar ; Marder, 2011 60. Marder, E. Variability, compensation, and modulation in neurons and circuits Proc. Natl. Acad. Sci. USA. 2011; 108 :15542-15548 Crossref Scopus (197) PubMed Google Scholar ; Marder and Goaillard, 2006 61. Marder, E. ∙ Goaillard, J.-M. Variability, compensation and homeostasis in neuron and network function Nat. Rev. Neurosci. 2006; 7 :563-574 Crossref Scopus (723) PubMed Google Scholar ; Turrigiano, 2011 96. Turrigiano, G. Too many cooks? Intrinsic and synaptic homeostatic mechanisms in cortical circuit refinement Annu. Rev. Neurosci. 2011; 34 :89-103 Crossref Scopus (425) PubMed Google Scholar ; Turrigiano, 1999 94. Turrigiano, G.G. Homeostatic plasticity in neuronal networks: The more things change, the more they stay the same Trends Neurosci. 1999; 22 :221-227 Full Text Full Text (PDF) Scopus (585) PubMed Google Scholar ; Turrigiano, 2017 97. Turrigiano, G.G. The dialectic of Hebb and homeostasis Philos. Trans. R. Soc. Lond. B Biol. Sci. 2017; 372 :20160258 Crossref Scopus (97) PubMed Google Scholar ). If similar transcriptional mechanisms underlie adaptation in the periphery, then sensory neurons of a given type would be expected to occupy a range of transcriptional states, with the specific state adopted by any given neuron both reflecting its prior activity history and predicting its future responses to sensory inputs ( Tyssowski and Gray, 2019 98. Tyssowski, K.M. ∙ Gray, J.M. The neuronal stimulation-transcription coupling map Curr. Opin. Neurobiol. 2019; 59 :87-94 Crossref Scopus (7) PubMed Google Scholar ). However, the relationship between activity-dependent gene regulation and functional adaptation remains elusive, in part because it has not yet been shown in either peripheral or central neurons that analog changes in activity yield proportional, bidirectional, and systematic changes in the expression of genes that tune neural function ( Davis, 2013 22. Davis, G.W. Homeostatic signaling and the stabilization of neural function Neuron. 2013; 80 :718-728 Full Text Full Text (PDF) Scopus (165) PubMed Google Scholar ).
There are ∼1,000 different olfactory sensory neuron (OSN) subtypes in the mouse, each of which can be identified across individuals based upon its expression of a single odorant receptor (OR) ( Monahan and Lomvardas, 2015 67. Monahan, K. ∙ Lomvardas, S. Monoallelic expression of olfactory receptors Annu. Rev. Cell Dev. Biol. 2015; 31 :721-740 Crossref Scopus (71) PubMed Google Scholar ). ORs are G protein-coupled receptors that transduce odor binding into an influx of calcium, which leads to action potentials. The expressed OR endows each OSN with a specific level of neural activity that depends on the odors present within a given environment. Although post-translational mechanisms sculpt OSN responses to rapidly fluctuating odor plumes, at longer timescales it is thought that OSNs faithfully report odor-receptor interactions to the brain. For example, OSN responses to odors (as assessed by functional imaging of OSN axons in the olfactory bulb, the first waystation for odor information in the brain) appear similar in individual mice tested at different times, across different mice, and in mice before and after training to associate a test odorant with a reward ( Bozza et al., 2004 9. Bozza, T. ∙ McGann, J.P. ∙ Mombaerts, P. ... In vivo imaging of neuronal activity by targeted expression of a genetically encoded probe in the mouse Neuron. 2004; 42 :9-21 Full Text Full Text (PDF) Scopus (265) PubMed Google Scholar ; Chu et al., 2017 17. Chu, M.W. ∙ Li, W.L. ∙ Komiyama, T. Lack of pattern separation in sensory inputs to the olfactory bulb during perceptual learning eNeuro. 2017; 4 ENEURO.0287-17.2017 Crossref Scopus (6) PubMed Google Scholar ; Kato et al., 2012 47. Kato, H.K. ∙ Chu, M.W. ∙ Isaacson, J.S. ... Dynamic sensory representations in the olfactory bulb: Modulation by wakefulness and experience Neuron. 2012; 76 :962-975 Full Text Full Text (PDF) Scopus (150) PubMed Google Scholar ; Rubin and Katz, 1999 81. Rubin, B.D. ∙ Katz, L.C. Optical imaging of odorant representations in the mammalian olfactory bulb Neuron. 1999; 23 :499-511 Full Text Full Text (PDF) Scopus (536) PubMed Google Scholar ; Soucy et al., 2009 87. Soucy, E.R. ∙ Albeanu, D.F. ∙ Fantana, A.L. ... Precision and diversity in an odor map on the olfactory bulb Nat. Neurosci. 2009; 12 :210-220 Crossref Scopus (217) PubMed Google Scholar ; Spors and Grinvald, 2002 88. Spors, H. ∙ Grinvald, A. Spatio-temporal dynamics of odor representations in the mammalian olfactory bulb Neuron. 2002; 34 :301-315 Full Text Full Text (PDF) Scopus (262) PubMed Google Scholar ; Wachowiak and Cohen, 2001 101. Wachowiak, M. ∙ Cohen, L.B. Representation of odorants by receptor neuron input to the mouse olfactory bulb Neuron. 2001; 32 :723-735 Full Text Full Text (PDF) Scopus (370) PubMed Google Scholar ). In contrast, olfactory bulb and cortical neurons adapt to the repeated presentation of an odor on timescales of minutes ( Best et al., 2005 7. Best, A.R. ∙ Thompson, J.V. ∙ Fletcher, M.L. ... Cortical metabotropic glutamate receptors contribute to habituation of a simple odor-evoked behavior J. Neurosci. 2005; 25 :2513-2517 Crossref Scopus (48) PubMed Google Scholar ; Cleland and Linster, 2005 18. Cleland, T.A. ∙ Linster, C. Computation in the olfactory system Chem. Senses. 2005; 30 :801-813 Crossref Scopus (101) PubMed Google Scholar ; McNamara et al., 2008 65. McNamara, A.M. ∙ Magidson, P.D. ∙ Linster, C. ... Distinct neural mechanisms mediate olfactory memory formation at different timescales Learn. Mem. 2008; 15 :117-125 Crossref Scopus (0) PubMed Google Scholar ; Wilson, 1998 109. Wilson, D.A. Habituation of odor responses in the rat anterior piriform cortex J. Neurophysiol. 1998; 79 :1425-1440 Crossref Scopus (181) PubMed Google Scholar ; Wilson, 2000 110. Wilson, D.A. Comparison of odor receptive field plasticity in the rat olfactory bulb and anterior piriform cortex J. Neurophysiol. 2000; 84 :3036-3042 Crossref PubMed Google Scholar ; Yadon and Wilson, 2005 117. Yadon, C.A. ∙ Wilson, D.A. The role of metabotropic glutamate receptors and cortical adaptation in habituation of odor-guided behavior Learn. Mem. 2005; 12 :601-605 Crossref Scopus (0) PubMed Google Scholar ). These findings suggest that ORs confer stable odor response properties upon OSNs, while the brain separates salient odors from background; this idea has pervasively influenced theoretical and computational models of odor coding ( Brann and Datta, 2020 11. Brann, D.H. ∙ Datta, S.R. Finding the brain in the nose Annu. Rev. Neurosci. 2020; 43 :277-295 Crossref Scopus (3) PubMed Google Scholar ; Chong et al., 2020 16. Chong, E. ∙ Moroni, M. ∙ Wilson, C. ... Manipulating synthetic optogenetic odors reveals the coding logic of olfactory perception Science. 2020; 368 :eaba2357 Crossref Scopus (17) PubMed Google Scholar ; Grabska-Barwińska et al., 2017 35. Grabska-Barwińska, A. ∙ Barthelmé, S. ∙ Beck, J. ... A probabilistic approach to demixing odors Nat. Neurosci. 2017; 20 :98-106 Crossref PubMed Google Scholar ; Hopfield, 1991 38. Hopfield, J.J. Olfactory computation and object perception Proc. Natl. Acad. Sci. USA. 1991; 88 :6462-6466 Crossref Scopus (93) PubMed Google Scholar ; Litwin-Kumar et al., 2017 58. Litwin-Kumar, A. ∙ Harris, K.D. ∙ Axel, R. ... Optimal degrees of synaptic connectivity Neuron. 2017; 93 :1153-1164.e7 Full Text Full Text (PDF) Scopus (97) PubMed Google Scholar ; Schaffer et al., 2018 84. Schaffer, E.S. ∙ Stettler, D.D. ∙ Kato, D. ... Odor perception on the two sides of the brain: Consistency despite randomness Neuron. 2018; 98 :736-742.e3 Full Text Full Text (PDF) Scopus (21) PubMed Google Scholar ; Teşileanu et al., 2019 92. Teşileanu, T. ∙ Cocco, S. ∙ Monasson, R. ... Adaptation of olfactory receptor abundances for efficient coding eLife. 2019; 8 :308 Crossref Scopus (8) Google Scholar ; Wilson et al., 2017 112. Wilson, C.D. ∙ Serrano, G.O. ∙ Koulakov, A.A. ... A primacy code for odor identity Nat. Commun. 2017; 8 :1477 Crossref Scopus (56) PubMed Google Scholar ; Zwicker et al., 2016 122. Zwicker, D. ∙ Murugan, A. ∙ Brenner, M.P. Receptor arrays optimized for natural odor statistics Proc. Natl. Acad. Sci. USA. 2016; 113 :5570-5575 Crossref Scopus (0) PubMed Google Scholar ).
Consistent with this view, transcriptional analyses suggest that the genes expressed by mature OSNs are largely similar across subtypes, with the exception of the ORs themselves, a handful of genes related to dorsoventral position in the olfactory epithelium, and ∼10 axon guidance genes that enable glomerular targeting in the olfactory bulb ( Fletcher et al., 2017 31. Fletcher, R.B. ∙ Das, D. ∙ Gadye, L. ... Deconstructing olfactory stem cell trajectories at single-cell resolution Cell Stem Cell. 2017; 20 :817-830.e8 Full Text Full Text (PDF) Scopus (84) PubMed Google Scholar ; Hanchate et al., 2015 37. Hanchate, N.K. ∙ Kondoh, K. ∙ Lu, Z. ... Single-cell transcriptomics reveals receptor transformations during olfactory neurogenesis Science. 2015; 350 :1251-1255 Crossref Scopus (116) PubMed Google Scholar ; Mori and Sakano, 2011 70. Mori, K. ∙ Sakano, H. How is the olfactory map formed and interpreted in the mammalian brain? Annu. Rev. Neurosci. 2011; 34 :467-499 Crossref Scopus (227) PubMed Google Scholar ; Nakashima et al., 2013 72. Nakashima, A. ∙ Takeuchi, H. ∙ Imai, T. ... Agonist-independent GPCR activity regulates anterior-posterior targeting of olfactory sensory neurons Cell. 2013; 154 :1314-1325 Full Text Full Text (PDF) Scopus (92) PubMed Google Scholar ; Scholz et al., 2016 85. Scholz, P. ∙ Kalbe, B. ∙ Jansen, F. ... Transcriptome analysis of murine olfactory sensory neurons during development using single cell RNA-seq Chem. Senses. 2016; 41 :313-323 Crossref Scopus (25) PubMed Google Scholar ; Vihani et al., 2020 99. Vihani, A. ∙ Hu, X.S. ∙ Gundala, S. ... Semiochemical responsive olfactory sensory neurons are sexually dimorphic and plastic eLife. 2020; 9 :e54501 Crossref Scopus (4) PubMed Google Scholar ; Wu et al., 2018 115. Wu, Y. ∙ Ma, L. ∙ Duyck, K. ... A population of navigator neurons is essential for olfactory map formation during the critical period Neuron. 2018; 100 :1066-1082.e6 Full Text Full Text (PDF) Scopus (9) PubMed Google Scholar ). This homogeneity suggests that individual OSN subtypes, which vary widely in their level of activity within a given environment, do not adapt their odor responses by actively modulating gene expression. In contrast, bulk RNA and activity measurements that pool across all OSNs in mice have hinted that OSNs may use transcription to compensate for the chronic absence or presence of activity, although results and interpretations have varied across experiments ( Barber and Coppola, 2015 4. Barber, C.N. ∙ Coppola, D.M. Compensatory plasticity in the olfactory epithelium: Age, timing, and reversibility J. Neurophysiol. 2015; 114 :2023-2032 Crossref Scopus (4) PubMed Google Scholar ; Cadiou et al., 2014 14. Cadiou, H. ∙ Aoudé, I. ∙ Tazir, B. ... Postnatal odorant exposure induces peripheral olfactory plasticity at the cellular level J. Neurosci. 2014; 34 :4857-4870 Crossref Scopus (43) PubMed Google Scholar ; Coppola and Waggener, 2012 19. Coppola, D.M. ∙ Waggener, C.T. The effects of unilateral naris occlusion on gene expression profiles in mouse olfactory mucosa J. Mol. Neurosci. 2012; 47 :604-618 Crossref Scopus (25) PubMed Google Scholar ; Coppola et al., 2006 20. Coppola, D.M. ∙ Waguespack, A.M. ∙ Reems, M.R. ... Naris occlusion alters transductory protein immunoreactivity in olfactory epithelium Histol. Histopathol. 2006; 21 :487-501 PubMed Google Scholar ; Fischl et al., 2014 29. Fischl, A.M. ∙ Heron, P.M. ∙ Stromberg, A.J. ... Activity-dependent genes in mouse olfactory sensory neurons Chem. Senses. 2014; 39 :439-449 Crossref Scopus (13) PubMed Google Scholar ; Fitzwater and Coppola, 2021 30. Fitzwater, E. ∙ Coppola, D.M. Olfactory deprivation and enrichment: An identity of opposites? Chem. Senses. 2021; 46 :bjaa071 Crossref Scopus (1) PubMed Google Scholar ; Hagendorf et al., 2009 36. Hagendorf, S. ∙ Fluegge, D. ∙ Engelhardt, C. ... Homeostatic control of sensory output in basal vomeronasal neurons: activity-dependent expression of ether-à-go-go-related gene potassium channels J. Neurosci. 2009; 29 :206-221 Crossref Scopus (24) PubMed Google Scholar ; Kass et al., 2013 46. Kass, M.D. ∙ Pottackal, J. ∙ Turkel, D.J. ... Changes in the neural representation of odorants after olfactory deprivation in the adult mouse olfactory bulb Chem. Senses. 2013; 38 :77-89 Crossref Scopus (12) PubMed Google Scholar ; Waggener and Coppola, 2007 102. Waggener, C.T. ∙ Coppola, D.M. Naris occlusion alters the electro-olfactogram: Evidence for compensatory plasticity in the olfactory system Neurosci. Lett. 2007; 427 :112-116 Crossref Scopus (27) PubMed Google Scholar ; Wang et al., 1993 103. Wang, H.W. ∙ Wysocki, C.J. ∙ Gold, G.H. Induction of olfactory receptor sensitivity in mice Science. 1993; 260 :998-1000 Crossref Scopus (154) PubMed Google Scholar ; Wang et al., 2017 104. Wang, Q. ∙ Titlow, W.B. ∙ McClintock, D.A. ... Activity-dependent gene expression in the mammalian olfactory epithelium Chem. Senses. 2017; 42 :611-624 Crossref Scopus (7) PubMed Google Scholar ). Resolving these discrepancies—and ultimately testing the hypothesis that dynamic gene expression mediates long-term adaptation in sensory neurons—requires asking how odor-evoked activity influences gene expression within particular OSN subtypes; this level of specificity is essential to clarify whether OSN transcriptomes change in an OR- and environment-specific manner; whether these changes are limited to small numbers of genes (as appears to be the case in C. elegans [ Cho et al., 2016 15. Cho, C.E. ∙ Brueggemann, C. ∙ L’Etoile, N.D. ... Parallel encoding of sensory history and behavioral preference during Caenorhabditis elegans olfactory learning eLife. 2016; 5 :e14000 Crossref Scopus (26) PubMed Google Scholar ; Juang et al., 2013 43. Juang, B.-T. ∙ Gu, C. ∙ Starnes, L. ... Endogenous nuclear RNAi mediates behavioral adaptation to odor Cell. 2013; 154 :1010-1022 Full Text Full Text (PDF) Scopus (53) PubMed Google Scholar ; L’Etoile et al., 2002 53. L’Etoile, N.D. ∙ Coburn, C.M. ∙ Eastham, J. ... The cyclic GMP-dependent protein kinase EGL-4 regulates olfactory adaptation in C. elegans Neuron. 2002; 36 :1079-1089 Full Text Full Text (PDF) Scopus (144) PubMed Google Scholar ]) or organized into a systematic program of gene expression; and whether environment-dependent transcriptional changes actually adapt OR-specific odor responses.
To address these questions we characterized, via single-cell RNA sequencing (scRNA-seq), transcriptional variation across the extraordinarily large array of identifiable OSN subtypes. Our experiments reveal that each OSN subtype expresses a distinguishable set of transcripts that is stereotyped across mice within a given environment. The main axis of transcriptional variability includes more than 70 functionally relevant genes that adaptively attenuate or amplify the transformation of odors into spikes. Furthermore, the expression of these genes varies in a continuous and coordinated manner across OSN subtypes, is modulated by specific interactions between ORs and the environment, and predicts OSN responses to new odors. Transcriptional variation among OSNs is therefore systematically organized through a rheostat-like mechanism (akin to a balance control on a stereo) whose setting in each OSN is defined by OR-environment interactions. Our findings suggest that the olfactory system uses this transcriptional rheostat to proportionally and bidirectionally adapt to persistent background odors—thereby enabling OSNs to engage in a form of sensory predictive coding—before odor information is transmitted to neural circuits responsible for perception. These data reveal that peripheral odor codes are flexible rather than fixed and support a broad model in which neurons continuously individualize their transcriptomes to facilitate functional adaptation.

Section: Results

To assess relationships between transcription and function in the peripheral olfactory system we performed scRNA-seq on ∼770,000 mature mouse OSNs ( Table S1 ). Our initial analysis focused on ∼40,000 mature OSNs derived from adult mice housed in a typical home cage environment; collectively, these OSNs expressed more than 1,000 ORs, with nearly every mature neuron expressing only one OR ( Figures 1 A and S1 A–S1D). Uniform manifold approximation and projection (UMAP) embeddings of ∼1,350 highly variable genes (HVGs, here and in all analyses excluding the OR genes themselves, see STAR Methods ) revealed that OSNs are partitioned into several broad subtypes related to positional identity and the expression of the lipid receptor CD36 ( Figure 1 B).
Given the few known transcriptional differences among mature OSNs, we expected that OR-defined OSN subpopulations would overlap in UMAP space; instead, OSNs expressing each OR were locally clustered and separated from those expressing different ORs, suggesting that each OSN subtype is transcriptionally unique ( Figures 1 C and S1 E). For example, the transcriptomes of OSNs expressing Olfr727 were self-similar and distinct from OSNs expressing Olfr728 and Olfr729 ( Figure 1 D). The transcriptomes of all OR-identified OSN subtypes were distinguishable, regardless of how transcriptome distances were computed or the frequency with which each OR was expressed ( Figures 1 D and S1 F–S1I). Linear classifiers distinguished OSNs expressing different ORs with near-perfect accuracy, and predicted the specific expressed OR (of the 831 queried) with >50% accuracy (versus 0.1% at chance) ( Figures 1 E, 1F, and S1 J). Approximately 1,000 HVGs were required for maximum classification accuracy, although individual genes contributed marginally to overall performance ( Figures S1 K and S1L). Importantly, classifiers accurately predicted the identity of the expressed OR in OSNs derived from held-out mice, indicating that OR-transcriptome relationships generalize across individuals housed in a similar environment ( Figure 1 G).
The unexpectedly close relationship between OR expression and OSN transcriptomes could result from shared regulatory mechanisms, or from each OR determining its associated transcriptome. To distinguish these possibilities, we performed scRNA-seq in mice with swapped coding regions for the M72 ( Olfr160 ) and S50 ( Olfr545 ) receptor genes ( Figure 1 H). OSNs expressing the M72 receptor from the S50 gene locus aligned with wild-type M72 OSNs; likewise, OSNs expressing S50 from the M72 gene locus resembled wild-type S50 OSNs ( Figures 1 I and 1J). The unique gene expression signature associated with each OSN is therefore largely specified by the expressed OR protein.
OSNs express a limited number of transcription factors and axon guidance genes in an OR-dependent manner during development ( Mori and Sakano, 2011 70. Mori, K. ∙ Sakano, H. How is the olfactory map formed and interpreted in the mammalian brain? Annu. Rev. Neurosci. 2011; 34 :467-499 Crossref Scopus (227) PubMed Google Scholar ; Parrilla et al., 2016 78. Parrilla, M. ∙ Chang, I. ∙ Degl’Innocenti, A. ... Expression of homeobox genes in the mouse olfactory epithelium J. Comp. Neurol. 2016; 524 :2713-2739 Crossref Scopus (7) PubMed Google Scholar ). However, genes from these categories were neither required for accurate OR predictions nor were they as predictive as either the complete set or the most predictive subset of HVGs ( Figure S1 M). Each OSN can also be categorized by the expression of CD36, the specific class of its expressed OR (class I versus class II), or the dorsal or ventral location of its associated glomeruli in the olfactory bulb; classifiers accurately distinguished ORs from OSNs within or between each of these categories ( Figures S1 N and S1O). Furthermore, classifiers distinguished OSNs independently of the genomic or phylogenetic relationships between ORs ( Figures S1 P and S1Q). Therefore, known differences relating to OSN identity or genomic/phylogenetic features of ORs do not explain the transcriptional diversity of mature OSNs.
Alternatively, the diversity in OSN transcriptomes might reflect OR-associated differences in neural activity. To test this possibility, we performed consensus non-negative matrix factorization (cNMF), which decomposes gene expression patterns observed across OSNs into sets of co-expressed genes called gene expression programs (GEPs) ( Figure 2 A, see STAR Methods ); importantly, cNMF successfully identified both identity-associated and activity-related GEPs in a prior study ( Kotliar et al., 2019 52. Kotliar, D. ∙ Veres, A. ∙ Nagy, M.A. ... Identifying gene expression programs of cell-type identity and cellular activity with single-cell RNA-seq eLife. 2019; 8 :e43803 Crossref Scopus (43) PubMed Google Scholar ). cNMF identified 10 GEPs—each composed of 100s of largely non-overlapping genes—that effectively captured OR-driven transcriptional variability, that varied in usage across OSNs in an OR-specific manner, and that accurately predicted the expressed OR in each OSN ( Figures 2 B and S2 A–S2D).
Of the 10 identified GEPs, we focused on the 7 whose constituent genes suggested putative functions ( Figure S2 E). Five GEPs encoded known aspects of OSN identity (dorsal, ventral, anterior, posterior, and CD36 positivity, Figures S2 B and S2F–S2H; Table S2 ). The other two GEPs, which we refer to as GEP High and GEP Low , included genes associated with neural activity in OSNs: GEP High included genes downregulated by chronic sensory deprivation (e.g., S100a5 , Pcp4l1 , and Kirrel2 ) while GEP Low included genes upregulated after chronic sensory deprivation (e.g., Calb2 , Kirrel3 , and Ppp3ca ) ( Fischl et al., 2014 29. Fischl, A.M. ∙ Heron, P.M. ∙ Stromberg, A.J. ... Activity-dependent genes in mouse olfactory sensory neurons Chem. Senses. 2014; 39 :439-449 Crossref Scopus (13) PubMed Google Scholar ; Wang et al., 2017 104. Wang, Q. ∙ Titlow, W.B. ∙ McClintock, D.A. ... Activity-dependent gene expression in the mammalian olfactory epithelium Chem. Senses. 2017; 42 :611-624 Crossref Scopus (7) PubMed Google Scholar ). Each OSN primarily used either GEP Low or GEP High , and the usage of each GEP varied continuously across OSN subtypes ( Figures 2 C and S2 B).
We hypothesized that persistent interactions between each OR and the wide variety of odors in a given environment (such as the food, bedding, and semiochemical odors present in a typical home cage) might explain the continuous variation of GEP High or GEP Low across OSN subtypes. To explore this idea, we developed a metric (simply the difference between GEP High and GEP Low ) that we provisionally refer to as the environmental state (ES) score ( Figure 2 D). ES scores for OSNs derived from mice housed in the home cage varied continuously across OSN subtypes; however, OSN subtype-specific ES scores were remarkably consistent across mice and enabled accurate predictions of OR identity ( Figures 2 E–2H). Both ES scores and GEP High and GEP Low usages aligned with the first principal component of the OSN transcriptomes ( Figures S2 I and S2J). GEP High and GEP Low genes were not expressed in immature OSNs but their expression increased and diversified after the onset of OR expression ( Figures S2 K and S2L).
Consistent with the hypothesis that GEP High and GEP Low genes, and thus ES scores, are sensitive to the chronic activity state of each OSN, artificially lowering (via nares occlusion for a month) or raising (via pulsed optogenetic stimulation for 12 h) OSN activity systematically decreased or increased ES scores, respectively ( Figures 3 A–3H and S3 A–S3E). To address whether OSN ES scores are sensitive to chronic activity levels under more physiological conditions, we compared OSN gene expression between mice housed in either a regular home cage or in two distinct naturalistic odor environments ( Figure 3 I). ES scores shifted significantly and bidirectionally in ∼45% of OSN subtypes across environments, consistent with specific odor environments differentially ligating or disengaging distinct ORs ( Figures 3 J–3N and S3 F–S3H).
Three additional lines of evidence argue that ES scores reflect specific interactions between each OR and each environment. First, occlusion-dependent changes in ES scores for each OR-defined OSN subtype were negatively correlated with the ES score in the open nostril ( Figure 3 O). ES scores after occlusion were sufficiently diverse to enable accurate predictions of OR identity; this diversity might reflect a variety of OR-specific spontaneous activity patterns ( Figures 3 P and S3 I–S3K). Second, after switching environments, ES scores for each OSN subtype were consistent across mice and accurately predicted the specific environment in which each mouse was housed ( Figures 3 Q, S3 L, and S3M). Finally, OSN subtypes whose ES scores increased across odor environments tended to have relatively low initial ES scores, and conversely those that fell tended to have relatively high initial ES scores ( Figure 3 R).
We ruled out several alternative explanations for environment-dependent changes in OSN ES scores. Odor-dependent modulation in OR expression levels or β-Arrestin2-mediated OR endocytosis could, in principle, influence ES scores ( Ibarra-Soria et al., 2017 40. Ibarra-Soria, X. ∙ Nakahara, T.S. ∙ Lilue, J. ... Variation in olfactory neuron repertoires is genetically controlled and environmentally modulated eLife. 2017; 6 :1083 Crossref Scopus (38) Google Scholar ; Mashukova et al., 2006 63. Mashukova, A. ∙ Spehr, M. ∙ Hatt, H. ... β-arrestin2-mediated internalization of mammalian odorant receptors J. Neurosci. 2006; 26 :9902-9912 Crossref Scopus (0) PubMed Google Scholar ; von der Weid et al., 2015 100. von der Weid, B. ∙ Rossier, D. ∙ Lindup, M. ... Large-scale transcriptional profiling of chemosensory neurons identifies receptor-ligand pairs in vivo Nat. Neurosci. 2015; 18 :1455-1463 Crossref Scopus (61) PubMed Google Scholar ). However, across all three of our experimental manipulations, OR gene expression and the usage of identity-related GEPs remained constant ( Figures 3 C, S3 C, S3H, and S3N–S3Q). Furthermore, β-Arrestin2 knockout mice exhibited largely normal ES scores that adapted to a new environment ( Figures S3 R–S3T). Taken together, these results reveal that specific interactions between each OR and the environment differentially drive activity in each OSN, which in turn specifies the particular level at which GEP High and GEP Low genes are expressed. Our results also demonstrate that, under physiological conditions and in realistic odor environments, odors and air chronically engage the entire OSN array.
What functions might environment-dependent gene expression confer upon mature OSNs? Inspection revealed that GEP High and GEP Low include 73 genes with known or likely roles in shaping OSN sensory responses (e.g., calcium homeostasis, OR signaling, and intrinsic excitability), as well as an additional ∼40 genes putatively involved in axon guidance or synaptic transmission ( Figure 4 A; Table S3 ). The expression of these genes smoothly co-varied across OSN subtypes and exhibited structured correlations and anticorrelations with other GEP High and GEP Low genes ( Figures 4 B and S4 A–S4C). Similar to the ES score itself, the expression of “functional” genes (here and throughout, defined as the set of 73 GEP High and GEP Low genes relevant to sensory responses) both distinguished all OSN subtypes and systematically fell after naris occlusion ( Figures S4 D–S4F). The observed pattern of functional gene expression in each OSN suggested a role in compensating for ongoing activity; the expression of genes that likely attenuate odor responses was higher in OSNs with high ES scores than in those with low ES scores, whereas genes that likely amplify responses showed the opposite trend ( Figures 4 C and 4D). Furthermore, persistently changing OSN activity by chronic occlusion, optogenetic stimulation, and switching environments caused functional gene expression to change bidirectionally in an OR-dependent manner ( Figures 4 E, 4F, and S4 G–S4K; Table S4 ).
To test the possibility that the continuous variation in functional gene expression uniquely adapts the odor responses of each OR-defined OSN subtype to each environment, we subjected the olfactory epithelium to Act-seq, a scRNA-seq variant in which neural activity is read out as a rapid change in gene expression ( Wu et al., 2017 114. Wu, Y.E. ∙ Pan, L. ∙ Zuo, Y. ... Detecting activated cell populations using single-cell RNA-seq Neuron. 2017; 96 :313-329.e6 Full Text Full Text (PDF) Scopus (141) PubMed Google Scholar ). Act-seq reliably identified a subset of OSNs (and therefore ORs) that acutely responded after a 2-h exposure to the volatile odorants acetophenone and octanal, as assessed by immediate early gene (IEG) expression (with similar results obtained using unsupervised analysis of odor-evoked transcriptional changes; Figures 5 A, 5B, and S5 A; see STAR Methods ). Act-seq identified a subset of ORs (∼12%–13% of total ORs) activated by either acetophenone or octanal; these included most known responsive ORs for each odor, as well as many new acetophenone and octanal receptors ( Figures S5 B–S5D) ( Bozza et al., 2002 8. Bozza, T. ∙ Feinstein, P. ∙ Zheng, C. ... Odorant receptor expression defines functional units in the mouse olfactory system J. Neurosci. 2002; 22 :3033-3043 Crossref PubMed Google Scholar ; Jiang et al., 2015 42. Jiang, Y. ∙ Gong, N.N. ∙ Hu, X.S. ... Molecular profiling of activated olfactory neurons identifies odorant receptors for odors in vivo Nat. Neurosci. 2015; 18 :1446-1454 Crossref Scopus (62) PubMed Google Scholar ; Repicky and Luetje, 2009 80. Repicky, S.E. ∙ Luetje, C.W. Molecular receptive range variation among mouse odorant receptors for aliphatic carboxylic acids J. Neurochem. 2009; 109 :193-202 Crossref Scopus (14) PubMed Google Scholar ; von der Weid et al., 2015 100. von der Weid, B. ∙ Rossier, D. ∙ Lindup, M. ... Large-scale transcriptional profiling of chemosensory neurons identifies receptor-ligand pairs in vivo Nat. Neurosci. 2015; 18 :1455-1463 Crossref Scopus (61) PubMed Google Scholar ).
Acetophenone and octanal elicited similar acute transcriptional changes across many genes ( Figure S5 E). We therefore developed an analog measure of odor response (referred to herein as the activation score) to quantitatively summarize information from the ∼500 genes (including IEGs) that were reliably and rapidly changed by odor exposure (and which lacked strong ES score correlations; Figure 5 C; Table S5 ; see STAR Methods ). To test whether activation scores capture meaningful variation in activity, we subjected OSNs to optogenetic stimulation, which revealed a tonic relationship between stimulation frequency and activation scores ( Figures 5 D and 5E). Similarly, increasing concentrations of acetophenone tonically increased both the number of ORs activated by acetophenone and the activation scores of acetophenone-responsive OSNs ( Figures 5 F, 5G, and S5 F).
To test whether activation scores also capture differences in binding affinities between different ligands for the same receptor, we took advantage of 2-hydroxyacetophenone (2-HA), which, relative to acetophenone, binds more strongly to the M72 receptor ( Arneodo et al., 2018 2. Arneodo, E.M. ∙ Penikis, K.B. ∙ Rabinowitz, N. ... Stimulus dependent diversity and stereotypy in the output of an olfactory functional unit Nat. Commun. 2018; 9 :1347 Crossref Scopus (15) PubMed Google Scholar ; Zhang et al., 2012 120. Zhang, J. ∙ Huang, G. ∙ Dewan, A. ... Uncoupling stimulus specificity and glomerular position in the mouse olfactory system Mol. Cell. Neurosci. 2012; 51 :79-88 Crossref Scopus (25) PubMed Google Scholar ). Act-seq revealed that 2-HA indeed elicits higher activation scores than acetophenone in OSNs expressing M72 ( Figure 5 H). Conversely, activation scores for OSNs expressing Olfr923 , a high-affinity acetophenone receptor, were higher for acetophenone than 2-HA ( Hu et al., 2020 39. Hu, X.S. ∙ Ikegami, K. ∙ Vihani, A. ... Concentration-dependent recruitment of mammalian odorant receptors eNeuro. 2020; 7 ENEURO.0103-19.2019 Crossref Scopus (5) Google Scholar ; Jiang et al., 2015 42. Jiang, Y. ∙ Gong, N.N. ∙ Hu, X.S. ... Molecular profiling of activated olfactory neurons identifies odorant receptors for odors in vivo Nat. Neurosci. 2015; 18 :1446-1454 Crossref Scopus (62) PubMed Google Scholar ). Furthermore, 2-HA, acetophenone, and two related odors each elicited a broad range of OR- and odor-specific activation scores that were stereotyped across mice and accurately predicted the specific odor each mouse experienced ( Figures S5 G–S5M). Taken together, these results demonstrate that Act-seq can identify the OSN subtypes (and thus the ORs) that can bind to and respond to any odorant, and that the activation score affords a quantitative transcriptional measure of the degree to which a given OSN has responded to an odor in vivo .
Consistent with the hypothesis that the transcriptome of each OSN shapes its acute odor responses, ES scores were negatively correlated with odor activation: the higher the ES score for a given acetophenone-responsive OSN subtype (identified across experiments via its OR), the lower its acute, acetophenone-evoked response ( Figures 5 I, S5 N, and S5O). This negative correlation was also observed in OSNs responding to octanal and to the three acetophenone-related odors ( Figures 5 I, S5 O, and S5P). The 73 functional genes were as effective as the ES score at predicting acute OSN odor responses, but the in vitro half-maximal effective concentration (EC 50 ) of each acetophenone OR was unable to support in vivo odor response predictions ( Figures 5 J, 5K, S5 Q, and S5R) ( Jiang et al., 2015 42. Jiang, Y. ∙ Gong, N.N. ∙ Hu, X.S. ... Molecular profiling of activated olfactory neurons identifies odorant receptors for odors in vivo Nat. Neurosci. 2015; 18 :1446-1454 Crossref Scopus (62) PubMed Google Scholar ; Saito et al., 2009 82. Saito, H. ∙ Chi, Q. ∙ Zhuang, H. ... Odor coding by a mammalian receptor repertoire Sci. Signal. 2009; 2 :ra9 Crossref Scopus (363) PubMed Google Scholar ). Interestingly, OSN activation scores following 2 h of acute optogenetic stimulation were also negatively correlated with control ES scores, indicating that the ability of light to transcriptionally activate each OSN also depends on the expression levels of functional genes ( Figures 5 L and S5 S).
If functional gene expression indeed plays a causal role in determining odor responses, then experimentally raising or lowering ES scores should predictably change acute odor responses ( Figure 6 A). We tested this hypothesis by lowering OSN activity via transient unilateral naris occlusion using removable plugs, and then performing Act-seq after acute odor exposure ( Figure 6 B). Transient occlusion reduced ES scores in an OR-specific manner but did not change the correlation structure between functional genes ( Figures 6 C, S6 A, and S6B). Similar sets of ORs were activated by acetophenone in control conditions and after occlusion, but acetophenone receptor-expressing OSNs derived from occluded nostrils exhibited higher activation scores ( Figures 6 D and S6 C). Critically, the occlusion-dependent changes in ES scores and functional gene expression predicted the occlusion-dependent changes in odor-evoked activation ( Figures 6 E, S6 D, and S6E).
Similarly, switching mice from the home cage into a new odor environment (which bidirectionally modulates ES scores [ Figures 3 I–3N]) altered acetophenone-driven OSN activation scores in an environment-dependent manner ( Figures 6 F and S6 F–S6I); activation scores were sufficiently different across environments and reliable across mice that they could be used to identify the environment in which a given mouse was housed ( Figures 6 F and S6 J–S6L). Activation scores for acetophenone-responsive OSN subtypes were also negatively correlated with ES scores within a given environment, and the bidirectional changes in ES scores or functional gene expression following environment shifts predicted the corresponding change in the acetophenone response for each OSN subtype ( Figures 6 G, S6 M, and S6N). Taken together, these results demonstrate that odor-evoked activation is not determined solely by the affinities of odors for their receptors, but rather is flexibly tuned in each OSN by functional genes, which adapt OSNs in an OR-specific manner to the specific contents of each odor environment.
We wondered how different environments induce changes in OSN transcriptomes and hypothesized that acute activity triggered by new odor environments sculpts long-term functional gene expression ( Figure 6 H). Simply switching mice between different environments caused OSNs to be activated, while OSN activation was negligible in mice moved between similar environments, demonstrating that OSN activation reflects salient changes in the odor environment ( Figure 6 I). Furthermore, OSN-specific activation scores measured 2 h after an environment shift predicted OSN ES score changes measured after 2 weeks ( Figures 6 J and 6K). Similarly, OSN activation scores observed after acute 2-h exposure to acetophenone or optogenetic stimulation predicted ES score changes after chronic acetophenone exposure or prolonged optogenetic stimulation, respectively ( Figures 6 L–6N and S6 O). These data demonstrate that ES scores adjust proportionally to acute perturbations in activity. Interestingly, much of the long-term change in ES scores and functional genes was apparent 4 h after switching environments, suggesting that ES scores integrate activity on timescales of hours ( Figures 6 O, S6 P, and S6Q). In contrast, transient 2-h exposure of mice to acetophenone did not change ES scores after 24 h ( Figure S6 R), indicating that the ongoing presence of odors is required for persistent changes in functional gene expression.
We observed that the ES score changes observed after chronic acetophenone exposure could be predicted by the baseline ES score of each acetophenone-responsive OSN subtype in the home cage; a similar relationship was observed following optogenetic stimulation ( Figures 6 P and 6Q). Given that baseline ES scores also determine acute responses after odor or light stimulation ( Figures 5 I and 5L), these results are consistent with odor-evoked activity and ES scores being linked together in a closed loop. We noted that OSNs with high ES scores exhibited some residual IEG expression in the home cage ( Figure S6 S). This finding suggests that transcription-based adaptation in OSNs compensates for but does not fully eliminate activity driven by background odors, suggesting that under normal circumstances OSNs are continuously re-adapting to their environment.
To test whether the ambient environment also shapes odor codes in the brain, we performed presynaptic functional imaging of OSN axons in the olfactory bulb ( Figure 7 A). OSN axons expressing the same OR converge on one or more insular structures known as glomeruli; imaging pre-synaptic OSN neural activity in olfactory bulb glomeruli can therefore characterize odor responses across different OSN subtypes. We imaged responses to a panel of purified odors before, during, and after a 2-week period in which mice were housed in one of the alternative odor environments described above ( Figures 7 B, S7 A, and S7B). Response amplitudes to the same odor stimulus changed bidirectionally in ∼50% of glomeruli after mice were switched from the standard home cage into a new environment, consistent with prior work exploring the influence of a single odor on subsequent responses ( Kass et al., 2016 45. Kass, M.D. ∙ Guang, S.A. ∙ Moberly, A.H. ... Changes in Olfactory Sensory Neuron Physiology and Olfactory Perceptual Learning After Odorant Exposure in Adult Mice Chem. Senses. 2016; 41 :123-133 PubMed Google Scholar ); these environment-dependent changes were consistently observed across both mice and odorants, and reverted when mice were later returned to standard home cages ( Figures 7 C–7E and S7 C–S7F).
To determine how environmental history influences odor coding, we imaged responses to a panel of 16 odors that broadly activated dorsal glomeruli ( Figure S7 G). A large fraction of glomeruli exhibited environment-specific odor response amplitudes, and linear decoders for each odor accurately distinguished between environments ( Figures 7 F and S7 H). Odor identity could also be accurately predicted based on the glomerular responses within any given environment; however, classifiers trained in one environment performed worse across environments ( Figure 7 G). Quantification of pairwise correlations in glomerular odor responses revealed that relationships for many odor pairs were modulated across environments, while close odor relationships were often preserved ( Figures 7 H, 7I, and S7 I); similarly, classification analysis designed to quantify the relational structure in odor responses revealed diffuse changes in odor relationships across odor environments ( Figures 7 J–7L and S7 J). Taken together, these data demonstrate that changes in OSN transcriptomes evoked by complex naturalistic environments are paralleled by pervasive environment-dependent changes in both pre-synaptic glomerular odor responses and population-level odor codes in the brain.

Section: Discussion

OSNs are thought to primarily communicate information about odor-OR interactions, which is used by the brain to facilitate odor perception ( Buck, 1996 12. Buck, L.B. Information coding in the vertebrate olfactory system Annu. Rev. Neurosci. 1996; 19 :517-544 Crossref PubMed Google Scholar ; Cleland and Linster, 2005 18. Cleland, T.A. ∙ Linster, C. Computation in the olfactory system Chem. Senses. 2005; 30 :801-813 Crossref Scopus (101) PubMed Google Scholar ; de March et al., 2020 23. de March, C.A. ∙ Titlow, W.B. ∙ Sengoku, T. ... Modulation of the combinatorial code of odorant receptor response patterns in odorant mixtures Mol. Cell. Neurosci. 2020; 104 :103469 Crossref Scopus (14) PubMed Google Scholar ; Firestein, 2001 28. Firestein, S. How the olfactory system makes sense of scents Nature. 2001; 413 :211-218 Crossref Scopus (808) PubMed Google Scholar ; Imai et al., 2010 41. Imai, T. ∙ Sakano, H. ∙ Vosshall, L.B. Topographic mapping—The olfactory system Cold Spring Harb. Perspect. Biol. 2010; 2 :a001776 Crossref Scopus (55) PubMed Google Scholar ; Sullivan et al., 1995 89. Sullivan, S.L. ∙ Ressler, K.J. ∙ Buck, L.B. Spatial patterning and information coding in the olfactory system Curr. Opin. Genet. Dev. 1995; 5 :516-523 Crossref PubMed Google Scholar ; Touhara, 2002 93. Touhara, K. Odor discrimination by G protein-coupled olfactory receptors Microsc. Res. Tech. 2002; 58 :135-141 Crossref Scopus (0) PubMed Google Scholar ). Here, we find that each of the ∼1,000 OR-defined OSN subtypes in the mouse olfactory system adapts to the environment through a common mechanism: a transcriptional rheostat. This rheostat is composed of more than 70 genes relevant to OSN function, whose expression levels vary continuously across OSNs in an OR-dependent manner and adapt dynamically as mice traverse distinct environments. The specific position adopted by this rheostat (i.e., the OR-specific pattern of functional gene expression) predicts the odor response amplitude of a given OSN; furthermore, acute odor responses triggered by novel odor environments predict future patterns of functional gene expression (i.e., the setting of the rheostat).
These observations suggest a closed regulatory loop in which analog changes in environment-driven activity yield proportional transcriptional changes that predictably influence future neural responses to odors. Thus, rather than faithfully reporting the extent of odor-OR interactions, the peripheral olfactory system uses gene expression to instantiate expectation, thereby building odor codes that are personalized by each animal’s experience. While fast, post-translational mechanisms for sensory adaptation have been observed across modalities, and many circuit-level mechanisms have been characterized that adapt central sensory responses, our data reveal a systematic, large-scale adaptive transcriptional program that operates at the level of sensory neurons themselves ( Benda, 2021 6. Benda, J. Neural adaptation Curr. Biol. 2021; 31 :R110-R116 Full Text Full Text (PDF) Scopus (0) PubMed Google Scholar ; Burns and Baylor, 2001 13. Burns, M.E. ∙ Baylor, D.A. Activation, deactivation, and adaptation in vertebrate photoreceptor cells Annu. Rev. Neurosci. 2001; 24 :779-805 Crossref Scopus (317) PubMed Google Scholar ; Fettiplace and Ricci, 2003 27. Fettiplace, R. ∙ Ricci, A.J. Adaptation in auditory hair cells Curr. Opin. Neurobiol. 2003; 13 :446-451 Crossref Scopus (0) PubMed Google Scholar ; Kadohisa and Wilson, 2006 44. Kadohisa, M. ∙ Wilson, D.A. Olfactory cortical adaptation facilitates detection of odors against background J. Neurophysiol. 2006; 95 :1888-1896 Crossref Scopus (88) PubMed Google Scholar ; Martelli and Storace, 2021 62. Martelli, C. ∙ Storace, D.A. Stimulus driven functional transformations in the early olfactory system Front. Cell. Neurosci. 2021; 15 :684742 Crossref Scopus (0) PubMed Google Scholar ; Wark et al., 2007 105. Wark, B. ∙ Lundstrom, B.N. ∙ Fairhall, A. Sensory adaptation Curr. Opin. Neurobiol. 2007; 17 :423-429 Crossref Scopus (324) PubMed Google Scholar ; Zufall and Leinders-Zufall, 2000 121. Zufall, F. ∙ Leinders-Zufall, T. The cellular and molecular basis of odor adaptation Chem. Senses. 2000; 25 :473-481 Crossref PubMed Google Scholar ).
Our data demonstrate that the OR repertoire is densely activated by airflow and odors in our environments, suggesting that every OSN must contend with some degree of chronic activation. Because experience bidirectionally alters ES gene expression on timescales of hours, transcription-mediated adaptation most likely helps to center OSNs in their dynamic range as animals traverse different odor contexts, or as odor environments evolve during circadian cycles. As such, the adaptive mechanism identified here likely serves a distinct purpose from those that rapidly truncate responses to odor filaments (and which support, e.g., odor-guided navigation), and from central habituation mechanisms that sparsen odor representations on the minutes-long timescale but cannot restore information that is lost when OSNs operate outside their dynamic range ( Kadohisa and Wilson, 2006 44. Kadohisa, M. ∙ Wilson, D.A. Olfactory cortical adaptation facilitates detection of odors against background J. Neurophysiol. 2006; 95 :1888-1896 Crossref Scopus (88) PubMed Google Scholar ; Kostal et al., 2008 51. Kostal, L. ∙ Lansky, P. ∙ Rospars, J.-P. Efficient olfactory coding in the pheromone receptor neuron of a moth PLoS Comput. Biol. 2008; 4 :e1000053 Crossref Scopus (29) PubMed Google Scholar ; Lecoq et al., 2009 55. Lecoq, J. ∙ Tiret, P. ∙ Charpak, S. Peripheral adaptation codes for high odor concentration in glomeruli J. Neurosci. 2009; 29 :3067-3072 Crossref Scopus (44) PubMed Google Scholar ; Martelli and Storace, 2021 62. Martelli, C. ∙ Storace, D.A. Stimulus driven functional transformations in the early olfactory system Front. Cell. Neurosci. 2021; 15 :684742 Crossref Scopus (0) PubMed Google Scholar ; Moore, 1994 69. Moore, P.A. A model of the role of adaptation and disadaptation in olfactory receptor neurons: Implications for the coding of temporal and intensity patterns in odor signals Chem. Senses. 1994; 19 :71-86 Crossref Scopus (42) PubMed Google Scholar ; Nagel and Wilson, 2011 71. Nagel, K.I. ∙ Wilson, R.I. Biophysical mechanisms underlying olfactory receptor neuron dynamics Nat. Neurosci. 2011; 14 :208-216 Crossref Scopus (108) PubMed Google Scholar ; Wilson, 2009 111. Wilson, D.A. Olfaction as a model system for the neurobiology of mammalian short-term habituation Neurobiol. Learn. Mem. 2009; 92 :199-205 Crossref Scopus (0) PubMed Google Scholar ).
Transcription factors and axon guidance genes appear insufficient to effectively distinguish OSN transcriptomes or predict OR expression. Although known identity markers have been thought to only assign OSNs to broad dorsal or ventral domains ( Bozza et al., 2009 10. Bozza, T. ∙ Vassalli, A. ∙ Fuss, S. ... Mapping of class I and class II odorant receptors to glomerular domains by two distinct types of olfactory sensory neurons in the mouse Neuron. 2009; 61 :220-233 Full Text Full Text (PDF) Scopus (135) PubMed Google Scholar ; Kobayakawa et al., 2007 50. Kobayakawa, K. ∙ Kobayakawa, R. ∙ Matsumoto, H. ... Innate versus learned odour processing in the mouse olfactory bulb Nature. 2007; 450 :503-508 Crossref Scopus (444) PubMed Google Scholar ; Tan and Xie, 2018 90. Tan, L. ∙ Xie, X.S. A Near-Complete Spatial Map of Olfactory Receptors in the Mouse Main Olfactory Epithelium Chem. Senses. 2018; 43 :427-432 PubMed Google Scholar ), the dorsal, ventral, anterior, and posterior GEPs are sufficiently diverse and organized to support OR predictions ( Figures S2 F–S2H and S3 Q). These observations suggest a fine gradation in OSN cell identities organized across the two main anatomical axes ( Bozza et al., 2009 10. Bozza, T. ∙ Vassalli, A. ∙ Fuss, S. ... Mapping of class I and class II odorant receptors to glomerular domains by two distinct types of olfactory sensory neurons in the mouse Neuron. 2009; 61 :220-233 Full Text Full Text (PDF) Scopus (135) PubMed Google Scholar ; Miyamichi et al., 2005 66. Miyamichi, K. ∙ Serizawa, S. ∙ Kimura, H.M. ... Continuous and overlapping expression domains of odorant receptor genes in the olfactory epithelium determine the dorsal/ventral positioning of glomeruli in the olfactory bulb J. Neurosci. 2005; 25 :3586-3592 Crossref Scopus (207) PubMed Google Scholar ; Pacifico et al., 2012 77. Pacifico, R. ∙ Dewan, A. ∙ Cawley, D. ... An olfactory subsystem that mediates high-sensitivity detection of volatile amines Cell Rep. 2012; 2 :76-88 Full Text Full Text (PDF) Scopus (90) PubMed Google Scholar ). OR expression levels and the usages of identity-related GEPs remained largely constant across all our experimental manipulations, indicating that functional genes are uniquely sensitive to the environment. Although the mechanisms that render ES genes sensitive to neural activity, and which coordinate expression levels across ES genes, remain to be determined, mature OSNs express several transcription factors (including Ebf1 and Lhx2 ) that in principle could be sensitive to activity; the prominent role of heterochromatin in regulating OR expression suggests that epigenetic mechanisms involving chromatin or DNA modifications might also coordinate ES gene expression ( Monahan and Lomvardas, 2015 67. Monahan, K. ∙ Lomvardas, S. Monoallelic expression of olfactory receptors Annu. Rev. Cell Dev. Biol. 2015; 31 :721-740 Crossref Scopus (71) PubMed Google Scholar ; Monahan et al., 2017 68. Monahan, K. ∙ Schieren, I. ∙ Cheung, J. ... Cooperative interactions enable singular olfactory receptor expression in mouse olfactory neurons eLife. 2017; 6 :e28620 Crossref Scopus (42) PubMed Google Scholar ).
Environment-driven variation in functional gene expression both highlights new odor information and dynamically sculpts population-level odor representations. Given that peripheral odors codes are modified by ongoing experience, it is not clear how the brain supports odor identification and generalization across different environments. It is possible that some features of population OSN activity (e.g., timing, dynamics) are relatively insensitive to differences in functional gene expression, and/or that circuit-level attractor dynamics in the olfactory bulb and cortex cause central representations for odors to converge, despite differing inputs. Conversely, the brain may take advantage of environment-specific differences in peripheral odor codes to better understand the context in which a given stimulus was encountered. Transcription-dependent changes in both vomeronasal sensory neurons and fly olfactory receptor neurons render their odor responses sensitive to sex hormones ( Dey et al., 2015 24. Dey, S. ∙ Chamero, P. ∙ Pru, J.K. ... Cyclic regulation of sensory perception by a female hormone alters behavior Cell. 2015; 161 :1334-1344 Full Text Full Text (PDF) Scopus (100) PubMed Google Scholar ; Ng et al., 2019 73. Ng, R. ∙ Salem, S.S. ∙ Wu, S.-T. ... Amplification of Drosophila olfactory responses by a DEG/ENaC channel Neuron. 2019; 104 :947-959.e5 Full Text Full Text (PDF) Scopus (20) PubMed Google Scholar ), raising the possibility that internal states may similarly influence conventional mammalian OSNs and thereby further modify odor codes.
There is a close conceptual relationship between the bidirectional sensory adaptation we describe herein and firing rate homeostasis (FRH), the process through which neurons in a network maintain stable firing rates by adjusting both synaptic weights and intrinsic neural properties ( Davis, 2006 21. Davis, G.W. Homeostatic control of neural activity: From phenomenology to molecular design Annu. Rev. Neurosci. 2006; 29 :307-323 Crossref Scopus (400) PubMed Google Scholar , 2013 22. Davis, G.W. Homeostatic signaling and the stabilization of neural function Neuron. 2013; 80 :718-728 Full Text Full Text (PDF) Scopus (165) PubMed Google Scholar ; Marder, 2011 60. Marder, E. Variability, compensation, and modulation in neurons and circuits Proc. Natl. Acad. Sci. USA. 2011; 108 :15542-15548 Crossref Scopus (197) PubMed Google Scholar ; Marder and Goaillard, 2006 61. Marder, E. ∙ Goaillard, J.-M. Variability, compensation and homeostasis in neuron and network function Nat. Rev. Neurosci. 2006; 7 :563-574 Crossref Scopus (723) PubMed Google Scholar ; Turrigiano, 2011 96. Turrigiano, G. Too many cooks? Intrinsic and synaptic homeostatic mechanisms in cortical circuit refinement Annu. Rev. Neurosci. 2011; 34 :89-103 Crossref Scopus (425) PubMed Google Scholar ; Turrigiano, 1999 94. Turrigiano, G.G. Homeostatic plasticity in neuronal networks: The more things change, the more they stay the same Trends Neurosci. 1999; 22 :221-227 Full Text Full Text (PDF) Scopus (585) PubMed Google Scholar ; Turrigiano, 2008 95. Turrigiano, G.G. The self-tuning neuron: Synaptic scaling of excitatory synapses Cell. 2008; 135 :422-435 Full Text Full Text (PDF) Scopus (942) PubMed Google Scholar , 2017 97. Turrigiano, G.G. The dialectic of Hebb and homeostasis Philos. Trans. R. Soc. Lond. B Biol. Sci. 2017; 372 :20160258 Crossref Scopus (97) PubMed Google Scholar ). Invertebrate neurons of a given type with identical firing properties can exhibit significant variation in ion channel expression, suggesting that there are many transcriptional means to achieving the same functional end ( Goldman et al., 2001 33. Goldman, M.S. ∙ Golowasch, J. ∙ Marder, E. ... Global structure, robustness, and modulation of neuronal models J. Neurosci. 2001; 21 :5229-5238 Crossref PubMed Google Scholar ; Marder, 2011 60. Marder, E. Variability, compensation, and modulation in neurons and circuits Proc. Natl. Acad. Sci. USA. 2011; 108 :15542-15548 Crossref Scopus (197) PubMed Google Scholar ; O’Leary et al., 2013 74. O’Leary, T. ∙ Williams, A.H. ∙ Caplan, J.S. ... Correlations in ion channel expression emerge from homeostatic tuning rules Proc. Natl. Acad. Sci. USA. 2013; 110 :E2645-E2654 Crossref Scopus (111) PubMed Google Scholar ; Schulz et al., 2007 86. Schulz, D.J. ∙ Goaillard, J.-M. ∙ Marder, E.E. Quantitative expression profiling of identified neurons reveals cell-specific constraints on highly variable levels of gene expression Proc. Natl. Acad. Sci. USA. 2007; 104 :13187-13191 Crossref Scopus (184) PubMed Google Scholar ). Our experiments in OSNs identify a deterministic and proportional interdependence between environment-dependent activity and functional gene expression patterns. We speculate that this tight closed-loop relationship emerges because OSNs (unlike neurons in networks) cannot manipulate synaptic weights to adapt the strength of their inputs, as input strength in OSNs is entirely determined by odor-receptor interactions. It has been proposed that structured correlations in the expression of functional genes can be used to define different cell types ( O’Leary et al., 2013 74. O’Leary, T. ∙ Williams, A.H. ∙ Caplan, J.S. ... Correlations in ion channel expression emerge from homeostatic tuning rules Proc. Natl. Acad. Sci. USA. 2013; 110 :E2645-E2654 Crossref Scopus (111) PubMed Google Scholar ; Schulz et al., 2007 86. Schulz, D.J. ∙ Goaillard, J.-M. ∙ Marder, E.E. Quantitative expression profiling of identified neurons reveals cell-specific constraints on highly variable levels of gene expression Proc. Natl. Acad. Sci. USA. 2007; 104 :13187-13191 Crossref Scopus (184) PubMed Google Scholar ); OSNs, whose functional genes exhibit near-perfect expression correlations along a continuum of activity levels, clearly meet this operational definition.
scRNA-seq analysis reveals a startling diversity of transcriptomes associated with neurons of a single putative type ( Kim et al., 2019 48. Kim, D.-W. ∙ Yao, Z. ∙ Graybuck, L.T. ... Multimodal analysis of cell types in a hypothalamic node controlling social behavior Cell. 2019; 179 :713-728.e17 Full Text Full Text (PDF) Scopus (54) PubMed Google Scholar ; Li et al., 2017 57. Li, H. ∙ Horns, F. ∙ Wu, B. ... Classifying Drosophila olfactory projection neuron subtypes by single-cell RNA sequencing Cell. 2017; 171 :1206-1220.e22 Full Text Full Text (PDF) Scopus (104) PubMed Google Scholar ; Tasic et al., 2018 91. Tasic, B. ∙ Yao, Z. ∙ Graybuck, L.T. ... Shared and distinct transcriptomic cell types across neocortical areas Nature. 2018; 563 :72-78 Crossref Scopus (420) PubMed Google Scholar ). It remains unclear whether these transcriptional differences reflect an occult diversity of neural subtypes or whether they instead reflect the ongoing activity-dependent modulation of a single underlying cell type ( Gouwens et al., 2020 34. Gouwens, N.W. ∙ Sorensen, S.A. ∙ Baftizadeh, F. ... Integrated morphoelectric and transcriptomic classification of cortical GABAergic cells Cell. 2020; 183 :935-953.e19 Full Text Full Text (PDF) Scopus (50) PubMed Google Scholar ; Kim et al., 2020 49. Kim, E.J. ∙ Zhang, Z. ∙ Huang, L. ... Extraction of distinct neuronal cell types from within a genetically continuous population Neuron. 2020; 107 :274-282.e6 Full Text Full Text (PDF) Scopus (28) PubMed Google Scholar ; Scala et al., 2021 83. Scala, F. ∙ Kobak, D. ∙ Bernabucci, M. ... Phenotypic variation of transcriptomic cell types in mouse motor cortex Nature. 2021; 598 :144-150 Crossref Scopus (18) PubMed Google Scholar ). Taken together, our findings—enabled by the ability to query gene expression and activity in ∼1,000 different OSN subtypes across experiments—are consistent with a general model in which neurons systematically modulate their transcriptomes to continuously adapt to their inputs.
Act-seq can reliably identify analog odor-OR relationships across much of the OR repertoire in vivo , suggesting its general utility for deorphanizing odors and receptors; however, OSNs expressing rare ORs may be missed by scRNA-seq. Our in vivo measures of acute odor-evoked neural activity depend on transcription, rather than directly querying either calcium or action potentials, and may not fully capture the activity state of each OSN. While our data strongly suggest that functional gene expression alters odor-spike coupling, it may also alter the gain of activity-transcription coupling. Furthermore, the mechanisms through which these functional genes, as well as potentially other genes, adapt OSNs remain to be determined. The significant environment-dependent changes in axonal calcium responses in the olfactory bulb roughly match observed transcriptional changes in OSNs; however, it is possible that some aspect of these changes is caused by pre-synaptic inhibition.

Section: STAR★Methods

REAGENT or RESOURCE SOURCE IDENTIFIER Biological samples Mouse olfactory epithelium This paper N/A Chemicals, peptides, and recombinant proteins Pentanal Sigma-Aldrich Cat# 110132 Pentanone Sigma-Aldrich Cat# 471194 Ethyl butyrate Sigma-Aldrich Cat# W242713 Heptanal Sigma-Aldrich Cat# W254002 Hexanal Sigma-Aldrich Cat# 115606 Propanal Sigma-Aldrich Cat# 538124 Butanal Sigma-Aldrich Cat# W217018 Butanone Sigma-Aldrich Cat# W217018 Hexanone Sigma-Aldrich Cat# 103004 Ethyl acetate Sigma-Aldrich Cat# 270989 Propyl acetate Sigma-Aldrich Cat# 537438 Butyl acetate Sigma-Aldrich Cat# 287725 Benzaldehyde Sigma-Aldrich Cat# B1334 Tiglaldehyde Sigma-Aldrich Cat# W340707 Methyl tiglate Thermo Fisher Cat# T024825ML Methyl valerate Sigma-Aldrich Cat# W275204 Acetophonone Sigma-Aldrich Cat# A10701 2-Hydroxyacetophenone Sigma-Aldrich Cat# H18607 4-Methylacetophenone Sigma-Aldrich Cat# W267708 Methyl salicylate Sigma-Aldrich Cat# M6752 Octanal Sigma-Aldrich Cat# O5608 Mineral oil Sigma-Aldrich Cat# M5904 Dipropylene glycol Sigma-Aldrich Cat# D215554 Actinomycin D Sigma-Aldrich Cat# A9415 Triptolide Sigma-Aldrich Cat# T3652 Anisomycin Sigma-Aldrich Cat# A9789 Papain Worthington Cat# LK003178 DNase I Worthington Cat# LK003172 EBSS Worthington Cat# LK003188 Hibernate-A Thermo Fisher Cat# A1247501 Heat-inactivated Fetal Bovine Serum Thermo Fisher Cat# 16140071 Propidium iodide Thermo Fisher Cat# P1304MP PBS Thermo Fisher Cat# 70011044 Critical commercial assays Chromium Next GEM Single Cell 3′ Kit v3.1 10x genomics Cat# 1000268 Chromium Next GEM Chip G Single Cell Kit 10x genomics Cat# 1000120 Dual Index Kit TT Set A 10x genomics Cat# 1000215 Agilent High Sensitivity DNA kit Agilent Cat# 5067-4626 KAPA Library Quantification Kit, illumina platform, Complete kit (Universal) Roche Cat# KK4824 Deposited data Raw and analyzed sequencing data This paper GEO: GSE173947 Experimental models: Organisms/strains Mouse: C57BL/6J The Jackson Laboratory JAX: 000664, RRID:IMSR_JAX:000664 Mouse: OMP-IRES-GFP The Jackson Laboratory JAX: 006667, RRID:IMSR_JAX:006667 Mouse: B6J.Cg-Gt(ROSA)26Sor tm95.1(CAG-GCaMP6f)Hze /MwarJ The Jackson Laboratory JAX:028865, RRID:IMSR_JAX:028865 Mouse: Arrb2 tm1Rjl /J The Jackson Laboratory JAX:011130, RRID:IMSR_JAX:011130 Mouse: B6;129P2-Olfr160 tm11(Olfr545)Mom /MomJ (S50 (M72 locus) ) Thomas Bozza JAX:006714, RRID:IMSR_JAX:006714 Mouse: B6;129P2-Olfr545 tm3(Olfr160)Mom /MomJ (M72 (S50 locus) ) Thomas Bozza JAX:006715, RRID:IMSR_JAX:006715 Mouse: Olfr17 tm7Mom /MomJ Stavros Lomvardas JAX:006669, RRID:IMSR_JAX:006669 Mouse: OMP-IRES-Cre Richard Axel MGI: 3045687 Mouse: OMP-ChR2(H134R)-Venus Thomas Bozza and Dmitry Rinberg Li et al., 2014 56. Li, A. ∙ Gire, D.H. ∙ Bozza, T. ... Precise detection of direct glomerular input duration by the olfactory bulb J. Neurosci. 2014; 34 :16058-16064 Crossref Scopus (37) PubMed Google Scholar Software and algorithms Python 3.6–3.8 Python https://www.python.org/ MATLAB (versions 2014a and 2015a) Mathworks https://www.mathworks.com/ ScanImage 5 Vidirio Technologies http://scanimage.vidriotechnologies.com/display/SIH/ScanImage+Home Wavesurfer 0.775 Howard Hughes Medical Institute Janelia Research Campus https://wavesurfer.janelia.org/ Suite2p Howard Hughes Medical Institute Janelia Research Campus https://github.com/mouseland/suite2p Adobe Illustrator Adobe RRID: SCR_010279 , https://www.adobe.com/products/illustrator.html Cell Ranger (2.2.0 for v2 and v3 data and 4.0.0 for v3.1 data) 10x genomics https://support.10xgenomics.com/single-cell-gene-expression/software/overview/welcome Scanpy 1.6.0 Wolf et al., 2018 113. Wolf, F.A. ∙ Angerer, P. ∙ Theis, F.J. SCANPY: Large-scale single-cell gene expression data analysis Genome Biol. 2018; 19 :15 Crossref Scopus (758) PubMed Google Scholar https://github.com/theislab/scanpy Python analysis scripts This paper Zenodo: https://doi.org/10.5281/zenodo.5550454 GitHub: https://github.com/dattalab/Tsukahara_Brann_OSN Other Teensy 3.2 Adafruit Cat# 2756 blue LED Digikey Cat# 1416-1052-6-ND Open table in a new tab
Further information and requests for resources and reagents should be directed to and will be fulfilled by the Lead Contact, Sandeep R. Datta ( srdatta@hms.harvard.edu ).
This study did not generate new unique reagents.
C57BL/6J, OMP-IRES-GEP, Ai95D (GCaMP6f) and β-arrestin2 knockout mice were obtained from Jackson Laboratory (stock number 000664, 006667, 028865, 011130). “OR-swap” mice (M72 (S50 locus) and S50 (M72 locus) ) were maintained in the Bozza laboratory (and are available from Jackson Laboratory with stock numbers 006715, 006714) ( Bozza et al., 2009 10. Bozza, T. ∙ Vassalli, A. ∙ Fuss, S. ... Mapping of class I and class II odorant receptors to glomerular domains by two distinct types of olfactory sensory neurons in the mouse Neuron. 2009; 61 :220-233 Full Text Full Text (PDF) Scopus (135) PubMed Google Scholar ). P2-IRES-GFP mice (P2 (P2 locus) ) were obtained from the Lomvardas laboratory (and are available from Jackson Laboratory with stock number 006669) ( Feinstein and Mombaerts, 2004 26. Feinstein, P. ∙ Mombaerts, P. A contextual model for axonal sorting into glomeruli in the mouse olfactory system Cell. 2004; 117 :817-831 Full Text Full Text (PDF) Scopus (246) PubMed Google Scholar ). OMP-IRES-Cre mice were obtained from the Axel laboratory ( Eggan et al., 2004 25. Eggan, K. ∙ Baldwin, K. ∙ Tackett, M. ... Mice cloned from olfactory sensory neurons Nature. 2004; 428 :44-49 Crossref Scopus (298) PubMed Google Scholar ). OMP-ChR2(H134R)-Venus mice were maintained in the Bozza laboratory and obtained from the Rinberg laboratory ( Li et al., 2014 56. Li, A. ∙ Gire, D.H. ∙ Bozza, T. ... Precise detection of direct glomerular input duration by the olfactory bulb J. Neurosci. 2014; 34 :16058-16064 Crossref Scopus (37) PubMed Google Scholar ). Mice of either sex between 6–16 weeks-old were used for experiments. Mouse husbandry and experiments were performed following institutional and federal guidelines and were approved by Harvard Medical School’s Institutional Animal Care and Use Committee.
To identify gene expression programs sensitive to ongoing activity from environmental odorants, 7 day old mice were anesthetized on ice, and one of the two nostrils was occluded by cautery, as previously described ( Fischl et al., 2014 29. Fischl, A.M. ∙ Heron, P.M. ∙ Stromberg, A.J. ... Activity-dependent genes in mouse olfactory sensory neurons Chem. Senses. 2014; 39 :439-449 Crossref Scopus (13) PubMed Google Scholar ). This age was chosen to minimize deficits in axon targeting that occur from manipulating activity levels at earlier post-natal time points ( Ma et al., 2014 59. Ma, L. ∙ Wu, Y. ∙ Qiu, Q. ... A developmental switch of axon targeting in the continuously regenerating mouse olfactory system Science. 2014; 344 :194-197 Crossref Scopus (45) PubMed Google Scholar ). Unilateral naris occlusion was confirmed using a dissection microscope. After ∼1 month, mice were used for scRNA-seq experiments. Cells isolated from occluded and open nostrils were processed and analyzed separately.
Act-seq ( Wu et al., 2017 114. Wu, Y.E. ∙ Pan, L. ∙ Zuo, Y. ... Detecting activated cell populations using single-cell RNA-seq Neuron. 2017; 96 :313-329.e6 Full Text Full Text (PDF) Scopus (141) PubMed Google Scholar ) was performed following odor exposure to quantify odor-evoked responses in each OSN subtype (defined by their expressed OR) across the entire OR repertoire. Mice were habituated to a reversed light cycle for at least for 1 week before odor exposure, transferred to a new disposable cage with regular bedding/food and kept overnight in a satellite animal facility. On the experimental day, each mouse was first transferred to a new empty disposable cage during the dark cycle and habituated for 20 minutes. Empty cages were used to avoid any activation by odorants present within the environments in which the mice were housed. Odors were added to a piece of filter paper (100 μL of odorant) in a 35 mm Petri dish and a cotton ball (200 μL of odorant) and placed in each cage. After 2 hours, mice were euthanized, and dissociation was performed as described below. Odors used in this study were as follows. Dipropylene glycol (DPG, control solvent), and 10% of acetophenone, octanal, 2-hydroxy acetophenone, 4-methyl acetophenone, and methyl salicylate. As a control, mice were exposed to DPG alone for 30 min. This control condition was used to account for any drift in transcriptomes during the overnight housing and habituation periods prior to odor exposure and designed to capture the transcriptome in the state it would have been in the odor-exposed animals prior to odor exposure. The 30 min DPG control was used for all Act-seq experiments, except following transient naris occlusion (see below); in the Act-seq experiments our results did not depend upon the specific control condition we used, which likely reflects the relative stability of the transcriptome for each OSN subtype. Act-seq was also performed using lower concentrations of acetophenone (1.0, 0.1, 0.01%) and 2-hydroxy acetophenone (0.1%, 0.01%). All odor dilutions were made with DPG, and all odors and DPG were obtained from Sigma. To assess the persistence of any transcriptional changes observed as a result of odor exposure, a cohort of mice was exposed to acetophenone or DPG for 2 hours, transferred to new clean regular home cages, and subjected to scRNA-seq after an additional 22 hours.
Because odor responses in occluded OSNs cannot be examined in the chronic occlusion experiment due to permanent cautery, transient unilateral naris occlusion was performed using removable nasal plugs. Adult mice (6-12 weeks old) were anesthetized by isoflurane and removal nasal plugs were inserted into one of the two nostrils, as previously described ( Galliano et al., 2021 32. Galliano, E. ∙ Hahn, C. ∙ Browne, L.P.R. ... Brief sensory deprivation triggers cell type-specific structural and functional plasticity in olfactory bulb neurons J. Neurosci. 2021; 41 :2135-2151 Crossref Scopus (2) PubMed Google Scholar ; Kass et al., 2013 46. Kass, M.D. ∙ Pottackal, J. ∙ Turkel, D.J. ... Changes in the neural representation of odorants after olfactory deprivation in the adult mouse olfactory bulb Chem. Senses. 2013; 38 :77-89 Crossref Scopus (12) PubMed Google Scholar ). The occlusion was confirmed by measuring airflow from the occluded nostril via a thermocouple. After 5 days, a subset of mice was used for scRNA-seq experiment directly (control mice) to assess the effects of naris occlusion on changes in gene expression. Under brief anesthesia by isoflurane, the remaining mice were unplugged and transferred to a new empty disposable cage containing either DPG alone or 10% acetophenone. After 2 hours, mice were subjected to scRNA-seq. Each of the two nostrils was used separately in both control (open and plugged) and odor-exposed mice (open and unplugged). Mice whose nostrils did not experience airflow after being unplugged, as assessed transcriptionally, were excluded from any analyses.
To examine environment-dependent changes in gene expression and their effects on odor-evoked responses, Act-Seq was performed 2 weeks after environment switches. Adult mice (6–12 weeks old) were group-housed in the regular home-cage environment for at least one week before the transfer to their novel environments. Individual mice were transferred to a new disposable cage containing materials for a novel environment in the satellite animal facility. Two different novel environments were used, with each containing non-overlapping contents: Environment A (paper bedding, hay, dried flowers (such as marigold), peanuts, seeds (e.g., sunflower seeds, pumpkin seeds), puffed rice), and Environment B (garden soil, aspen shavings, coconut husks, dried fruits (e.g., berries, mango, pineapple), dried vegetables (e.g., green peas, corn, bell peppers), millet, fresh fruits (banana, apple, peach), corn flakes). Mice were singly-housed throughout the entire 2 weeks and were transferred to newly prepared environmental cages every 12 hours to minimize the contributions of any murine odors, which are likely the predominant odorants present within standard home-cage housing environments. After 2 weeks, individual mice were transferred to new empty disposable cages, and Act-Seq using 10% acetophenone was performed as above.
To assess the dynamics of gene expression changes in response to novel environments, mice were housed overnight in a new disposable cage with regular bedding/food in a satellite animal facility. On the experimental day, each mouse was first transferred to Environment A cages and subjected to scRNA-seq after 45 minutes, 2, 4, 12, 24 hours, or 3, 5, 14 days (with cages refreshed every 12 hours for durations longer than 12 hours). To account for any non-specific effects resulting from transferring mice from the animal facility to disposable cages within the satellite facility, data from mice transferred and housed in new disposable cages with regular bedding and food overnight were used as controls for downstream analyses of the effects of Environment A on gene expression.
For β-arrestin2 knockout mice, scRNA-seq was performed on cohorts of mice that were either housed in home cages, housed in new disposable cages with regular bedding and food overnight and then transferred to Environment A cages for 5 days, or housed in new disposable cages with regular bedding and food overnight as controls, as described above. Each of the three knockout datasets was compared to its respective dataset from wild-type mice housed in the same condition.
To determine whether OSN activation reflects salient differences between environments, one set of mice were housed in a new disposable cage with regular bedding/food overnight in a satellite animal facility and then transferred to Environment A for 5 days. On the experimental day, mice were transferred to either a new Environment A cage or a home cage for two hours before being subjected to scRNA-seq. An additional cohort of mice was housed in the home cage. The day before the experiment, they were transferred to a new disposable cage with regular bedding/food overnight in a satellite animal facility. On the experimental day they were transferred to a new home cage for two hours before being subjected to scRNA-seq. These three conditions were compared to mice transferred to Environment A cages for 2 hours as part of the time course described above, thus generating all four combinations of environmental switches between mice housed in Environment A and home cages.
To compare the effects of chronic odor exposure with the acute activation observed via Act-seq, scRNA-seq was performed after exposure to DPG alone or 0.1, 1, 10% of acetopheone (diluted by DPG) for 5 days. Adult mice were individually housed in regular home cages in a satellite animal facility overnight, then two cotton balls, each of which was soaked with 300 μL of DPG or diluted acetophenone solution, were added into each cage. The odorized cotton balls were replaced every 12 hours and cages were replaced every 2 days.
To characterize quantitative changes in gene expression after activation of OSNs, OMP-ChR2(H134R)-Venus mice were subject to optogenetic activation and analyzed via scRNA-seq. Mice (N = 14) were anesthetized with 2% isoflurane and injected with bupivacaine (1.25 mg/kg) under the scalp. An incision was then made to expose the dorsal skull and a scalpel (Aspen Surgical 372615 Bard-Parker) was used to thin the bone overlying the right olfactory bulb, after which cyanoacrylate glue (Loctite Glass Glue) was applied over the thinned bone. A blue LED (470 nm, Lumileds LXZ1-PB01, Digikey) was soldered to a two-pin connector (Millmax, Digikey ED8450-ND) and manually placed over the bulb. A titanium head bar was then placed over the caudal end of the skull, and the whole dorsal surface was covered with dental cement (Metabond, Parkell). After the dental cement dried, a layer of black nail polish was applied to minimize the leak of blue light during stimulation. Postoperative care included a subcutaneous injection of buprenorphine SR (1 mg/kg, given 1 hour prior to surgery start) and carprofen (5 mg/kg) administered through drinking water. Before experiments, mice were tethered to a cable connecting the LED to a microcontroller (Teensy 3.2, Adafruit) that provided a custom stimulation pattern. The LED emitted 100mW at 470nm, measured with a light meter (Thorlabs PM100D).
For chronic activation, OSNs were activated by 5 pulses (50 msec on, 50 msec off cycle) with a 10 s inter-pulse interval for 12 hours before being subjected to scRNA-seq. For acute activation, OSNs were activated by the same cycle as above with a 5, 10, or 20 s inter-pulse interval for 2 hours (denoted as High, Medium, and Low, respectively) and then subjected to scRNA-seq. For both chronic and acute activation, control mice underwent the same surgery and tethering, but were implanted with a dummy connector and did not receive LED stimulation. Home cage control samples for optogenetic experiments were mice that underwent the same surgery but were subjected to scRNA-seq directly from the home cage without any optogenetic stimulation. Because the LED was placed over the right olfactory bulb, only the right nostril was dissociated and used for scRNA-seq for all optogenetic stimulation and control experiments.
The main olfactory epithelium was dissected in Earle’s Balanced Salt Solution (EBSS, pre-treated with carbogen for at least 5 minutes before each use, Worthington), then transferred to a round-bottomed glass dish containing 750 μL of papain solution (one vial of Papain (Worthington) dissolved in 5 mL of EBSS and then equilibrated 10 minutes at 37°C) and 50 μL of DNase solution (one vial of DNase-I (Worthington) dissolved in 500 μL of EBSS). Bone was removed from the epithelium under a dissecting microscope and the resulting epithelial tissue was placed in a 5 mL tube (Becton Dickinson) with an additional 1.75 mL of Papain solution and 200 μL of DNase-I solution and rocked gently for ∼60 minutes at 37°C. The tissue was then gently triturated with a 5 mL pipette 10-15 times, passed through a 40 μm cell strainer (Becton Dickinson), and washed with 1 mL of Hibernate-A medium containing 10% Fetal Bovine Serum (FBS, GIBCO). Filtered cells were transferred to a new 5 mL tube and centrifuged 5 minutes at 300 x g. The supernatant was decanted, the cells were washed once with 4 mL Hibernate-A containing 10% FBS and resuspended in 1 mL Hibernate-A containing 0.2% FBS. Importantly, each of the solutions above contained transcriptional inhibitors (5 μg/mL of Actinomycin D, 10 μg/mL of Anisomycin and 10 μM of Triptolide, all obtained from Sigma) for all experiments, especially the Act-Seq experiments, except where noted ( Table S1 ).
Dissociated cells were stained with propidium iodide (final concentration 1.65 μg/mL) and subjected to FACS to remove dead cells and obvious doublets. For fluorescent reporter-expressing mouse lines (OMP-IRES-GFP, P2 (P2 locus) , M72 (S50 locus) , S50 (M72 locus) , OMP-ChR2(H134R)-Venus), fluorescence positive and negative cells were sorted separately using a FITC filter. Cells were sorted into Hibernate-A containing 5% FBS (and 0.1x concentration of transcriptional inhibitors), centrifuged for 5 minutes at 300 g, and resuspended with PBS. For samples from OMP-IRES-GFP and OMP-ChR2(H134R)-Venus mice, fluorescence positive cells were used for scRNA-seq experiments. For samples from OR lines (P2 (P2 locus) , M72 (S50 locus) and S50 (M72 locus) ), fluorescence positive and negative cells were combined for scRNA-seq experiments.
Single cell RNA-seq library were prepared from the single cell suspensions via the chromium single cell gene expression system (chromium single cell 3′ reagents and GEM v2, v3 or v3.1 dual index, 10x genomics), using the default protocols provided by 10x genomics. Each replicate, other than GFP-positive ones, was loaded at a concentration predicted to yield 10,000 cells, for which the expected multiplet rate is ∼8.0%.
Sequencing library fragments were examined using the Agilent High Sensitivity DNA kit (Agilent) and quantified via qPCR by the KAPA library quantification kit (Roche). NextSeq and NovaSeq platforms were used for sequencing libraries. 75 cycle High output kit was used for NextSeq (Read1 = 26 cycle, Index (i7) = 8 cycle, Read2 = 58 cycle). Full flowcells of 100 cycle SP/S1/S2 kits, full flowcells or single lanes of 200 cycle S4 kit were used for NovaSeq (minimum read lengths: Read1 = 28 cycle, Index (i7) = 8 cycle, Read2 = 89 cycle for v2 and v3 kits and Read1 = 28 cycle, Index (i7) = 10 cycle, Index (i5) = 10 cycle, Read2 = 77 cycle for v3.1 dual index kits). Demultiplexed fastq files were generated by mkfastq function in Cell Ranger software.
Demultiplexed fastq files were aligned to the mouse reference genome mm10 (Ensembl 93) and converted into gene expression matrices using the 10x Genomics Cell Ranger software (version 2.2.0 (v2 and v3 samples) or 4.0.0 (v3.1 samples)) with two key modifications. First, despite the fact that the 10x genomic platforms have relatively high rates of intronic priming ( La Manno et al., 2018 54. La Manno, G. ∙ Soldatov, R. ∙ Zeisel, A. ... RNA velocity of single cells Nature. 2018; 560 :494-498 Crossref Scopus (690) PubMed Google Scholar ), Cell Ranger by default considers multi-mapped reads that map to a single exonic locus as well as to non-exonic (e.g., intronic) locations as being uniquely mapped to that gene (and modifies the MAPQ scores accordingly), even when the read may have better alignment to the non-exonic loci. These multimapped reads (typically 5%–10% of all reads) were filtered out by removing any read in the bam file with a MM:i:1 tag. Second, the output BAM files from Cell Ranger also contained many reads that were uniquely mapped to separate genes despite sharing the same cell barcode and unique molecular identifier (UMI), which is biologically implausible given that the cell barcode and UMI should uniquely identify each individual transcript. This could be either the result of UMI collision or misalignment. In support of the latter possibility, different reads of individual UMIs were often each uniquely aligned to multiple related genes, such as the large family of olfactory receptors (ORs). To avoid double-counting UMIs and inflating the numbers of genes, ORs, or UMIs detected in each cell, all ambiguous UMIs that mapped to multiple genes were removed from the BAM file with custom scripts, using samtools and pysam. The gene expression matrix was then recomputed by counting the number of distinct UMIs for each cell barcode for each gene.
Mature OSNs were identified using an iterative subclustering procedure via the Scanpy python package ( Wolf et al., 2018 113. Wolf, F.A. ∙ Angerer, P. ∙ Theis, F.J. SCANPY: Large-scale single-cell gene expression data analysis Genome Biol. 2018; 19 :15 Crossref Scopus (758) PubMed Google Scholar ). In each cell, the UMIs were total-count normalized and scaled by 10,000 (TPT normalized). Variable genes that were overdispersed relative to their mean were identified using the SPRING gene filtering function “filter_genes” with parameters (90, 3, 10; see ( Weinreb et al., 2018 107. Weinreb, C. ∙ Wolock, S. ∙ Klein, A.M. SPRING: A kinetic interface for visualizing high dimensional single-cell expression data Bioinformatics. 2018; 34 :1246-1248 Crossref Scopus (112) PubMed Google Scholar )). Ribosomal, mitrochondrial, and OR genes were excluded from the variable genes. To identify mature OSNs, the gene expression of the set of variable genes was log-normalized, and for each gene, the residuals from linear regression models using the total number of UMIs and percent of UMIs for mitochondrial genes as predictors were then scaled via z-scoring and reduced to a smaller number of dimensions via principal component analysis (PCA). Cells were clustered using the top 35 PCs via the Leiden algorithm (resolution = 1.2). Clusters containing mature OSNs were identified based on their expression of known mature OSN marker genes (e.g., Omp , Stoml3 , Cnga2 , Adcy3 ), the presence of cells expressing OR genes, as well as the absence of immature OSN marker genes or genes found in non-neuronal cells (e.g., Sox11 , Gap43 , Cbr2 , C1qb , Aqp3 ). A small cluster containing the non-canonical Gucy2d (GCD) and Gucy1b2 expressing neurons was routinely identified but not used for any analyses in this paper. Clusters containing dying cells with low numbers of total counts, low numbers of genes, and high percentages of mitochondrial genes were removed. This clustering procedure typically revealed a cluster of OSNs that had higher than average total counts (often close to double the mean of other OSN clusters) and the majority of cells in such clusters often expressed multiple ORs; these cells are likely OSN-OSN doublets and were not considered further. Similarly, clusters containing mixtures of OSN and non-neuronal markers were also likely doublets between OSNs and other cell types and were not considered further. After excluding immature OSNs and non-neuronal cells (~30% of cells) as well as doublets (<5% of cells), the above procedure (starting from variable gene identification but using only 20 PCs) was repeated multiple times for the mature OSN clusters that passed these initial filtering steps to remove any additional immature or unhealthy OSNs (with low counts or > 10% of total counts in mitochondrial genes) until stable results were obtained, yielding the mature OSNs (60–65% of all cells) used for downstream analyses. Importantly, although immature OSNs (e.g., Gap43+ and weakly Omp+ ) routinely express OR genes and other mature OSN markers, these OSNs were excluded by the conservative subclustering procedure described above so that any comparisons between cells expressing the same OR would not be confounded by any differences in OSN maturity.
The Ensembl database (Release 93) was used for OR gene annotation. Functional OR genes were identified as genes that are associated with GO term “olfactory receptor activity” (GO:0004984); the TAAR family of receptors was also included (GO:0001594, GO:1990081). To identify the OR class for each mouse OR, phylogenetic analysis was performed using all mouse and zebrafish OR proteins in MEGA7 with default parameters. As previously described, OR proteins cluster into two main phylogenetic clusters ( Zhang and Firestein, 2002 119. Zhang, X. ∙ Firestein, S. The olfactory receptor gene superfamily of the mouse Nat. Neurosci. 2002; 5 :124-133 Crossref Scopus (642) PubMed Google Scholar ). The ORs that clustered together with zebrafish ORs are the class I ORs and the remaining ORs are class II ORs. To compare OR protein similarity, the pairwise phylogenetic distance matrix between OR protein sequences was calculated by taking the cophenetic distance of the phylogenetic tree of all ORs. For each pair of ORs, the cophenetic distance is equal to the height of a dendrogram in which the two branches of the phylogenetic tree containing both ORs first merge into a single cluster. Unsupervised graph-based clustering of cells identified a cluster of OSNs expressing Cd36 , as previously described ( Oberland et al., 2015 75. Oberland, S. ∙ Ackels, T. ∙ Gaab, S. ... CD36 is involved in oleic acid detection by the murine olfactory system Front. Cell. Neurosci. 2015; 9 :366 Crossref Scopus (24) PubMed Google Scholar ; Xavier et al., 2016 116. Xavier, A.M. ∙ Ludwig, R.G. ∙ Nagai, M.H. ... CD36 is expressed in a defined subpopulation of neurons in the olfactory epithelium Sci. Rep. 2016; 6 :25507 Crossref Scopus (19) PubMed Google Scholar ). ORs were identified as Cd36 -positive if the majority of OSNs expressing that OR were found within the Cd36 -positive clusters. OSNs were categorized as dorsal or ventral based on their expression of known dorsal ( Nqo1 , Acsm4 ) and ventral ( Ncam2 , Nfix ) marker genes. ORs expressed in dorsal or ventral OSNs were referred to as dorsal or ventral ORs. With the exception of three known ventral class I ORs, all other class I ORs are dorsal, whereas OSNs expressing individual class II OR expressed either dorsal or ventral marker genes. The OR genes are located in gene clusters across most chromosomes in the genome; OR genes whose transcription start sites (TSS) were within 3 megabases of any other OR gene were considered part of the same gene cluster ( Monahan et al., 2017 68. Monahan, K. ∙ Schieren, I. ∙ Cheung, J. ... Cooperative interactions enable singular olfactory receptor expression in mouse olfactory neurons eLife. 2017; 6 :e28620 Crossref Scopus (42) PubMed Google Scholar ).
Of the 1,172 identified functional ORs, an OR was considered expressed in any given OSN if at least 3 UMIs were detected (except for the experiments using the 10x v2 chemistry, where a threshold of 2 UMIs was used). Mature OSNs expressing single ORs were identified based on the OR that they expressed, and all cells expressing the same OR were considered as the same OSN subtype for downstream analyses. The vast majority of mature OSNs expressed a single OR ( Figure S1 D). OSNs expressing multiple ORs at high levels typically had higher numbers of total counts and were likely cell doublets that remained even after the previous filtering steps. OSN expressing multiple ORs with higher expression for a single OR gene also sometimes expressed other OR genes at low levels, as seen during development ( Hanchate et al., 2015 37. Hanchate, N.K. ∙ Kondoh, K. ∙ Lu, Z. ... Single-cell transcriptomics reveals receptor transformations during olfactory neurogenesis Science. 2015; 350 :1251-1255 Crossref Scopus (116) PubMed Google Scholar ), or due to contamination from ambient RNA or errors in gene alignment. Regardless, any OSN expressing either zero or multiple OR genes was not considered further for any downstream analyses. OR frequency was defined empirically based on the fraction of all mature OSNs expressing a given OR. The expression level for each OR was determined based on the normalized expression (see below) of that OR gene within the OSNs singly-expressing that OR. In the “OR-swap” mice, in which the coding sequence for each OR was knocked into the locus of the other, cells expressing swapped ORs were identified based on the gene counts for the locus rather than the expressed OR (e.g., in M72 (S50 locus) mice, OR transcripts that originated from the S50 locus indicate the expression of M72 swap cells while OSNs expressing M72 from the endogenous locus were not considered and vice versa for S50 (M72 locus) mice) due to fact that only coding sequences were swapped whereas the 3′ UTR for the original OR remain and are detected given the 3′ bias of the 10x data that arises from the use of oligo(dT) primers. The median number of UMIs/genes detected per mature OSNs and number of mature OSNs used for each replicate are summarized in Table S1 .
ORs were expressed at a wide range of frequencies, spanning multiple orders of magnitude ( Figures S1 A and S1B). For instance, given that the 200 OR genes with the highest frequencies are expressed in ∼50% of all OSNs, if standard algorithms like PCA are applied on all OSNs at once, they would weight ORs expressed in 100 cells 100x more than an OR expressed in a single cell, and the resulting top PCs would capture the axes of transcriptional variation that distinguished highly-expressed ORs rather than all OSN subtypes. Similarly, classifiers trained on all cells would more easily distinguish highly-expressed ORs (from their higher influence on the PCs, increased presence in training data, and higher likelihood of accurate predictions by chance), and one could achieve high levels of overall prediction accuracy even with models that were unable to distinguish among the majority of ORs. Therefore, to account for OR frequency, most analyses were performed using equal numbers of OSNs per OR by subsampling from the population of OSNs that expressed the set of ORs each detected in at least a certain number of cells (e.g., at least 4-10, as specified, depending on the analysis). This subsampling procedure was performed 1,000 times and results were summarized for each OSN subtype (as defined by the expressed OR) across the 1,000 restarts. Analyses at the OSN subtype level were performed by first averaging across all OSNs expressing the same OR within a given condition.
The filtered mature OSN datasets containing only cells expressing single ORs were renormalized, starting again from the raw UMI counts for each gene. Normalization was performed by dividing the counts for each gene in each cell by the total counts across all genes (excluding mitochondrial and ribosomal genes, as well as highly-expressed lncRNAs and lincRNAs like Malat1 and Gm42418, and sex-specific transcripts like Xist ) in that cell and multiplying by 10,000 to yield tags per ten thousand (TPT) normalized data. Normalized expression in the figures and throughout refers to TPT-normalized data, where a value of 1 indicates on average 1 UMI for that gene per 10,000 UMIs. For analyses that required scaled data (e.g., PCA and classification), the logarithm of the TPT-normalized data was used (log(TPT + 1)). Scaling via z-scoring was performed for each gene, using means and standard deviations identified by taking the mean of the values from 100 restarts containing equal numbers of cells per OR. The home-cage data consisted of six replicates distributed across 2 batches; separate scaling was used for each batch, but similar results were obtained by scaling both batches together. For the “OR-swap” experiments, the means and standard deviations were fit using only cells from wild-type mice collected with the same 10x v2 chemistry platform, and these were applied to the “OR-swap” and P2 (P2 locus) OSNs. In the chronic occlusion data, the means and standard deviations were recomputed using data from both nostrils. In the environment switch experiments, the gene scaling was recomputed using data from all environments.
Importantly, besides scaling and normalizing the gene expression data, no methods for batch correction or dataset integration were performed for any dataset. The mature OSNs were readily identified and separately isolated from each dataset (obviating the need for any additional alignment of cell types across datasets), and batch effects were rarely observed when comparing the normalized expression between datasets (apart from changes in the levels of mitochondrial and ribosomal genes, which were excluded from normalization procedures and downstream analyses). This analytical choice was deliberate, as data integration procedures are affected by changes in OSN composition (due to differences in the set and frequency of ORs detected across datasets and the wide range of OR frequencies), can modify the transcriptomes by averaging and leaking data across cells (which may express different ORs), and could make OSNs transcriptomes more or less similar to each other in a manner that would hinder and bias downstream comparisons between cells expressing the same OR across experimental conditions. For instance, in the Act-Seq experiments, our expectation was that a small fraction of OSNs would exhibit difference in their transcriptomes upon being activated by odorants; however, dataset integration procedures typically attempt to normalize such differences, and thus tend to make control OSNs appear more activated and odor-exposed OSNs appear less activated. Some datasets were collected with different 10x kits (v2, v3, and v3.1; see Table S1 ); as these kits differ in their sensitivities, each sample was compared with appropriate control samples collected with the same platform.
A consensus set of genes whose expression varied across mature OSNs were identified and used as the basis of most downstream analyses where transcriptomes were compared across OSNs and conditions. After using the OR genes to identify the OR expressed in each cell, the OR genes were not considered further, and were subsequently removed from all downstream analyses. Mitochondrial and ribosomal genes, and the lncRNAs mentioned above were also excluded. Using the home-cage data, the population of OSNs that expressed 831 ORs in at least 10 cells was used. To identify genes whose expression varied across cells expressing different ORs, 10 cells were selected for each OR and the F-score between the scaled gene expression and OR identity was computed for each gene, using the set of ∼15,000 genes that were expressed in at least 0.2% of OSNs. This procedure was performed 1,000 times and genes that were consistently strongly significant (Benjamini-Hochberg FDR-corrected p value ≤ 1 × 10 −7 for at least 90% of restarts) were considered highly-variable genes (HVGs). This procedure identified a set of 1,350 non-OR genes that were used for downstream analyses. Varying thresholds, such as the number of restarts to consider a gene as a HVG, yielded different numbers of HVGs but gave consistent results with respect to other analyses ( Figure S1 I).
Principal component analysis (PCA) was performed using equal numbers of cells for each OR to avoid any OR having undue weights on any PC based on its frequency of expression. All versions of PCA shown used the scaled expression of the set of 1,350 HVGs, and these HVGs were reduced to the top 20 PCs; however, stable results were obtained with different numbers of HVGs and PCs ( Figure S1 I). After fitting PCA in this manner using equal numbers of cells for each OR the fitted gene loadings (V T ) were applied to the scaled HVG expression for all cells to obtain PCA scores for the remaining cells. In analyses in which this subsampling procedure was repeated across restarts, PCA was fit on the subset of cells sampled for each restart. For UMAP visualization, the results from a single restart are shown (although qualitatively similar results were obtained across restarts). In the “OR-swap” experiments, PCA was fit using only OSNs from wild-type mice (with equal numbers of cells per OR) and then applied to the cells from the “OR-swap” and P2 (P2 locus) mouse lines. In the chronic occlusion experiments, PCA was refit using equal numbers of cells per each OR for each nostril, and in the environment switch experiments, PCA was fit using equal cells for each OR from each of the DPG-exposed control mice from each of the three environments.
UMAP was used solely for visualization purposes ( McInnes et al., 2018 64. McInnes, L., Healy, J., and Melville, J. (2018). UMAP: Uniform manifold approximation and projection for dimension reduction. arXiv, https://arxiv.org/pdf/1802.03426v3.pdf . Google Scholar ). To generate UMAP visualizations, the gene expression of each cell was further reduced from 20 PCs to 2 dimensions using the Uniform Manifold Approximation and Projection (UMAP) technique with parameters n_neighbors = 25, min_dist = 0.6, and metric = “euclidean.” As for PCA, UMAP embeddings were fit using balanced numbers of cells for each OR (and only for wild-type OSNs in the “OR-swap” experiments), and these embeddings were then used to transform to the PCA scores for all cells of a given dataset into the same UMAP space. UMAP was fit using 1,000 epochs and a learning rate of 0.25 to improve the stability of this transformation step. The UMAP embeddings were refit separately using the PC scores from each dataset, yielding embeddings that differed qualitatively in appearance yet retained similar features (dorsal, ventral, and Cd36 -positive OSNs were separated, the main axis was activity-dependent, cells expressing the same OR were locally clustered). UMAP and PCA were also refit using only cells from the occluded nostrils to determine if OSN subtypes cluster based on intrinsic activity in the absence of odor-evoked activity.
To measure the similarity of cells based on their gene expression, the transcriptome distance was defined as the cosine distance (1 – cosine similarity) between the PC scores of pairs of OSNs. The cosine distance is bounded between 0 (an angle of 0° indicating similar transcriptomes), 1 (an angle of 90° indicating orthogonality) and 2 (an angle of 180° indicating opposing transcriptomes).
Equal numbers of cells (10) were selected for each OR (of the 831 ORs detected in at least 10 cells in the home-cage dataset), PCA was refit based on the scaled HVG expression of these 8,310 cells and the pairwise transcriptome distance matrix was then evaluated. Within-OR distances we calculated, for each OR, as the median pairwise distance between all pairs of cells sharing that OR. For between-OR distances, the median pairwise distance between all pairs of ORs was calculated. Then, since each OR is more similar and dissimilar to specific subsets of other ORs, for each OR, the distribution of between-OR distances were summarized across all pairs of ORs sharing that OR. Starting from subsampling OSNs, the within- and between-OR distances were recomputed across 1,000 restarts, and the distribution of within-OR distances across ORs was compared to the distribution of pairwise distances between each OR and all other ORs. On each restart, the OR labels were also shuffled across cells, and within-OR distances were recomputed (and were close to 1 indicating that the transcriptomes of random cells were dissimilar). Similar results were also obtained using the Euclidean and Correlation distance metrics. To evaluate whether these distributions of within- and between-OR transcriptome distances remained separable (even though distances increase with increasing dimensionality) across various choices of gene sets and numbers of PCs, the Jensen–Shannon divergence was computed by comparing the discretized versions of these two distributions on each restart (with 111 evenly spaced bins between 0 and 2) and comparing the entropy of the average distribution to that of the average of the entropies of each individual distribution.
To determine whether cells sharing the same OR are clustered locally within gene expression space, a k -nearest neighbor (KNN) approach was used. For each of 1,000 restarts, using the pairwise distance matrix between cells described above, for each cell for each OR, the fraction of all the other cells that share the same OR within k neighbors was computed empirically for progressively larger groups of k neighbors. The fraction of same-OR cells found within k neighbors was averaged for each OR across restarts and was then summarized across the entire set of 831 ORs. The local clustering of cells sharing the same-OR was not apparent when shuffling the OR labels across the cells from each restart.
In all instances, classification was performed in a cross-validated manner using linear classifiers fit on equal numbers of cells for each OR. Equal numbers of cells were randomly selected for each OR (10 cells for each of the 831 ORs expressed in at least 10 OSNs in the home-cage data). For both pairwise and OR identity classification, the number of cross-validation folds was chosen to be equal to the number of subsampled cells (10) for each OR. For each fold, one cell expressing each OR was held out and the remained cells were used to train linear support vector machine (SVM) models (SVC with kernel = “linear,” decision_function_shape = “one-vs-one,” and regularization parameter C = 0.03). The hyperparameters for the classification pipeline were identified via a random search, but similar results were obtained across a range of hyperparameters. The input to the classifiers was the scaled gene expression (excluding any OR, ribosomal, or mitochondrial genes), using all genes (∼13,000) that were expressed in at least 0.5% of all cells. During each cross-validation fold, feature selection was performed by keeping the top 10% of genes with the highest F-score with the OR labels of the training fold cells. Importantly, although this is the same procedure used for HVG selection described above and the 10% threshold was designed to yield a similar number of genes, because feature selection was performed in a cross-validated manner, the resulting set of 1,300 genes identified for each fold may differ slightly from the set of HVGs used for other analyses). Next, the dimensionality of these 1,300 genes was further reduced to 20 dimensions with linear transformations via PCA and Linear Discriminant Analysis (LDA), also using only the cells in the training fold. Importantly, in addition to using equal numbers of cells per OR (to make predictions at similar chance levels for each OR), the feature selection, PCA and LDA transformations, and SVM decision boundaries were all fit using only the data in the training folds and then applied to the held-out cells in the test fold to generate predictions of the expressed OR in each held-out cell. This classification pipeline therefore avoids data leakage (which could aid in the prediction of OR identities and potentially bias results) between training and test folds.
Pairwise classification was performed using the same classification pipeline. For each training fold, as described above, the gene sets, PCA and LDA transformations were fit using all cells in the training fold, and then applied to transform all held-out cells into the same 20D subspace. Then, using the training data, separate SVM models were fit for each pair of ORs ( 831 C 2 = 344,865 pairs) and these decisions boundaries were applied to the held-out cells of that OR pair to predict which OR within that pair each held-out cell expressed. This cross-validation procedure was repeated for each cross-validation fold, and the mean classification accuracy was computed for each OR pair. The entire pairwise classification procedure (starting from subsampling OSNs) was repeated across 1,000 restarts (yielding in total 344,865 × 10 × 1,000 = 3.45 billion models). The mean accuracy for each OR pair was summarized across the 1,000 restarts, and the distributions of classifications accuracies were shown for the 344,865 OR pairs. The median prediction accuracy was 100% (compared to a chance accuracy of 50%), indicating that in the majority of OR pairs, the OR identity for every OSN of that OR pair was correctly predicted in each of the 1,000 restarts. The same classification procedure was performed separately for both nostrils for the 436 ORs detected in at least 10 cells in each nostril in the chronic occlusion data.
The same cross-validation and classification procedure was used to predict which OR (out of 831) was expressed in each held-out cell. “One-vs-one” SVM models were first fit on the PCA and LDA-transformed gene expression of all OR pairs in the training set and then these transformations and models were applied to each cell in the test fold; this procedure was repeated for each fold. The “decision function” from this procedure thus returned for each held-out cell the predictions from the model fitted on each pair of ORs in the respective training fold, yielding a matrix of 8,310 cells x 344,865 models that indicates for each of the 344,865 “one-vs-one” binary pairwise classifiers which OR within that pair was more likely to be expressed. Predictions were generated using the standard voting procedure; for each cell, for each OR, the number of times that the subset of 831 pairwise models containing that OR predicted that specific OR (rather than the other OR in each pair) as more likely to be expressed were summed. The OR with the highest number of “+1” votes (out of a maximum possible 831) was predicted as the OR that was most likely to be expressed in a given cell. Since this procedure calculated the total number of votes for each OR for each cell, it also generated the likelihood (based on the ranks of the number of “+1” votes for each OR) any given OR was expressed in any given cell. Cells whose OR identity was correctly predicted were those in which the actual OR expressed in that cell was the one that received the most votes (or on rare occasions tied for the most votes).
Given that correctly predicting the exact OR (out of 831) of each held-out cell given only 9 training cells expressing the same OR and 7470 (830 × 9) cells expressing other ORs is a difficult task (with chance accuracy 1/831), the frequency in which the OR expressed in each held-out cell was within the top-N% of predicted ORs was also calculated using the ranks of the number of votes for each OR described above. In this case, predictions were considered as accurate at increasing percent thresholds (e.g., 0.25% = the actual OR was within the top 2 ORs with the most votes and 1% = within the top 8 ORs out of 831). For both the exact and top-N% classification procedures, the classification accuracy for each OR was summarized across the 10 cells expressing that OR in each restart and the accuracy for each OR was then averaged across 1,000 restarts yielding the average classification accuracy for each of the 831 ORs, which are shown in the figures. Across the 831 ORs, the median classification accuracy was ∼50%. Given the balanced number of cells per OR, classification accuracy did not depend on OR frequency ( Figure S1 J) and was at chance levels for classifiers fit on the same data in each restart but with shuffled OR labels (1/831 = 0.1% for the exact predictions and 1% for the top-1% predictions). This same OR identity classification procedure was performed separately for both nostrils for the 436 ORs detected in at least 10 cells in each nostril in the chronic occlusion data.
OR identity classification was performed as described above, but the % threshold for the F-score feature selection procedure of the classification pipeline was modified to assess the classification performance with varying numbers of genes. First, the high threshold was progressively increased from 0.5 to 12.5% of the ∼13,000 expressed genes (compared to the default of 10%). Next, starting from the default threshold of 10%, the most informative genes were progressively excluded by increasing the low threshold in 0.5% intervals such that the top 0.5%, then the top 1%, were excluded until only genes in the top 9.5%–10% remained. 10 restarts were performed for each gene threshold, and the mean accuracy across ORs was calculated.
OR identity classification was performed as above for the different gene sets, using genes from each set that were expressed in at least 0.5% of cells. These gene sets included the set of 543 mouse transcription factors detected in the OSNs ( Aibar et al., 2017 1. Aibar, S. ∙ González-Blas, C.B. ∙ Moerman, T. ... SCENIC: Single-cell regulatory network inference and clustering Nat. Methods. 2017; 14 :1083-1086 Crossref Scopus (656) PubMed Google Scholar ), and a set of 119 axon guidance genes (defined as known cell adhesion molecules with the following prefixes: Slit, Robo, Epha, Ephb, Efn, Nrp, Sema, Plx, Kirrel, Pcdh, Cdh, Tenm; using these prefixes was important because common GO terms for axon guidance genes also include OSN-specific transcription factors like Lhx2 and Bcl11b and other genes like ion channels that are not directly involved in axon guidance). As a comparison, classification was performed using only the top 0.75% of highly variable genes based on their F-score (rather than the default used above of 10%, thus yielding ∼100 rather than 1,300 genes). Optimal hyperparameters for feature selection (based on their F-score in the training folds, as before) for the percent of genes from each gene set to keep, as well as the number of dimensions for PCA and LDA and SVM regularization strength were identified via randomized searches for each gene set. Classification was also performed after removing all transcription factors and axon guidance genes (and increasing the F-score threshold to 10.5% to again use the top ∼1,300 genes). Models trained with only axon guidance genes or transcription factors performed substantially worse than those with the top 100 F-score genes, and excluding all axon guidance genes and transcription factors genes had little effect on classification accuracy ( Figure S1 M).
Pairwise and OR identity classification was performed with the same pipeline described above. Rather than just generalizing across held-out cells (which may have been from either the same or other mice), here classification was performed by leaving out all of the OSNs from single mouse, while the remaining 5 out of 6 mice were used for training to fit the classification pipeline (gene selection, PCA and LDA transformations, and the SVM decision boundaries). For each mouse, ORs found in at least 10 cells in the 5 training mice and at least 4 cells in the test mouse were used, and classification accuracies for each OR in the test mouse were evaluated across 1,000 restarts. Similar accuracies were observed when shuffling mouse identities, demonstrating that models successful generalize across mice. Generalization performance was at chance levels when trained on models with shuffled OR labels.
Classification was performed for the “OR-swap” mice using the PCs fit on the set of 1,350 HVGs. The top 10 PCs were used as inputs to “one-vs-one” SVM linear classifiers trained to distinguish between M72, S50, and P2. Using the 42/18/84 cells for M72/S50/P2 in the wild-type data, the models were trained using 15-fold cross validation (subsampling 15 cells for each OR) to evaluate their ability to distinguish between wild-type OSNs expressing the three ORs. Models fit on only the 15 wild-type cells subsampled for each OR also successfully generalized to accurately predict the OR identities in the more than 500 held-out cells for each OR from the “OR-swap” and P2 (P2 locus) mouse lines. Classification accuracy was summarized across 1,000 restarts.
Classification of OR class was performed at the OSN subtype level (by taking the means of all the OSNs expressing each OR) between the 504/207/105 ventral class II, dorsal class II, and dorsal class I ORs. For each of 1,000 restarts, 80 OSN subtypes were selected for each OR type and classification was performed using 10-fold cross-validation with a pipeline that used linear SVMs (SVC with kernel = “linear,” decision_function_shape = “one-vs-one,” and regularization parameter C = 0.03) fit on the top 10 PCs in each training fold to predict the OR class of the held-out ORs. Classification accuracies were at chance performance (33.3%) upon shuffling the OR type labels across OSN subtypes.
Non-negative Matrix Factorization (NMF) was used to decompose the transcriptomes of each OSN into a smaller set of interpretable factors. NMF decomposes the gene expression matrix (cells x HVGs) into a combination of two matrices (W ∗ H), one containing gene loadings (H) for each factor and another containing the usages (W) of these factors in each cell ( Figure 2 A). In contrast to PCA, these NMF factors often represent biologically meaningful and interpretable gene sets, and therefore were referred to as gene expression programs (GEPs). Because NMF is non-deterministic, a recently-described consensus NMF (cNMF) strategy was used, which has successfully found identity- and activity-related GEPs in a range of scRNA-seq datasets ( Kotliar et al., 2019 52. Kotliar, D. ∙ Veres, A. ∙ Nagy, M.A. ... Identifying gene expression programs of cell-type identity and cellular activity with single-cell RNA-seq eLife. 2019; 8 :e43803 Crossref Scopus (43) PubMed Google Scholar ). TPT-normalized data rather than raw counts (as used previously) were used as inputs to the cNMF procedure, since biological variation in the number of counts per cell was not expected given that all cells were mature OSNs. Each gene was scaled by its standard deviation using the standard deviations described above.
In brief, as previously described ( Kotliar et al., 2019 52. Kotliar, D. ∙ Veres, A. ∙ Nagy, M.A. ... Identifying gene expression programs of cell-type identity and cellular activity with single-cell RNA-seq eLife. 2019; 8 :e43803 Crossref Scopus (43) PubMed Google Scholar ), cNMF applies NMF multiple times and, after excluding outliers (based on their distance to nearest neighbors, density_threshold = 0.3), clusters the gene loadings across restarts with k -means clustering and uses the median of these clusters as the new gene loadings. In each of 20 restarts in which 10 cells were resampled for each of the 831 ORs, NMF was refit 150 times across a range of factors. A rank 18 decomposition, which balanced the tradeoff between reconstruction error (as measured by the Frobenius norm) and the consistency of the identified GEPs across restarts (as measured by the silhouette score), was used for the analyses presented here, but similar GEPs were observed with factorizations of other ranks. To match factors across restarts, the 54,000 × 54,000 distance matrix (18 × 150 × 20) was subject to k- means clustering using the value of k (19) that maximized the silhouette score. Clusters for stable factors should have close to 3,000 members (20 × 150). For each of the 19 clusters, the median loading across cluster members for each gene were used as the consensus gene loadings for that GEP. Three of these 19 clusters either appeared in few restarts or had non-zero usages only in small numbers of cells and were not considered further. For the 16 remaining GEPs, the loadings were normalized to sum to 1 for each GEP; these loadings can be found in Table S2 . Using this set of 16 GEPs as the new H matrix, the usages of these GEPs for each OSN were calculated by reapplying NMF while keeping the gene loadings constant (with update_H = False).
Individual GEPs may explain variation across ORs, allowing for accurate classification of OR identities, or they may explain other, independent, aspects of variation. To distinguish between these possibilities, across 10,000 restarts 10 cells were randomly subsampled for each OR, and the correlation between the mean GEP usages for cells expressing each OR (vectors of length 831 for each of the 16 GEPs) were compared between the first and second half of cells for each OR. The 10 GEPs with consistently-high correlations (R > 0.9) were considered “OR-specific,” and each had higher gene loadings in a restricted set of HVGs ( Figures S2 A and S2B).
GEPs were identified based on manual inspection of genes with high loadings and high correlations with the usages for that GEP; four GEPs included known dorsal, ventral, anterior or posterior identity marker genes, while one GEP was specific to genes associated with CD36 positivity. One GEP contained genes like Ddit3 (CHOP) that are associated with ER stress and the unfolded protein response, but this GEP was not identified as OR-specific in our mature OSN dataset. GEPs that were not OR-specific (GEPs 11-16) and whose means across cells expressing the same OR are therefore not meaningful, or GEPs whose functions were unable to be identified based on their gene loadings (GEPs 8-10, which also had usages that were weakly correlated with other GEPs) were not considered for downstream analyses.
Two of the OR-specific GEPs encoded many genes associated with neural activity in OSNs (reviewed in ( Wang et al., 2017 104. Wang, Q. ∙ Titlow, W.B. ∙ McClintock, D.A. ... Activity-dependent gene expression in the mammalian olfactory epithelium Chem. Senses. 2017; 42 :611-624 Crossref Scopus (7) PubMed Google Scholar )). One included S100a5 , Pcp4l1 , and Kirrel2 (which are downregulated by chronic sensory deprivation), while another included Calb2 , Kirrel3 , Ppp3ca (which are upregulated after chronic sensory deprivation; see Figure 4 and Table S3 ). These two GEPs were referred to as GEP High and GEP Low . The usages of GEP High and GEP Low were anti-correlated and expressed in a mutually-exclusive manner across a continuous range of values ( Figures 2 and S2 ). The difference in their usages was therefore summarized as a single metric to define a single continuous axis of gene expression. This difference (GEP High - GEP Low ) was referred to as the Environmental State (ES) score, and GEP High and GEP Low were collectively referred to as ES GEPs, given the hypothesis that variation in ES GEP usages and thus ES scores across OSNs expressing different ORs is a consequence of the differential contribution of environmental odors on the activity levels and expression of ES-related genes across OSNs.
Among the identity GEPs, GEP Dorsal and GEP Ventral , as well as GEP Anterior and GEP Posterior also varied smoothly and in a similar mutually-exclusive manner across ORs; their differences in usages were therefor also summarized into single metrics (DV score = GEP Dorsal - GEP Ventral and AP score = GEP Anterior - GEP Posterior ) to capture the continuous variation across these 3 independent axes (DV, AP, and ES; see Figure S2 ). The DV scores were distributed bimodally, and OSNs whose DV score was at least 40 were considered as dorsal OSNs, yielding consistent results as the manual gene-based identification of dorsal OSNs described above.
Genes associated with each of GEP High and GEP Low were identified by two criteria: 1) the gene was within the top 200 genes with the highest loading for that GEP and 2) the expression of that gene was correlated with the GEP usage on OR-by-OR basis in the home cage data (the Spearman’s rank correlation between the vectors of GEP means and gene means across the 831 ORs was 0.25). This approach identified 168 and 177 genes in GEP High and GEP Low , respectively. The potential functions/ontologies of these genes were manually annotated, and 63 and 54 “neuronal” genes with known or proposed function in neurons were identified for the two ES GEPs. As listed in Table S3 , these neuronal genes were categorized according to their putative roles in either calcium homeostasis (calcium binding, calcium signaling, inositol phosphatide related) ion transfer (ion channel, ion pump/transporter), axon guidance (axon guidance, cell adhesion), synapse (synapse, secretory peptide), or protein transport (ER/Golgi/cilia related). The remaining genes with high loadings and correlations with the ES GEPs had similar patterns of gene expression in OSNs as the above genes, but their functions in OSNs remain unannotated. The “neuronal” genes were further restricted to include only the “functional” gene categories that are predicted to directly impact OSN odor responses, and which included the 73 genes that were part of the calcium homeostasis, ion transfer and OR signaling categories (see Table S3 ). Of note, while many known components of OR signaling are included in this list, the expression of Ano2 and Adcy3 remained constant across OSN subtypes and did not meet the above correlation thresholds (ρ < 0.2 for GEP High , GEP Low , and the ES score for both genes). Furthermore, although Omp was weakly correlated with the ES score (ρ = 0.36), because it was not part of the HVGs it did not contribute to the usages of any GEP.
Although cNMF gene loadings were identified using the home-cage data, they were subsequently applied to other datasets to thus compare, on an OR-by-OR basis, changes in gene expression and GEP usages across experimental conditions. For all datasets, the TPT-normalized HVG expression from that dataset was scaled by the standard deviations from the home-cage data that were used when initially fitting cNMF. Using the fixed set of gene loadings (H), new usages (W) were solved by refitting NMF (update_H = False). To compare GEP usages across conditions, the mean GEP usage in that condition was calculated for each OSN subtype for all cells expressing that OR, and then differences between conditions were computed for each OSn subtype; distributions depict the change across OSN subtypes.
Changes in ES scores were evaluated by comparing the ES scores for each OSN subtype across experimental conditions. For chronic and transient occlusion ES scores from occluded nostrils were compared to those from open nostrils. For environment switches ES scores were compared for each OSN subtype between pairs of environments. For optogenetic stimulation, the change in ES scores was compared between mice housed in the home cages and those that either were or were not optogenetically-stimulated. In the chronic acetophenone experiments, ES scores were compared between mice that were chronically exposed to various concentrations of acetophenone and those that were exposed to the control solvent DPG. The changes in ES scores and z-scored functional gene expression across conditions for each OSN subtype are described in Table S4 . The relative ES score change for each OSN subtype was calculated by subtracting the mean across all OSN subtypes, to normalize for any global changes across conditions that were present across the population of OSNs.
The Spearman’s rank correlation was also used to compare the consistency of ES scores in OSNs expressing the same OR across datasets. ORs identified in each dataset were compared, and the correlation coefficient was calculated on an OR-by-OR basis between the vectors of mean usages for each OSN subtype in each dataset (where each value is the mean ES score across all OSNs that express that OR in each dataset). On-diagonal values for pairwise correlation matrices were calculated via bootstrapping, by resampling with replacement the ES scores for each OSN subtype from the OSNs expressing that OR and taking the mean of the pairwise correlations (of the OR-by-OR ES score means) between all pairs (10,000) from 100 bootstrap restarts.
In all experiments, identity-related GEP usages were stable for each OR across conditions (ρ > 0.95), whereas the ES GEPs and ES scores moved predictably with changes in activity. To assess how the change in ES scores related to the overall change in transcriptomes across conditions, equal numbers of cells were subsampled for each OR, and the difference in the mean ES score for each OR was correlated with the PCs of the Δ HVG versus OR matrix (the difference in mean expression of each HVG between cells expressing each OR in each condition). In the chronic occlusion, optogenetic stimulation, and environment switch experiments, the changes in ES scores were strongly correlated (ρ > 0.8) with the top PC of this matrix, and thus well aligned with the main axis of overall gene expression changes. Given that ES scores are also aligned with the top PC of the transcriptomes in the home cage, these data together suggest that activity-regulated ES genes define a main axis of transcriptional variation, and experimental manipulation causes restricted changes in gene expression along this axis.
ORs with significant changes in their associated ES scores across datasets were identified empirically using the d-prime metric, which measured the separability of the ES score distributions for each OSN subtype. Within each OSN subtype, the d-prime statistic was calculated by taking the difference in the mean ES scores for each condition and dividing by the square-root of the average of the variance in the two conditions. This observed d-prime statistic was compared to the distribution of resulting d-prime values from permuting the condition labels across all cells of a given OSN subtype 10,000 times. P values were calculated empirically, corrections for multiple comparisons were performed via the Benjamini-Hochberg FDR procedure, and FDR-corrected p values ≤ 0.01 were considered as statistically significant. ORs with significant shifts in the chronic occlusion and environment switch experiments had mean d-prime values of 5.63 and 2.50, respectively, indicating excellent separability. OSN subtypes with significant ES score changes were separated into those whose mean ES scores increased and decreases based on the sign of the difference in mean ES scores across datasets. In the environment switch experiments, each pair of environments was analyzed separately, but results are concatenated across the 3 environment pairs (and therefore in plots depicting OSN subtypes there are 3 datapoints for OSN subtypes identified in all 3 environments).
Pairwise OR classification and classification of OR identity was performed using the same cross-validation and balanced subsampling procedures described above. However, rather than performing gene selection and dimensionality reduction during training, the direct input to the linear SVM classifiers was the GEP usages for each OSN for either all 10 OR-specific GEPs or only the two ES GEPs, as specified. Classification was performed using the 831 ORs found in at least 10 cells in the home-cage data, the 436 ORs found in at least 10 cells in both nostrils in the chronic occlusion data, and in the 488/496/522 ORs found in at least 8 cells in home-cage, environment A and environment B datasets from the environment switch experiments. Despite using only 2 or 10 dimensions to distinguish the entire set of ORs, classification accuracies were above chance for all datasets, and at chance levels upon shuffling OR labels for each OSN.
Rather than identifying the OR expressed in each cell, linear SVM classifiers were also used to test whether OSNs expressing the same OR were distinguishable across datasets based on their GEP usages. Separate classifiers were used for each OSN subtype and k -fold cross-validation was used, with k set to be equal to the numbers of cells subsampled per condition. As expected, classification accuracy was significantly above chance for the chronic occlusion and environment switch experiments, especially for the ORs with significant ES shifts (but ORs with smaller but non-significant shifts were still discriminable at above-chance levels). Classification performance was similar using all 10 GEPs or only the 2 ES GEPs, and at chance levels when the dataset label was permuted across OSNs for each of 1,000 restarts, further demonstrating that the main change across conditions is restricted to changes in the ES score axis.
Classification of environment identity was also performed across randomly selected subpopulations of OSN subtypes, using a minimum distance classification procedure. Across 1,000 restarts, six OSNs were subsampled for each OSN subtype for each environment (from the 477 subtypes present with enough cells in all environments), and five OSNs were used for training. The mean ES score for each subtype for each of the three environments was calculated (yielding three training vectors containing the mean ES scores across the population of 477 subtypes). The ES scores of the held-out cells for each subtype were similarly concatenated into three test vectors. For each of the 1,000 restarts, subpopulations of the OSN subtypes (containing 1–50 subtypes) were randomly sub-selected 1,000 times and the training vector for that subpopulation with the minimum distance to the same subpopulation from each test vector was the predicted environment label; predictions were considered accurate if the training vector with the minimum distance came from the same environment as the test vector. Accuracies were summarized across restarts, and classification performance was at chance levels when the environment labels were shuffled across training cells for each OSN subtype.
Modified versions of the ES GEPs were constructed to assess the contributions of individual genes within the ES GEPs. Although many genes have low loadings for each GEP and a restricted subset have higher loadings, each GEP was defined based on their loadings across the entire set of 1,350 HVGs. To test whether the 73 functional genes could substitute for the entire set of HVGs, the loadings for all of the remaining HVGs were set to 0, the total loadings for each GEP were rescaled to sum to 1 across the 73 functional genes, and this new gene loading (H) matrix was used to calculate updated usages (W) by reapplying NMF (with update_H = False).
The “functional” ES score, constructed again as GEP High - GEP Low from the new set of usages was highly correlated (ρ > 0.99) with the ES score from all HVGs, decreased as expected upon occlusion, and could distinguish between OSNs expressing different pairs of ORs using the classification procedure described above, thus indicating that the “functional” genes and their expression can substitute for the entire set of HVGs ( Figure S4 ). We also observed that the levels of some of the activation genes varied slightly across environments. To assess the contribution of these activation genes on ES scores and on the ES scores changes measured after environmental shifts, the loadings for the 169 activation genes that were part of the HVGs were set to 0 for all GEPs and the GEP usage and ES score was recalculated as described above. The ES scores and changes in ES scores calculated using all HVGs or excluding the activation genes were highly correlated (ρ > 0.99), suggesting that activation genes (whose expression primarily changes during periods of acute activation) do not account for the significant shifts in ES scores observed across environments.
Pseudotime analysis was performed on the immature OSNs identified from mice housed in the home cages. The Leiden clustering procedure that was used to identify mature OSNs also identified clusters of immature OSNs, which were used for pseudotime analysis. Diffusion pseudotime (n_dcs = 10) was calculated in Scanpy on the nearest neighbor graph (n_pcs = 10, n_neighbors = 10), and normalized to the lowest pseudotime values of immature OSNs that had undergone OR choice and were expressing ORs. To compare gene expression patterns and GEP usages in immature OSNs expressing given ORs with those of their respective mature OSN subtype, only immature OSNs that had chosen and expressed ORs were used. Gene expression and GEP usage as a function of pseudotime were evaluated using linear generalized additive models (GAMs) in pyGAM. A linear GAM was fit using 15 basis splines (lambda = 1) for individual genes and fit using 50 splines (lambda = 5) for GEP usages, and the mean and 95% confidence intervals of the mean were evaluated across a grid of 500 evenly-spaced pseudotime values. The mature ES scores across OSN subtypes were discretized into five quantiles, and separate GAMs were fit using the immature OSNs expressing ORs from each mature ES score quantile.
Given the wide variation in gene expression across OSNs in the home-cage condition, differential expression testing was performed at the OR-by-OR level to identify genes that consistently changed across multiple OSN subtypes. Differential expression (DE) testing was performed using ORs found in at least 6 cells in each dataset to balance the trade-off between the number of OSN subtypes and within-subtype variance. Testing was performed via the Wilcoxon signed-rank test (comparing, for each gene, the differences between means for each OSN subtype across conditions). P values were corrected for multiple comparisons across genes via the Benjamini-Hochberg FDR procedure.
For chronic occlusion, the DE genes with the most significant changes were defined as those among the top 500 genes with the lowest p values that had consistent changes across ORs (same sign of change in at least 50% of the 673 OSN subtypes detected in at least 6 cells in each nostril and absolute value of the median log 2 -fold change across OSN subtypes of at least 0.5); however, consistent results were obtained across a wide range of thresholds given that most DE genes changed in the majority of the OSN subtypes. As expected, genes that increased or decreased during occlusion had high loadings for GEP Low and GEP High , respectively.
DE testing via the Wilcoxon signed-rank test was also performed to identify genes that were acutely responsive to odor exposure. For each odor, the same DE testing procedure was performed separately for activated and non-activated OSN subtypes (as defined based on the percentage of activated cells expressing that OR; see below). To exclude the small subsets of genes that changed indiscriminately across all OSN subtypes regardless of whether they had been activated by odor, genes whose p value was higher for non-activated ORs or those whose mean change in expression across OSN subtypes was less than 1.5 times higher in the activated than non-activated OSN subtypes were removed and not considered for downstream analyses.
OSN subtypes that were responsive to odorants were identified via a two-step process. First, individual OSNs (as defined by the expressed OR) were determined as activated based on their mean z-scored immediate early genes (IEG) expression. A set of 10 IEGs were used ( Btg2, Egr1, Fos, Fosb, Gm13889, Junb, Nr4a1, Nr4a2, Pcdh10, and Srxn1 ). These genes were reliably and strongly induced in odor-exposed mice and, unlike many of the activity-dependent genes that are part of the ES GEPs and whose expression varies widely across OSNs expressing different ORs, these IEGs had consistently low expression across OSNs in control mice (average expression ∼0.15 in the control conditions and average log 2 fold-change of ∼5 in the odor conditions). The set of 10 IEGs was used since even though all of the IEGs were specific to acute activation by odors, they were still only detected in a minority of cells due to the sparse nature of scRNA-seq. The means and standard deviations for IEG z-scoring were fit on the TPT-normalized IEG expression (without the log transformation due to the sparsity of expression) across 100 restarts containing equal numbers of subsampled cells for each OR from mice that were exposed to either acetophenone or octanal. OSNs whose mean z-scored expression was above 0.2 (∼15% of OSNs in odor-exposed mice but less than 2% of OSNs in control mice exposed to the DPG solvent alone).
Second, as expected, the distribution of the percent of OSNs per OSN subtype was bimodal, with a majority of OSN subtypes showing low percentages of activated OSNs with a smaller subset showing high percentages of activated cells. Using the ORs detected in at least 4 cells in both control and odor-exposed conditions, activated ORs were defined as those in which less than 20% of cells expressing that OR were activated in the control conditions and more than 70% of cells were activated in the odor-exposed conditions, with the additional requirement of non-zero expression of at least 4 IEGs (to avoid false positives from OSNs activated by semiochemicals in the empty cages used for Act-Seq or those that strongly induced a small number of IEGs). Given that the set of ORs and the number of cells expressing each OR differed across datasets, odor-responsive OSN subtypes were re-evaluated for each dataset. Overall, odor-responsive OSN subtypes that were detected in multiple datasets were consistently identified as odor-responsive, though a small fraction of them (and thus their expressed ORs) were identified as activated in some datasets but only partially activated in others. These results are likely due to both the consequences of experimental manipulations, which were designed to affect odor responses, as well as the relatively conservative thresholds used above to identify ORs as activated.
For the environment switch experiments and the Act-Seq experiments using the four acetophenone-related odors, activated ORs were identified as described above, except using an IEG threshold of −0.05 because of the higher levels of IEG expression in the 10x v3.1 data. For the acetophenone concentration series experiment, activated ORs were either identified for each concentration, or the ORs identified as activated at 10% were also examined at lower concentrations, as specified in the text. In the optogenetic stimulation experiments, no IEG thresholds were used to identify activated cells, and instead all dorsal OSN subtypes were used for downstream analyses. In the chronic acetophenone exposure experiments, the set of acetophenone-responsive ORs identified via the acute Act-Seq experiments were used.
Although IEG induction could identify activated OSNs in a binary manner, the sparse nature of the IEGs made them less suitable for measuring differences in the degree of activation. Therefore, a larger set of odor-responsive genes (from the DE genes identified above) were used to construct an analog metric for activation and therefore compare differences in the amount of activation across OSN subtypes (as defined by their expressed ORs). The set of “activation” genes used for this metric satisfied the following criteria 1) significant responses (FDR ≤ 1 × 10 −3 ) to both acetophenone and octanal, and 2) average TPT-expression of at least 0.8 in activated ORs (such that the metric wouldn’t be biased by the presence of zeros). Acetophenone and octanal induced similar changes in gene expression in their respective responsive OSN subtypes. Of the ∼500 genes passing these criteria, the small number of genes that had high (ρ > 0.4) correlations with the ES score in the control mice were removed, leaving a set of 472 “activation” genes that were used for all Act-Seq experiments ( Table S5 ).
Consistent with activation score genes generally not being differentially used in the home cage, the majority of these activation genes were not part of the 1,350 HVGs in the home-cage data, and thus do not contribute to any GEP usages. The remaining 169 activation genes that were also considered as HVGs often had weak loadings across multiple GEPs. Only 16 of these 169 genes had high loadings for GEP High , and removing all activation genes from the HVGs and recomputing GEP usages yielded similar results. Together, these results suggest that activation gene expression is specific to the acute effects of odor exposure and does not contribute significantly to baseline variation in transcriptional identities or ES scores across OSN subtypes. To summarize the effects of odor activation across this set of activation genes, the TPT-expression of these activation genes were z-scored (using means and standard deviations for these genes in the control, acetophenone, and octanal datasets, identified by subsampling equal numbers of cells across all ORs expressed in at least 6 cells across 100 restarts). Next, using the combined set of activated acetophenone- and octanal-responsive OSN subtypes, PCA was performed on the differences in z-scored activation gene expression between control and odor conditions. The top PC of this activation gene delta matrix was kept, and the activation score was defined as the product of the weights for this top PC and the difference in z-scored activation gene expression between odor and control conditions.
Thus, the activation score summarizes for each OSN subtype the overall movement of the activation genes between control and odor conditions along this main activation axis. Although the activation score weights were fit using the combined set of acetophenone- and octanal-responsive OSN subtypes expressed in at least 6 cells for stability purposes, all subsequent Act-Seq results are shown using the larger sets of ORs detected in at least 4 cells in both control and odor conditions. To obtain activation scores for OSN subtypes from other datasets (such as those in the transient occlusion and environment switch experiments), the activation score was evaluated in a similar manner by multiplying the activation PC weights and the delta activation gene expression (odor – control) for each OSN subtype. Only activated OSNs from the odor-exposed mice were used for calculating the activation score. The weights were kept constant across experiments, but three separate versions of the gene scaling was used for the ACE and OCT Act-Seq experiments, the transient occlusion experiments, and all other Act-Seq and environment switch experiments, respectively, to account for changes in the gene means due to differences in 10x kit versions and sequencing depth across these datasets. In all experiments, activation scores were higher in odor-exposed and odor-responsive OSN subtypes. Across replicates from the same condition, OSN subtypes had consistent levels of activation, demonstrating that the activation score successfully captures differences in the amount of activation in each condition across OSNs expressing different ORs.
Two additional complementary methods were used to identify activated cells and measure activation in the ACE and OCT Act-Seq experiments. First unsupervised graph-based Leiden clustering (resolution = 0.6) was fit on the top 20 PCs from the scaled HVGs (where PCA was fit using equal numbers of cells from control, acetophenone, and octanal mice and applied to all cells). A single cluster bore the hallmarks of activated cells, and primarily contained cells from the odor condition with increased IEG expression. Additionally, nearly all of the OSNs from odor-exposed mice that expressed activated ORs, as identified via the IEG approach described above, were part of this activated cluster.
Second, activated ORs and weights on genes affected by odor exposure were simultaneously identified via unsupervised tensor component analysis (TCA). Nonnegative tensor decomposition was fit using the hierarchical alternating least-squares algorithm (ncp_hals) in the tensortools python package ( Williams et al., 2018 108. Williams, A.H. ∙ Kim, T.H. ∙ Wang, F. ... Unsupervised discovery of demixed, low-dimensional neural dynamics across multiple timescales through tensor component analysis Neuron. 2018; 98 :1099-1115.e8 Full Text Full Text (PDF) Scopus (63) PubMed Google Scholar ), and the tensor of conditions x activation genes x OSN subtypes was reduced with a rank 4 decomposition into 4 rank-1 tensors. One of these tensors represented activation and had 1) high weights in the odor but not control condition, 2) high weights for activation genes affected by acute odor exposure (like Pcdh10 and Fos) , as well as 3) high weights for the odor-responsive OSN subtypes identified above based on their IEG expressions; furthermore, the TCA weights for the activation factor for each OSN subtype was correlated with the mean activation score for that subtype (ρ > 0.85 for both ACE and OCT).
ES scores were compared to the activation scores for each OSN subtype to test how OSN transcriptional variation affects odor responses. All correlations were calculated between the ES scores in control mice and the activation scores from separate odor-exposed mice, using the set of odor-responsive OSN subtypes detected in at least 4 cells in both control and odor conditions. Comparisons were made at the OSN subtype level, between the mean ES score from the control condition and that OSN subtype’s activation score. When comparing the change in ES score and change in activation scores across datasets, only OSN subtypes present in at least 4 cells in both control and odor conditions for each dataset being compared were used.
Cross-validated linear regression models were constructed using the TPT-normalized expression of the functional genes in the control mice as predictors of the activation score in odor-exposed mice. Regularization was performed using elastic-net regularized linear models, where the optimal hyperparameters (alpha, the l1-ratio, and standardization of regressors) were identified through grid searches for each dataset. 5-fold cross-validation was used, and model performance was evaluated via the mean squared error (MSE) between predicated and observed activation scores from each test fold. This cross-validation procedure was repeated 1,000 times and the distribution of observed MSEs was compared to the predictions obtained when the same models were trained and tested on data in which the activation scores were permuted across OSN subtypes; this shuffling procedure represents performance similar to that of null models that predict the mean activation score for all subtypes. Reported errors were normalized as a percentage of the observed data to facilitate comparisons across datasets. For a subset of datasets, the predictions of the activation score from the functional genes were also compared to predictions from ordinary least-squares (OLS) linear regression models that used the control ES score as a single predictor. Predictions of the changes in activation scores were evaluated in a similar way to those of the activation score, except the changes in functional gene expression for each OSN subtype were used as predictors. In addition to shuffling the change in activation score across OSN subtypes, these models were also evaluated on data where the condition label was permuted across OSNs for each OSN subtype before calculating the changes in the functional gene expression for that subtype.
Classification of odor identity for the acetophenone analogs based on activation scores was performed using a minimum distance procedure in a similar manner to classification of environmental identity via ES scores. The input was the set of 106 OSN subtypes whose ORs were activated by at least one of the four acetophenone-related odors and were detected in at least four OSNs for each odor (since few ORs were present and activated in enough cells across all four datasets; but see below). Across 1,000 restarts, three OSNs per odor were used for training and the fourth was used for testing. The mean activation score for each subtype for each odor was calculated. For each of the 1,000 restarts, subpopulations of the OSN subtypes were randomly sub-selected 1,000 times and predictions were considered accurate if, across the subpopulation of activation scores, the training vector with the minimum distance for each test vector shared the same odor label. Predictions were at chance levels upon shuffling odor labels across cells for each OSN subtype. The same classification procedure was also used for each pair of acetophenone odors, but the input was the set of ORs activated by both analogs for each pair to determine if the pattern of activation scores across OSN subtypes can distinguish between odors, even for ORs activated by both odors.
Classification of environments using OSN activation scores after odor exposure as predictors was performed using cross-validated linear SVM classifiers. Activation scores were computed for each OSN (rather than the OSN subtype as described above) by applying the activation gene weights to the difference in expression between the activation gene expression in each cell in the odor condition and that of the mean of its respective OSN subtype in the control condition. Classification was performed as before by subsampling equal numbers of cells per OR on each of 1,000 restarts, and prediction accuracies were at chance levels when the OR labels were shuffled across OR pairs or the environment pair labels were shuffled across the OSNs expression each OR.
The set of activated ORs identified via Act-seq were compared to those identified via the DREAM and phospho-S6 immunoprecipitation methods ( Jiang et al., 2015 42. Jiang, Y. ∙ Gong, N.N. ∙ Hu, X.S. ... Molecular profiling of activated olfactory neurons identifies odorant receptors for odors in vivo Nat. Neurosci. 2015; 18 :1446-1454 Crossref Scopus (62) PubMed Google Scholar ; von der Weid et al., 2015 100. von der Weid, B. ∙ Rossier, D. ∙ Lindup, M. ... Large-scale transcriptional profiling of chemosensory neurons identifies receptor-ligand pairs in vivo Nat. Neurosci. 2015; 18 :1455-1463 Crossref Scopus (61) PubMed Google Scholar ). In vitro EC 50 values to acetophenone for its receptors were obtained from ( Jiang et al., 2015 42. Jiang, Y. ∙ Gong, N.N. ∙ Hu, X.S. ... Molecular profiling of activated olfactory neurons identifies odorant receptors for odors in vivo Nat. Neurosci. 2015; 18 :1446-1454 Crossref Scopus (62) PubMed Google Scholar ; Saito et al., 2009 82. Saito, H. ∙ Chi, Q. ∙ Zhuang, H. ... Odor coding by a mammalian receptor repertoire Sci. Signal. 2009; 2 :ra9 Crossref Scopus (363) PubMed Google Scholar ). Only ORs from these prior papers that were also identified in the Act-seq experiments described above were used for comparisons. The 717 ORs detected in four or more OSNs in both DPG and acetophenone-exposed animals included 16/22 DREAM and 25/49 phospho-S6 ACE ORs. ORs that were not identified by Act-seq were also not identified in more than 4 OSNs in these experiments, suggesting that these receptors might be “missing” because they are expressed in particularly small numbers of OSNs; note that this observation raises the possibility that these receptors are also near the noise floor in the DREAM and pS6 methods, since these approaches rely on bulk sequencing approaches that are also likely affected by OR frequency. In contrast to the relationship observed between the control ES score and activation scores, there was no relationship between in vitro EC 50 values and activation scores from any concentration of ACE and OLS linear regression models were unable to predict activation scores from the EC 50 values alone.
OSN specific activation scores were measured after mice were shifted from the home-cage to environment A (envA). The activation score at these time points was then compared to the two-week changes in the ES score (as measured as the difference in the ES score between home-cage and envA-housed mice in the environment switch experiments). The activation score was calculated by applying the activation gene weights to the activation gene deltas between mice from each time point and control mice housed in disposable cages with regular food/bedding overnight. The activation scores were normalized by subtracting the mean activation score across OSN subtypes, to account for any non-specific changes in activation across the entire population (e.g., due to changes in odor sampling that may occur upon the transfer to new environment cages). The resulting “relative activation scores” were compared between OSN subtypes with significant increases and decreases in their ES scores after two weeks in envA, for subtypes present in at least 4 cells in all 4 conditions (home-cage and envA after two-weeks, as well as in the overnight control data and in the envA two hour dataset). As expected, OSN subtypes with significant increases/decreases in their ES scores after two weeks showed increased/decreased activation (relative to the mean) at each time point. In contrast, the opposite effects were observed for mice switched from envA back to home cages, and little activation was observed between mice switched to cages of the same environment.
The correlation between the activation scores at two hours and the two-week ES score shifts was evaluated using all OSN subtypes, and the two-week ES score shifts were also compared to the change in the ES score after 24 hours. Predictions of the sign of the two-week ES score based on the activation score at each time point was performed using 10-fold cross-validated linear SVMs (fit at the OSN subtype level using a random subset of 80 of the OSN subtypes whose ES scores significantly increased and 80 that decreased after two-weeks for classification on each of 1,000 restarts). Classification accuracy was consistently above chance levels but was at chance levels upon shuffling the sign of the two-week ES score change for each restart.
All surgical procedures were performed in accordance with the guidelines provided by IACUC at Harvard Medical School. Prior to surgery, 4-6 weeks old Omp-IRES-Cre;Ai95D (GCaMP6f) mice, were subcutaneously injected with the analgesic Buprenorphine-SR (1mg/kg) and anesthetized 1-2 hours later with isoflurane (3% induction, 1%–2% maintenance). The skin overlying the left olfactory bulb was retracted and the underlying periosteum was scraped off with a scalpel. The skull was subsequently cleaned with saline and allowed to dry. A 2.5 mm circular craniotomy was made using a biopsy punch (Integra Miltex) taking care not to damage the underlying dura. Gelfoam saturated with cold saline was placed over the craniotomy to reduce swelling and suppress minor bleeds. A custom cranial window was constructed using two circular coverslips (Warner Instruments, 3mm, #1 thickness). The first coverslip was ground down to 2.5 mm in diameter using a diamond scribe and subsequently bonded to the second 3mm coverslip using Norland 71 optical epoxy. With the smaller coverslip in contact with the dura, the exposed edges of the 3mm coverslip were gently depressed until flush with the surrounding skull and secured in place with glass glue (Loctite, P.N. 233841). This “top hat” design ensured a tight seal around the craniotomy. For head-fixation, a custom titanium head plate was positioned over the skull and, using a manual manipulator, aligned to be coplanar with the cranial window. Following alignment, the head-plate was secured to the skull using dental cement (C&B Metabond, Parkell) and the animal was returned to the home cage for recovery. The supplementary analgesic Carprofen (5mg/kg) was provided in drinking water for 4 days following surgery. Throughout the 1-2 weeks prior to chronic imaging, the craniotomy was regularly inspected for any changes in clarity. Animals with excessive overgrowth of dura and skull tissue were not imaged and were removed from the study. In order to keep the cranial window clear of debris between imaging sessions, the dorsal surface of the skull was covered with silicone sealant (Kwik-Cast, World Precision Instruments).
A 23-valve olfactometer was used to present odors, as previously described (Island Motion Systems, see Pashkovski et al., 2020 79. Pashkovski, S.L. ∙ Iurilli, G. ∙ Brann, D. ... Structure and flexibility in cortical representations of odour space Nature. 2020; 583 :253-258 Crossref Scopus (24) PubMed Google Scholar ). In brief, custom Arduino software was used to control valve opening and closing, thereby enabling switching between odor vials and the blank vial. This software also controlled the output of two mass flow controllers (MFC). The first MFC delivered a constant carrier flow at 0.75 L min −1 of purified air into a common channel; the second MFC supplied a constant flow at 0.25 L min −1 of clean air that was injected into an odor vial (see below) and then merged with the carrier flow 1 inch (2.54 cm) in front of the mouse’s nose. A larger exhaust fan drew air from the cage enclosing the imaging rig to prevent any cross-contamination between odors. Monomolecular odors were diluted in Mineral oil (Sigma), and this vapor-phase concentration was further diluted 1:4 by the carrier airflow. Odor presentations lasted for two seconds and were interleaved by 30 s of blank (Mineral oil) delivery. The order of presentation of odors was pseudo-randomized for each experiment, such that on any given trial, odors were presented once in no predictable order.
Chronic imaging of the dorsal surface of the olfactory bulb was performed after recovery from the surgery (1–2 weeks) under ketamine (100mg/kg) and xylazine (10 mg/kg) induced anesthesia, to specifically isolate responses in OSN axons with less modulation from local interneurons and long-range cortical feedback. Depth of anesthesia was assessed every 15 minutes via the toe-pinch reflex and intraperitoneal ketamine was administered at 1/3 concentration of the induction dose for anesthesia maintenance. Multiphoton imaging was performed at 60 Hz using a 16 kHz resonant galvo scanner (Cambridge Technologies) with a chameleon laser tuned to 920 nm delivered to 30-50 mW of excited power at the front end of the objective (10X Olympus XLUMPLFL10XW-SP lens, NA 0.6), as previously described ( Pashkovski et al., 2020 79. Pashkovski, S.L. ∙ Iurilli, G. ∙ Brann, D. ... Structure and flexibility in cortical representations of odour space Nature. 2020; 583 :253-258 Crossref Scopus (24) PubMed Google Scholar ). Emitted fluorescence was detected using Hamamatsu H10770PA-40 PMTs. Scanimage 5 was used for hardware control and image data acquisition; WaveSurfer was used for recording of acquisition, odor and frame triggers, as well as sniffing data in a subset of mice. To obtain consistent field of views across sessions, 0.5 mg of Texas-Red conjugated Dextran (3000 MW, D3328 Thermo Fisher) dye was injected subcutaneously, and the field of view was aligned using both red and green channels based on patterns of vasculature and glomeruli, respectively (using the first session as a template). Animals were monitored throughout each imaging session for any drift in the field of view across trials.
Initial experiments consisted of a cohort of four mice imaged across multiple environment shifts. Each imaging session consisted of at least 8 trials, in which each of the 7 odors were presented. The odors used included 3 odors that activate broad sets of the dorsal glomeruli and which were presented at both a high/low concentration (pentanone [25/2.5%], ethyl butyrate [2.5/0.25%], and pentanal [25/2.5%]) as well as a 7th blank odorant (Mineral oil). When mice were not being imaged, they were housed in either regular home-cage or Environment A (envA) cages, consisting of the same contents as used for the scRNA-seq experiments. Throughout the course of the experiment, mice were sequentially housed in the regular home cages (home1), envA cages (envA), and then regular home cages again (home2). 4–6 sessions were obtained for home1, 4–6 sessions were obtained for envA (across 14 days of housing in envA), and 2–3 sessions were obtained for home2 (across an additional 14 days of housing in the regular home-cage environments).
In an additional cohort of two mice, the responses to a broader panel of 16 odors (to facilitate decoding analyses) that densely activated the dorsal olfactory bulb were imaged. Each session consisted of at least 6 trials, in which a blank odor and each of the 16 odors (2.5% of pentanal, pentanone, ethyl butyrate, heptanal, hexanal, propanal, butanal, butanone, hexanone, ethyl acetate, propyl acetate, butyl acetate, benzaldehyde, tiglaldehyde, methyl tiglate, methyl valerate, all of which were obtained from Sigma except for methyl tiglate, which was obtained from Thermo Fisher) were presented pseudo-randomly. Throughout the course of the experiment, mice were sequentially housed in the regular home cages (home-cage) and envA cages (envA).
For alignment of the FOV across sessions, baseline-subtracted images were downsampled (from 60 Hz to 10 Hz) and the mean image from each session was used to register the field of view across imaging sessions. Registration across sessions was performed using an iterative approach to align each session to a common template session. First, the optimal geometric transformation that maximized the overall cross correlation between mean images was identified using OpenCV (findTransformECC with warp_mode = MOTION_HOMOGRAPHY and gaussFiltSize = 1). Next, local deformations were further aligned with Dipy (SymmetricDiffeomorphicRegistration with metric = CCMetric, level_iters = [250, 100, 50, 25], and inv_iter = 50). The resulting procedure gave an invertible warping for each session that was subsequently applied to all frames from that session. Throughout a session, the field of view was stable, and no motion correction was applied; therefore, after registration, glomeruli were stably aligned across all trials and sessions. The z-depth of the image plane was aligned for every imaging session based on the specific pattern of vasculature and glomeruli found in each mouse, and this single plane was imaged throughout each session. Figure S7 B shows that FOVs are stable across sessions and environments, as assessed by the pairwise enhanced correlation coefficient between mean images of the entire FOVs (computeECC function in OpenCV). Regions of interest (ROIs, glomeruli) were identified via Suite2p (skipping the registration and deconvolution steps) from the entire set of registered baseline-subtracted and down-sampled images from all sessions ( Pachitariu et al., 2017 76. Pachitariu, M. ∙ Stringer, C. ∙ Dipoppa, M. ... Suite2p: Beyond 10,000 neurons with standard two-photon microscopy bioRxiv. 2017; Google Scholar ). ROIs that covered multiple glomeruli or masks glomeruli split into multiple ROIs were manually corrected. Using the set of identified ROIs, fluorescence traces were manually extracted from the raw movies from each session by applying the session-specific warping described above to each movie and then taking the dot product of the fluorescence in the aligned movies with the pixel weights of each ROI mask. Neuropil subtraction was not performed since annuli from each glomerulus would overlap with other glomeruli and there was little background fluorescence outside of activated glomeruli.
For each trial and glomerulus, GCaMP signals were baseline-subtracted and normalized relative to their baseline (dF/F). The 10 th percentile of the ten seconds prior to each odor presentation was considered as the baseline. dF/F values were interpolated to 50 Hz and smoothed by convolving with a Gaussian filter (length = 21, standard deviation = 5). Because of the long duration of the initial cohort, in which mice were imaged across multiple environment shifts over more than a month, dF/F traces were z-scored for each trial; dF/F values were not z-scored for the later cohort, which was imaged for a shorter duration across a single environment shift.
Responsive glomeruli were identified separately for each environment. Responsive glomeruli were defined as those whose mean response from 0.0 to 3.0 s after odor valve onset was significantly higher than that of the prior 10 s (p ≤ 1 × 10 −3 , via the Wilcoxon signed-rank test and adjusted via the Holm–Bonferroni method across odors for each glomerulus) and whose mean z-scored dF/F was greater than 0.5 (or mean dF/F was greater than 0.125 for the second cohort).
Responses were aligned across trials using the population mean to account for the variability in response onset present because odors were given in open loop without controlling for sniffing. The set of glomeruli that responded in at least two environments with a positive mean odor response were used for aligning odor responses across trials. The population mean was computed across these responsive glomeruli for each trial and the population onset was defined as the first time point in which the population exceeded a threshold (0.75 for z-scored dF/F data and 0.25 for dF/F); traces were aligned across trials by shifting them based on the identified population onset. This alignment procedure increased the correlation of the odor response across trials for each odor, suggesting that responses are more reliable once aligned to population, rather than odor, onset. Sniffing was also recorded with a pressure sensor (Honeywell AWM3100V) in a subset of mice to further assess the performance of this alignment procedure. Sniffing signals were uncorrelated across trials when using the odor valve times but were correlated across trials when using the shifts identified via the population onset. After alignment, the population response reliably increased following inspiration, further suggesting that this alignment procedure helps to correct for variability in timing of odor responses across trials due to sniffing. After alignment relative to the population mean, responsive glomeruli were re-identified used the same thresholds and procedure described above, except now using the first 3 s after population onset, and responsive glomeruli kept for downstream analyses were those that were identified as responsive in at least two environments, and whose response to a given odor was a least twice that of the response to the blank.
For the responsive glomeruli for each odor, the mean response amplitudes for each trial (the mean dF/F or z-scored dF/F values in the first 3 s following population onset) were averaged across trials within each environment. Glomeruli whose odor response amplitude differed across environment pairs were identified via permutation testing. The observed differences in means across environments was compared to a null distribution calculated by following the same procedure after permuting environment labels across trials 100,000 times. P values were calculated empirically for each glomerulus-odor pair and were adjusted across pairs by the Benjamini-Hochberg FDR procedure. Pairs whose FDR-corrected p value was ≤ 0.01 were considered as significantly different across environments. Across mice and odors, 20%–80% of responsive glomeruli demonstrated significant shifts in response amplitudes across the shift from home-cage to envA. In contrast, fewer glomerular-odor pairs were significantly different between home1 and home2. Glomerular responses were considered as reverted if the response amplitudes in home2 were more similar to home1 than envA. While one would naively expect reversions via regression to the mean if data were independent, no glomeruli were identified as environmentally sensitive when environmental labels were shuffled before calculating the observed difference, indicating that the observed differences in response amplitudes between home1 and envA (as well as those between envA and home2) are not the results of spurious partitioning of responses. Together, these results suggest that a large fraction of glomeruli responsive to a given odor are stable within environments but vary across environments.
Population odor responses were analyzed using pseudo-populations of glomeruli imaged across mice. Pentanal elicited the broadest responses across the population of glomeruli and was therefore used to assess how the population response differed between environments. To test whether differences at the population level in the pentanal responses in envA compared to home1 were reverted in home2, an “environmental axis” that separated the home1 and envA responses was constructed. For each mouse, two testing sessions were held out for both home1 and envA, and the remaining sessions were used for training, and the response at each time point in these training sessions was averaged across all training trials. PCA was fit on the population responses in the training data to reduce the dimensionality of the glomerular population to 10 dimensions, and the mean response was calculated in 30 overlapping windows in time (each 2 s long starting from −0.2 s and each subsequent one offset by 0.05 s from odor onset). The differences across the 10 PCs between the response in envA and home1 was calculated for each window, and the weights were averaged across the 30 windows and then normalized by their L-2 norm. This procedure thus returns the projection vector designed to maximally separate the odor responses in the two environments. To test whether this projection generalized to held-out sessions, the PCA transformation was applied to the mean response in the held-out sessions for home1 and envA, as well as to the home2 sessions. The difference between the population responses along this environment axis between the held-out home1 and envA session sessions was compared to the difference between the home2 and held-out home1 sessions. This cross-validation procedure was repeated across 1,000 restarts, and the mean and standard deviations across restarts were evaluated. Across all restarts, the response in envA readily diverged after odor onset, whereas the response in home2 remained similar to that in home1 at all time points after odor onset.
Pairwise correlations for each odor pair were calculated for each environment using the population vectors of mean odor responses (averaged across the first 3 s following population onset). For each odor pair, the union of responsive glomeruli was used. The pairwise correlation distance between all trials for each odor was computed and the median across trial pairs was computed for each odor pair. This same procedure also applied to pairs of the same odor, and the on-diagonal of the resulting correlation matrix represents the median across trials pairs and demonstrates the stability of the population response to the same odor across trials. The difference in correlation matrices across environments was computed, and the observed difference in the mean absolute change in pairwise correlations of the lower triangle (excluding the diagonal) was compared to a null distribution of means from shuffling the environment identity of each trial across 10,000 shuffles. For both mice, the observed difference was greater than that observed in any shuffle. Correlation matrices are shown after hierarchical clustering odors using Ward’s method.
Classification of environment identity was performed for each odor separately using the responsive glomeruli for each odor. Classification was performed using pseudo-populations of glomeruli combined across mice, using the mean response for each glomerulus across the first 3 s following population onset. For each of 100 restarts, 18 trials were randomly chosen for each mouse for each environment and were split into 12 training and 6 test trials. Glomerular responses were permuted across trials within each mouse and then concatenated across mice to generate pseudo-trials for model training and testing. On each restart, subpopulations of glomeruli were randomly selected 100 times, thus yielding 10,000 models. Standardization across trials for each glomerulus via z-scoring and linear SVM classifiers (regularization parameter C = 0.1) were both fit on the training data and applied to predict the environment label of the held-out test pseudo-trials, and the accuracy was summarized for each subpopulation across restarts. Performance was a chance levels upon shuffling the environment labels of the training and test data.
Odor identity was predicted in a similar manner, using the mean responses across the first 3 s following population onset in pseudo-populations of glomeruli. For each of 100 restarts, for each environment, 6 test trials (containing the responses to each of the 16 odors) were randomly held out, and the glomeruli were randomly permuted across test trials 10 times to generate pseudo-populations for 60 test pseudo-trials for each of the 16 odors. The remaining training trials were randomly subsampled from each environment to yield 24 training trials for each odor. On each restart, subpopulations of glomeruli were randomly selected 20 times, thus yielding 2,000 (20 × 100) models for each threshold. A classification pipeline was fit on the training data, consisting of standardization across trials for each glomerulus via z-scoring, reducing the dimensionality via PCA (n_components = 5 when the number of glomeruli was < 10, else n_components = 10), and fitting linear SVM classifiers (“one-vs-one” configuration with regularization parameter C = 0.5), and then applied to the test data. The training data from each environment and the test data from held-out trials from each environment were each used for training and testing, thus generating all four combinations (2 × 2) of training and testing data from either the same or different environments. Classification performance was summarized across restarts for each threshold for each of the within-environment and between-environment training/testing combinations and compared to 1) performance when environment labels were shuffled across the training trials and across the test trials from each environment and 2) performance when the odor labels were shuffled. Classification performance quickly saturated with increasing number of glomeruli, was higher for held-out trials from the same environment, and was at chance performance when odor labels were shuffled.
Odor generalization was performed to determine how the changes in pairwise odor correlations observed across environments impacted odor coding. The same pseudo-populations were constructed for training and test trials from each environment as described above for odor decoding. The entire pseudo-population of glomeruli was used without subsampling. The training and test data was first transformed with the z-scoring and PCA transformation (n_components = 10) described above and fit on the training data. However, rather than fitting a single classifier to all trials from all odors, a separate classifier was fit on each odor pair in the training data ( 16 C 2 = 120 pairs) and applied to the remaining odor pairs (119) in the test data, thus yielding 120 × 119 = 14,280 predictions. This same procedure was repeated for each of the four within- and between-environment training/testing combinations, and the entire procedure was repeated when the environment labels were shuffled across the training trials and across the test trials from each environment. Classification accuracy from classifiers trained and tested on different odor pairs from the same environment (within-environment) was sorted across the 14,280 pairs and the accuracy for each pair in the within-environment condition was compared to that of the between-environment and shuffled-environment conditions. Although the overall distribution of classification accuracies was similar for each of the three conditions, the mean absolute difference between within-environment and between-environment accuracies for each pair was greater for the observed, rather than the shuffled environmental labels, further demonstrating that pairwise relationships between odors are altered across environments.
Single-cell RNA-seq analyses were performed in python (versions 3.6-3.8) using the Scanpy package ( Wolf et al., 2018 113. Wolf, F.A. ∙ Angerer, P. ∙ Theis, F.J. SCANPY: Large-scale single-cell gene expression data analysis Genome Biol. 2018; 19 :15 Crossref Scopus (758) PubMed Google Scholar ) as well as custom-written scripts using the open-source python scientific stack (pysam, SciPy, NumPy, scikit-learn, umap-learn, pandas, statsmodels, matplotlib, seaborn, Numba, Dask). cNMF was performed using modified versions of the code described in ( Kotliar et al., 2019 52. Kotliar, D. ∙ Veres, A. ∙ Nagy, M.A. ... Identifying gene expression programs of cell-type identity and cellular activity with single-cell RNA-seq eLife. 2019; 8 :e43803 Crossref Scopus (43) PubMed Google Scholar ) and accessed at https://github.com/dylkot/cNMF . Imaging data was analyzed using additional packages, including OpenCV and Suite2p ( Pachitariu et al., 2017 76. Pachitariu, M. ∙ Stringer, C. ∙ Dipoppa, M. ... Suite2p: Beyond 10,000 neurons with standard two-photon microscopy bioRxiv. 2017; Google Scholar ). Scripts to replicate data analyses are available at https://github.com/dattalab/Tsukahara_Brann_OSN .
Hypothesis testing was performed using non-parametric statistical tests, including the Mann-Whitney U Test and the Wilcoxon signed-rank test, except in the cases where p values were calculated empirically using resampling-based permutation tests. Distributions were compared via the Kolmogorov–Smirnov (KS) test. Experiments with multiple factors were tested with either a two-way ANOVA or with the Jonckheere-Terpstra trend test (calculated empirically via 10,000 permutations), a non-parametric extension of the Kruskal–Wallis test to evaluate trends across groups. Statistical tests that were performed for multiple genes, ORs, GEPs, glomeruli, and odors were corrected for multiple comparisons using the Benjamini-Hochberg FDR Procedure or the Holm–Bonferroni method, as specified in the text. The results of statistical tests are listed in the figure legends. The precision of sample statistics and regression trend lines were evaluated using bootstrapping, and, except where noted, plots and error bars depict the mean and the 95% confidence intervals of the mean across 1,000-10,000 bootstraps. Results from classification, regression, and other analyses were repeated across 1,000 restarts, using balanced subsamples of the data in analyses at the OSN-level to account for differences in OR frequencies. Throughout the paper, a non-parametric version of the boxplot (also known as a letter-value plot) was used to represent multiple quantiles and tails of large distributions of data (e.g., to summarize across OSN subtypes or sets of ORs or OR pairs) in an agnostic way that does require setting bandwidth parameters as in violin plots or kernel density estimates. Like a conventional boxplot, the largest box represents the interquartile range (25–75 percentile) and the median (dotted-line). Subsequent boxes recursively represent exponentially-smaller quantiles (the 12.5–25 and 75–87.5 percentiles, then 6.25–12.5 and 87.5–93.75 percentiles, then 3.125-6.25 and 93.75–96.875 percentiles, and so forth).

Section: Acknowledgments

We thank John McGann and Matthew Grubb for technical advice on naris occlusion; Venkatesh Murthy, Dima Rinberg, and Catherine Dulac for mice; and Kelsey Tyssowski, Vanessa Ruta, Rachel Wilson, Bernardo Sabatini, David Ginty, Michael Greenberg, Piali Sengupta, and the Datta lab for useful comments on the manuscript. We thank Neha Bhagat for laboratory assistance and Janet Wallace for administrative assistance. We thank the Bauer Core Facility at Harvard University for sequencing and the Flow Cytometry Core at Beth Israel Deaconess Medical Center. Portions of this research were conducted on the O2 High Performance Compute Cluster at Harvard Medical School. Illustrations were created in part with BioRender.com and Vecteezy.com . S.R.D. is supported by NIH grants R011DC016222 and U19 NS112953 and by grants from the Simons Collaboration on the Global Brain, the Brain Research Foundation, and the Tan Yang Center at Harvard Medical School. T.T. is supported by postdoctoral fellowships from the Japan Society for the Promotion of Science, the Louis Perry Jones Fund, and the Tan Yang Center. D.H.B. is supported by an NSF Graduate Research Fellowship and by NIH grant F31DC019017.
T.T., D.H.B., and S.R.D. designed the study and interpreted the data. T.T. and D.H.B. performed and analyzed scRNA-seq experiments; T.T., D.H.B., and G.G. performed optogenetic stimulation experiments; and T.T., D.H.B., and S.L.P. performed and analyzed functional imaging experiments. T.B. provided resources and assisted in experimental design and interpretation. T.T., D.H.B., and S.R.D. wrote the manuscript with input from all authors.
The authors declare no competing interests.

Section: Supplemental information (5)

Download all File (11.80 KB) Table S1. Summary of single-cell RNA-seq datasets for olfactory sensory neurons used in this study, related to Figures 1, 2, 3, 4, 5, and 6 File (325.13 KB) Table S2. Loadings of 1,350 highly variable genes for 16 gene expression programs identified by consensus non-negative matrix factorization of the home cage dataset, related to Figure 2 File (4.98 KB) Table S3. 117 environmental state neuronal genes, including 73 functional genes that may regulate sensory responses, related to Figure 4 File (2.18 MB) Table S4. Changes in Z -scored expression of 117 environmental state neuronal genes across conditions, for each OSN subtype, related to Figure 4 File (61.09 KB) Table S5. 472 genes used to calculate activation score that were acutely odor-sensitive in responsive OSNs, related to Figure 5 Eight values characterizing the 472 genes used to calculate the activation score are shown. Columns are as follows: “activation_score_loading”: gene loading for calculating activation score. “ess_correlation”: Spearman’s rho between normalized expression and environmental state score in the home cage dataset on OR-by-OR basis. “p_adj_ACE2h”: FDR corrected p values for the differential expression (via Wilcoxon signed-rank test) between control and acetophenone 2h samples for acetophenone responsive ORs on OR-by-OR basis. “ctl_expr_ACE2h”: Normalized mean expression for OSNs expressing-acetophenone responsive ORs in the control data. “expression_ACE2h”: Normalized mean expression for OSNs expressing acetophenone responsive ORs in the acetophenone 2h data. “p_adj_OCT2h,” “ctl_expr_OCT2h,” “expression_OCT2h”: same as the previous three columns for acetophenone responsive ORs, but for OSNs expressing octanal-responsive ORs.
