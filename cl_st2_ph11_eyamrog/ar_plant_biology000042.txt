We usecookiesto track usage and preferences.I Understand
A pan-genome is the nonredundant collection of genes and/or DNA sequences in a species. Numerous studies have shown that plant pan-genomes are typically much larger than the genome of any individual and that a sizable fraction of the genes in any individual are present in only some genomes. The construction and interpretation of plant pan-genomes are challenging due to the large size and repetitive content of plant genomes. Most pan-genomes are largely focused on nontransposable element protein coding genes because they are more easily analyzed and defined than noncoding and repetitive sequences. Nevertheless, noncoding and repetitive DNA play important roles in determining the phenotype and genome evolution. Fortunately, it is now feasible to make multiple high-quality genomes that can be used to construct high-resolution pan-genomes that capture all the variation. However, assembling, displaying, and interacting with such high-resolution pan-genomes will require the development of new tools.
Article metrics loading...
A pan-genome is the nonredundant collection of genes and/or DNA sequences in a species. Numerous studies have shown that plant pan-genomes are typically much larger than the genome of any individual and that a sizable fraction of the genes in any individual are present in only some genomes. The construction and interpretation of plant pan-genomes are challenging due to the large size and repetitive content of plant genomes. Most pan-genomes are largely focused on nontransposable element protein coding genes because they are more easily analyzed and defined than noncoding and repetitive sequences. Nevertheless, noncoding and repetitive DNA play important roles in determining the phenotype and genome evolution. Fortunately, it is now feasible to make multiple high-quality genomes that can be used to construct high-resolution pan-genomes that capture all the variation. However, assembling, displaying, and interacting with such high-resolution pan-genomes will require the development of new tools.
In the classical view of intraspecific genetic variation, the genome of each individual is described as a set of small variations on a commonreference genome. In recent years, however, comparative analysis of genomes or genome segments from multiple individuals of the same species has revealed that a single reference genome is inadequate to capture the genetic diversity of a species. These findings demand a more expansive view of genetic variation, in which genomes within a species may differ in more dramatic ways, including a diversity ofstructural variants (SVs)that, strikingly, can contain one or more genes. This in turn implies that the functional gene content of a species is far more variable than previously imagined.
Practically, while aligning sequence reads from many individuals to a reference genome effectively identifies small polymorphisms [single nucleotide polymorphisms (SNPs) and small insertions and deletions (indels)], this approach completely misses longer (>50 bp) stretches of novel sequences not found in the reference genome as well as sequences that are highly divergent from the reference genome (24,25). These larger SVs includepresence/absence variants (PAVs)andcopy number variants (CNVs)(Figure 1). Significantly, SVs can be large enough to contain genes, sometimes many genes. While numerous studies demonstrate the critical role SVs can play on agronomically important traits (e.g., resistance to biotic stress and abiotic stress, flowering time, plant architecture, yield, and grain or fruit quality) (reviewed in76), we do not have a firm grip on the spectrum, prevalence, and mechanisms for the formation for SVs in plants. This has motivated the construction of plantpan-genomes.

Figure 1Click to view


Most simply, the pan-genome can be defined as the nonredundant set of genes within a species (Figure 2). However, this gene-based definition misses all the diversity of noncoding sequences and the locations of repetitive elements like transposable elements (TEs), some of which may be important for gene regulation and phenotypic expression in eukaryotes, as well as gene-preserving SVs including inversions and translocations. A more inclusive pan-genome definition would be the nonredundant set of genomic sequences within a species (Figure 2c). Unfortunately, as discussed in detail below, this more broadly defined sequence-based pan-genome is much more difficult to construct, interpret, and display than a gene-based pan-genome with its discrete units of known biological meaning (Figure 2). Due to technical challenges, the plant pan-genomes constructed to date are primarily gene-based. Recent improvements in DNA sequencing, however, are greatly decreasing the cost of assembling very high-quality genomes, removing one of the barriers to constructing useful sequence-based pan-genomes for plants.

Figure 2Click to view


This review discusses the concept and nomenclature of pan-genomes and provides an overview of the construction, use, and limitations of the plant pan-genomes created to date. In addition, the difficulties of creating, studying, and interacting with plant pan-genomes are explored along with how recent advances may help overcome these difficulties.
The first pan-genome was constructed in 2005 from eight strains of the bacterial speciesStreptococcus agalactiaeby comparing de novo assemblies and annotations (78). In this study, the authors divided the pan-genome into two fractions: core and dispensable. The core genome consists of the genes present in all strains, while the dispensable genome consists of genes absent from one or more strains (Figure 2b). The dispensable genome was further divided into what the authors called “accessory genes” (found in at least two strains and missing from at least one strain) and “unique genes” (found in only one strain). Significantly, theS. agalactiaepan-genome was much larger than any individual genome within this bacterial species. In this review we use the term variable rather than dispensable to denote genes found in only some lines because dispensable implies that the organism could survive without such genes and this is almost certainly not the case (48). Simultaneous loss of multiple members ofvariable genefamilies may be lethal, and numerous epistatic interactions are also expected.
A practical limitation of binary terminology (e.g., core versus variable) is its sensitivity to assembly and/or annotation errors, which are inevitable in large genome collections. For example, if a truecore geneis missing from one genome because of error, it will be mistakenly counted as a variable gene. This becomes a significant problem as the number of genomes increases. Taken to the extreme, if enough genomes were sequenced, there could be no core genes identified simply due to technical errors. To correct for this kind of error, some authors divide the pan-genome into additional fractions to represent how many lines a gene is present in. For example, Koonin & Wolf (37) divided bacterial pan-genomes into four fractions: core genes that are found in all genomes, soft-core genes that are found in almost all lines, shell genes that are found in fewer lines than the soft-core but more than just a few lines, and finally cloud genes that are found in only a few lines. This nomenclature has also been adopted for two plant pan-genomes (17,23) and has the advantage of grouping genes in such a way that robust comparisons can be made. For example, comparing core and shell genes will be a true comparison between genes found in all lines and genes that are truly missing in some lines without the dilution caused by technical errors such as missed core genes or artifactual genome annotations.
The widespread use of pan-genomes is hindered by the lack of standardized ways to define, construct, describe, or visualize them. Thus, comparisons between pan-genomes are fraught, and all of the assumptions and thresholds that went into making each pan-genome must be taken into account during any comparisons. Indeed, even when authors use the same nomenclature, the meaning may be different. For example, while most studies define the core genome as the set of genes found in all lines, some studies include genes found in an overwhelming majority of the lines, e.g., 95% (30). Thus, care must be exercised when comparing results from different groups as well as when interpreting the biological meaning of these results.
While a gene-based pan-genome is conceptually straightforward, it raises the question, When are two loci divergent enough to be considered different genes? It is common to group sequences within and between genomes by similarity to define groups of orthologous genes, but this can be especially problematic in plants where one often finds large gene families whose members have evolved over varying timescales from a common ancestral gene. Another consideration is how heavily, if at all, to weigh synteny when deciding which genes in two lines are the same gene. For example, two consecutive similar genes in individuals 1 and 2 could represent two distinct, tandemly duplicated genes, inherited from a common ancestor, or parallel duplications. Recent duplicates may have nearly identical sequences, which leads to cases where there are clearly two genes in one line and one gene in another. Is a gene a discrete physical entity, or is a gene really the known or potential function of the DNA sequence? If one considers genes as discrete transmissible DNA sequences, then recent duplicates should be counted as two genes represented in the pan-genome.
A more conservative approach would be to consider genes with nearly the same sequence, and presumably the same or similar function, as a single pan-gene. Using this approach in the simple example above, a cluster of tandemly duplicated genes would be represented as a single pan-gene. However, all genes in the cluster contribute DNA sequences to the pan-gene cluster capturing population-level variation. This clustered pan-gene approach has the advantage that it is not confused by gene duplication and/or gene movement, and most plant pan-genomes constructed to date use clustering based on similarity to construct a gene-based pan-genome. However, the clustering process inevitably leads us back to the question of when two sequences are divergent enough to be called different genes, and each study uses its own thresholds. As with almost everything biological, divergence is a continuum, and depending on the thresholds used, the pan-genome will be smaller or larger. Thus, as a practical matter, creating a pan-genome requires a number of assumptions and thresholds, and these must be taken into account when interpreting (and especially when comparing) published results, and authors should be up front about the implications of their methods.
While most pan-genomes constructed to date are primarily gene-based because of the relative ease of comparing and categorizing discrete units defined by transcription and translation, the importance of noncoding and repetitive sequences is unquestionable. It would therefore be extremely powerful to define a comprehensive sequence-based pan-genome that includes information about the relative position of all sequences. Unfortunately, interpreting noncoding sequence variation is challenging. Indeed, even for classes of noncoding sequences of known importance, e.g., promoters, our ability to predict and define their boundaries is poor. Thus, there is no straightforward way to functionally partition and compare nongenic sequences as there is for genes. Repetitive sequences like TEs present additional challenges, as they may be found in the genome in various stages of mutational decay. Nevertheless, these sequences play important roles in regulating gene expression, as was elegantly demonstrated by an analysis of TEs and grape color (35). The mobility of these elements makes their inclusion in pan-genomes all the more important because they are responsible for much of the intraspecific sequence diversity (6,47).
Genome size is determined by the net effect of processes that expand and contract DNA sequences. Differences in these processes between individuals create the structural variation observed inpan-genomes. Thus, an understanding of these processes is useful for understanding the challenges of accurately assembling and interpreting pan-genomes. The primary mechanisms contributing to genome expansion are polyploidization (whole-genome duplication), segmental duplication, proliferation of repetitive DNA sequences, and unequal crossing over, often fostered by repetitive DNA (56,63,85). The main mechanisms contributing to genome contraction include TE-mediated unequal homologous recombination, illegitimate recombination (nonhomologous recombination), and deletion-biased double-strand break repair (reviewed in69).
It is well known that all plants are derived from ancient polyploidization events, and many lineages have undergone more recent polyploidization events (67,84). Polyploidization has two important consequences for pan-genomicSVs: (a) the absence of selection pressure to prevent the loss of some redundant genes and sequences and (b) recombination-mediated exchanges between nonhomologous chromosomes leading to the doubling or loss of chromosome fragments (85). The relative contribution of these mechanisms may vary between species. For example, inArabidopsis, illegitimate recombination was the main driving force behind its decreased genome size, whereas deletion-biased double-strand break repair contributed to genome shrinkage in the carnivorous plantGenlisea nigrocaulis(82). This is relevant to pan-genomic SVs because individuals that share the same polyploidization event may retain, add, or lose different genomic segments.
In addition to polyploidy, several potential mechanisms can cause the de novo formation of SVs, including illegitimate recombination between copies of repeated sequences such as TEs, transfer RNA genes, or segmental duplications; rearrangements associated with DNA repair by nonhomologous end joining; microhomology-mediated break-induced replication, contraction, or expansion of variable number tandem repeats; and mobile element insertions (reviewed in26,29). For example, many of theCNVsin rice have been attributed to TE insertions and nonhomologous end joining (4). Some inversions in maize have been demonstrated to be caused by illegitimate recombination and nonhomologous end joining (34,46,91,93,98). Whatever the cause, the SVs in the variable genome cause extensive genicPAVs. A substantial proportion of genes are affected by SVs directly or indirectly, and those genes can affect many processes, including biotic stress and abiotic stress tolerance, flowering time, plant architecture, yield, and grain or fruit quality (reviewed in76).
In addition to gene loss, some of the above-listed mechanisms of SVs in the pan-genome may also give rise to new genes. For example, although both whole-genome and smaller duplications are often followed by gene loss, some of the retained genes can evolve new functions due to relaxed selection pressure on homoeologous genes. Importantly, proteins coded by TEs can be co-opted (i.e., domesticated) by the host as an adaptation to evolutionary conflict (32). A classic example of TE domestication is found inDrosophila, where the integrity of the chromosome telomeres is maintained not by telomerase but by two non–long terminal repeat retrotransposons (59). Eukaryotes may also acquire genes from prokaryotes via lateral gene transfer, though the occurrence may be rare and restricted (39).
By 2015, numerous studies had demonstrated that large prokaryotic pan-genomes are the rule (81). The degree to which this could be extrapolated to eukaryotes, however, was not clear. The large differences between the biology of prokaryotes and eukaryotes could conceivably influence the size of the pan-genome. In particular, the very concept of a species is not directly equivalent, the mechanism of genetic exchange between individuals of the same species is radically different, and the much higher frequency of horizontal gene flow in bacteria would be expected to dramatically influence the size of the pan-genome. Furthermore, the large size and nontrivial ploidy of plant genomes create major challenges in constructing and interpreting plant pan-genomes, including sequencing cost, assembly quality, annotation variability, and visualization and mining.
The notion of constructing plant pan-genomes was unimaginable before the advent of inexpensive short-read sequencing technology made it feasible to sequence multiple lines from a single species. Nevertheless, due primarily to the repetitive nature of plant genomes, it is impossible to assemble highly contiguous plant genomes from short reads alone. Creating high-quality assemblies is even more challenging for outbred and/or polyploid species due to the need to separate haplotypes of heterozygous individuals. Thus, short-read sequencing technology is most suited to studying gene space and inbred plants with small genomes and is the basis of virtually all plant pan-genomes published to date. The long reads produced by Pacific Biosciences (PacBio) sequencing technology span tens of kilobases and typically contain complete genic haplotypes. As a result, they are extremely powerful for assembling highly contiguous plant genomes because they can span repetitive regions and preserve haplotype phasing across genes. Recent decreases in the cost of PacBio sequencing and the higher accuracy of circular consensus sequencing for PacBio have made it feasible to produce highly accurate and contiguous whole-genome assemblies of multiple individuals from the same species. This will usher in a new wave of high-confidence plant pan-genomes that include noncoding sequences, repetitive sequences, and larger SVs (e.g., inversions) (47).
Given a collection of assembled genomes, the next step in interpretation is annotation, or the identification of functional features such as transcribed sequences and exon boundaries. Genome annotation is still very much an art, and the results of different annotation methods applied to the same genome can differ by thousands of genes. This layer of technical variability further complicates the comparison and interpretation of plant pan-genomes, especially when evaluating the size and significance of the core genome. Thus, when constructing gene-based pan-genomes, it is highly desirable that the same annotation protocol be used for all genomes including, wherever possible, using the same transcriptional supporting data (e.g., transcriptome sequencing) as inputs for each genome. Further complicating matters, we lack the ability to reliably predict and define regulatory regions and control elements that, for the most part, are completely ignored by annotation pipelines, greatly limiting the utility of the resulting pan-genomes.
In addition to the technical difficulties of creating pan-genomes, the tools for displaying and interacting with pan-genomes present additional challenges. Existing genome browsers and databases, with their focus on linear reference genomes, are ill-suited to display the complexity inherent in pan-genomes created from many individual genomes. This is especially problematic for sequence-based pan-genomes. As described in detail below, new tools and approaches are needed to fully utilize the increasingly accurate pan-genomes being produced.
Several plantpan-genomeshave been constructed (Table 1) using a variety of approaches that resulted in pan-genomes of varying degrees of completeness and accuracy. However, they all indicate that the pan-genome is substantially larger than any individual genome and that a large fraction of genes in any individual arevariable genes. The first hint that plant pan-genomes could be much larger than individual genomes came from studies that mapped individual sequence reads toreference genomes. Read mapping easily identifies SNPs and small indels (less than the length of individual read, typically 50 bp) in large numbers of plant genomes (e.g.,25,50). It can also identify larger deletions or highly divergent regions with respect to the reference genome as areas in which few reads map. This approach has been used by numerous studies to identify substantial amounts of reference sequence that were missing or highly divergent in nonreference genomes. For example, examination of twoArabidopsislines revealed 3.4 Mb of sequence that was deleted or divergent with respect to the reference genome (57), a survey of six divergent lines of the grassBrachypodium distachyonidentified 10–21 Mb of deleted or highly divergent DNA relative to the reference genome (24), and a survey of 302 soybean lines identified 6,388 deletions comprising 73.6 Mb with respect to two reference genomes (97). Since there is nothing special about the lines used to create the reference genomes, presumably there are similar amounts of nonreference sequence in each nonreference line indicating that the pan-genomes for these representative monocot and dicot species could be considerably larger than any individual genome. In this section, we highlight several plant pan-genome studies as examples of the different approaches ranging from early efforts, which made compromises to minimize sequencing cost, to the most recent studies, which are based on highly contiguous and accurate genome assemblies.
Plant pan-genomes
Abbreviation: NA, not applicable.
aThe number of unique genes or gene clusters is reported depending on how the pan-genome was constructed.
bIf applicable, the number reported is the number of pan-gene clusters, not the number of annotated genes.
cIf applicable, the number of high- and low-confidence pan-genes is reported. Low-confidence genes are usually defined as genes only appearing in one or a few genomes.
dIf applicable, the high-confidence pan-genome is used for this ratio.
eOnly transcripts are reported.
fEstimated by the authors.
gNCBI assembly GCA_011745865.1.

To overcome the size and complexity of the maize genome and estimate the size of the pan-genome, Hirsch et al. (28) used a pan-transcriptomic approach. They sequenced messenger RNA from the seedlings of 503 maize lines and assembled pooled reads that did not map to the reference genome. After removing transcripts that were similar to reference genes (>85% identity over 85% of the length), they identified 8,681 expressed genes that were not contained in the reference genome. While this approach is limited in that it only captures genes expressed in seedlings and is completely blind to noncoding sequences, it did demonstrate that the maize pan-genome was substantially larger than the reference genome. Maize possesses a large and notoriously variable genome, so learning whether these results could be generalized had to wait for studies in plants with less dynamic genomes.
A light shotgun-sampling metagenomic approach that combines low-coverage sequence from many lines prior to assembly is a cost-effective approach that takes advantage of identity by descent across multiple genomes. This kind of approach has been used to create pan-genomes for rice and wheat. Yao et al. (89) constructed a rice pan-genome from 1,483 rice lines. They removed reads that aligned to the reference genome and then pooled the remaining reads according to subspecies (one pool forindicaand one pool forjaponica) prior to independently assembling the reads from each subspecies. While this approach has the advantage of inexpensively sampling much more germplasm than is possible with de novo assembly of each individual line, the assemblies are, by definition, chimeric and it cannot be determined which genes came from which line. This method also misses low-abundance genes because the sequencing depth is too low, especially when polymorphisms are considered. Despite these limitations, 1,913 high-confidence nonreference protein-coding genes (out of 8,991 total nonreference protein-coding genes) were annotated for theindicalines, indicating that rice also has a substantial pan-genome. Significantly, the authors conducted a genetic association study that showed that 23.5% of metabolic traits were more significantly associated with nonreference genome markers than with reference genome markers and that 41.6% of SNPs associated with agronomic traits were in variable sequences. Thus, this study demonstrated the importance of variable genes and the value of pan-genomics for crop improvement. The very large hexaploid wheat genome presents challenges for pan-genome construction. Montenegro et al. (54) addressed this challenge using a metagenome approach. Based on 18 cultivars, they estimated that the full wheat pan-genome contains 140,500 genes, of which approximately 81,070 are core.
A pan-genome was constructed from 10Brassica oleracealines using an iterative mapping and assembly approach that assembled and inserted novel sequences from each line into the pan-genome before adding sequences from the next line (19). For each line, read pairs that both mapped to the current pan-genome (starting with the reference genome) were identified and eliminated from further consideration. Then the remaining read pairs, some with one read that mapped to the current pan-genome, were assembled. The resulting contigs were then inserted into the reference genome using read pairs that linked the current pan-genome to the newly assembled contigs. In this manner they constructed a pan-genome that was 20% larger and contained 3% (2,154) more genes than the reference genome. Interestingly, they noted PAVs in flowering time genes that may be responsible for the early flowering of the rapid cycling line TO1000. The same approach was used to create a pan-genome for 53 natural and synthetic accessions of the allotetraploidBrassica napus(31). Examination of the pan-genome revealed that homoeologous exchanges were the mechanism for some of the extensive PAVs observed. While these pan-genomes clearly identified novel pan-genome sequences beyond the reference and demonstrated the functional importance of the pan-genome, their utility is limited because the assembly and incorporation of sequence create chimeras and truncations. In addition, smaller variants (from SNPs to small indels) in each line are not captured.
A so-called map-to-pan approach was used to create pan-genomes for rice, pepper, tomato, and sunflower (17,30,58,83). To construct a sequence-based pan-genome from highly fragmented de novo assemblies, first the contigs were clustered and then the largest contig from each contig cluster was added to the pan-genome, which was then annotated.PAVsin all the lines were then called by mapping raw reads to the pan-genome. This approach allows for the creation of pan-genomes from large numbers of lines with relatively low sequence coverage. However, since the initial assemblies are incomplete and unannotated, the number and type of variants that can be unambiguously assigned to individual genomes are limited. Using this approach, Wang et al. (83) created a rice pan-genome based on 3,010 accessions. They identified more than 10,000 nonreference genes, which produced a gene-based pan-genome about 25% larger than any individual rice genome. Using the same approach, Ou et al. (58) constructed a pan-genome from 383 pepper lines corresponding to fourCapsicumspecies. Again, the pan-genome was considerably larger than any single genome; however, by including four species, the pan-genome constructed was also undoubtedly larger than the pan-genome for a single species. The same approach was used to construct a tomato pan-genome from 725 accessions, which identified 4,873 nonreference genes (17). A similar strategy using targeted assembly was used to construct a pan-genome from 287 cultivated sunflower lines (30). The authors first mapped reads to the reference genome and then assembled reads that did not individually map for each accession. The resulting contigs were clustered and the pan-genome constructed. Since the sequencing was low coverage, the resulting pan-genome is not comprehensive; nevertheless, the authors identified 2,700 nonreference genes that passed all their filtering steps.
Confidently estimating the core and variable genome size and identifying all variants (from SNPs to large indels) in individual genomes require the de novo assembly and annotation of the genomes from a large number of lines. The first pan-genomes that used this approach were created for two model plants,B.distachyonandMedicago truncatula(23,95). This was feasible because both species have small genomes that allow nearly complete, if still very fragmented, genomes to be assembled from short read sequences. Genomes from 15 lines were used to create theM. truncatulapan-genome, and genomes from 54 lines were used forB. distachyon. Both studies created the pan-genome by clustering genes based on sequence similarity. InM. truncatula, 67% of the genes in the pan-genome were variable and the pan-genome was 47% larger than the reference genome. TheB. distachyonpan-genome showed a similarly large percentage ofvariable genes, with about half the genes in individual genomes being variable. Since theB. distachyonpan-genome used a much higher number of genomes, the authors divided the pan-genome into four fractions:core genesthat were found in every line, soft-core genes that were found in almost every line, shell genes that were found in three or more lines but not included in the soft core, and cloud genes that were found in only one to two lines. They excluded the cloud genes from most analyses and focused on the remaining high-confidence pan-genome. Even with this conservative approach, the pan-genome contained 23% more gene clusters than the reference genome, and about half of the genes in any genome were variable genes. In addition to creating pan-genomes, both studies also identified all the smaller variants that can be recovered from the individual genome assemblies. Both studies also made rudimentary explorations of the role of TEs on gene expression and pan-genome evolution and found, not surprisingly, that TE insertions close to genes tended to decrease expression. While the fragmented assemblies are not ideal for detecting largerSVs, the authors of theM. truncatulapan-genome did catalog such variants. Encouragingly, 88–94% of the SVs in the lines examined were validated by PacBio long reads. These two studies agree with results from earlier studies onGlycine soja(43), rice (68), andBrassica rapa(45), which all used a similar approach, as well as a recent study on sesame (92), but these studies used many fewer lines and lower-quality assemblies that precluded firm conclusions about pan-genome size.
The next level of pan-genome construction is based on highly accurate and contiguous assemblies that can now be constructed at reasonable cost using PacBio sequencing. The very long (often megabase-scale) PacBio contigs can be placed into chromosome-scale scaffolds using Hi-C, optical mapping, and/or linkage maps. Theoretically, all variants, from SNPs to chromosomal translocations, can be identified by comparing these assemblies. A pan-genome for 27 soybean lines was constructed from high-quality assemblies (26 PacBio assemblies and the reference genome) (47). Similar to other pan-genomes from de novo assemblies, a gene-based pan-genome was constructed by clustering genes based on similarity. In addition, the high contiguity of the assemblies allowed them to call 776,399 SVs with respect to the reference genome. They next consolidated the SVs into 124,222 nonredundant SVs, used those to create asequence graph(described in detail below) as a representation of the sequence-based pan-genome, and found that about 78.5% of all PAVs were located in repetitive regions. They then made another sequence graph, which excluded PAVs that contained >90% repetitive sequence. This less repetitive graph was used to call 55,402 SVs in 2,898 accessions by mapping sequence reads to the graph. This approach removes the bias inherent in calling variants with respect to a single reference genome and gives a more comprehensive picture of PAVs at the population level. It should be noted that while sequence graphs were used as part of the analysis to show that TE insertions were correlated with changes in gene expression and variation in agronomic traits, the authors neither used the graphs to construct the pan-genome (see the section titled Sequence-Based Pan-Genomes and Graph-Based Analysis) nor released the graphs in an easily accessible format, which limits their utility to the community.
Although the main focus of this review is thepan-genomesof plant species, the concept of a pan-genome as the collection of all genetic sequences found in a species (or other taxon) is more generally applicable (65). The most widely studied pan-genome among animal species is, of course, that of humans (33,42,71,77), although over the past few years pan-genome projects have been undertaken for fruit flies (12,40), mice (44), pigs (79), and salmon (7). These studies, performed with various methodologies, are difficult to compare directly to each other and to those of plants. It does appear, however, that plants have quantitatively larger pan-genomes. The earliest comparison of multiple human genomes identified 5 Mb of additional sequences in Asian and African genomes relative to the humanreference genomebased predominantly on samples of European origin (42). These sequences are mostly short, with only one-sixth of the novel sequence contigs longer than 1 kb. At the level of genes, while the authors found that nearly 100 human transcripts defined by transcriptome data and absent from the human reference could be aligned to the two nonreference genomes, one-third of these novel genes are members of highly variable families associated with immunity, with the remainder being predominantly hypothetical genes of unknown function. Comparable amounts of novel sequences were found in other human populations (33,77). Using a simple population genetics model of neutral insertion/deletion of new sequences and generously assuming a well-mixed large population size of 6.5 billion, Li et al. (42) suggested that the species-level pan-genome could amount to as much as 40 Mb. A more recent comprehensive study of 910 humans of African descent (71), however, found 296 Mb of nonreference sequences across their sample and found higher levels of novel sequences shared with high-quality Asian genomes, suggesting that the original estimates of Li et al. for novel sequences per genome could be underestimated by a factor of 10. At the gene level, approximately 300 named genes were affected by structural variation. This human pan-genome study, the most complete analysis currently available, suggests that the human pan-genome accounts for 10% more genes than the reference genome. Other animal pan-genomes include pig (estimated at 72.5 Mb additional sequence beyond the reference, based on 11 genomes) (79) and mouse (14–75 Mb of nonreference sequences in each of 16 mouse strains). These are within a factor of three of the human pan-genome size.
Why are plant pan-genomes so much larger than mammalian pan-genomes? The answer to this question can be found by considering the mutational and population-genetic processes that produce species-level diversity. As with single nucleotide variation, structural variation arises initially as a mutation; neutral variation is subject to genetic drift, while other variation is either swept to fixation (positive selection) or lost (negative selection). Key parameters for analyzing pan-genomes are therefore the mutation rate for structural variation and the effective population size, which governs genetic drift, as well as the relative fraction of SVs that are neutral. Relative to animals, plants have several numerical advantages that lead to expectations of larger pan-genomes. At the mutational level, the large number of recently expanded transposable repetitive elements provides ample substrate for nonallelic homologous recombination that can produce duplications and deletions. Active TEs can also mobilize neighboring sequences and produce structural change. Similarly, hybridization with other taxa can also add novel variation; from the perspective of natural genetic variation, the effect of this kind of gene migration is similar to mutation. The relative rate of structural mutation between plants and mammals is therefore a key parameter to be determined. Since flowering plant species have a history of ancient duplications, residual effective redundancy may allow more of these SVs (especially deletions) to be neutral. A second crucial parameter is effective population size (36) since a larger population produces more mutations and can accommodate more standing variation due to drift. The larger effective population sizes of plants may explain the more than tenfold enhancement of standing single nucleotide variation compared with mammals. Standing structural variation is expected to scale linearly with effective population size. These mutational and population-genetic factors governing pan-genome size are appealing topics for future study.
Plant pan-genome construction has undergone dramatic technical improvement from initial studies based on short reads and incomplete assemblies to the use of highly accurate and contiguous PacBio assemblies. This development opens the door to creating much more comprehensive sequence-based pan-genomes that include accurately placed noncoding and repetitive sequences. The plant pan-genomes constructed to date are primarily gene-based pan-genomes. Even if these studies use some sort of sequence-based pan-genome assembly as an intermediary step, their most accessible output includes matrices ofPAVsand sometimes the corresponding genes from each individual line. Missing from these studies is an accessible representation or catalog of all sequence variants and their relationships to nearby (i.e., linked) sequences. This limits the utility of existing pan-genomes because they cannot easily be mined for nongenic sequences that control phenotypes (e.g., regulatory elements and insertions of TEs that influence gene expression) (6). In general, noncoding sequences are more variable than genes or TEs, and we know less about their biological significance. Some noncoding sequences (e.g., promoters and regulatory elements) play obvious roles, but the significance of the vast majority of noncoding sequences is unknown; however, conservation of some noncoding sequences over evolutionary time suggests an important role (80). Capturing the diversity of a species’ nongenic sequences and repetitive elements requires the construction of an accurate, accessible, sequence-based pan-genome.
Sequence graphshave the potential to be a powerful tool to represent, display, and/or construct sequence-based pan-genomes because they can compactly represent intersequence relationships. Distinct sequences are represented as nodes of the graph, and their spatial relationships to other sequences (usually, immediate adjacency or proximity) are represented as edges (Figure 3). Because identical or highly similar sequences between genomes collapse into common nodes, even large collections of many assemblies can be encoded compactly. The basis of a sequence graph is typically a set of sequence alignments that reveal common and divergent elements in the data set (Figure 3). The more divergent the sequences, the more nodes and edges are induced, and the more complex the graph. Although attractive by their generic nature, alignment-based sequence graphs face several challenges stemming from difficulties in aligning divergent sequences. For example, if related, but highly divergent, sequences fail to align, they will not be recognized as potential allelic or duplicated variants and will not be correctly represented in the graph. Large repeats within genomes also may create ambiguities and errors in the alignment, leading to tangles in the graph that are difficult to interpret. Approaches being developed to work around these problems include preventing the collapse of multiple nodes in the graph and restricting alignment to uniquely anchored chains, which avoids complex graph structures from the start (41). Other approaches are more thorough and inclusive in the early stages of alignment, with a subsequent attempt to unroll the complex structures of the cyclic graph into isolated direct acyclic graphs that lack path collisions and other ambiguities (16,62).

Figure 3Click to view


When reliable prior knowledge exists about the variant composition in a pan-genome (typically obtained via read-to-reference mapping), there are computational tools that can transform a linear reference sequence and a set of variant calls into graphs (18). This approach bypasses the computationally expensive all-versus-all alignment step along with the uncertainties of subsequent graph construction, but the trade-off is increased reference bias and a potentially incomplete variant picture, especially amongSVs, due to known limitations of current linear reference-based variant callers. It is still debated whether reference-guided graph construction or an all-versus-all alignment approach produces more practically relevant and computationally tractable results.
In apan-genomesequence graph, every node is sample-coherent, meaning that the complete sequence associated with a node exists in at least one of the input assemblies. To reconstruct a particular genomic region, one simply needs to “walk” along adjacent nodes that originated from the sample(s) of interest (Figures 2cand3). One can expect that homologous regions in a pan-genome will share many nodes in common and, therefore, could be viewed as a collection of similar paths diverging and converging precisely around variant positions. Since the graph contains, ideally, all the assembled sequence in the pan-genome, rare variants could potentially be revealed this way. It must be noted that this model requires either that the input assemblies should be from haploid/inbred organisms or that the contigs are fully haplotype-phased.
Representing and categorizing variants in the form of a pan-genome graph that can be useful to a user present new challenges. First of all, even with a handful of genomes, the topology of a graph can get very complex. Smaller variants nested inside large structural rearrangements add new layers of complexity to the graph, making it difficult to classify a region of variation and define its boundaries (see the section titled Graph-Based Variant Calling). Establishing a hierarchy of variation topology becomes an important task—one that is tightly dependent on the graph construction model chosen. One type of alignment graph called a cactus graph has features that allow it to be transformed into a hierarchical tree of related but independent subgraphs (60). In this transformation, a set of alternative paths that diverge and then converge again becomes a kind of supernode from which the subgraph buds out. As these abstracted subgraphs can themselves be quite complex, each can be further simplified into child nodes and buds, giving the whole structure a cactus-like appearance. This hierarchical decomposition not only reveals the substructure of the pan-genome but also breaks down the problem of variant categorization into a more manageable set of problems (60). Other formalizations of nested structures in direct acyclic graphs have since been proposed with the similar goal of providing a framework for establishing generic models of variation inference in pan-genomes (18).
Establishing a stable genome coordinate system for a pan-genome graph is another significant challenge. Such a coordinate system would allow users to refer to a feature in a way that parallels the use of areference genomecoordinate system. Graphs constructed from all-to-all pairwise sequence alignments lose the linear coordinate system associated with linear references, which poses an obvious challenge to defining variant loci. An important development in this area is the advent of Minigraph, a data model where reference coordinates are established on the graph topology and remain stable as new samples are iteratively added to the graph (41). In this model, the linear coordinate of a node is encoded precisely for the single sample that had induced it during the iterative graph construction, and since every node is sample-coherent, this coordinate will not change as more samples are added. Another suggested proxy for a coordinate system is to use node identifiers directly to infer a pan-genomic locus, avoiding altogether explicit linear coordinates (49). In this scenario, one question that deserves further exploration is whether it is feasible, for the purposes of visualization and analysis, for a variant locus to be defined solely in relation to its graph neighborhood or whether it would still have to be mapped back to the individual linear genomes on an as-needed basis by a particular application. Furthermore, such a system would be unstable as the addition of a new genome to the reference graph could disrupt the node content.
Finally, pan-genomes with a large number of rare variants can result in very large and highly branched graphs, creating substantial computational challenges for both graph construction and the access/query operations a user may want to perform on the graph. Ultimately, there is a limit to how much variation an alignment-based graph can represent, determined in part by the computational efficiency of the graph model, but also by the limitations of the underlying alignment methods. After all, a sequence graph is only as accurate and sensitive as the alignments it was built from, and an ever-increasing fragmentation in the graph will ultimately limit its alignability. Specialized sequence alignment methods and efficient graph representation models are needed to address these challenges. Efforts in this area are spearheaded by the vgteam, the creators of a far-reaching graph-based framework for working with pan-genome variation (18).
Reference graph data structures can represent both SVs and point mutations using the same semantics (27). However, since lengths of the polymorphisms involved vary dramatically, their discovery in a graph context is far from trivial. While there is no commonly accepted approach, a few methods have been proposed that we see as paving the way toward fully automated pan-genome variation profiling in the future. An intuitive way to discover pan-genomic variation embedded in a graph is by exploring its topology directly. Visually, a simple variant locus can appear as a bubble on a path through the graph. More complex variants can show up as nested bubbles and other patterns that can be more challenging to visualize and formally define (Figure 4). Computational algorithms, including the above-mentioned hierarchical graph decomposition, have been developed to automate this process of untangling the complex topology caused by nested variation (61). Once graph-embedded variant sites have been identified, one can envision mapping the reads back to the participating nodes to genotype each individual genome path through each bubble. For small variants, a direct read-to-graph pileup approach offered by VG tools can both call variants embedded in the base graph and detect novel variants, augmenting the graph in the process (55). Despite showing encouraging results in limited studies, much work lies ahead to make these methods more robust, sensitive, and applicable to different types of variation observed in pan-genomes.

Figure 4Click to view


At the present time, most publicly hosted plantpan-genomesdeploy traditional linear genome browsers [e.g., JBrowse (9), GBrowse (74), and IGV (66,74)] for viewing base-level variation and gene annotations with respect to a designated reference genome, withPAVclusters displayed in simple tabular views, or use repurposed gene family viewers [e.g., Phytozome's gene family report (21) or Legume Federation's Genome Context Viewer (13)]. RPAN (75), hosting a rice pan-genome with over 3,000 accessions, provides a single JBrowse genome browser built on the linear reference pan-genome, with PAV tracks and a mapped read coverage track for each accession. Genes in the browser are linked to a tabular view of PAV attributes (such as core versus noncore classification and gene presence frequency across major and minor subgroups of accessions). Searching by location, gene identifier, sequence similarity, or presence frequency within a user-specified subset of accessions is supported, but search results cannot be downloaded, only entire data sets. WheatPan (54) hosts a GBrowse genome browser built around an 18-cultivar hexaploid bread wheat pan-genome. PAV is indicated directly on the browser via pie charts for each gene, and details are available concerning which lines are present or absent. Genes are annotated via UniProt homology. The wheat pan-genome can be searched by region, gene identifier, and sequence similarity. BnPIR (73), theB. napuspan-genome information resource, includes a JBrowse instance built around the linear pan-genome constructed from eight high-quality assemblies, with PAV heatmap tracks, a GBrowse-based synteny view of all eight genomes simultaneously, and a separate variant browser. Detailed gene pages with functional annotation assignments are accessible via the Gene Search, and PAV cluster reports are available from the Gene Classification search page. In Phytozome's BrachyPan database (23), JBrowse genome browsers are available for the linear reference pan-genome, as well as for each of the 54 assembled and annotatedB. distachyonaccessions that were used to construct it. All genes from every accession are mapped into each accession's genome browser. Genes are color-coded and grouped into tracks based on whether they are part of core, soft-core, shell, or cloud PAV clusters, and each gene is linked to the BrachyPan PAV cluster for that gene. All gene and PAV cluster information can be downloaded from BrachyPan's BioMart (72) data warehouse, which also supports PAV fingerprint queries (e.g., “find all clusters with these accessions present and all others absent”).
While single reference linear genome browsers provide a reasonable entry point to exploring certain types of pan-genome variation (gene PAVs, SNPs, and smallerSVs), they fall short on providing users with a visual overview of larger-scale structural variation across the pan-genome, such as translocations, large insertions, and nested variation (e.g., a subset of accessions all having an insertion relative to the reference and that insertion sequence itself varying across the subset). Ideally, one would like to move seamlessly from broad surveys of the full range of variation captured in the pan-genome graph, to selecting a subgraph based on variant content or being anchored by genes of interest, and finally to drilling down to a view of those variants mapped onto the (or a) reference genome in our traditional linear genome browser view. As noted in recent reviews (14,16), multiscale plant pan-genome graph visualization remains a work in progress, impeded by the large size, variant density, and complexity of typical plant genomes. Many of the tools for visualizing assembly graphs [e.g., GfaViz (20), Bandage (86), and AGB (53)] struggle with regions larger than 0.1 Gbp (the model grassB. distachyonhas a reference genome nearly three times as large) and are difficult to decorate with annotation features, making them hard to query when a user or application needs to extract subgraphs and regions of interest. Some of the tools providing base-scale detail have similar maximum region size limits [e.g., sequenceTubeMap (8), VG (27)], though ODGI, for example, can potentially handle genomes on the giga–base pair scale. One tool combining large-scale and local-scale visualization is MoMI-G (90), which uses a Circos (38) plot to display pan-genomic variation on the whole-genome level, synchronized with a table of (filterable) variants and a sequenceTubeMap view of stacked linearized paths representing the pan-genome's constituent haplotypes, with base-level resolution. Selecting variants in Circos or the tabular display loads the corresponding region into the sequenceTubeMap view. As MoMI-G has limitations on the number of haplotypes and region size over which it can display a linearized view, efforts are underway to develop the Pantograph Genome Browser (70), which will enable stacked linearized path views encompassing an entire plant chromosome (giga–base pair scale) and for thousands of haplotypes. Combining a multiscale pan-genome browser like Pantograph with the traditional linear genome browsers’ search, display, and data mining tools provided by large public plant-genome databases would provide a valuable, integrated platform for studying both the structure and biological function of plant pan-genomic diversity.
While plant pan-genomics is still an emerging field that has not yet exerted a large impact on plant research and breeding, a few examples highlight its application to population genetics, the evaluation of wild relatives, and polyploid genome evolution. By definition, pan-genomes inform us about population genomics and the prevalence of genes and polymorphisms across populations, and most pan-genome studies include substantial population analysis. However, these analyses primarily focus on SNPs relative to areference genomeand as such are expansions of previous techniques and studies (28,30). With the advent of high-quality pan-genomes based on increasingly complete assemblies, researchers are gaining the power to comprehensively evaluate SVs at the population level. Recently, SVs have been used in genetic analysis, including genome-wide association studies (1) based on different types of SVs including PAVs (47,73) and TE insertion polymorphisms (11). Of particular interest for clonal crops, SVs have been shown to be a major driving force for plant evolution and domestication (2,96). However, most of these studies are based on SVs relative to a single reference genome with the discovery of insertion polymorphisms limited by read length. A full characterization of the different types of genetic variation can only be achieved with plant pan-genomes, where variations can be genotyped relative to a pan-genome instead of a single reference genome.
Hybridization and genomic introgression have been shown to be major sources of genetic variation in both animals (15,51,64) and plants (5,30,87). Genomic regions of introgression have been documented as hot spots for structural variations that contain disease resistance genes (3). With the possibility of fully characterizing different types of genetic variation, plant pan-genomes will enable genome-wide high-resolution admixture mapping across multiple scales and help pinpoint causal genetic mutations underlying specific traits.
Population stratification was traditionally studied with limited markers, and later with genome-wide SNPs, to understand evolutionary processes. With the advent of plant pan-genomics, PAVs have been used to characterize population differentiations (17,23). A complete characterization of the SV spectrum (type, size, frequency) enabled by high-quality (graph-based) pan-genomes will offer a powerful new window into the evolutionary processes behind different types of SVs. Population-specific SVs in particular may be associated with traits specific to that population. Adaptive SVs may be identified using simulations to disentangle demographic and selection processes (52,88).
Pan-genomes can also be created from multiple species or higher taxonomic groups to explore genome evolution. Not surprisingly, this approach has been applied to bacterial species. For example, core/pan-genome ratios were used to define new bacterial species (10). The rationales for multispecies pan-genome studies in plants include identifying genes and other sequences that could be transferred between species to improve crops, identifying historic introgressions between species, and understanding polyploid genome evolution. Pan-genomes from closely related, interfertile species are similar to a single species pan-genome in that, at least in theory, the genes have a possibility of exchange between individuals. Plant pan-genomes that fall into this category include rice and pepper (58,94). When pan-genomes include wild relatives of domesticated crops, many genes of possible agricultural use can be identified (e.g., disease resistance genes and genes characteristic of abiotic stress tolerance). For example, Zhao et al. (94) compared wild and cultivated rice genomes and identified potentially useful genes that could be transferred to cultivated rice by constructing a pan-genome from 54 accessions ofOryza sativaand 13Oryza rufipogonaccessions. They found 10,872 genes that were at least partially absent in the Nipponbare reference genome. As in other studies, thevariable geneswere enriched for genes involved in biotic and abiotic stress responses, exactly the type of genes that could be agronomically valuable. Another application of a multispecies pan-genome was used to study genome evolution after the polyploidization events that formed the allotetraploid grassBrachypodium hybridum. By constructing a pan-genome containing 52 genomes from one of the diploid progenitors and the corresponding D subgenomes from four polyploid genomes, the authors were able to distinguish genome evolution that happened before and after polyploidization (22). They determined that the D subgenome was evolving much more slowly than a simple comparison between single reference genomes would suggest. The substantial sequence divergence and changes in chromosome number between the diploid parents,B. distachyonandBrachypodium stacei, serve as substantial barriers to homoeologous recombination, which may contribute to the stability of the subgenomes. By contrast, a pan-genomic analysis of the recent allotetraploidB. napusrevealed that frequent homoeologous exchanges between the very similar subgenomes accounted for many of thePAVsobserved (31).
Technological improvements in long-read sequencing (e.g., PacBio circular consensus sequencing) have made it cost-effective to create multiple nearly complete genome assemblies for small- to moderate-sized plant genomes (up to 1 Gbp). These are the ideal raw material for creating highly accurate sequence-basedpan-genomesthat contain all the genes and noncoding sequences, as well as most repetitive elements in the proper order, orientation, and accurate long-range contiguity. A powerful scenario for using this technology would be to select 10–30 lines that capture the maximum amount of genetic diversity within a species and create reference-quality assemblies and annotations for this set. Significantly, several plant pan-genome studies have estimated the number of genomes required to capture most of the genomic diversity in a species and concluded that fewer than 30 genomes, selected to maximize diversity, are sufficient (19,23,28,83,94). A graph approach would then be used to create a high-confidence, sequence-based pan-genome from these reference-quality genomes. The resulting pan-genome graph would be used to generate displays that can be viewed at various zoom levels to allow users to visualize and search for all polymorphisms of interest, including large SVs, individual genes, and SNPs. The display would also allow the download and export of selected sequences and alignments for detailed analysis. This would complement a gene-based pan-genome that could easily be constructed from the annotated genomes. To capture the full diversity within a species, hundreds to thousands (such as in entire germplasm collections) of additional lines would be sequenced and assembled using short-read technology. The sequences and annotations from these lines would be aligned and added to the pan-genome graph and additional variants called and cataloged. The final result would be an extremely useful tool for studying natural diversity, identifying markers for breeding, selecting lines with desirable combinations of alleles, assigning function to noncoding sequences, and studying gene function.
D.S.R. is a member of the Scientific Advisory Board of Dovetail Genomics. The other authors are not aware of any affiliations, memberships, funding, or financial holdings that might be perceived as affecting the objectivity of this review.
The work conducted by the US Department of Energy (DOE) Joint Genome Institute is supported by the Office of Science of the US DOE under contract DE-AC02-05CH11231. We thank Dr. Peter Morrell and his lab members at the University of Minnesota for valuable comments.
Literature Cited
Data & Media loading...
Literature Cited


